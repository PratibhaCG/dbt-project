[0m18:37:06.707858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c5cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104133380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104133410>]}


============================== 18:37:06.709744 | 02eacb18-c06c-4e0f-b4e4-a1fc8f949d33 ==============================
[0m18:37:06.709744 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:37:06.710086 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'write_json': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'log_cache_events': 'False', 'target_path': 'None', 'printer_width': '80', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'empty': 'False', 'version_check': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_format': 'default', 'static_parser': 'True'}
[0m18:37:06.936782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02eacb18-c06c-4e0f-b4e4-a1fc8f949d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105360470>]}
[0m18:37:06.961475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02eacb18-c06c-4e0f-b4e4-a1fc8f949d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054fe960>]}
[0m18:37:06.962799 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m18:37:07.027220 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:37:07.027656 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:37:07.027867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '02eacb18-c06c-4e0f-b4e4-a1fc8f949d33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054fab40>]}
[0m18:37:07.536093 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m18:37:07.536731 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m18:37:07.571187 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_project.stg_policy_events' (models/example/stg_policy_events.sql) depends on a node named 'policy_events' which was not found
[0m18:37:07.573520 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.90021855, "process_in_blocks": "0", "process_kernel_time": 0.176277, "process_mem_max_rss": "125353984", "process_out_blocks": "0", "process_user_time": 1.295018}
[0m18:37:07.573819 [debug] [MainThread]: Command `dbt run` failed at 18:37:07.573771 after 0.90 seconds
[0m18:37:07.574010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045becf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a0f80>]}
[0m18:37:07.574174 [debug] [MainThread]: Flushing usage events
[0m18:37:08.964560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:50.597552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e42fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10585fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10585f7d0>]}


============================== 18:41:50.599388 | 7e815059-5270-49bf-bd42-9955338d7514 ==============================
[0m18:41:50.599388 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:41:50.599740 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'printer_width': '80', 'target_path': 'None', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'debug': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_format': 'default', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'write_json': 'True', 'no_print': 'None'}
[0m18:41:50.729150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e815059-5270-49bf-bd42-9955338d7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588dd00>]}
[0m18:41:50.753936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e815059-5270-49bf-bd42-9955338d7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d12b0>]}
[0m18:41:50.755433 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m18:41:50.797736 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:41:50.798161 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:41:50.798366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e815059-5270-49bf-bd42-9955338d7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad7a70>]}
[0m18:41:51.304178 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m18:41:51.304824 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m18:41:51.339181 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.unique_my_first_dbt_model_id.16e066b321' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m18:41:51.339502 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.not_null_my_first_dbt_model_id.5fb22c2710' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m18:41:51.339695 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.unique_my_second_dbt_model_id.57a0f8c493' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m18:41:51.339868 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.not_null_my_second_dbt_model_id.151b76d778' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m18:41:51.381724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e815059-5270-49bf-bd42-9955338d7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059cb2c0>]}
[0m18:41:51.421783 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:41:51.422753 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:41:51.433701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e815059-5270-49bf-bd42-9955338d7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060604d0>]}
[0m18:41:51.433935 [info ] [MainThread]: Found 3 models, 2 analyses, 5 data tests, 429 macros
[0m18:41:51.434111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e815059-5270-49bf-bd42-9955338d7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa13d0>]}
[0m18:41:51.434830 [info ] [MainThread]: 
[0m18:41:51.435014 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:51.435151 [info ] [MainThread]: 
[0m18:41:51.435395 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:41:51.437606 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m18:41:51.495086 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m18:41:51.495327 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m18:41:51.495480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:51.557521 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m18:41:51.558337 [debug] [ThreadPool]: On list_dev: Close
[0m18:41:51.558706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m18:41:51.559151 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m18:41:51.562140 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:41:51.562301 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m18:41:51.562423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:51.563072 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:41:51.563760 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:41:51.563885 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m18:41:51.564071 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:41:51.564191 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:41:51.564308 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m18:41:51.565013 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:41:51.565374 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:41:51.565497 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m18:41:51.565611 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m18:41:51.565783 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:41:51.565905 [debug] [ThreadPool]: On create_dev_main: Close
[0m18:41:51.566394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dev_main, now list_dev_main)
[0m18:41:51.568701 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:41:51.568880 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m18:41:51.569005 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:51.569215 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:41:51.569335 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m18:41:51.569463 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m18:41:51.578231 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m18:41:51.579620 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m18:41:51.580455 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m18:41:51.580599 [debug] [ThreadPool]: On list_dev_main: Close
[0m18:41:51.580860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e815059-5270-49bf-bd42-9955338d7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d8eb10>]}
[0m18:41:51.581083 [debug] [MainThread]: Using duckdb connection "master"
[0m18:41:51.581207 [debug] [MainThread]: On master: BEGIN
[0m18:41:51.581325 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:51.581537 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:41:51.581658 [debug] [MainThread]: On master: COMMIT
[0m18:41:51.581776 [debug] [MainThread]: Using duckdb connection "master"
[0m18:41:51.581890 [debug] [MainThread]: On master: COMMIT
[0m18:41:51.582083 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:41:51.582263 [debug] [MainThread]: On master: Close
[0m18:41:51.584055 [debug] [Thread-1 (]: Began running node model.my_project.load_policy
[0m18:41:51.584311 [info ] [Thread-1 (]: 1 of 3 START sql view model main.load_policy ................................... [RUN]
[0m18:41:51.584525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dev_main, now model.my_project.load_policy)
[0m18:41:51.584684 [debug] [Thread-1 (]: Began compiling node model.my_project.load_policy
[0m18:41:51.587370 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.load_policy"
[0m18:41:51.587803 [debug] [Thread-1 (]: Began executing node model.my_project.load_policy
[0m18:41:51.601837 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.load_policy"
[0m18:41:51.602349 [debug] [Thread-1 (]: Using duckdb connection "model.my_project.load_policy"
[0m18:41:51.602521 [debug] [Thread-1 (]: On model.my_project.load_policy: BEGIN
[0m18:41:51.602667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:51.602978 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:51.603170 [debug] [Thread-1 (]: Using duckdb connection "model.my_project.load_policy"
[0m18:41:51.603328 [debug] [Thread-1 (]: On model.my_project.load_policy: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.load_policy"} */

  
  create view "dev"."main"."load_policy__dbt_tmp" as (
    SELECT *
FROM read_csv_auto('data/policy_events.csv')
  );

[0m18:41:51.646919 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m18:41:51.649815 [debug] [Thread-1 (]: Using duckdb connection "model.my_project.load_policy"
[0m18:41:51.649998 [debug] [Thread-1 (]: On model.my_project.load_policy: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.load_policy"} */
alter view "dev"."main"."load_policy__dbt_tmp" rename to "load_policy"
[0m18:41:51.651013 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:51.655237 [debug] [Thread-1 (]: On model.my_project.load_policy: COMMIT
[0m18:41:51.655409 [debug] [Thread-1 (]: Using duckdb connection "model.my_project.load_policy"
[0m18:41:51.655550 [debug] [Thread-1 (]: On model.my_project.load_policy: COMMIT
[0m18:41:51.656786 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:41:51.659125 [debug] [Thread-1 (]: Using duckdb connection "model.my_project.load_policy"
[0m18:41:51.659301 [debug] [Thread-1 (]: On model.my_project.load_policy: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.load_policy"} */

      drop view if exists "dev"."main"."load_policy__dbt_backup" cascade
    
[0m18:41:51.659830 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:51.660887 [debug] [Thread-1 (]: On model.my_project.load_policy: Close
[0m18:41:51.661728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e815059-5270-49bf-bd42-9955338d7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636d7f0>]}
[0m18:41:51.662055 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.load_policy .............................. [[32mOK[0m in 0.08s]
[0m18:41:51.662346 [debug] [Thread-1 (]: Finished running node model.my_project.load_policy
[0m18:41:51.662682 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m18:41:51.662940 [info ] [Thread-1 (]: 2 of 3 START sql view model main.stg_policy_events ............................. [RUN]
[0m18:41:51.663158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.load_policy, now model.my_project.stg_policy_events)
[0m18:41:51.663315 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m18:41:51.664391 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m18:41:51.664650 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m18:41:51.665873 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m18:41:51.666151 [debug] [Thread-1 (]: Using duckdb connection "model.my_project.stg_policy_events"
[0m18:41:51.666309 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: BEGIN
[0m18:41:51.666452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:51.666687 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:51.666838 [debug] [Thread-1 (]: Using duckdb connection "model.my_project.stg_policy_events"
[0m18:41:51.666995 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_policy_events"} */

  
  create view "dev"."main"."stg_policy_events__dbt_tmp" as (
    WITH deduped AS (
  SELECT
    DISTINCT policy_id,
    event_type,
    TRY_CAST(event_timestamp AS TIMESTAMP) AS event_ts
  FROM "dev"."main"."load_policy"  
  WHERE 
    policy_id IS NOT NULL
    AND event_type IN ('quote', 'bind', 'cancel')
    AND TRY_CAST(event_timestamp AS TIMESTAMP) IS NOT NULL
)
SELECT
  policy_id,
  event_type,
  event_ts,
  DATE_TRUNC('month', event_ts) AS event_month
FROM deduped
  );

[0m18:41:51.706158 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m18:41:51.707604 [debug] [Thread-1 (]: Using duckdb connection "model.my_project.stg_policy_events"
[0m18:41:51.707770 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_policy_events"} */
alter view "dev"."main"."stg_policy_events__dbt_tmp" rename to "stg_policy_events"
[0m18:41:51.708058 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:51.708623 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: COMMIT
[0m18:41:51.708772 [debug] [Thread-1 (]: Using duckdb connection "model.my_project.stg_policy_events"
[0m18:41:51.708907 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: COMMIT
[0m18:41:51.709286 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:51.710249 [debug] [Thread-1 (]: Using duckdb connection "model.my_project.stg_policy_events"
[0m18:41:51.710408 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_policy_events"} */

      drop view if exists "dev"."main"."stg_policy_events__dbt_backup" cascade
    
[0m18:41:51.710666 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:51.711229 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: Close
[0m18:41:51.711479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e815059-5270-49bf-bd42-9955338d7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643d2e0>]}
[0m18:41:51.711750 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.stg_policy_events ........................ [[32mOK[0m in 0.05s]
[0m18:41:51.712008 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m18:41:51.712320 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m18:41:51.712605 [info ] [Thread-1 (]: 3 of 3 START sql view model main.policy_lifecycle_enriched ..................... [RUN]
[0m18:41:51.712800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m18:41:51.712955 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m18:41:51.715002 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m18:41:51.715336 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m18:41:51.716639 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m18:41:51.716955 [debug] [Thread-1 (]: Using duckdb connection "model.my_project.policy_lifecycle_enriched"
[0m18:41:51.717115 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: BEGIN
[0m18:41:51.717260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:51.717504 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:41:51.717652 [debug] [Thread-1 (]: Using duckdb connection "model.my_project.policy_lifecycle_enriched"
[0m18:41:51.717887 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
  create view "dev"."main"."policy_lifecycle_enriched__dbt_tmp" as (
    WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
    MAX(event_ts) AS last_event_ts
  FROM "dev"."main"."stg_policy_events"
  GROUP BY policy_id
),
last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type
  FROM (
    SELECT policy_id, event_type, event_ts,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM "dev"."main"."stg_policy_events"
  ) t
  WHERE t.rn = 1
)
SELECT
  f.policy_id,
  f.first_quote_ts,
  f.first_bind_ts,
  f.first_cancel_ts,
  -- Status business logic
  CASE
    WHEN f.first_cancel_ts IS NOT NULL AND l.last_event_type = 'cancel' THEN 'cancelled'
    WHEN f.first_bind_ts IS NOT NULL THEN 'bound'
    ELSE 'quoted'
  END AS current_status,
  CASE
    WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
      THEN TIMESTAMPDIFF('minute', f.first_quote_ts, f.first_bind_ts)
    ELSE NULL
  END AS quote_to_bind_mins,
  CASE
    WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
      THEN TIMESTAMPDIFF('minute', f.first_bind_ts, f.first_cancel_ts)
    ELSE NULL
  END AS bind_to_cancel_mins,
  DATE_TRUNC('month', COALESCE(f.first_quote_ts, f.first_bind_ts, f.first_cancel_ts)) AS event_month
FROM firsts f
LEFT JOIN last_evt l
  ON f.policy_id = l.policy_id
  );

[0m18:41:51.800050 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
  create view "dev"."main"."policy_lifecycle_enriched__dbt_tmp" as (
    WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
    MAX(event_ts) AS last_event_ts
  FROM "dev"."main"."stg_policy_events"
  GROUP BY policy_id
),
last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type
  FROM (
    SELECT policy_id, event_type, event_ts,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM "dev"."main"."stg_policy_events"
  ) t
  WHERE t.rn = 1
)
SELECT
  f.policy_id,
  f.first_quote_ts,
  f.first_bind_ts,
  f.first_cancel_ts,
  -- Status business logic
  CASE
    WHEN f.first_cancel_ts IS NOT NULL AND l.last_event_type = 'cancel' THEN 'cancelled'
    WHEN f.first_bind_ts IS NOT NULL THEN 'bound'
    ELSE 'quoted'
  END AS current_status,
  CASE
    WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
      THEN TIMESTAMPDIFF('minute', f.first_quote_ts, f.first_bind_ts)
    ELSE NULL
  END AS quote_to_bind_mins,
  CASE
    WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
      THEN TIMESTAMPDIFF('minute', f.first_bind_ts, f.first_cancel_ts)
    ELSE NULL
  END AS bind_to_cancel_mins,
  DATE_TRUNC('month', COALESCE(f.first_quote_ts, f.first_bind_ts, f.first_cancel_ts)) AS event_month
FROM firsts f
LEFT JOIN last_evt l
  ON f.policy_id = l.policy_id
  );

[0m18:41:51.800322 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:41:51.800541 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: ROLLBACK
[0m18:41:51.804725 [debug] [Thread-1 (]: Failed to rollback 'model.my_project.policy_lifecycle_enriched'
[0m18:41:51.804894 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: Close
[0m18:41:51.805951 [debug] [Thread-1 (]: Runtime Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Catalog Error: Scalar Function with name timestampdiff does not exist!
  Did you mean "to_timestamp"?
  
  LINE 39:       THEN TIMESTAMPDIFF('minute', f.first_quote_ts, f.first_bind_ts)
                      ^
[0m18:41:51.806163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e815059-5270-49bf-bd42-9955338d7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643ca70>]}
[0m18:41:51.806438 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model main.policy_lifecycle_enriched ............ [[31mERROR[0m in 0.09s]
[0m18:41:51.806705 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m18:41:51.806969 [debug] [Thread-4 (]: Marking all children of 'model.my_project.policy_lifecycle_enriched' to be skipped because of status 'error'.  Reason: Runtime Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Catalog Error: Scalar Function with name timestampdiff does not exist!
  Did you mean "to_timestamp"?
  
  LINE 39:       THEN TIMESTAMPDIFF('minute', f.first_quote_ts, f.first_bind_ts)
                      ^.
[0m18:41:51.807506 [debug] [MainThread]: Using duckdb connection "master"
[0m18:41:51.807639 [debug] [MainThread]: On master: BEGIN
[0m18:41:51.807756 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:51.807987 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:41:51.808113 [debug] [MainThread]: On master: COMMIT
[0m18:41:51.808234 [debug] [MainThread]: Using duckdb connection "master"
[0m18:41:51.808346 [debug] [MainThread]: On master: COMMIT
[0m18:41:51.808531 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:41:51.808649 [debug] [MainThread]: On master: Close
[0m18:41:51.808799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:51.808921 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m18:41:51.809059 [info ] [MainThread]: 
[0m18:41:51.809202 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m18:41:51.809596 [debug] [MainThread]: Command end result
[0m18:41:51.819726 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:41:51.820458 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:41:51.823237 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m18:41:51.823397 [info ] [MainThread]: 
[0m18:41:51.823567 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:41:51.823697 [info ] [MainThread]: 
[0m18:41:51.823867 [error] [MainThread]: [31mFailure in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)[0m
[0m18:41:51.824040 [error] [MainThread]:   Runtime Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Catalog Error: Scalar Function with name timestampdiff does not exist!
  Did you mean "to_timestamp"?
  
  LINE 39:       THEN TIMESTAMPDIFF('minute', f.first_quote_ts, f.first_bind_ts)
                      ^
[0m18:41:51.824183 [info ] [MainThread]: 
[0m18:41:51.824333 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/policy_lifecycle_enriched.sql
[0m18:41:51.824461 [info ] [MainThread]: 
[0m18:41:51.824609 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m18:41:51.826114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2631845, "process_in_blocks": "0", "process_kernel_time": 0.196967, "process_mem_max_rss": "158728192", "process_out_blocks": "0", "process_user_time": 1.636009}
[0m18:41:51.826389 [debug] [MainThread]: Command `dbt run` failed at 18:41:51.826347 after 1.26 seconds
[0m18:41:51.826553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046a5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f6300>]}
[0m18:41:51.826706 [debug] [MainThread]: Flushing usage events
[0m18:41:52.921680 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:21:33.526795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10822fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108263b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108263c20>]}


============================== 09:21:33.528689 | 811fd366-64a3-4162-8940-719f6c89de6a ==============================
[0m09:21:33.528689 [info ] [MainThread]: Running with dbt=1.10.6
[0m09:21:33.529071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'quiet': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'static_parser': 'True', 'write_json': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'log_format': 'default', 'fail_fast': 'False', 'introspect': 'True'}
[0m09:21:33.539360 [info ] [MainThread]: dbt version: 1.10.6
[0m09:21:33.539625 [info ] [MainThread]: python version: 3.12.4
[0m09:21:33.539778 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m09:21:33.539917 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit
[0m09:21:40.263368 [info ] [MainThread]: Using profiles dir at /Users/pratibhagangavarapu/.dbt
[0m09:21:40.264048 [info ] [MainThread]: Using profiles.yml file at /Users/pratibhagangavarapu/.dbt/profiles.yml
[0m09:21:40.264232 [info ] [MainThread]: Using dbt_project.yml file at /Users/pratibhagangavarapu/my_project/dbt_project.yml
[0m09:21:40.264377 [info ] [MainThread]: adapter type: bigquery
[0m09:21:40.264505 [info ] [MainThread]: adapter version: 1.10.1
[0m09:21:40.307829 [info ] [MainThread]: Configuration:
[0m09:21:40.308123 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:21:40.308283 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:21:40.308426 [info ] [MainThread]: Required dependencies:
[0m09:21:40.308608 [debug] [MainThread]: Executing "git --help"
[0m09:21:40.329279 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:21:40.329776 [debug] [MainThread]: STDERR: "b''"
[0m09:21:40.330064 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:21:40.330288 [info ] [MainThread]: Connection:
[0m09:21:40.330492 [info ] [MainThread]:   method: service-account
[0m09:21:40.330640 [info ] [MainThread]:   database: horizontal-ray-467611-f9
[0m09:21:40.330776 [info ] [MainThread]:   execution_project: horizontal-ray-467611-f9
[0m09:21:40.330947 [info ] [MainThread]:   schema: single_view_policy_assignment
[0m09:21:40.331214 [info ] [MainThread]:   location: None
[0m09:21:40.331359 [info ] [MainThread]:   priority: None
[0m09:21:40.331504 [info ] [MainThread]:   maximum_bytes_billed: None
[0m09:21:40.331649 [info ] [MainThread]:   impersonate_service_account: None
[0m09:21:40.331795 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m09:21:40.331936 [info ] [MainThread]:   job_retries: 1
[0m09:21:40.332204 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m09:21:40.332533 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m09:21:40.332779 [info ] [MainThread]:   timeout_seconds: None
[0m09:21:40.332961 [info ] [MainThread]:   client_id: None
[0m09:21:40.333079 [info ] [MainThread]:   token_uri: None
[0m09:21:40.333203 [info ] [MainThread]:   compute_region: None
[0m09:21:40.333315 [info ] [MainThread]:   dataproc_cluster_name: None
[0m09:21:40.333472 [info ] [MainThread]:   gcs_bucket: None
[0m09:21:40.333588 [info ] [MainThread]:   dataproc_batch: None
[0m09:21:40.333933 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m09:21:40.458080 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m09:21:40.458482 [debug] [MainThread]: On debug: select 1 as id
[0m09:21:40.458672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:21:42.891127 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:c584ed2c-9163-4d0d-a7e7-f737e5e775fc&page=queryresults
[0m09:21:43.846728 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:21:43.848406 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:21:43.849647 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 10.358966, "process_in_blocks": "0", "process_kernel_time": 1.283117, "process_mem_max_rss": "393740288", "process_out_blocks": "0", "process_user_time": 3.533715}
[0m09:21:43.850728 [debug] [MainThread]: Command `dbt debug` succeeded at 09:21:43.850544 after 10.36 seconds
[0m09:21:43.851324 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:21:43.851971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1550c76e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1544c9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b8320>]}
[0m09:21:43.852723 [debug] [MainThread]: Flushing usage events
[0m09:21:45.120626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:30:39.991265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd8380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d84560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d841d0>]}


============================== 09:30:39.992822 | bdffe58c-3ea5-4197-ab85-e9524e89cfde ==============================
[0m09:30:39.992822 [info ] [MainThread]: Running with dbt=1.10.6
[0m09:30:39.993159 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'debug': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'quiet': 'False', 'static_parser': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'introspect': 'True', 'write_json': 'True', 'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'log_cache_events': 'False'}
[0m09:30:41.997163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdffe58c-3ea5-4197-ab85-e9524e89cfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd3560>]}
[0m09:30:42.021718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdffe58c-3ea5-4197-ab85-e9524e89cfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f46a8d0>]}
[0m09:30:42.022027 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m09:30:42.134829 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m09:30:42.192097 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m09:30:42.192389 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m09:30:42.192576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bdffe58c-3ea5-4197-ab85-e9524e89cfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b1513d0>]}
[0m09:30:42.687837 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m09:30:42.688455 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m09:30:42.718195 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.unique_my_first_dbt_model_id.16e066b321' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m09:30:42.718512 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.not_null_my_first_dbt_model_id.5fb22c2710' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m09:30:42.718715 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.unique_my_second_dbt_model_id.57a0f8c493' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m09:30:42.718892 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.not_null_my_second_dbt_model_id.151b76d778' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m09:30:42.862331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdffe58c-3ea5-4197-ab85-e9524e89cfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17138bf80>]}
[0m09:30:42.902121 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m09:30:42.903193 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m09:30:42.914063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdffe58c-3ea5-4197-ab85-e9524e89cfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f721820>]}
[0m09:30:42.914301 [info ] [MainThread]: Found 3 models, 2 analyses, 5 data tests, 496 macros
[0m09:30:42.914473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdffe58c-3ea5-4197-ab85-e9524e89cfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x171098680>]}
[0m09:30:42.915202 [info ] [MainThread]: 
[0m09:30:42.915388 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m09:30:42.915528 [info ] [MainThread]: 
[0m09:30:42.915754 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:30:42.917424 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m09:30:42.917624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:30:43.951043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m09:30:43.952131 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:30:44.803552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdffe58c-3ea5-4197-ab85-e9524e89cfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1710dedb0>]}
[0m09:30:44.804495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:30:44.870944 [debug] [Thread-1 (]: Began running node model.my_project.load_policy
[0m09:30:44.871377 [info ] [Thread-1 (]: 1 of 3 START sql view model single_view_policy_assignment.load_policy .......... [RUN]
[0m09:30:44.871661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.load_policy)
[0m09:30:44.871882 [debug] [Thread-1 (]: Began compiling node model.my_project.load_policy
[0m09:30:44.875424 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.load_policy"
[0m09:30:44.875824 [debug] [Thread-1 (]: Began executing node model.my_project.load_policy
[0m09:30:44.891670 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.load_policy"
[0m09:30:44.892143 [debug] [Thread-1 (]: On model.my_project.load_policy: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.load_policy"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`load_policy`
  OPTIONS()
  as SELECT *
FROM `horizontal-ray-467611-f9.single_view_policy_assignment.POLICY_EVENTS`;


[0m09:30:44.892378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:30:46.426832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:12f943a6-28ce-439e-b24e-a4b081de6669&page=queryresults
[0m09:30:46.793032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdffe58c-3ea5-4197-ab85-e9524e89cfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147ebb950>]}
[0m09:30:46.793499 [info ] [Thread-1 (]: 1 of 3 OK created sql view model single_view_policy_assignment.load_policy ..... [[32mCREATE VIEW (0 processed)[0m in 1.92s]
[0m09:30:46.793888 [debug] [Thread-1 (]: Finished running node model.my_project.load_policy
[0m09:30:46.794328 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m09:30:46.794664 [info ] [Thread-1 (]: 2 of 3 START sql view model single_view_policy_assignment.stg_policy_events .... [RUN]
[0m09:30:46.794925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.load_policy, now model.my_project.stg_policy_events)
[0m09:30:46.795129 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m09:30:46.796710 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m09:30:46.797093 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m09:30:46.798437 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m09:30:46.798816 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  OPTIONS()
  as WITH deduped AS (
  SELECT
    DISTINCT policy_id,
    event_type,
    SAFE_CAST(event_timestamp AS TIMESTAMP) AS event_ts
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`load_policy`  
  WHERE 
    policy_id IS NOT NULL
    AND event_type IN ('quote', 'bind', 'cancel')
    AND SAFE_CAST(event_timestamp AS TIMESTAMP) IS NOT NULL
)

SELECT
  policy_id,
  event_type,
  event_ts,
  FORMAT_DATE('%B', DATE_TRUNC(DATE(event_ts), MONTH)) AS event_month
FROM deduped;


[0m09:30:46.799048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:30:48.445389 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:826dd301-53d5-4b14-b276-f6d239ee011d&page=queryresults
[0m09:30:49.201383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdffe58c-3ea5-4197-ab85-e9524e89cfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1710a8bf0>]}
[0m09:30:49.203189 [info ] [Thread-1 (]: 2 of 3 OK created sql view model single_view_policy_assignment.stg_policy_events  [[32mCREATE VIEW (0 processed)[0m in 2.41s]
[0m09:30:49.204267 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m09:30:49.205492 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m09:30:49.206284 [info ] [Thread-1 (]: 3 of 3 START sql view model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m09:30:49.206892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m09:30:49.207369 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m09:30:49.212585 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m09:30:49.213799 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m09:30:49.217523 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m09:30:49.218500 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
  OPTIONS()
  as WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
    MAX(event_ts) AS last_event_ts
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      event_ts,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
)

SELECT
  f.policy_id,
  f.first_quote_ts,
  f.first_bind_ts,
  f.first_cancel_ts,

  -- Status business logic
  CASE
    WHEN f.first_cancel_ts IS NOT NULL AND l.last_event_type = 'cancel' THEN 'cancelled'
    WHEN f.first_bind_ts IS NOT NULL THEN 'bound'
    ELSE 'quoted'
  END AS current_status,

  -- Quote to bind duration
  CASE
    WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
    ELSE NULL
  END AS quote_to_bind_mins,

  -- Bind to cancel duration
  CASE
    WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
    ELSE NULL
  END AS bind_to_cancel_mins,

  -- Month name of first event
  FORMAT_DATE('%B', DATE_TRUNC(DATE(COALESCE(f.first_quote_ts, f.first_bind_ts, f.first_cancel_ts)), MONTH)) AS event_month

FROM firsts f
LEFT JOIN last_evt l
  ON f.policy_id = l.policy_id;


[0m09:30:49.219059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:30:50.340712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:548a8ad0-2c8a-4e41-8d03-9e095fcf23a3&page=queryresults
[0m09:30:50.963718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdffe58c-3ea5-4197-ab85-e9524e89cfde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1725419d0>]}
[0m09:30:50.965282 [info ] [Thread-1 (]: 3 of 3 OK created sql view model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE VIEW (0 processed)[0m in 1.76s]
[0m09:30:50.966264 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m09:30:50.967704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:30:51.022303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:30:51.022542 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m09:30:51.022757 [info ] [MainThread]: 
[0m09:30:51.022938 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 8.11 seconds (8.11s).
[0m09:30:51.023431 [debug] [MainThread]: Command end result
[0m09:30:51.036268 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m09:30:51.037080 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m09:30:51.040441 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m09:30:51.040627 [info ] [MainThread]: 
[0m09:30:51.040805 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:30:51.040944 [info ] [MainThread]: 
[0m09:30:51.041101 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m09:30:51.041334 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.081777, "process_in_blocks": "0", "process_kernel_time": 0.956788, "process_mem_max_rss": "407273472", "process_out_blocks": "0", "process_user_time": 4.547474}
[0m09:30:51.041601 [debug] [MainThread]: Command `dbt run` succeeded at 09:30:51.041561 after 11.08 seconds
[0m09:30:51.041767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x171098680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17114acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1725e9340>]}
[0m09:30:51.041932 [debug] [MainThread]: Flushing usage events
[0m09:30:53.134958 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:06:02.539213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109260560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092602c0>]}


============================== 13:06:02.541122 | 15a7e7fd-78bb-4f1b-b886-bc737020293d ==============================
[0m13:06:02.541122 [info ] [MainThread]: Running with dbt=1.10.6
[0m13:06:02.541519 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'version_check': 'True', 'write_json': 'True', 'empty': 'False', 'static_parser': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'no_print': 'None', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'log_cache_events': 'False'}
[0m13:06:04.788889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15a7e7fd-78bb-4f1b-b886-bc737020293d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b4a1f70>]}
[0m13:06:04.814541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15a7e7fd-78bb-4f1b-b886-bc737020293d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108704da0>]}
[0m13:06:04.814893 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:06:04.930759 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m13:06:05.013093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m13:06:05.013430 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/stg_policy_events.sql
[0m13:06:05.013621 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/policy_lifecycle_enriched.sql
[0m13:06:05.013784 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/load_policy.sql
[0m13:06:05.146715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15a7e7fd-78bb-4f1b-b886-bc737020293d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c3aa060>]}
[0m13:06:05.186980 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m13:06:05.188439 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m13:06:05.200796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15a7e7fd-78bb-4f1b-b886-bc737020293d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107890410>]}
[0m13:06:05.201069 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m13:06:05.201268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15a7e7fd-78bb-4f1b-b886-bc737020293d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c3a8230>]}
[0m13:06:05.202056 [info ] [MainThread]: 
[0m13:06:05.202263 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m13:06:05.202395 [info ] [MainThread]: 
[0m13:06:05.202646 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:06:05.204391 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m13:06:05.204610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:06.325887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m13:06:06.327250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:06:07.079976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15a7e7fd-78bb-4f1b-b886-bc737020293d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d1010>]}
[0m13:06:07.080986 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:06:07.124767 [debug] [Thread-1 (]: Began running node model.my_project.load_policy
[0m13:06:07.125110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.load_policy)
[0m13:06:07.125313 [debug] [Thread-1 (]: Began compiling node model.my_project.load_policy
[0m13:06:07.129408 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.load_policy"
[0m13:06:07.129899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:07.168041 [debug] [Thread-1 (]: Finished running node model.my_project.load_policy
[0m13:06:07.168562 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m13:06:07.168883 [info ] [Thread-1 (]: 1 of 2 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m13:06:07.169173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.load_policy, now model.my_project.stg_policy_events)
[0m13:06:07.169354 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m13:06:07.172886 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m13:06:07.173295 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m13:06:07.191341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:07.961143 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m13:06:07.961853 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH  __dbt__cte__load_policy as (


SELECT *
FROM `horizontal-ray-467611-f9.single_view_policy_assignment.POLICY_EVENTS`
), deduped AS (
  SELECT
    DISTINCT policy_id,
    event_type,
    SAFE_CAST(event_timestamp AS TIMESTAMP) AS event_ts
  FROM __dbt__cte__load_policy  
  WHERE 
    policy_id IS NOT NULL
    AND event_type IN ('quote', 'bind', 'cancel')
    AND SAFE_CAST(event_timestamp AS TIMESTAMP) IS NOT NULL
)

SELECT
  policy_id,
  event_type,
  event_ts,
  FORMAT_DATE('%B', DATE_TRUNC(DATE(event_ts), MONTH)) AS event_month
FROM deduped
    );
  
[0m13:06:09.004931 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:c825489d-ff85-4cb8-b9e4-44e59c2fdb9f&page=queryresults
[0m13:06:11.894561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15a7e7fd-78bb-4f1b-b886-bc737020293d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d9bbb60>]}
[0m13:06:11.895436 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (716.0 rows, 15.2 KiB processed)[0m in 4.72s]
[0m13:06:11.896080 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m13:06:11.896830 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m13:06:11.897253 [info ] [Thread-1 (]: 2 of 2 START sql table model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m13:06:11.897644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m13:06:11.897959 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m13:06:11.901228 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m13:06:11.902092 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m13:06:11.911211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:12.754415 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m13:06:12.756819 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    
    

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
    MAX(event_ts) AS last_event_ts
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      event_ts,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
)

SELECT
  f.policy_id,
  f.first_quote_ts,
  f.first_bind_ts,
  f.first_cancel_ts,

  -- Status business logic
  CASE
    WHEN f.first_cancel_ts IS NOT NULL AND l.last_event_type = 'cancel' THEN 'cancelled'
    WHEN f.first_bind_ts IS NOT NULL THEN 'bound'
    ELSE 'quoted'
  END AS current_status,

  -- Quote to bind duration
  CASE
    WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
    ELSE NULL
  END AS quote_to_bind_mins,

  -- Bind to cancel duration
  CASE
    WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
    ELSE NULL
  END AS bind_to_cancel_mins,

  -- Month name of first event
  FORMAT_DATE('%B', DATE_TRUNC(DATE(COALESCE(f.first_quote_ts, f.first_bind_ts, f.first_cancel_ts)), MONTH)) AS event_month

FROM firsts f
LEFT JOIN last_evt l
  ON f.policy_id = l.policy_id
    );
  
[0m13:06:13.648208 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:6f6c47cd-73f4-4aa5-bcf5-b3442c60ebe8&page=queryresults
[0m13:06:15.835929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15a7e7fd-78bb-4f1b-b886-bc737020293d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c8a6d50>]}
[0m13:06:15.837562 [info ] [Thread-1 (]: 2 of 2 OK created sql table model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE TABLE (351.0 rows, 15.2 KiB processed)[0m in 3.94s]
[0m13:06:15.838440 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m13:06:15.840073 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:06:15.896907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:06:15.897242 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m13:06:15.897437 [info ] [MainThread]: 
[0m13:06:15.897639 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 10.69 seconds (10.69s).
[0m13:06:15.898080 [debug] [MainThread]: Command end result
[0m13:06:15.911443 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m13:06:15.912412 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m13:06:15.915555 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m13:06:15.915745 [info ] [MainThread]: 
[0m13:06:15.915950 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:06:15.916096 [info ] [MainThread]: 
[0m13:06:15.916262 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:06:15.916526 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.410731, "process_in_blocks": "0", "process_kernel_time": 0.85994, "process_mem_max_rss": "407175168", "process_out_blocks": "0", "process_user_time": 4.215839}
[0m13:06:15.916812 [debug] [MainThread]: Command `dbt run` succeeded at 13:06:15.916766 after 13.41 seconds
[0m13:06:15.916997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c3e8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c22d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092605f0>]}
[0m13:06:15.917172 [debug] [MainThread]: Flushing usage events
[0m13:06:17.185175 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:35.461880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c0da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c87cb0>]}


============================== 13:21:35.463436 | 18d0570c-58ae-4aea-a447-537645465d2f ==============================
[0m13:21:35.463436 [info ] [MainThread]: Running with dbt=1.10.6
[0m13:21:35.463762 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'write_json': 'True', 'warn_error': 'None', 'empty': 'False', 'version_check': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --full-refresh', 'use_experimental_parser': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_cache_events': 'False'}
[0m13:21:37.376650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18d0570c-58ae-4aea-a447-537645465d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168d3cb00>]}
[0m13:21:37.400911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18d0570c-58ae-4aea-a447-537645465d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1690d6450>]}
[0m13:21:37.401233 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:21:37.514113 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m13:21:37.593346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:21:37.593652 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/stg_policy_events.sql
[0m13:21:37.593845 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/policy_lifecycle_enriched.sql
[0m13:21:37.713153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18d0570c-58ae-4aea-a447-537645465d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a98b650>]}
[0m13:21:37.755984 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m13:21:37.757405 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m13:21:37.768105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18d0570c-58ae-4aea-a447-537645465d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ababa70>]}
[0m13:21:37.768353 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m13:21:37.768533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18d0570c-58ae-4aea-a447-537645465d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a93c350>]}
[0m13:21:37.769285 [info ] [MainThread]: 
[0m13:21:37.769484 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m13:21:37.769631 [info ] [MainThread]: 
[0m13:21:37.769876 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:21:37.771581 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m13:21:37.771792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:38.907171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m13:21:38.908399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:39.666846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18d0570c-58ae-4aea-a447-537645465d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1697c9df0>]}
[0m13:21:39.668194 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:39.732656 [debug] [Thread-1 (]: Began running node model.my_project.load_policy
[0m13:21:39.733035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.load_policy)
[0m13:21:39.733273 [debug] [Thread-1 (]: Began compiling node model.my_project.load_policy
[0m13:21:39.737392 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.load_policy"
[0m13:21:39.737824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:39.773213 [debug] [Thread-1 (]: Finished running node model.my_project.load_policy
[0m13:21:39.773569 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m13:21:39.773922 [info ] [Thread-1 (]: 1 of 2 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m13:21:39.774158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.load_policy, now model.my_project.stg_policy_events)
[0m13:21:39.774345 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m13:21:39.777717 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m13:21:39.778025 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m13:21:39.798057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:40.530749 [debug] [Thread-1 (]: Hard refreshing `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events` because it is not replaceable
[0m13:21:40.740676 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m13:21:40.741352 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    partition by timestamp_trunc(event_ts, day)
    cluster by policy_id, event_type

    
    OPTIONS()
    as (
      

WITH  __dbt__cte__load_policy as (


SELECT *
FROM `horizontal-ray-467611-f9.single_view_policy_assignment.POLICY_EVENTS`
), deduped AS (
  SELECT
    DISTINCT policy_id,
    event_type,
    SAFE_CAST(event_timestamp AS TIMESTAMP) AS event_ts
  FROM __dbt__cte__load_policy  
  WHERE 
    policy_id IS NOT NULL
    AND event_type IN ('quote', 'bind', 'cancel')
    AND SAFE_CAST(event_timestamp AS TIMESTAMP) IS NOT NULL
)

SELECT
  policy_id,
  event_type,
  event_ts,
  FORMAT_DATE('%B', DATE_TRUNC(DATE(event_ts), MONTH)) AS event_month
FROM deduped
    );
  
[0m13:21:41.460667 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:4991de0d-19fc-4c12-806e-41234c2bd99a&page=queryresults
[0m13:21:45.181439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18d0570c-58ae-4aea-a447-537645465d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163fd3a10>]}
[0m13:21:45.182307 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (0.0 rows, 15.2 KiB processed)[0m in 5.41s]
[0m13:21:45.182958 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m13:21:45.183711 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m13:21:45.184286 [info ] [Thread-1 (]: 2 of 2 START sql table model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m13:21:45.184738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m13:21:45.185095 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m13:21:45.188720 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m13:21:45.189383 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m13:21:45.197748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:45.905962 [debug] [Thread-1 (]: Hard refreshing `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched` because it is not replaceable
[0m13:21:46.047512 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m13:21:46.049917 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    partition by timestamp_trunc(first_bind_ts, day)
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
    MAX(event_ts) AS last_event_ts
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      event_ts,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
)

SELECT
  f.policy_id,
  f.first_quote_ts,
  f.first_bind_ts,
  f.first_cancel_ts,

  -- Status business logic
  CASE
    WHEN f.first_cancel_ts IS NOT NULL AND l.last_event_type = 'cancel' THEN 'cancelled'
    WHEN f.first_bind_ts IS NOT NULL THEN 'bound'
    ELSE 'quoted'
  END AS current_status,

  -- Quote to bind duration
  CASE
    WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
    ELSE NULL
  END AS quote_to_bind_mins,

  -- Bind to cancel duration
  CASE
    WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
    ELSE NULL
  END AS bind_to_cancel_mins,

  -- Month name of first event
  FORMAT_DATE('%B', DATE_TRUNC(DATE(COALESCE(f.first_quote_ts, f.first_bind_ts, f.first_cancel_ts)), MONTH)) AS event_month

FROM firsts f
LEFT JOIN last_evt l
  ON f.policy_id = l.policy_id
    );
  
[0m13:21:47.425477 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a4b80e03-17a8-4452-91a9-65fe9ecc0b32&page=queryresults
[0m13:21:50.545497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18d0570c-58ae-4aea-a447-537645465d2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ac57c20>]}
[0m13:21:50.547678 [info ] [Thread-1 (]: 2 of 2 OK created sql table model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 5.36s]
[0m13:21:50.548678 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m13:21:50.550460 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:21:50.608515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:50.608795 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m13:21:50.608985 [info ] [MainThread]: 
[0m13:21:50.609177 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 12.84 seconds (12.84s).
[0m13:21:50.609628 [debug] [MainThread]: Command end result
[0m13:21:50.623080 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m13:21:50.623957 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m13:21:50.626847 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m13:21:50.627020 [info ] [MainThread]: 
[0m13:21:50.627226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:50.627368 [info ] [MainThread]: 
[0m13:21:50.627525 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:21:50.627780 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.197543, "process_in_blocks": "0", "process_kernel_time": 0.942086, "process_mem_max_rss": "406536192", "process_out_blocks": "0", "process_user_time": 4.08702}
[0m13:21:50.628068 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:50.628027 after 15.20 seconds
[0m13:21:50.628253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1692e3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169216fc0>]}
[0m13:21:50.628421 [debug] [MainThread]: Flushing usage events
[0m13:21:52.004169 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:24:36.965159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104928f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c81a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e5c410>]}


============================== 13:24:36.966741 | 3c1a4fbc-e5c3-4375-9d66-bcee91847a2a ==============================
[0m13:24:36.966741 [info ] [MainThread]: Running with dbt=1.10.6
[0m13:24:36.967082 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_cache_events': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'empty': 'None', 'write_json': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'introspect': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'target_path': 'None'}
[0m13:24:38.863467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c1a4fbc-e5c3-4375-9d66-bcee91847a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x173e06b40>]}
[0m13:24:38.887592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c1a4fbc-e5c3-4375-9d66-bcee91847a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x174a665a0>]}
[0m13:24:38.887886 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:24:39.002911 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m13:24:39.082180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:39.082394 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:39.101310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c1a4fbc-e5c3-4375-9d66-bcee91847a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16da60890>]}
[0m13:24:39.146713 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m13:24:39.147911 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m13:24:39.163756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c1a4fbc-e5c3-4375-9d66-bcee91847a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x174d50f80>]}
[0m13:24:39.164022 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m13:24:39.164204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c1a4fbc-e5c3-4375-9d66-bcee91847a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x174c47e60>]}
[0m13:24:39.165043 [info ] [MainThread]: 
[0m13:24:39.165257 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m13:24:39.165396 [info ] [MainThread]: 
[0m13:24:39.165649 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:24:39.167475 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9_single_view_policy_assignment'
[0m13:24:39.167690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:39.941860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c1a4fbc-e5c3-4375-9d66-bcee91847a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x174c77020>]}
[0m13:24:39.943176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:40.002608 [debug] [Thread-1 (]: Began running node test.my_project.EVENT_MONTH
[0m13:24:40.002963 [info ] [Thread-1 (]: 1 of 5 START test EVENT_MONTH .................................................. [RUN]
[0m13:24:40.003284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now test.my_project.EVENT_MONTH)
[0m13:24:40.003507 [debug] [Thread-1 (]: Began compiling node test.my_project.EVENT_MONTH
[0m13:24:40.008378 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.EVENT_MONTH"
[0m13:24:40.008833 [debug] [Thread-1 (]: Began executing node test.my_project.EVENT_MONTH
[0m13:24:40.021780 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.EVENT_MONTH"
[0m13:24:40.022289 [debug] [Thread-1 (]: On test.my_project.EVENT_MONTH: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.EVENT_MONTH"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE event_month IS NULL
  
  
      
    ) dbt_internal_test
[0m13:24:40.022514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:45.380946 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:79e9be80-8ac9-46a1-8d85-0cdc82c99bdb&page=queryresults
[0m13:24:45.913516 [error] [Thread-1 (]: 1 of 5 FAIL 1 EVENT_MONTH ...................................................... [[31mFAIL 1[0m in 5.91s]
[0m13:24:45.915210 [debug] [Thread-1 (]: Finished running node test.my_project.EVENT_MONTH
[0m13:24:45.916054 [debug] [Thread-1 (]: Began running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m13:24:45.916817 [info ] [Thread-1 (]: 2 of 5 START test FIRST_EVENT_TIMESTAMP ........................................ [RUN]
[0m13:24:45.917578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.EVENT_MONTH, now test.my_project.FIRST_EVENT_TIMESTAMP)
[0m13:24:45.918137 [debug] [Thread-1 (]: Began compiling node test.my_project.FIRST_EVENT_TIMESTAMP
[0m13:24:45.922330 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m13:24:45.923345 [debug] [Thread-1 (]: Began executing node test.my_project.FIRST_EVENT_TIMESTAMP
[0m13:24:45.926578 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m13:24:45.927676 [debug] [Thread-1 (]: On test.my_project.FIRST_EVENT_TIMESTAMP: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.FIRST_EVENT_TIMESTAMP"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE first_quote_ts IS NULL AND first_bind_ts IS NULL AND first_cancel_ts IS NULL
  
  
      
    ) dbt_internal_test
[0m13:24:45.928232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:47.190559 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:19cfc822-4f60-4753-b087-10f1c1b42e4d&page=queryresults
[0m13:24:47.673633 [error] [Thread-1 (]: 2 of 5 FAIL 1 FIRST_EVENT_TIMESTAMP ............................................ [[31mFAIL 1[0m in 1.76s]
[0m13:24:47.675952 [debug] [Thread-1 (]: Finished running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m13:24:47.676652 [debug] [Thread-1 (]: Began running node test.my_project.NEGATIVE_DURATION
[0m13:24:47.677357 [info ] [Thread-1 (]: 3 of 5 START test NEGATIVE_DURATION ............................................ [RUN]
[0m13:24:47.678018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.FIRST_EVENT_TIMESTAMP, now test.my_project.NEGATIVE_DURATION)
[0m13:24:47.678492 [debug] [Thread-1 (]: Began compiling node test.my_project.NEGATIVE_DURATION
[0m13:24:47.682983 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.NEGATIVE_DURATION"
[0m13:24:47.684098 [debug] [Thread-1 (]: Began executing node test.my_project.NEGATIVE_DURATION
[0m13:24:47.687462 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.NEGATIVE_DURATION"
[0m13:24:47.688336 [debug] [Thread-1 (]: On test.my_project.NEGATIVE_DURATION: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.NEGATIVE_DURATION"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_mins < 0 OR bind_to_cancel_mins < 0
  
  
      
    ) dbt_internal_test
[0m13:24:47.688811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:49.107498 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:1bcef5b6-4b32-4b43-a73b-11408204bb13&page=queryresults
[0m13:24:49.443560 [error] [Thread-1 (]: 3 of 5 FAIL 1 NEGATIVE_DURATION ................................................ [[31mFAIL 1[0m in 1.77s]
[0m13:24:49.445091 [debug] [Thread-1 (]: Finished running node test.my_project.NEGATIVE_DURATION
[0m13:24:49.445762 [debug] [Thread-1 (]: Began running node test.my_project.NO_NULL
[0m13:24:49.446425 [info ] [Thread-1 (]: 4 of 5 START test NO_NULL ...................................................... [RUN]
[0m13:24:49.447119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.NEGATIVE_DURATION, now test.my_project.NO_NULL)
[0m13:24:49.447692 [debug] [Thread-1 (]: Began compiling node test.my_project.NO_NULL
[0m13:24:49.455570 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.NO_NULL"
[0m13:24:49.456702 [debug] [Thread-1 (]: Began executing node test.my_project.NO_NULL
[0m13:24:49.459300 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.NO_NULL"
[0m13:24:49.460050 [debug] [Thread-1 (]: On test.my_project.NO_NULL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.NO_NULL"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched` WHERE policy_id IS NULL
  
  
      
    ) dbt_internal_test
[0m13:24:49.460523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:50.907734 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:6e7878c4-02e7-49cb-a503-874eaaf7c65e&page=queryresults
[0m13:24:51.347829 [error] [Thread-1 (]: 4 of 5 FAIL 1 NO_NULL .......................................................... [[31mFAIL 1[0m in 1.90s]
[0m13:24:51.349713 [debug] [Thread-1 (]: Finished running node test.my_project.NO_NULL
[0m13:24:51.350487 [debug] [Thread-1 (]: Began running node test.my_project.STATUS_VALUE_RANGE
[0m13:24:51.351170 [info ] [Thread-1 (]: 5 of 5 START test STATUS_VALUE_RANGE ........................................... [RUN]
[0m13:24:51.351820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.NO_NULL, now test.my_project.STATUS_VALUE_RANGE)
[0m13:24:51.352375 [debug] [Thread-1 (]: Began compiling node test.my_project.STATUS_VALUE_RANGE
[0m13:24:51.357491 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.STATUS_VALUE_RANGE"
[0m13:24:51.358724 [debug] [Thread-1 (]: Began executing node test.my_project.STATUS_VALUE_RANGE
[0m13:24:51.362049 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.STATUS_VALUE_RANGE"
[0m13:24:51.362942 [debug] [Thread-1 (]: On test.my_project.STATUS_VALUE_RANGE: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.STATUS_VALUE_RANGE"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE current_status NOT IN ('quoted', 'bound', 'cancelled')
  
  
      
    ) dbt_internal_test
[0m13:24:51.363410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:52.621396 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:8d732054-1739-4bbc-b6f1-daecc93a83b2&page=queryresults
[0m13:24:53.092562 [error] [Thread-1 (]: 5 of 5 FAIL 1 STATUS_VALUE_RANGE ............................................... [[31mFAIL 1[0m in 1.74s]
[0m13:24:53.094632 [debug] [Thread-1 (]: Finished running node test.my_project.STATUS_VALUE_RANGE
[0m13:24:53.096656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:24:53.158679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:53.159006 [debug] [MainThread]: Connection 'test.my_project.STATUS_VALUE_RANGE' was properly closed.
[0m13:24:53.159231 [info ] [MainThread]: 
[0m13:24:53.159467 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 13.99 seconds (13.99s).
[0m13:24:53.160194 [debug] [MainThread]: Command end result
[0m13:24:53.173324 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m13:24:53.174188 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m13:24:53.177452 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m13:24:53.177631 [info ] [MainThread]: 
[0m13:24:53.177828 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m13:24:53.177980 [info ] [MainThread]: 
[0m13:24:53.178162 [error] [MainThread]: [31mFailure in test EVENT_MONTH (tests/EVENT_MONTH.sql)[0m
[0m13:24:53.178330 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:24:53.178457 [info ] [MainThread]: 
[0m13:24:53.178609 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/EVENT_MONTH.sql
[0m13:24:53.178741 [info ] [MainThread]: 
[0m13:24:53.178895 [error] [MainThread]: [31mFailure in test FIRST_EVENT_TIMESTAMP (tests/FIRST_EVENT_TIMESTAMP.sql)[0m
[0m13:24:53.179049 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:24:53.179161 [info ] [MainThread]: 
[0m13:24:53.179299 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/FIRST_EVENT_TIMESTAMP.sql
[0m13:24:53.179418 [info ] [MainThread]: 
[0m13:24:53.179564 [error] [MainThread]: [31mFailure in test NEGATIVE_DURATION (tests/NEGATIVE_DURATION.sql)[0m
[0m13:24:53.179712 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:24:53.179826 [info ] [MainThread]: 
[0m13:24:53.179963 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/NEGATIVE_DURATION.sql
[0m13:24:53.180083 [info ] [MainThread]: 
[0m13:24:53.180227 [error] [MainThread]: [31mFailure in test NO_NULL (tests/NO_NULL.sql)[0m
[0m13:24:53.180371 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:24:53.180486 [info ] [MainThread]: 
[0m13:24:53.180620 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/NO_NULL.sql
[0m13:24:53.180740 [info ] [MainThread]: 
[0m13:24:53.180884 [error] [MainThread]: [31mFailure in test STATUS_VALUE_RANGE (tests/STATUS_VALUE_RANGE.sql)[0m
[0m13:24:53.181029 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:24:53.181147 [info ] [MainThread]: 
[0m13:24:53.181284 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/STATUS_VALUE_RANGE.sql
[0m13:24:53.181403 [info ] [MainThread]: 
[0m13:24:53.181556 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=5
[0m13:24:53.181793 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 16.246832, "process_in_blocks": "0", "process_kernel_time": 0.989219, "process_mem_max_rss": "404865024", "process_out_blocks": "0", "process_user_time": 4.060651}
[0m13:24:53.182067 [debug] [MainThread]: Command `dbt test` failed at 13:24:53.182020 after 16.25 seconds
[0m13:24:53.182251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17d090a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x174c47ec0>]}
[0m13:24:53.182415 [debug] [MainThread]: Flushing usage events
[0m13:24:55.176796 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:34.226755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105adcd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b844d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068381a0>]}


============================== 13:51:34.228181 | b6b94348-d647-40fe-9e97-12bd7e11652b ==============================
[0m13:51:34.228181 [info ] [MainThread]: Running with dbt=1.10.6
[0m13:51:34.228529 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run', 'static_parser': 'True', 'printer_width': '80', 'target_path': 'None', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'fail_fast': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_format': 'default', 'use_colors': 'True', 'debug': 'False', 'no_print': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'version_check': 'True'}
[0m13:51:35.979366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6b94348-d647-40fe-9e97-12bd7e11652b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160926e10>]}
[0m13:51:36.003502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6b94348-d647-40fe-9e97-12bd7e11652b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160e65cd0>]}
[0m13:51:36.003810 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:51:36.116103 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m13:51:36.194429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m13:51:36.194745 [debug] [MainThread]: Partial parsing: updated file: my_project://tests/NO_NULL.sql
[0m13:51:36.194936 [debug] [MainThread]: Partial parsing: updated file: my_project://tests/NEGATIVE_DURATION.sql
[0m13:51:36.195096 [debug] [MainThread]: Partial parsing: updated file: my_project://tests/EVENT_MONTH.sql
[0m13:51:36.195247 [debug] [MainThread]: Partial parsing: updated file: my_project://tests/FIRST_EVENT_TIMESTAMP.sql
[0m13:51:36.281162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6b94348-d647-40fe-9e97-12bd7e11652b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1612b6ed0>]}
[0m13:51:36.320335 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m13:51:36.321449 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m13:51:36.331480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6b94348-d647-40fe-9e97-12bd7e11652b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161268c80>]}
[0m13:51:36.331715 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m13:51:36.331894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6b94348-d647-40fe-9e97-12bd7e11652b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1612b66f0>]}
[0m13:51:36.332647 [info ] [MainThread]: 
[0m13:51:36.332854 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m13:51:36.332986 [info ] [MainThread]: 
[0m13:51:36.333224 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:51:36.334861 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m13:51:36.335074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:37.448234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m13:51:37.449515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:38.214092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6b94348-d647-40fe-9e97-12bd7e11652b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15effef60>]}
[0m13:51:38.215523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:51:38.277522 [debug] [Thread-1 (]: Began running node model.my_project.load_policy
[0m13:51:38.277919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.load_policy)
[0m13:51:38.278186 [debug] [Thread-1 (]: Began compiling node model.my_project.load_policy
[0m13:51:38.282482 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.load_policy"
[0m13:51:38.282977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:38.318048 [debug] [Thread-1 (]: Finished running node model.my_project.load_policy
[0m13:51:38.318492 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m13:51:38.318762 [info ] [Thread-1 (]: 1 of 2 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m13:51:38.318992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.load_policy, now model.my_project.stg_policy_events)
[0m13:51:38.319151 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m13:51:38.322539 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m13:51:38.322874 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m13:51:38.343222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:39.077409 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m13:51:39.078253 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events` as DBT_INTERNAL_DEST
        using (

WITH  __dbt__cte__load_policy as (


SELECT *
FROM `horizontal-ray-467611-f9.single_view_policy_assignment.POLICY_EVENTS`
), deduped AS (
  SELECT
    DISTINCT policy_id,
    event_type,
    SAFE_CAST(event_timestamp AS TIMESTAMP) AS event_ts
  FROM __dbt__cte__load_policy  
  WHERE 
    policy_id IS NOT NULL
    AND event_type IN ('quote', 'bind', 'cancel')
    AND SAFE_CAST(event_timestamp AS TIMESTAMP) IS NOT NULL
)

SELECT
  policy_id,
  event_type,
  event_ts,
  FORMAT_DATE('%B', DATE_TRUNC(DATE(event_ts), MONTH)) AS event_month
FROM deduped
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.policy_id = DBT_INTERNAL_DEST.policy_id
                ) and (
                    DBT_INTERNAL_SOURCE.event_type = DBT_INTERNAL_DEST.event_type
                )

    
    when matched then update set
        `policy_id` = DBT_INTERNAL_SOURCE.`policy_id`,`event_type` = DBT_INTERNAL_SOURCE.`event_type`,`event_ts` = DBT_INTERNAL_SOURCE.`event_ts`,`event_month` = DBT_INTERNAL_SOURCE.`event_month`
    

    when not matched then insert
        (`policy_id`, `event_type`, `event_ts`, `event_month`)
    values
        (`policy_id`, `event_type`, `event_ts`, `event_month`)


    
[0m13:51:39.681483 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:aa273e7a-a734-44ff-a9db-19c4dc89c49b&page=queryresults
[0m13:51:39.683588 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:aa273e7a-a734-44ff-a9db-19c4dc89c49b&page=queryresults
[0m13:51:39.697547 [debug] [Thread-1 (]: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m13:51:39.699493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6b94348-d647-40fe-9e97-12bd7e11652b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1613d3b60>]}
[0m13:51:39.700159 [error] [Thread-1 (]: 1 of 2 ERROR creating sql incremental model single_view_policy_assignment.stg_policy_events  [[31mERROR[0m in 1.38s]
[0m13:51:39.700729 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m13:51:39.701202 [debug] [Thread-4 (]: Marking all children of 'model.my_project.stg_policy_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target/run/my_project/models/example/stg_policy_events.sql.
[0m13:51:39.701861 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m13:51:39.702279 [info ] [Thread-1 (]: 2 of 2 SKIP relation single_view_policy_assignment.policy_lifecycle_enriched ... [[33mSKIP[0m]
[0m13:51:39.702642 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m13:51:39.703437 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:51:39.750033 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:39.750249 [debug] [MainThread]: Connection 'model.my_project.stg_policy_events' was properly closed.
[0m13:51:39.750420 [info ] [MainThread]: 
[0m13:51:39.750598 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 3.42 seconds (3.42s).
[0m13:51:39.750966 [debug] [MainThread]: Command end result
[0m13:51:39.763766 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m13:51:39.764567 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m13:51:39.767347 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m13:51:39.767505 [info ] [MainThread]: 
[0m13:51:39.767682 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:51:39.767820 [info ] [MainThread]: 
[0m13:51:39.768015 [error] [MainThread]: [31mFailure in model stg_policy_events (models/example/stg_policy_events.sql)[0m
[0m13:51:39.768203 [error] [MainThread]:   Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m13:51:39.768339 [info ] [MainThread]: 
[0m13:51:39.768494 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/stg_policy_events.sql
[0m13:51:39.768628 [info ] [MainThread]: 
[0m13:51:39.768779 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m13:51:39.769023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.574087, "process_in_blocks": "0", "process_kernel_time": 1.079568, "process_mem_max_rss": "401965056", "process_out_blocks": "0", "process_user_time": 3.597121}
[0m13:51:39.769284 [debug] [MainThread]: Command `dbt run` failed at 13:51:39.769245 after 5.57 seconds
[0m13:51:39.769464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce67e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16121f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16110b020>]}
[0m13:51:39.769620 [debug] [MainThread]: Flushing usage events
[0m13:51:41.174625 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:36.827758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104893c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f78410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f78080>]}


============================== 13:54:36.829690 | ea4ab0e5-1035-4fa2-8ec2-b071fcb09a98 ==============================
[0m13:54:36.829690 [info ] [MainThread]: Running with dbt=1.10.6
[0m13:54:36.830063 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'target_path': 'None', 'version_check': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'False', 'debug': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'no_print': 'None', 'write_json': 'True', 'log_format': 'default', 'static_parser': 'True', 'quiet': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'use_colors': 'True'}
[0m13:54:39.073955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea4ab0e5-1035-4fa2-8ec2-b071fcb09a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f022d0>]}
[0m13:54:39.098390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea4ab0e5-1035-4fa2-8ec2-b071fcb09a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f4d250>]}
[0m13:54:39.098696 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:54:39.211965 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m13:54:39.293447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:39.293667 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:39.312175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea4ab0e5-1035-4fa2-8ec2-b071fcb09a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15844fb60>]}
[0m13:54:39.356068 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m13:54:39.357318 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m13:54:39.368233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea4ab0e5-1035-4fa2-8ec2-b071fcb09a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15912dfd0>]}
[0m13:54:39.368471 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m13:54:39.368645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea4ab0e5-1035-4fa2-8ec2-b071fcb09a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158714410>]}
[0m13:54:39.369378 [info ] [MainThread]: 
[0m13:54:39.369584 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m13:54:39.369721 [info ] [MainThread]: 
[0m13:54:39.369955 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:54:39.371588 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m13:54:39.371781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:40.401980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m13:54:40.403453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:41.179443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea4ab0e5-1035-4fa2-8ec2-b071fcb09a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158715f40>]}
[0m13:54:41.180424 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:41.239465 [debug] [Thread-1 (]: Began running node model.my_project.load_policy
[0m13:54:41.239799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.load_policy)
[0m13:54:41.240031 [debug] [Thread-1 (]: Began compiling node model.my_project.load_policy
[0m13:54:41.245482 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.load_policy"
[0m13:54:41.245882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:41.280496 [debug] [Thread-1 (]: Finished running node model.my_project.load_policy
[0m13:54:41.280857 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m13:54:41.281242 [info ] [Thread-1 (]: 1 of 2 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m13:54:41.281499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.load_policy, now model.my_project.stg_policy_events)
[0m13:54:41.281667 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m13:54:41.285069 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m13:54:41.285399 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m13:54:41.305955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:42.044740 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m13:54:42.045670 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events` as DBT_INTERNAL_DEST
        using (

WITH  __dbt__cte__load_policy as (


SELECT *
FROM `horizontal-ray-467611-f9.single_view_policy_assignment.POLICY_EVENTS`
), deduped AS (
  SELECT
    DISTINCT policy_id,
    event_type,
    SAFE_CAST(event_timestamp AS TIMESTAMP) AS event_ts
  FROM __dbt__cte__load_policy  
  WHERE 
    policy_id IS NOT NULL
    AND event_type IN ('quote', 'bind', 'cancel')
    AND SAFE_CAST(event_timestamp AS TIMESTAMP) IS NOT NULL
)

SELECT
  policy_id,
  event_type,
  event_ts,
  FORMAT_DATE('%B', DATE_TRUNC(DATE(event_ts), MONTH)) AS event_month
FROM deduped
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.policy_id = DBT_INTERNAL_DEST.policy_id
                ) and (
                    DBT_INTERNAL_SOURCE.event_type = DBT_INTERNAL_DEST.event_type
                )

    
    when matched then update set
        `policy_id` = DBT_INTERNAL_SOURCE.`policy_id`,`event_type` = DBT_INTERNAL_SOURCE.`event_type`,`event_ts` = DBT_INTERNAL_SOURCE.`event_ts`,`event_month` = DBT_INTERNAL_SOURCE.`event_month`
    

    when not matched then insert
        (`policy_id`, `event_type`, `event_ts`, `event_month`)
    values
        (`policy_id`, `event_type`, `event_ts`, `event_month`)


    
[0m13:54:42.750123 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a2bd2669-4914-4e7e-9700-0f96acebcb20&page=queryresults
[0m13:54:42.752270 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a2bd2669-4914-4e7e-9700-0f96acebcb20&page=queryresults
[0m13:54:42.763323 [debug] [Thread-1 (]: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m13:54:42.766082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea4ab0e5-1035-4fa2-8ec2-b071fcb09a98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d98860>]}
[0m13:54:42.766764 [error] [Thread-1 (]: 1 of 2 ERROR creating sql incremental model single_view_policy_assignment.stg_policy_events  [[31mERROR[0m in 1.48s]
[0m13:54:42.767335 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m13:54:42.767799 [debug] [Thread-4 (]: Marking all children of 'model.my_project.stg_policy_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target/run/my_project/models/example/stg_policy_events.sql.
[0m13:54:42.768433 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m13:54:42.768985 [info ] [Thread-1 (]: 2 of 2 SKIP relation single_view_policy_assignment.policy_lifecycle_enriched ... [[33mSKIP[0m]
[0m13:54:42.769449 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m13:54:42.770243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:42.816704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:42.816911 [debug] [MainThread]: Connection 'model.my_project.stg_policy_events' was properly closed.
[0m13:54:42.817077 [info ] [MainThread]: 
[0m13:54:42.817247 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m13:54:42.817602 [debug] [MainThread]: Command end result
[0m13:54:42.830444 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m13:54:42.831247 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m13:54:42.834017 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m13:54:42.834177 [info ] [MainThread]: 
[0m13:54:42.834363 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:54:42.834507 [info ] [MainThread]: 
[0m13:54:42.834690 [error] [MainThread]: [31mFailure in model stg_policy_events (models/example/stg_policy_events.sql)[0m
[0m13:54:42.834865 [error] [MainThread]:   Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Billing has not been enabled for this project. Enable billing at https://console.cloud.google.com/billing. DML queries are not allowed in the free tier. Set up a billing account to remove this restriction.
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m13:54:42.834999 [info ] [MainThread]: 
[0m13:54:42.835152 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/stg_policy_events.sql
[0m13:54:42.835279 [info ] [MainThread]: 
[0m13:54:42.835427 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m13:54:42.835664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.039107, "process_in_blocks": "0", "process_kernel_time": 0.820275, "process_mem_max_rss": "402620416", "process_out_blocks": "0", "process_user_time": 3.958015}
[0m13:54:42.835931 [debug] [MainThread]: Command `dbt run` failed at 13:54:42.835889 after 6.04 seconds
[0m13:54:42.836106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dc7680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158109820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1582e03b0>]}
[0m13:54:42.836264 [debug] [MainThread]: Flushing usage events
[0m13:54:44.006071 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:16.664684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0c0e0>]}


============================== 14:44:16.666626 | 1d20198c-bdb6-4ca7-aa27-9b10c2010fd0 ==============================
[0m14:44:16.666626 [info ] [MainThread]: Running with dbt=1.10.6
[0m14:44:16.667012 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'use_colors': 'True', 'no_print': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --full-refresh', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'version_check': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'debug': 'False', 'introspect': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'printer_width': '80', 'log_path': '/Users/pratibhagangavarapu/my_project/logs'}
[0m14:44:18.837913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d20198c-bdb6-4ca7-aa27-9b10c2010fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13963f0e0>]}
[0m14:44:18.863850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d20198c-bdb6-4ca7-aa27-9b10c2010fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ade0c0>]}
[0m14:44:18.864198 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m14:44:18.979442 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m14:44:19.063426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:44:19.063644 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:44:19.082657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d20198c-bdb6-4ca7-aa27-9b10c2010fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148b03680>]}
[0m14:44:19.127734 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m14:44:19.128943 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m14:44:19.140697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d20198c-bdb6-4ca7-aa27-9b10c2010fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148914050>]}
[0m14:44:19.140935 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m14:44:19.141119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d20198c-bdb6-4ca7-aa27-9b10c2010fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1487923f0>]}
[0m14:44:19.141855 [info ] [MainThread]: 
[0m14:44:19.142063 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m14:44:19.142194 [info ] [MainThread]: 
[0m14:44:19.142453 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:44:19.144285 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m14:44:19.144528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:20.279099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m14:44:20.280472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:21.018318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d20198c-bdb6-4ca7-aa27-9b10c2010fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103478fe0>]}
[0m14:44:21.018721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:21.058951 [debug] [Thread-1 (]: Began running node model.my_project.load_policy
[0m14:44:21.059182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.load_policy)
[0m14:44:21.059367 [debug] [Thread-1 (]: Began compiling node model.my_project.load_policy
[0m14:44:21.063806 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.load_policy"
[0m14:44:21.064173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:21.096838 [debug] [Thread-1 (]: Finished running node model.my_project.load_policy
[0m14:44:21.097204 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m14:44:21.097498 [info ] [Thread-1 (]: 1 of 2 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m14:44:21.097766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.load_policy, now model.my_project.stg_policy_events)
[0m14:44:21.097912 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m14:44:21.101225 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m14:44:21.101533 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m14:44:21.122092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:21.898530 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m14:44:21.899353 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    partition by timestamp_trunc(event_ts, day)
    cluster by policy_id, event_type

    
    OPTIONS()
    as (
      

WITH  __dbt__cte__load_policy as (


SELECT *
FROM `horizontal-ray-467611-f9.single_view_policy_assignment.POLICY_EVENTS`
), deduped AS (
  SELECT
    DISTINCT policy_id,
    event_type,
    SAFE_CAST(event_timestamp AS TIMESTAMP) AS event_ts
  FROM __dbt__cte__load_policy  
  WHERE 
    policy_id IS NOT NULL
    AND event_type IN ('quote', 'bind', 'cancel')
    AND SAFE_CAST(event_timestamp AS TIMESTAMP) IS NOT NULL
)

SELECT
  policy_id,
  event_type,
  event_ts,
  FORMAT_DATE('%B', DATE_TRUNC(DATE(event_ts), MONTH)) AS event_month
FROM deduped
    );
  
[0m14:44:22.725307 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:3adf2ebe-dd20-4b7a-93bd-e0ff6aba011b&page=queryresults
[0m14:44:26.367831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d20198c-bdb6-4ca7-aa27-9b10c2010fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139ac3b00>]}
[0m14:44:26.368689 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (0.0 rows, 15.2 KiB processed)[0m in 5.27s]
[0m14:44:26.369238 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m14:44:26.369879 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m14:44:26.370354 [info ] [Thread-1 (]: 2 of 2 START sql table model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m14:44:26.370782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m14:44:26.371089 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m14:44:26.374204 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m14:44:26.374795 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m14:44:26.382721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:27.152651 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m14:44:27.155455 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    partition by timestamp_trunc(first_bind_ts, day)
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
    MAX(event_ts) AS last_event_ts
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      event_ts,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
)

SELECT
  f.policy_id,
  f.first_quote_ts,
  f.first_bind_ts,
  f.first_cancel_ts,

  -- Status business logic
  CASE
    WHEN f.first_cancel_ts IS NOT NULL AND l.last_event_type = 'cancel' THEN 'cancelled'
    WHEN f.first_bind_ts IS NOT NULL THEN 'bound'
    ELSE 'quoted'
  END AS current_status,

  -- Quote to bind duration
  CASE
    WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
    ELSE NULL
  END AS quote_to_bind_mins,

  -- Bind to cancel duration
  CASE
    WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
    ELSE NULL
  END AS bind_to_cancel_mins,

  -- Month name of first event
  FORMAT_DATE('%B', DATE_TRUNC(DATE(COALESCE(f.first_quote_ts, f.first_bind_ts, f.first_cancel_ts)), MONTH)) AS event_month

FROM firsts f
LEFT JOIN last_evt l
  ON f.policy_id = l.policy_id
    );
  
[0m14:44:27.839177 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:3d99f037-90fb-469e-87f6-c269d8472086&page=queryresults
[0m14:44:29.883869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d20198c-bdb6-4ca7-aa27-9b10c2010fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148e38e90>]}
[0m14:44:29.885076 [info ] [Thread-1 (]: 2 of 2 OK created sql table model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 3.51s]
[0m14:44:29.885813 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m14:44:29.886962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:29.938730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:29.938970 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m14:44:29.939158 [info ] [MainThread]: 
[0m14:44:29.939351 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 10.80 seconds (10.80s).
[0m14:44:29.939814 [debug] [MainThread]: Command end result
[0m14:44:29.953130 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m14:44:29.953917 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m14:44:29.956742 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m14:44:29.956914 [info ] [MainThread]: 
[0m14:44:29.957106 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:29.957242 [info ] [MainThread]: 
[0m14:44:29.957418 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:44:29.957672 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13.326474, "process_in_blocks": "0", "process_kernel_time": 0.865657, "process_mem_max_rss": "404324352", "process_out_blocks": "0", "process_user_time": 4.055543}
[0m14:44:29.957948 [debug] [MainThread]: Command `dbt run` succeeded at 14:44:29.957904 after 13.33 seconds
[0m14:44:29.958119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053dad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148544ce0>]}
[0m14:44:29.958294 [debug] [MainThread]: Flushing usage events
[0m14:44:31.352124 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:21:18.816820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d90470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d901d0>]}


============================== 18:21:18.818964 | 89152803-68fa-4bea-9938-66b9aade7e65 ==============================
[0m18:21:18.818964 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:21:18.819362 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_cache_events': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'partial_parse': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'write_json': 'True', 'empty': 'None', 'quiet': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'printer_width': '80', 'no_print': 'None', 'version_check': 'True'}
[0m18:21:20.998984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89152803-68fa-4bea-9938-66b9aade7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ad689e0>]}
[0m18:21:21.023291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89152803-68fa-4bea-9938-66b9aade7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c046d20>]}
[0m18:21:21.023596 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:21:21.136924 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:21:21.219059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:21:21.219278 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:21:21.237806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89152803-68fa-4bea-9938-66b9aade7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c48b050>]}
[0m18:21:21.282102 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:21:21.283430 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:21:21.299927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89152803-68fa-4bea-9938-66b9aade7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c950890>]}
[0m18:21:21.300162 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m18:21:21.300345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89152803-68fa-4bea-9938-66b9aade7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c80bfb0>]}
[0m18:21:21.301128 [info ] [MainThread]: 
[0m18:21:21.301329 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m18:21:21.301465 [info ] [MainThread]: 
[0m18:21:21.301710 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:21:21.303380 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9_single_view_policy_assignment'
[0m18:21:21.303557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:22.133181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89152803-68fa-4bea-9938-66b9aade7e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ad6a270>]}
[0m18:21:22.134537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:21:22.197979 [debug] [Thread-1 (]: Began running node test.my_project.EVENT_MONTH
[0m18:21:22.198348 [info ] [Thread-1 (]: 1 of 5 START test EVENT_MONTH .................................................. [RUN]
[0m18:21:22.198637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now test.my_project.EVENT_MONTH)
[0m18:21:22.198848 [debug] [Thread-1 (]: Began compiling node test.my_project.EVENT_MONTH
[0m18:21:22.203928 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.EVENT_MONTH"
[0m18:21:22.204543 [debug] [Thread-1 (]: Began executing node test.my_project.EVENT_MONTH
[0m18:21:22.217300 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.EVENT_MONTH"
[0m18:21:22.217755 [debug] [Thread-1 (]: On test.my_project.EVENT_MONTH: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.EVENT_MONTH"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT *
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
WHERE event_month IS NULL
   OR NOT event_month IN ('January', 'February', ..., 'December')
  
  
      
    ) dbt_internal_test
[0m18:21:22.217972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:23.493251 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:f6971109-5073-4418-a468-c98729221e83&page=queryresults
[0m18:21:23.495824 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:f6971109-5073-4418-a468-c98729221e83&page=queryresults
[0m18:21:23.510305 [debug] [Thread-1 (]: Database Error in test EVENT_MONTH (tests/EVENT_MONTH.sql)
  Syntax error: Unexpected "." at [13:50]
  compiled code at target/run/my_project/tests/EVENT_MONTH.sql
[0m18:21:23.511532 [error] [Thread-1 (]: 1 of 5 ERROR EVENT_MONTH ....................................................... [[31mERROR[0m in 1.31s]
[0m18:21:23.513112 [debug] [Thread-1 (]: Finished running node test.my_project.EVENT_MONTH
[0m18:21:23.513730 [debug] [Thread-1 (]: Began running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:21:23.514420 [debug] [Thread-4 (]: Marking all children of 'test.my_project.EVENT_MONTH' to be skipped because of status 'error'.  Reason: Database Error in test EVENT_MONTH (tests/EVENT_MONTH.sql)
  Syntax error: Unexpected "." at [13:50]
  compiled code at target/run/my_project/tests/EVENT_MONTH.sql.
[0m18:21:23.515103 [info ] [Thread-1 (]: 2 of 5 START test FIRST_EVENT_TIMESTAMP ........................................ [RUN]
[0m18:21:23.516087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.EVENT_MONTH, now test.my_project.FIRST_EVENT_TIMESTAMP)
[0m18:21:23.516562 [debug] [Thread-1 (]: Began compiling node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:21:23.520054 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m18:21:23.520962 [debug] [Thread-1 (]: Began executing node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:21:23.523664 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m18:21:23.524538 [debug] [Thread-1 (]: On test.my_project.FIRST_EVENT_TIMESTAMP: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.FIRST_EVENT_TIMESTAMP"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE first_quote_ts IS NULL 
AND first_bind_ts IS NULL 
AND first_cancel_ts IS NULL
  
  
      
    ) dbt_internal_test
[0m18:21:23.524947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:26.363595 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:cd35d8e8-8b11-4cee-b888-9a28193e5697&page=queryresults
[0m18:21:27.101709 [error] [Thread-1 (]: 2 of 5 FAIL 1 FIRST_EVENT_TIMESTAMP ............................................ [[31mFAIL 1[0m in 3.59s]
[0m18:21:27.102756 [debug] [Thread-1 (]: Finished running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:21:27.103341 [debug] [Thread-1 (]: Began running node test.my_project.NEGATIVE_DURATION
[0m18:21:27.103967 [info ] [Thread-1 (]: 3 of 5 START test NEGATIVE_DURATION ............................................ [RUN]
[0m18:21:27.104538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.FIRST_EVENT_TIMESTAMP, now test.my_project.NEGATIVE_DURATION)
[0m18:21:27.104956 [debug] [Thread-1 (]: Began compiling node test.my_project.NEGATIVE_DURATION
[0m18:21:27.108263 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.NEGATIVE_DURATION"
[0m18:21:27.109070 [debug] [Thread-1 (]: Began executing node test.my_project.NEGATIVE_DURATION
[0m18:21:27.111442 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.NEGATIVE_DURATION"
[0m18:21:27.112074 [debug] [Thread-1 (]: On test.my_project.NEGATIVE_DURATION: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.NEGATIVE_DURATION"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_mins < 0 
OR bind_to_cancel_mins < 0
  
  
      
    ) dbt_internal_test
[0m18:21:27.113066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:28.921318 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:08777eee-2665-4cda-9734-91fb1a4bdb29&page=queryresults
[0m18:21:29.456334 [error] [Thread-1 (]: 3 of 5 FAIL 1 NEGATIVE_DURATION ................................................ [[31mFAIL 1[0m in 2.35s]
[0m18:21:29.458079 [debug] [Thread-1 (]: Finished running node test.my_project.NEGATIVE_DURATION
[0m18:21:29.458853 [debug] [Thread-1 (]: Began running node test.my_project.NO_NULL
[0m18:21:29.459525 [info ] [Thread-1 (]: 4 of 5 START test NO_NULL ...................................................... [RUN]
[0m18:21:29.460239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.NEGATIVE_DURATION, now test.my_project.NO_NULL)
[0m18:21:29.460815 [debug] [Thread-1 (]: Began compiling node test.my_project.NO_NULL
[0m18:21:29.468587 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.NO_NULL"
[0m18:21:29.469920 [debug] [Thread-1 (]: Began executing node test.my_project.NO_NULL
[0m18:21:29.472624 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.NO_NULL"
[0m18:21:29.473499 [debug] [Thread-1 (]: On test.my_project.NO_NULL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.NO_NULL"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT *
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
WHERE policy_id IS NULL OR event_type IS NULL
  
  
      
    ) dbt_internal_test
[0m18:21:29.473980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:30.968680 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:775f23ff-4824-47cf-80b8-322630ed3b66&page=queryresults
[0m18:21:31.578895 [info ] [Thread-1 (]: 4 of 5 PASS NO_NULL ............................................................ [[32mPASS[0m in 2.12s]
[0m18:21:31.580495 [debug] [Thread-1 (]: Finished running node test.my_project.NO_NULL
[0m18:21:31.581162 [debug] [Thread-1 (]: Began running node test.my_project.STATUS_VALUE_RANGE
[0m18:21:31.581791 [info ] [Thread-1 (]: 5 of 5 START test STATUS_VALUE_RANGE ........................................... [RUN]
[0m18:21:31.582808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.NO_NULL, now test.my_project.STATUS_VALUE_RANGE)
[0m18:21:31.583528 [debug] [Thread-1 (]: Began compiling node test.my_project.STATUS_VALUE_RANGE
[0m18:21:31.588284 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.STATUS_VALUE_RANGE"
[0m18:21:31.589772 [debug] [Thread-1 (]: Began executing node test.my_project.STATUS_VALUE_RANGE
[0m18:21:31.592443 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.STATUS_VALUE_RANGE"
[0m18:21:31.593257 [debug] [Thread-1 (]: On test.my_project.STATUS_VALUE_RANGE: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.STATUS_VALUE_RANGE"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE current_status NOT IN ('quoted', 'bound', 'cancelled')
  
  
      
    ) dbt_internal_test
[0m18:21:31.593715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:32.809351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:258cad82-dfab-44bd-b037-eb37ba4578fe&page=queryresults
[0m18:21:33.218379 [error] [Thread-1 (]: 5 of 5 FAIL 1 STATUS_VALUE_RANGE ............................................... [[31mFAIL 1[0m in 1.64s]
[0m18:21:33.219962 [debug] [Thread-1 (]: Finished running node test.my_project.STATUS_VALUE_RANGE
[0m18:21:33.222163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:21:33.283030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:21:33.283366 [debug] [MainThread]: Connection 'test.my_project.STATUS_VALUE_RANGE' was properly closed.
[0m18:21:33.283614 [info ] [MainThread]: 
[0m18:21:33.283853 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 11.98 seconds (11.98s).
[0m18:21:33.284607 [debug] [MainThread]: Command end result
[0m18:21:33.298110 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:21:33.298913 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:21:33.302456 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m18:21:33.302657 [info ] [MainThread]: 
[0m18:21:33.302852 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m18:21:33.303008 [info ] [MainThread]: 
[0m18:21:33.303192 [error] [MainThread]: [31mFailure in test EVENT_MONTH (tests/EVENT_MONTH.sql)[0m
[0m18:21:33.303374 [error] [MainThread]:   Database Error in test EVENT_MONTH (tests/EVENT_MONTH.sql)
  Syntax error: Unexpected "." at [13:50]
  compiled code at target/run/my_project/tests/EVENT_MONTH.sql
[0m18:21:33.303510 [info ] [MainThread]: 
[0m18:21:33.303660 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/EVENT_MONTH.sql
[0m18:21:33.303794 [info ] [MainThread]: 
[0m18:21:33.303945 [error] [MainThread]: [31mFailure in test FIRST_EVENT_TIMESTAMP (tests/FIRST_EVENT_TIMESTAMP.sql)[0m
[0m18:21:33.304100 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:21:33.304223 [info ] [MainThread]: 
[0m18:21:33.304366 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/FIRST_EVENT_TIMESTAMP.sql
[0m18:21:33.304488 [info ] [MainThread]: 
[0m18:21:33.304634 [error] [MainThread]: [31mFailure in test NEGATIVE_DURATION (tests/NEGATIVE_DURATION.sql)[0m
[0m18:21:33.304784 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:21:33.304899 [info ] [MainThread]: 
[0m18:21:33.305038 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/NEGATIVE_DURATION.sql
[0m18:21:33.305159 [info ] [MainThread]: 
[0m18:21:33.305301 [error] [MainThread]: [31mFailure in test STATUS_VALUE_RANGE (tests/STATUS_VALUE_RANGE.sql)[0m
[0m18:21:33.305445 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:21:33.305560 [info ] [MainThread]: 
[0m18:21:33.305735 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/STATUS_VALUE_RANGE.sql
[0m18:21:33.305918 [info ] [MainThread]: 
[0m18:21:33.306088 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=5
[0m18:21:33.306354 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 14.523426, "process_in_blocks": "0", "process_kernel_time": 1.430025, "process_mem_max_rss": "404127744", "process_out_blocks": "0", "process_user_time": 3.688834}
[0m18:21:33.306622 [debug] [MainThread]: Command `dbt test` failed at 18:21:33.306584 after 14.52 seconds
[0m18:21:33.306805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bdc650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c80bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c803170>]}
[0m18:21:33.306968 [debug] [MainThread]: Flushing usage events
[0m18:21:34.755370 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:27:09.394289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065279e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074044d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107404230>]}


============================== 18:27:09.395931 | 0236df79-27e0-492b-bb9f-74e48373de43 ==============================
[0m18:27:09.395931 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:27:09.396306 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --full-refresh --select policy_lifecycle_enriched', 'printer_width': '80', 'use_colors': 'True', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error': 'None', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'partial_parse': 'True'}
[0m18:27:11.317522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0236df79-27e0-492b-bb9f-74e48373de43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7fd10>]}
[0m18:27:11.341913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0236df79-27e0-492b-bb9f-74e48373de43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148ef6d20>]}
[0m18:27:11.342259 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:27:11.455883 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:27:11.538934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:27:11.539278 [debug] [MainThread]: Partial parsing: updated file: my_project://tests/EVENT_MONTH.sql
[0m18:27:11.621040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0236df79-27e0-492b-bb9f-74e48373de43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1499920f0>]}
[0m18:27:11.661030 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:27:11.662044 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:27:11.672025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0236df79-27e0-492b-bb9f-74e48373de43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1499148f0>]}
[0m18:27:11.672259 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m18:27:11.672445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0236df79-27e0-492b-bb9f-74e48373de43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1497000e0>]}
[0m18:27:11.673045 [info ] [MainThread]: 
[0m18:27:11.673252 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m18:27:11.673387 [info ] [MainThread]: 
[0m18:27:11.673620 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:27:11.674024 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m18:27:11.674225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:12.763319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m18:27:12.764319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:13.495909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0236df79-27e0-492b-bb9f-74e48373de43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149765820>]}
[0m18:27:13.497014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:13.556612 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m18:27:13.557029 [info ] [Thread-1 (]: 1 of 1 START sql table model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m18:27:13.557309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.policy_lifecycle_enriched)
[0m18:27:13.557528 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m18:27:13.562217 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m18:27:13.562599 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m18:27:13.574378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:14.324740 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m18:27:14.325544 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    partition by timestamp_trunc(first_bind_ts, day)
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
    MAX(event_ts) AS last_event_ts
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      event_ts,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
)

SELECT
  f.policy_id,
  f.first_quote_ts,
  f.first_bind_ts,
  f.first_cancel_ts,

  -- Status business logic
  CASE
    WHEN f.first_cancel_ts IS NOT NULL AND l.last_event_type = 'cancel' THEN 'cancelled'
    WHEN f.first_bind_ts IS NOT NULL THEN 'bound'
    ELSE 'quoted'
  END AS current_status,

  -- Quote to bind duration
  CASE
    WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
    ELSE NULL
  END AS quote_to_bind_mins,

  -- Bind to cancel duration
  CASE
    WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
    ELSE NULL
  END AS bind_to_cancel_mins,

  -- Month name of first event
  FORMAT_DATE('%B', DATE_TRUNC(DATE(COALESCE(f.first_quote_ts, f.first_bind_ts, f.first_cancel_ts)), MONTH)) AS event_month

FROM firsts f
LEFT JOIN last_evt l
  ON f.policy_id = l.policy_id
    );
  
[0m18:27:15.636596 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:f8119977-7bfe-4f36-95aa-221bf9aab18a&page=queryresults
[0m18:27:18.131607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0236df79-27e0-492b-bb9f-74e48373de43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13afc3a10>]}
[0m18:27:18.132334 [info ] [Thread-1 (]: 1 of 1 OK created sql table model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 4.57s]
[0m18:27:18.132913 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m18:27:18.133894 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:18.178858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:18.179056 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m18:27:18.179220 [info ] [MainThread]: 
[0m18:27:18.179384 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.51 seconds (6.51s).
[0m18:27:18.179722 [debug] [MainThread]: Command end result
[0m18:27:18.191859 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:27:18.192659 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:27:18.195374 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m18:27:18.195546 [info ] [MainThread]: 
[0m18:27:18.195747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:27:18.195891 [info ] [MainThread]: 
[0m18:27:18.196064 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:27:18.196310 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.833226, "process_in_blocks": "0", "process_kernel_time": 0.938577, "process_mem_max_rss": "402898944", "process_out_blocks": "0", "process_user_time": 3.848054}
[0m18:27:18.196601 [debug] [MainThread]: Command `dbt run` succeeded at 18:27:18.196553 after 8.83 seconds
[0m18:27:18.196780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107404470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149c030b0>]}
[0m18:27:18.196955 [debug] [MainThread]: Flushing usage events
[0m18:27:19.631451 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:27:26.583406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104985b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105824410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105824170>]}


============================== 18:27:26.584949 | 11feb898-b004-4f27-866e-cb32d3be6512 ==============================
[0m18:27:26.584949 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:27:26.585329 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'fail_fast': 'False', 'use_colors': 'True', 'invocation_command': 'dbt test --select FIRST_EVENT_TIMESTAMP', 'cache_selected_only': 'False', 'empty': 'None', 'debug': 'False', 'version_check': 'True', 'static_parser': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_cache_events': 'False', 'partial_parse': 'True', 'write_json': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'target_path': 'None', 'quiet': 'False'}
[0m18:27:27.950864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11feb898-b004-4f27-866e-cb32d3be6512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1728d31d0>]}
[0m18:27:27.975775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11feb898-b004-4f27-866e-cb32d3be6512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172d52ab0>]}
[0m18:27:27.976132 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:27:28.089065 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:27:28.167841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:27:28.168047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:27:28.186802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11feb898-b004-4f27-866e-cb32d3be6512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f5b4a10>]}
[0m18:27:28.231081 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:27:28.232304 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:27:28.247644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11feb898-b004-4f27-866e-cb32d3be6512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1730552e0>]}
[0m18:27:28.247876 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m18:27:28.248052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11feb898-b004-4f27-866e-cb32d3be6512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172d667e0>]}
[0m18:27:28.248687 [info ] [MainThread]: 
[0m18:27:28.248902 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m18:27:28.249040 [info ] [MainThread]: 
[0m18:27:28.249295 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:27:28.250960 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9_single_view_policy_assignment'
[0m18:27:28.251153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:29.028281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11feb898-b004-4f27-866e-cb32d3be6512', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172cf2630>]}
[0m18:27:29.028771 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:29.074057 [debug] [Thread-1 (]: Began running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:27:29.074334 [info ] [Thread-1 (]: 1 of 1 START test FIRST_EVENT_TIMESTAMP ........................................ [RUN]
[0m18:27:29.074587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now test.my_project.FIRST_EVENT_TIMESTAMP)
[0m18:27:29.074768 [debug] [Thread-1 (]: Began compiling node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:27:29.079066 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m18:27:29.079444 [debug] [Thread-1 (]: Began executing node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:27:29.091253 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m18:27:29.091694 [debug] [Thread-1 (]: On test.my_project.FIRST_EVENT_TIMESTAMP: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.FIRST_EVENT_TIMESTAMP"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE first_quote_ts IS NULL 
AND first_bind_ts IS NULL 
AND first_cancel_ts IS NULL
  
  
      
    ) dbt_internal_test
[0m18:27:29.091933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:29.953867 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:ab67701a-b79e-45d6-9006-8831e38d6011&page=queryresults
[0m18:27:30.508839 [error] [Thread-1 (]: 1 of 1 FAIL 1 FIRST_EVENT_TIMESTAMP ............................................ [[31mFAIL 1[0m in 1.43s]
[0m18:27:30.510042 [debug] [Thread-1 (]: Finished running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:27:30.511502 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:30.561479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:30.561676 [debug] [MainThread]: Connection 'test.my_project.FIRST_EVENT_TIMESTAMP' was properly closed.
[0m18:27:30.561841 [info ] [MainThread]: 
[0m18:27:30.562022 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.31 seconds (2.31s).
[0m18:27:30.562383 [debug] [MainThread]: Command end result
[0m18:27:30.576264 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:27:30.577089 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:27:30.580202 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m18:27:30.580369 [info ] [MainThread]: 
[0m18:27:30.580560 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:27:30.580798 [info ] [MainThread]: 
[0m18:27:30.581043 [error] [MainThread]: [31mFailure in test FIRST_EVENT_TIMESTAMP (tests/FIRST_EVENT_TIMESTAMP.sql)[0m
[0m18:27:30.581244 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:27:30.581386 [info ] [MainThread]: 
[0m18:27:30.581539 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/FIRST_EVENT_TIMESTAMP.sql
[0m18:27:30.581684 [info ] [MainThread]: 
[0m18:27:30.581857 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:27:30.582289 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.0292096, "process_in_blocks": "0", "process_kernel_time": 1.614712, "process_mem_max_rss": "406880256", "process_out_blocks": "0", "process_user_time": 2.911216}
[0m18:27:30.582631 [debug] [MainThread]: Command `dbt test` failed at 18:27:30.582582 after 4.03 seconds
[0m18:27:30.582856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172c08dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f94f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172f74890>]}
[0m18:27:30.583045 [debug] [MainThread]: Flushing usage events
[0m18:27:31.701170 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:31:16.926588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761a8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076940e0>]}


============================== 18:31:16.928228 | 6cf51569-6d09-4cf2-99b3-9f3405b06682 ==============================
[0m18:31:16.928228 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:31:16.928566 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'introspect': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'printer_width': '80', 'target_path': 'None', 'partial_parse': 'True', 'quiet': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'no_print': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'empty': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --full-refresh'}
[0m18:31:18.793063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6cf51569-6d09-4cf2-99b3-9f3405b06682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a161d00>]}
[0m18:31:18.817221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6cf51569-6d09-4cf2-99b3-9f3405b06682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16af3ed20>]}
[0m18:31:18.817519 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:31:18.931378 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:31:19.010083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:31:19.010307 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:31:19.029028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6cf51569-6d09-4cf2-99b3-9f3405b06682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b714050>]}
[0m18:31:19.072946 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:31:19.074410 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:31:19.085707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6cf51569-6d09-4cf2-99b3-9f3405b06682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c2160c0>]}
[0m18:31:19.085953 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m18:31:19.086142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cf51569-6d09-4cf2-99b3-9f3405b06682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c205ca0>]}
[0m18:31:19.086891 [info ] [MainThread]: 
[0m18:31:19.087093 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m18:31:19.087226 [info ] [MainThread]: 
[0m18:31:19.087471 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:31:19.089218 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m18:31:19.089430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:20.267172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m18:31:20.268440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:21.030922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6cf51569-6d09-4cf2-99b3-9f3405b06682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16afca6f0>]}
[0m18:31:21.031883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:21.087521 [debug] [Thread-1 (]: Began running node model.my_project.load_policy
[0m18:31:21.087845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.load_policy)
[0m18:31:21.088068 [debug] [Thread-1 (]: Began compiling node model.my_project.load_policy
[0m18:31:21.093218 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.load_policy"
[0m18:31:21.093656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:21.128796 [debug] [Thread-1 (]: Finished running node model.my_project.load_policy
[0m18:31:21.129252 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m18:31:21.129641 [info ] [Thread-1 (]: 1 of 2 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m18:31:21.129931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.load_policy, now model.my_project.stg_policy_events)
[0m18:31:21.130108 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m18:31:21.133589 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m18:31:21.133938 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m18:31:21.154497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:21.912491 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m18:31:21.913293 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    partition by timestamp_trunc(event_ts, day)
    cluster by policy_id, event_type

    
    OPTIONS()
    as (
      

WITH  __dbt__cte__load_policy as (


SELECT *
FROM `horizontal-ray-467611-f9.single_view_policy_assignment.POLICY_EVENTS`
), deduped AS (
  SELECT
    DISTINCT policy_id,
    event_type,
    SAFE_CAST(event_timestamp AS TIMESTAMP) AS event_ts
  FROM __dbt__cte__load_policy  
  WHERE 
    policy_id IS NOT NULL
    AND event_type IN ('quote', 'bind', 'cancel')
    AND SAFE_CAST(event_timestamp AS TIMESTAMP) IS NOT NULL
)

SELECT
  policy_id,
  event_type,
  event_ts,
  FORMAT_DATE('%B', DATE_TRUNC(DATE(event_ts), MONTH)) AS event_month
FROM deduped
    );
  
[0m18:31:22.844422 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a23e42f7-3793-4be2-bf94-8235db576de8&page=queryresults
[0m18:31:26.118470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf51569-6d09-4cf2-99b3-9f3405b06682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460bb9b0>]}
[0m18:31:26.119279 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (0.0 rows, 15.2 KiB processed)[0m in 4.99s]
[0m18:31:26.119879 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m18:31:26.120530 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m18:31:26.121076 [info ] [Thread-1 (]: 2 of 2 START sql table model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m18:31:26.121552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m18:31:26.121905 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m18:31:26.125196 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m18:31:26.126013 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m18:31:26.133956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:26.838696 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m18:31:26.840909 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    partition by timestamp_trunc(first_bind_ts, day)
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
    MAX(event_ts) AS last_event_ts
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      event_ts,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
)

SELECT
  f.policy_id,
  f.first_quote_ts,
  f.first_bind_ts,
  f.first_cancel_ts,

  -- Status business logic
  CASE
    WHEN f.first_cancel_ts IS NOT NULL AND l.last_event_type = 'cancel' THEN 'cancelled'
    WHEN f.first_bind_ts IS NOT NULL THEN 'bound'
    ELSE 'quoted'
  END AS current_status,

  -- Quote to bind duration
  CASE
    WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
    ELSE NULL
  END AS quote_to_bind_mins,

  -- Bind to cancel duration
  CASE
    WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
    ELSE NULL
  END AS bind_to_cancel_mins,

  -- Month name of first event
  FORMAT_DATE('%B', DATE_TRUNC(DATE(COALESCE(f.first_quote_ts, f.first_bind_ts, f.first_cancel_ts)), MONTH)) AS event_month

FROM firsts f
LEFT JOIN last_evt l
  ON f.policy_id = l.policy_id
    );
  
[0m18:31:27.248061 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:6c212feb-9cb7-4b41-820e-0b8be3643750&page=queryresults
[0m18:31:29.603227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6cf51569-6d09-4cf2-99b3-9f3405b06682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c54be90>]}
[0m18:31:29.604537 [info ] [Thread-1 (]: 2 of 2 OK created sql table model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 3.48s]
[0m18:31:29.605465 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m18:31:29.606838 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:29.661156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:29.661425 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m18:31:29.661620 [info ] [MainThread]: 
[0m18:31:29.661810 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 10.57 seconds (10.57s).
[0m18:31:29.662257 [debug] [MainThread]: Command end result
[0m18:31:29.675378 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:31:29.676477 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:31:29.679312 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m18:31:29.679472 [info ] [MainThread]: 
[0m18:31:29.679652 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:31:29.679786 [info ] [MainThread]: 
[0m18:31:29.679941 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:31:29.680183 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.78406, "process_in_blocks": "0", "process_kernel_time": 1.059704, "process_mem_max_rss": "404226048", "process_out_blocks": "0", "process_user_time": 3.808073}
[0m18:31:29.680454 [debug] [MainThread]: Command `dbt run` succeeded at 18:31:29.680410 after 12.78 seconds
[0m18:31:29.680632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076944d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076940e0>]}
[0m18:31:29.680796 [debug] [MainThread]: Flushing usage events
[0m18:31:31.169080 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:31:58.513533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b8c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db43b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db40b0>]}


============================== 18:31:58.514986 | bc8dcccc-ce7d-4e8f-9eba-666973e206be ==============================
[0m18:31:58.514986 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:31:58.515327 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'version_check': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'static_parser': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'quiet': 'False', 'debug': 'False', 'use_colors': 'True', 'empty': 'None', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'write_json': 'True', 'printer_width': '80'}
[0m18:32:00.015162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc8dcccc-ce7d-4e8f-9eba-666973e206be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162604500>]}
[0m18:32:00.039638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc8dcccc-ce7d-4e8f-9eba-666973e206be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162b6ad20>]}
[0m18:32:00.039967 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:32:00.178247 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:32:00.256376 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:32:00.256595 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:32:00.275207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc8dcccc-ce7d-4e8f-9eba-666973e206be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162b8e8d0>]}
[0m18:32:00.319134 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:32:00.320181 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:32:00.334984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc8dcccc-ce7d-4e8f-9eba-666973e206be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163151700>]}
[0m18:32:00.335224 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m18:32:00.335403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc8dcccc-ce7d-4e8f-9eba-666973e206be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1631184a0>]}
[0m18:32:00.336192 [info ] [MainThread]: 
[0m18:32:00.336402 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m18:32:00.336541 [info ] [MainThread]: 
[0m18:32:00.336794 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:32:00.338448 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9_single_view_policy_assignment'
[0m18:32:00.338633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:01.089804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc8dcccc-ce7d-4e8f-9eba-666973e206be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163007e60>]}
[0m18:32:01.091122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:32:01.151641 [debug] [Thread-1 (]: Began running node test.my_project.EVENT_MONTH
[0m18:32:01.151989 [info ] [Thread-1 (]: 1 of 5 START test EVENT_MONTH .................................................. [RUN]
[0m18:32:01.152282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now test.my_project.EVENT_MONTH)
[0m18:32:01.152500 [debug] [Thread-1 (]: Began compiling node test.my_project.EVENT_MONTH
[0m18:32:01.157359 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.EVENT_MONTH"
[0m18:32:01.157759 [debug] [Thread-1 (]: Began executing node test.my_project.EVENT_MONTH
[0m18:32:01.170344 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.EVENT_MONTH"
[0m18:32:01.170803 [debug] [Thread-1 (]: On test.my_project.EVENT_MONTH: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.EVENT_MONTH"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT *
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
WHERE FORMAT_DATE('%B', DATE_TRUNC(DATE(event_ts), MONTH)) IS NULL
  
  
      
    ) dbt_internal_test
[0m18:32:01.171020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:02.656453 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:fe09feb3-62d3-4b72-8391-e18fdaae617a&page=queryresults
[0m18:32:03.108896 [info ] [Thread-1 (]: 1 of 5 PASS EVENT_MONTH ........................................................ [[32mPASS[0m in 1.96s]
[0m18:32:03.109960 [debug] [Thread-1 (]: Finished running node test.my_project.EVENT_MONTH
[0m18:32:03.110564 [debug] [Thread-1 (]: Began running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:32:03.111215 [info ] [Thread-1 (]: 2 of 5 START test FIRST_EVENT_TIMESTAMP ........................................ [RUN]
[0m18:32:03.111816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.EVENT_MONTH, now test.my_project.FIRST_EVENT_TIMESTAMP)
[0m18:32:03.112232 [debug] [Thread-1 (]: Began compiling node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:32:03.115466 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m18:32:03.116244 [debug] [Thread-1 (]: Began executing node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:32:03.118784 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m18:32:03.119755 [debug] [Thread-1 (]: On test.my_project.FIRST_EVENT_TIMESTAMP: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.FIRST_EVENT_TIMESTAMP"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE first_quote_ts IS NULL 
AND first_bind_ts IS NULL 
AND first_cancel_ts IS NULL
  
  
      
    ) dbt_internal_test
[0m18:32:03.120602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:04.192194 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:b5920f16-9f2c-4bbc-9b39-91f5ccfd5e91&page=queryresults
[0m18:32:04.584389 [error] [Thread-1 (]: 2 of 5 FAIL 1 FIRST_EVENT_TIMESTAMP ............................................ [[31mFAIL 1[0m in 1.47s]
[0m18:32:04.586300 [debug] [Thread-1 (]: Finished running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:32:04.587161 [debug] [Thread-1 (]: Began running node test.my_project.NEGATIVE_DURATION
[0m18:32:04.587895 [info ] [Thread-1 (]: 3 of 5 START test NEGATIVE_DURATION ............................................ [RUN]
[0m18:32:04.588557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.FIRST_EVENT_TIMESTAMP, now test.my_project.NEGATIVE_DURATION)
[0m18:32:04.589113 [debug] [Thread-1 (]: Began compiling node test.my_project.NEGATIVE_DURATION
[0m18:32:04.594610 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.NEGATIVE_DURATION"
[0m18:32:04.595859 [debug] [Thread-1 (]: Began executing node test.my_project.NEGATIVE_DURATION
[0m18:32:04.599436 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.NEGATIVE_DURATION"
[0m18:32:04.600439 [debug] [Thread-1 (]: On test.my_project.NEGATIVE_DURATION: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.NEGATIVE_DURATION"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_mins < 0 
OR bind_to_cancel_mins < 0
  
  
      
    ) dbt_internal_test
[0m18:32:04.600941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:05.625448 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:c43e1c91-2743-45a4-ae60-bbc5a49025c6&page=queryresults
[0m18:32:06.186886 [error] [Thread-1 (]: 3 of 5 FAIL 1 NEGATIVE_DURATION ................................................ [[31mFAIL 1[0m in 1.60s]
[0m18:32:06.188425 [debug] [Thread-1 (]: Finished running node test.my_project.NEGATIVE_DURATION
[0m18:32:06.189174 [debug] [Thread-1 (]: Began running node test.my_project.NO_NULL
[0m18:32:06.189940 [info ] [Thread-1 (]: 4 of 5 START test NO_NULL ...................................................... [RUN]
[0m18:32:06.190696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.NEGATIVE_DURATION, now test.my_project.NO_NULL)
[0m18:32:06.191270 [debug] [Thread-1 (]: Began compiling node test.my_project.NO_NULL
[0m18:32:06.195776 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.NO_NULL"
[0m18:32:06.196842 [debug] [Thread-1 (]: Began executing node test.my_project.NO_NULL
[0m18:32:06.200644 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.NO_NULL"
[0m18:32:06.201585 [debug] [Thread-1 (]: On test.my_project.NO_NULL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.NO_NULL"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT *
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
WHERE policy_id IS NULL OR event_type IS NULL
  
  
      
    ) dbt_internal_test
[0m18:32:06.202151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:07.468639 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:636af626-1a48-4279-82d7-1f0c1b6eea90&page=queryresults
[0m18:32:07.861199 [info ] [Thread-1 (]: 4 of 5 PASS NO_NULL ............................................................ [[32mPASS[0m in 1.67s]
[0m18:32:07.862794 [debug] [Thread-1 (]: Finished running node test.my_project.NO_NULL
[0m18:32:07.863897 [debug] [Thread-1 (]: Began running node test.my_project.STATUS_VALUE_RANGE
[0m18:32:07.864729 [info ] [Thread-1 (]: 5 of 5 START test STATUS_VALUE_RANGE ........................................... [RUN]
[0m18:32:07.865462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.NO_NULL, now test.my_project.STATUS_VALUE_RANGE)
[0m18:32:07.865978 [debug] [Thread-1 (]: Began compiling node test.my_project.STATUS_VALUE_RANGE
[0m18:32:07.870458 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.STATUS_VALUE_RANGE"
[0m18:32:07.871356 [debug] [Thread-1 (]: Began executing node test.my_project.STATUS_VALUE_RANGE
[0m18:32:07.873904 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.STATUS_VALUE_RANGE"
[0m18:32:07.874675 [debug] [Thread-1 (]: On test.my_project.STATUS_VALUE_RANGE: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.STATUS_VALUE_RANGE"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE current_status NOT IN ('quoted', 'bound', 'cancelled')
  
  
      
    ) dbt_internal_test
[0m18:32:07.875116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:08.742099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:e2ac1ca3-8f84-4e09-920d-7687654c5ec6&page=queryresults
[0m18:32:09.205773 [error] [Thread-1 (]: 5 of 5 FAIL 1 STATUS_VALUE_RANGE ............................................... [[31mFAIL 1[0m in 1.34s]
[0m18:32:09.206912 [debug] [Thread-1 (]: Finished running node test.my_project.STATUS_VALUE_RANGE
[0m18:32:09.208330 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:32:09.270141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:09.270535 [debug] [MainThread]: Connection 'test.my_project.STATUS_VALUE_RANGE' was properly closed.
[0m18:32:09.270782 [info ] [MainThread]: 
[0m18:32:09.271013 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 8.93 seconds (8.93s).
[0m18:32:09.271756 [debug] [MainThread]: Command end result
[0m18:32:09.285134 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:32:09.286000 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:32:09.289312 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m18:32:09.289495 [info ] [MainThread]: 
[0m18:32:09.289688 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m18:32:09.289852 [info ] [MainThread]: 
[0m18:32:09.290047 [error] [MainThread]: [31mFailure in test FIRST_EVENT_TIMESTAMP (tests/FIRST_EVENT_TIMESTAMP.sql)[0m
[0m18:32:09.290227 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:32:09.290364 [info ] [MainThread]: 
[0m18:32:09.290570 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/FIRST_EVENT_TIMESTAMP.sql
[0m18:32:09.290746 [info ] [MainThread]: 
[0m18:32:09.290903 [error] [MainThread]: [31mFailure in test NEGATIVE_DURATION (tests/NEGATIVE_DURATION.sql)[0m
[0m18:32:09.291061 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:32:09.291174 [info ] [MainThread]: 
[0m18:32:09.291315 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/NEGATIVE_DURATION.sql
[0m18:32:09.291436 [info ] [MainThread]: 
[0m18:32:09.291583 [error] [MainThread]: [31mFailure in test STATUS_VALUE_RANGE (tests/STATUS_VALUE_RANGE.sql)[0m
[0m18:32:09.291732 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:32:09.291847 [info ] [MainThread]: 
[0m18:32:09.291985 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/STATUS_VALUE_RANGE.sql
[0m18:32:09.292108 [info ] [MainThread]: 
[0m18:32:09.292258 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m18:32:09.292508 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 10.809225, "process_in_blocks": "0", "process_kernel_time": 1.455755, "process_mem_max_rss": "404226048", "process_out_blocks": "0", "process_user_time": 3.504024}
[0m18:32:09.292784 [debug] [MainThread]: Command `dbt test` failed at 18:32:09.292746 after 10.81 seconds
[0m18:32:09.292973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074877a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d68bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160382b40>]}
[0m18:32:09.293138 [debug] [MainThread]: Flushing usage events
[0m18:32:10.573349 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:39.838017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078675f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853c230>]}


============================== 18:34:39.839799 | ec6b5e2b-81cc-4b8c-8647-d244bedf4788 ==============================
[0m18:34:39.839799 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:34:39.840183 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'no_print': 'None', 'debug': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'cache_selected_only': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select policy_lifecycle_enriched --full-refresh', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'log_format': 'default', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'use_colors': 'True', 'version_check': 'True'}
[0m18:34:41.589542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec6b5e2b-81cc-4b8c-8647-d244bedf4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150fcec00>]}
[0m18:34:41.613869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec6b5e2b-81cc-4b8c-8647-d244bedf4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084ee2a0>]}
[0m18:34:41.614176 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:34:41.730031 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:34:41.815888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:34:41.816229 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/policy_lifecycle_enriched.sql
[0m18:34:41.934701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec6b5e2b-81cc-4b8c-8647-d244bedf4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1515bbd10>]}
[0m18:34:41.974168 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:34:41.975709 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:34:41.987092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec6b5e2b-81cc-4b8c-8647-d244bedf4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150fcfef0>]}
[0m18:34:41.987328 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m18:34:41.987503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec6b5e2b-81cc-4b8c-8647-d244bedf4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1515bbda0>]}
[0m18:34:41.988115 [info ] [MainThread]: 
[0m18:34:41.988301 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m18:34:41.988433 [info ] [MainThread]: 
[0m18:34:41.988657 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:34:41.989062 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m18:34:41.989254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:42.995934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m18:34:42.997087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:43.756262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec6b5e2b-81cc-4b8c-8647-d244bedf4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151450f80>]}
[0m18:34:43.757868 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:43.821123 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m18:34:43.821609 [info ] [Thread-1 (]: 1 of 1 START sql table model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m18:34:43.821915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.policy_lifecycle_enriched)
[0m18:34:43.822133 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m18:34:43.826705 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m18:34:43.827132 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m18:34:43.838207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:44.598404 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m18:34:44.599464 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    partition by timestamp_trunc(first_bind_ts, day)
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
    MAX(event_ts) AS last_event_ts
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      event_ts,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
)

SELECT
  f.policy_id,
  f.first_quote_ts,
  f.first_bind_ts,
  f.first_cancel_ts,

  -- Status business logic
  CASE
    WHEN f.first_cancel_ts IS NOT NULL AND l.last_event_type = 'cancel' THEN 'cancelled'
    WHEN f.first_bind_ts IS NOT NULL THEN 'bound'
    ELSE 'quoted'
  END AS current_status,

  -- Quote to bind duration
  CASE
    WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
    ELSE NULL
  END AS quote_to_bind_mins,

  -- Bind to cancel duration
  CASE
    WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
    ELSE NULL
  END AS bind_to_cancel_mins,

  -- Month name of first event
  FORMAT_DATE('%B', DATE_TRUNC(DATE(COALESCE(f.first_quote_ts, f.first_bind_ts, f.first_cancel_ts)), MONTH)) AS event_month

FROM firsts f
LEFT JOIN last_evt l
  ON f.policy_id = l.policy_id
WHERE f.first_quote_ts IS NOT NULL 
   OR f.first_bind_ts IS NOT NULL 
   OR f.first_cancel_ts IS NOT NULL
    );
  
[0m18:34:45.102364 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:8a9d7296-d755-4093-ab9f-aaf391bdd805&page=queryresults
[0m18:34:47.711437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec6b5e2b-81cc-4b8c-8647-d244bedf4788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106858aa0>]}
[0m18:34:47.712162 [info ] [Thread-1 (]: 1 of 1 OK created sql table model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 3.89s]
[0m18:34:47.712705 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m18:34:47.713584 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:47.762313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:47.762584 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m18:34:47.762776 [info ] [MainThread]: 
[0m18:34:47.762968 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.77 seconds (5.77s).
[0m18:34:47.763335 [debug] [MainThread]: Command end result
[0m18:34:47.775301 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:34:47.776097 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:34:47.778838 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m18:34:47.779000 [info ] [MainThread]: 
[0m18:34:47.779194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:47.779340 [info ] [MainThread]: 
[0m18:34:47.779502 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:34:47.779740 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.9739246, "process_in_blocks": "0", "process_kernel_time": 0.908395, "process_mem_max_rss": "408600576", "process_out_blocks": "0", "process_user_time": 3.739024}
[0m18:34:47.780011 [debug] [MainThread]: Command `dbt run` succeeded at 18:34:47.779970 after 7.97 seconds
[0m18:34:47.780192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c72d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1515bbef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15104eb70>]}
[0m18:34:47.780362 [debug] [MainThread]: Flushing usage events
[0m18:34:49.100564 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:35:06.688375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105625cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ee4170>]}


============================== 18:35:06.689977 | 571f1db8-358a-4084-845e-30667d5199d3 ==============================
[0m18:35:06.689977 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:35:06.690360 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'invocation_command': 'dbt test --select FIRST_EVENT_TIMESTAMP', 'printer_width': '80', 'quiet': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'no_print': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'log_format': 'default', 'partial_parse': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'empty': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'use_experimental_parser': 'False'}
[0m18:35:08.263055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '571f1db8-358a-4084-845e-30667d5199d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6d6a0>]}
[0m18:35:08.288032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '571f1db8-358a-4084-845e-30667d5199d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c666480>]}
[0m18:35:08.288371 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:35:08.401718 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:35:08.480543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:08.480743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:08.499449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '571f1db8-358a-4084-845e-30667d5199d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c664f20>]}
[0m18:35:08.543321 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:35:08.544623 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:35:08.559833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '571f1db8-358a-4084-845e-30667d5199d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d354fb0>]}
[0m18:35:08.560072 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m18:35:08.560247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '571f1db8-358a-4084-845e-30667d5199d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d0c9970>]}
[0m18:35:08.560860 [info ] [MainThread]: 
[0m18:35:08.561045 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m18:35:08.561185 [info ] [MainThread]: 
[0m18:35:08.561421 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:35:08.563084 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9_single_view_policy_assignment'
[0m18:35:08.563284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:09.295071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '571f1db8-358a-4084-845e-30667d5199d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c68a630>]}
[0m18:35:09.296396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:09.359404 [debug] [Thread-1 (]: Began running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:35:09.359806 [info ] [Thread-1 (]: 1 of 1 START test FIRST_EVENT_TIMESTAMP ........................................ [RUN]
[0m18:35:09.360091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now test.my_project.FIRST_EVENT_TIMESTAMP)
[0m18:35:09.360301 [debug] [Thread-1 (]: Began compiling node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:35:09.365201 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m18:35:09.365807 [debug] [Thread-1 (]: Began executing node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:35:09.378312 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m18:35:09.378729 [debug] [Thread-1 (]: On test.my_project.FIRST_EVENT_TIMESTAMP: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.FIRST_EVENT_TIMESTAMP"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE first_quote_ts IS NULL 
AND first_bind_ts IS NULL 
AND first_cancel_ts IS NULL
  
  
      
    ) dbt_internal_test
[0m18:35:09.378957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:10.658655 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:97bb30f2-03f3-4858-98af-144cb1cffe9a&page=queryresults
[0m18:35:11.331136 [error] [Thread-1 (]: 1 of 1 FAIL 1 FIRST_EVENT_TIMESTAMP ............................................ [[31mFAIL 1[0m in 1.97s]
[0m18:35:11.332220 [debug] [Thread-1 (]: Finished running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:35:11.333562 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:11.385589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:11.385806 [debug] [MainThread]: Connection 'test.my_project.FIRST_EVENT_TIMESTAMP' was properly closed.
[0m18:35:11.386012 [info ] [MainThread]: 
[0m18:35:11.386271 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m18:35:11.386687 [debug] [MainThread]: Command end result
[0m18:35:11.399791 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:35:11.400713 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:35:11.403949 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m18:35:11.404413 [info ] [MainThread]: 
[0m18:35:11.404693 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:35:11.404859 [info ] [MainThread]: 
[0m18:35:11.405065 [error] [MainThread]: [31mFailure in test FIRST_EVENT_TIMESTAMP (tests/FIRST_EVENT_TIMESTAMP.sql)[0m
[0m18:35:11.405236 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:35:11.405357 [info ] [MainThread]: 
[0m18:35:11.405513 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/FIRST_EVENT_TIMESTAMP.sql
[0m18:35:11.405646 [info ] [MainThread]: 
[0m18:35:11.405797 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m18:35:11.406057 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.7486286, "process_in_blocks": "0", "process_kernel_time": 1.370641, "process_mem_max_rss": "403947520", "process_out_blocks": "0", "process_user_time": 3.140192}
[0m18:35:11.406336 [debug] [MainThread]: Command `dbt test` failed at 18:35:11.406296 after 4.75 seconds
[0m18:35:11.406525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fab470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d24b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d2095e0>]}
[0m18:35:11.406692 [debug] [MainThread]: Flushing usage events
[0m18:35:12.793260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:35:37.336659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106832960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cc0e0>]}


============================== 18:35:37.338063 | ff70b7ef-2573-4098-af57-ba39434592b3 ==============================
[0m18:35:37.338063 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:35:37.338390 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'debug': 'False', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'fail_fast': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'invocation_command': 'dbt run --full-refresh', 'partial_parse': 'True', 'warn_error': 'None', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'use_colors': 'True', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'no_print': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False'}
[0m18:35:38.705672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff70b7ef-2573-4098-af57-ba39434592b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737f4a0>]}
[0m18:35:38.729864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff70b7ef-2573-4098-af57-ba39434592b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a871c40>]}
[0m18:35:38.730167 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:35:38.846805 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:35:38.924626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:38.924852 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:38.943543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff70b7ef-2573-4098-af57-ba39434592b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b08a6f0>]}
[0m18:35:38.987974 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:35:38.989140 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:35:38.999010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff70b7ef-2573-4098-af57-ba39434592b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b52d040>]}
[0m18:35:38.999250 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m18:35:38.999430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff70b7ef-2573-4098-af57-ba39434592b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b006450>]}
[0m18:35:39.000156 [info ] [MainThread]: 
[0m18:35:39.000367 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m18:35:39.000512 [info ] [MainThread]: 
[0m18:35:39.000756 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:35:39.002455 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m18:35:39.002645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:40.046557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m18:35:40.047669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:40.788521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff70b7ef-2573-4098-af57-ba39434592b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b60a630>]}
[0m18:35:40.789264 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:40.846082 [debug] [Thread-1 (]: Began running node model.my_project.load_policy
[0m18:35:40.846354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.load_policy)
[0m18:35:40.846576 [debug] [Thread-1 (]: Began compiling node model.my_project.load_policy
[0m18:35:40.851866 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.load_policy"
[0m18:35:40.852256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:40.886819 [debug] [Thread-1 (]: Finished running node model.my_project.load_policy
[0m18:35:40.887180 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m18:35:40.887508 [info ] [Thread-1 (]: 1 of 2 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m18:35:40.887783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.load_policy, now model.my_project.stg_policy_events)
[0m18:35:40.887950 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m18:35:40.891288 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m18:35:40.891593 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m18:35:40.911726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:41.655991 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m18:35:41.656598 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    partition by timestamp_trunc(event_ts, day)
    cluster by policy_id, event_type

    
    OPTIONS()
    as (
      

WITH  __dbt__cte__load_policy as (


SELECT *
FROM `horizontal-ray-467611-f9.single_view_policy_assignment.POLICY_EVENTS`
), deduped AS (
  SELECT
    DISTINCT policy_id,
    event_type,
    SAFE_CAST(event_timestamp AS TIMESTAMP) AS event_ts
  FROM __dbt__cte__load_policy  
  WHERE 
    policy_id IS NOT NULL
    AND event_type IN ('quote', 'bind', 'cancel')
    AND SAFE_CAST(event_timestamp AS TIMESTAMP) IS NOT NULL
)

SELECT
  policy_id,
  event_type,
  event_ts,
  FORMAT_DATE('%B', DATE_TRUNC(DATE(event_ts), MONTH)) AS event_month
FROM deduped
    );
  
[0m18:35:42.247520 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:2a20fb50-bc82-4b54-8528-fe6bf5f6e39f&page=queryresults
[0m18:35:45.159011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff70b7ef-2573-4098-af57-ba39434592b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ae46120>]}
[0m18:35:45.159963 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (0.0 rows, 15.2 KiB processed)[0m in 4.27s]
[0m18:35:45.160629 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m18:35:45.161319 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m18:35:45.161801 [info ] [Thread-1 (]: 2 of 2 START sql table model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m18:35:45.162165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m18:35:45.162452 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m18:35:45.165636 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m18:35:45.166355 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m18:35:45.174659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:45.899117 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m18:35:45.900563 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    partition by timestamp_trunc(first_bind_ts, day)
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
    MAX(event_ts) AS last_event_ts
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      event_ts,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
)

SELECT
  f.policy_id,
  f.first_quote_ts,
  f.first_bind_ts,
  f.first_cancel_ts,

  -- Status business logic
  CASE
    WHEN f.first_cancel_ts IS NOT NULL AND l.last_event_type = 'cancel' THEN 'cancelled'
    WHEN f.first_bind_ts IS NOT NULL THEN 'bound'
    ELSE 'quoted'
  END AS current_status,

  -- Quote to bind duration
  CASE
    WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
    ELSE NULL
  END AS quote_to_bind_mins,

  -- Bind to cancel duration
  CASE
    WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
    ELSE NULL
  END AS bind_to_cancel_mins,

  -- Month name of first event
  FORMAT_DATE('%B', DATE_TRUNC(DATE(COALESCE(f.first_quote_ts, f.first_bind_ts, f.first_cancel_ts)), MONTH)) AS event_month

FROM firsts f
LEFT JOIN last_evt l
  ON f.policy_id = l.policy_id
WHERE f.first_quote_ts IS NOT NULL 
   OR f.first_bind_ts IS NOT NULL 
   OR f.first_cancel_ts IS NOT NULL
    );
  
[0m18:35:46.244063 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:f2bcdd92-581a-4d26-be1c-caf96da2ef09&page=queryresults
[0m18:35:48.602639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff70b7ef-2573-4098-af57-ba39434592b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b98be30>]}
[0m18:35:48.604406 [info ] [Thread-1 (]: 2 of 2 OK created sql table model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 3.44s]
[0m18:35:48.605487 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m18:35:48.607281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:48.666276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:48.666826 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m18:35:48.667077 [info ] [MainThread]: 
[0m18:35:48.667286 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 9.67 seconds (9.67s).
[0m18:35:48.667795 [debug] [MainThread]: Command end result
[0m18:35:48.681563 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:35:48.682400 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:35:48.685312 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m18:35:48.685510 [info ] [MainThread]: 
[0m18:35:48.685715 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:48.685864 [info ] [MainThread]: 
[0m18:35:48.686029 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:35:48.686287 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.37916, "process_in_blocks": "0", "process_kernel_time": 1.282643, "process_mem_max_rss": "405127168", "process_out_blocks": "0", "process_user_time": 3.491452}
[0m18:35:48.686558 [debug] [MainThread]: Command `dbt run` succeeded at 18:35:48.686518 after 11.38 seconds
[0m18:35:48.686738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16afccce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b3bba70>]}
[0m18:35:48.686911 [debug] [MainThread]: Flushing usage events
[0m18:35:50.181077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:36:12.229969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10656f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10713c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10713c0e0>]}


============================== 18:36:12.231246 | 1932c018-ad27-40d8-9aef-cc7f3f0d0149 ==============================
[0m18:36:12.231246 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:36:12.231582 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'invocation_command': 'dbt test', 'version_check': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'static_parser': 'True', 'printer_width': '80', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'no_print': 'None', 'warn_error': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True'}
[0m18:36:13.629249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1932c018-ad27-40d8-9aef-cc7f3f0d0149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a3a1af0>]}
[0m18:36:13.654373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1932c018-ad27-40d8-9aef-cc7f3f0d0149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10713ed20>]}
[0m18:36:13.654724 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:36:13.769336 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:36:13.850177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:36:13.850418 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:36:13.869217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1932c018-ad27-40d8-9aef-cc7f3f0d0149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a31a930>]}
[0m18:36:13.913975 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:36:13.915138 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:36:13.930684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1932c018-ad27-40d8-9aef-cc7f3f0d0149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ac50fe0>]}
[0m18:36:13.930932 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m18:36:13.931118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1932c018-ad27-40d8-9aef-cc7f3f0d0149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ab0e240>]}
[0m18:36:13.931903 [info ] [MainThread]: 
[0m18:36:13.932102 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m18:36:13.932241 [info ] [MainThread]: 
[0m18:36:13.932491 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:36:13.934197 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9_single_view_policy_assignment'
[0m18:36:13.934394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:14.663074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1932c018-ad27-40d8-9aef-cc7f3f0d0149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ab0e240>]}
[0m18:36:14.664400 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:36:14.725105 [debug] [Thread-1 (]: Began running node test.my_project.EVENT_MONTH
[0m18:36:14.725437 [info ] [Thread-1 (]: 1 of 5 START test EVENT_MONTH .................................................. [RUN]
[0m18:36:14.725726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now test.my_project.EVENT_MONTH)
[0m18:36:14.725937 [debug] [Thread-1 (]: Began compiling node test.my_project.EVENT_MONTH
[0m18:36:14.730794 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.EVENT_MONTH"
[0m18:36:14.731298 [debug] [Thread-1 (]: Began executing node test.my_project.EVENT_MONTH
[0m18:36:14.744199 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.EVENT_MONTH"
[0m18:36:14.744631 [debug] [Thread-1 (]: On test.my_project.EVENT_MONTH: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.EVENT_MONTH"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT *
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
WHERE FORMAT_DATE('%B', DATE_TRUNC(DATE(event_ts), MONTH)) IS NULL
  
  
      
    ) dbt_internal_test
[0m18:36:14.744846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:16.021618 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:b7013875-225e-4f4a-ab98-ddfd4fc536e0&page=queryresults
[0m18:36:16.644707 [info ] [Thread-1 (]: 1 of 5 PASS EVENT_MONTH ........................................................ [[32mPASS[0m in 1.92s]
[0m18:36:16.645808 [debug] [Thread-1 (]: Finished running node test.my_project.EVENT_MONTH
[0m18:36:16.646427 [debug] [Thread-1 (]: Began running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:36:16.647095 [info ] [Thread-1 (]: 2 of 5 START test FIRST_EVENT_TIMESTAMP ........................................ [RUN]
[0m18:36:16.647648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.EVENT_MONTH, now test.my_project.FIRST_EVENT_TIMESTAMP)
[0m18:36:16.648067 [debug] [Thread-1 (]: Began compiling node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:36:16.651347 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m18:36:16.652301 [debug] [Thread-1 (]: Began executing node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:36:16.656095 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m18:36:16.656825 [debug] [Thread-1 (]: On test.my_project.FIRST_EVENT_TIMESTAMP: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.FIRST_EVENT_TIMESTAMP"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE first_quote_ts IS NULL 
AND first_bind_ts IS NULL 
AND first_cancel_ts IS NULL
  
  
      
    ) dbt_internal_test
[0m18:36:16.657212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:17.601472 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:086f7084-844b-4297-97db-e79636b58f3c&page=queryresults
[0m18:36:17.991619 [error] [Thread-1 (]: 2 of 5 FAIL 1 FIRST_EVENT_TIMESTAMP ............................................ [[31mFAIL 1[0m in 1.34s]
[0m18:36:17.993393 [debug] [Thread-1 (]: Finished running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:36:17.994180 [debug] [Thread-1 (]: Began running node test.my_project.NEGATIVE_DURATION
[0m18:36:17.995005 [info ] [Thread-1 (]: 3 of 5 START test NEGATIVE_DURATION ............................................ [RUN]
[0m18:36:17.995788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.FIRST_EVENT_TIMESTAMP, now test.my_project.NEGATIVE_DURATION)
[0m18:36:17.996422 [debug] [Thread-1 (]: Began compiling node test.my_project.NEGATIVE_DURATION
[0m18:36:18.001985 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.NEGATIVE_DURATION"
[0m18:36:18.003118 [debug] [Thread-1 (]: Began executing node test.my_project.NEGATIVE_DURATION
[0m18:36:18.006688 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.NEGATIVE_DURATION"
[0m18:36:18.007652 [debug] [Thread-1 (]: On test.my_project.NEGATIVE_DURATION: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.NEGATIVE_DURATION"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_mins < 0 
OR bind_to_cancel_mins < 0
  
  
      
    ) dbt_internal_test
[0m18:36:18.008222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:18.904445 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:bc33cdbf-0ef0-41e1-ab3e-20d16ad5a04c&page=queryresults
[0m18:36:19.276781 [error] [Thread-1 (]: 3 of 5 FAIL 1 NEGATIVE_DURATION ................................................ [[31mFAIL 1[0m in 1.28s]
[0m18:36:19.278305 [debug] [Thread-1 (]: Finished running node test.my_project.NEGATIVE_DURATION
[0m18:36:19.278962 [debug] [Thread-1 (]: Began running node test.my_project.NO_NULL
[0m18:36:19.279582 [info ] [Thread-1 (]: 4 of 5 START test NO_NULL ...................................................... [RUN]
[0m18:36:19.280245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.NEGATIVE_DURATION, now test.my_project.NO_NULL)
[0m18:36:19.281109 [debug] [Thread-1 (]: Began compiling node test.my_project.NO_NULL
[0m18:36:19.285407 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.NO_NULL"
[0m18:36:19.286426 [debug] [Thread-1 (]: Began executing node test.my_project.NO_NULL
[0m18:36:19.289691 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.NO_NULL"
[0m18:36:19.290581 [debug] [Thread-1 (]: On test.my_project.NO_NULL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.NO_NULL"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT *
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
WHERE policy_id IS NULL OR event_type IS NULL
  
  
      
    ) dbt_internal_test
[0m18:36:19.291068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:20.646497 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a8fa6207-efaf-4642-aebe-589e7495f43a&page=queryresults
[0m18:36:21.026252 [info ] [Thread-1 (]: 4 of 5 PASS NO_NULL ............................................................ [[32mPASS[0m in 1.75s]
[0m18:36:21.027805 [debug] [Thread-1 (]: Finished running node test.my_project.NO_NULL
[0m18:36:21.028501 [debug] [Thread-1 (]: Began running node test.my_project.STATUS_VALUE_RANGE
[0m18:36:21.029183 [info ] [Thread-1 (]: 5 of 5 START test STATUS_VALUE_RANGE ........................................... [RUN]
[0m18:36:21.029871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.NO_NULL, now test.my_project.STATUS_VALUE_RANGE)
[0m18:36:21.030388 [debug] [Thread-1 (]: Began compiling node test.my_project.STATUS_VALUE_RANGE
[0m18:36:21.035505 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.STATUS_VALUE_RANGE"
[0m18:36:21.036601 [debug] [Thread-1 (]: Began executing node test.my_project.STATUS_VALUE_RANGE
[0m18:36:21.039680 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.STATUS_VALUE_RANGE"
[0m18:36:21.040478 [debug] [Thread-1 (]: On test.my_project.STATUS_VALUE_RANGE: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.STATUS_VALUE_RANGE"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE current_status NOT IN ('quoted', 'bound', 'cancelled')
  
  
      
    ) dbt_internal_test
[0m18:36:21.040918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:22.179939 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a3b0508c-b268-4ba2-8c6e-a49e2bdb2939&page=queryresults
[0m18:36:22.536193 [error] [Thread-1 (]: 5 of 5 FAIL 1 STATUS_VALUE_RANGE ............................................... [[31mFAIL 1[0m in 1.51s]
[0m18:36:22.538358 [debug] [Thread-1 (]: Finished running node test.my_project.STATUS_VALUE_RANGE
[0m18:36:22.540623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:36:22.601436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:22.601782 [debug] [MainThread]: Connection 'test.my_project.STATUS_VALUE_RANGE' was properly closed.
[0m18:36:22.602032 [info ] [MainThread]: 
[0m18:36:22.602270 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 8.67 seconds (8.67s).
[0m18:36:22.603126 [debug] [MainThread]: Command end result
[0m18:36:22.616142 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:36:22.616956 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:36:22.620212 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m18:36:22.620393 [info ] [MainThread]: 
[0m18:36:22.620579 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m18:36:22.620752 [info ] [MainThread]: 
[0m18:36:22.621008 [error] [MainThread]: [31mFailure in test FIRST_EVENT_TIMESTAMP (tests/FIRST_EVENT_TIMESTAMP.sql)[0m
[0m18:36:22.621201 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:36:22.621341 [info ] [MainThread]: 
[0m18:36:22.621500 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/FIRST_EVENT_TIMESTAMP.sql
[0m18:36:22.621662 [info ] [MainThread]: 
[0m18:36:22.621832 [error] [MainThread]: [31mFailure in test NEGATIVE_DURATION (tests/NEGATIVE_DURATION.sql)[0m
[0m18:36:22.621997 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:36:22.622295 [info ] [MainThread]: 
[0m18:36:22.622452 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/NEGATIVE_DURATION.sql
[0m18:36:22.622582 [info ] [MainThread]: 
[0m18:36:22.622731 [error] [MainThread]: [31mFailure in test STATUS_VALUE_RANGE (tests/STATUS_VALUE_RANGE.sql)[0m
[0m18:36:22.622882 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:36:22.622999 [info ] [MainThread]: 
[0m18:36:22.623142 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/STATUS_VALUE_RANGE.sql
[0m18:36:22.623266 [info ] [MainThread]: 
[0m18:36:22.623422 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m18:36:22.623677 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 10.423765, "process_in_blocks": "0", "process_kernel_time": 1.839692, "process_mem_max_rss": "406880256", "process_out_blocks": "0", "process_user_time": 3.161858}
[0m18:36:22.623949 [debug] [MainThread]: Command `dbt test` failed at 18:36:22.623909 after 10.42 seconds
[0m18:36:22.624134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a3a1d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ad370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10713c350>]}
[0m18:36:22.624298 [debug] [MainThread]: Flushing usage events
[0m18:36:24.022783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:38:23.109196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a98110>]}


============================== 18:38:23.110653 | 29cdd601-2b87-4ab9-b22d-678e3f3f4004 ==============================
[0m18:38:23.110653 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:38:23.110994 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'partial_parse': 'True', 'introspect': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'log_format': 'default', 'target_path': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'invocation_command': 'dbt run --full-refresh', 'use_colors': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'empty': 'False'}
[0m18:38:24.745539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29cdd601-2b87-4ab9-b22d-678e3f3f4004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1262fae70>]}
[0m18:38:24.770838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29cdd601-2b87-4ab9-b22d-678e3f3f4004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126062d20>]}
[0m18:38:24.771167 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:38:24.912039 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:38:24.996613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:38:24.997038 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/policy_lifecycle_enriched.sql
[0m18:38:25.115077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29cdd601-2b87-4ab9-b22d-678e3f3f4004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12694bec0>]}
[0m18:38:25.156383 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:38:25.157614 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:38:25.169355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29cdd601-2b87-4ab9-b22d-678e3f3f4004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1267fa5a0>]}
[0m18:38:25.169732 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m18:38:25.169925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29cdd601-2b87-4ab9-b22d-678e3f3f4004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126924080>]}
[0m18:38:25.170885 [info ] [MainThread]: 
[0m18:38:25.171108 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m18:38:25.171257 [info ] [MainThread]: 
[0m18:38:25.171558 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:38:25.173739 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m18:38:25.173969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:26.292732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m18:38:26.294051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:27.056963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29cdd601-2b87-4ab9-b22d-678e3f3f4004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1262347d0>]}
[0m18:38:27.058269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:38:27.122287 [debug] [Thread-1 (]: Began running node model.my_project.load_policy
[0m18:38:27.122647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.load_policy)
[0m18:38:27.122883 [debug] [Thread-1 (]: Began compiling node model.my_project.load_policy
[0m18:38:27.126950 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.load_policy"
[0m18:38:27.127398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:27.162943 [debug] [Thread-1 (]: Finished running node model.my_project.load_policy
[0m18:38:27.163322 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m18:38:27.163620 [info ] [Thread-1 (]: 1 of 2 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m18:38:27.163943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.load_policy, now model.my_project.stg_policy_events)
[0m18:38:27.164107 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m18:38:27.167425 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m18:38:27.167734 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m18:38:27.188446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:27.977798 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m18:38:27.978808 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    partition by timestamp_trunc(event_ts, day)
    cluster by policy_id, event_type

    
    OPTIONS()
    as (
      

WITH  __dbt__cte__load_policy as (


SELECT *
FROM `horizontal-ray-467611-f9.single_view_policy_assignment.POLICY_EVENTS`
), deduped AS (
  SELECT
    DISTINCT policy_id,
    event_type,
    SAFE_CAST(event_timestamp AS TIMESTAMP) AS event_ts
  FROM __dbt__cte__load_policy  
  WHERE 
    policy_id IS NOT NULL
    AND event_type IN ('quote', 'bind', 'cancel')
    AND SAFE_CAST(event_timestamp AS TIMESTAMP) IS NOT NULL
)

SELECT
  policy_id,
  event_type,
  event_ts,
  FORMAT_DATE('%B', DATE_TRUNC(DATE(event_ts), MONTH)) AS event_month
FROM deduped
    );
  
[0m18:38:28.507244 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:92144c78-27d4-4271-9025-8507a5bd20ec&page=queryresults
[0m18:38:31.638695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29cdd601-2b87-4ab9-b22d-678e3f3f4004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048b5070>]}
[0m18:38:31.639610 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (0.0 rows, 15.2 KiB processed)[0m in 4.47s]
[0m18:38:31.640372 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m18:38:31.641230 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m18:38:31.641692 [info ] [Thread-1 (]: 2 of 2 START sql table model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m18:38:31.642073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m18:38:31.642379 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m18:38:31.645405 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m18:38:31.645947 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m18:38:31.653260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:32.373113 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m18:38:32.375786 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    partition by timestamp_trunc(first_bind_ts, day)
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
    MAX(event_ts) AS last_event_ts
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      event_ts,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
)

SELECT
  f.policy_id,
  f.first_quote_ts,
  f.first_bind_ts,
  f.first_cancel_ts,

  -- Status business logic
  CASE
    WHEN f.first_cancel_ts IS NOT NULL AND l.last_event_type = 'cancel' THEN 'cancelled'
    WHEN f.first_bind_ts IS NOT NULL THEN 'bound'
    ELSE 'quoted'
  END AS current_status,

  -- Quote to bind duration
  CASE
    WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
    ELSE NULL
  END AS quote_to_bind_mins,

  -- Bind to cancel duration
  CASE
    WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
      THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
    ELSE NULL
  END AS bind_to_cancel_mins,

  -- Month name of first event
  FORMAT_DATE('%B', DATE_TRUNC(DATE(COALESCE(f.first_quote_ts, f.first_bind_ts, f.first_cancel_ts)), MONTH)) AS event_month

FROM firsts f
LEFT JOIN last_evt l
  ON f.policy_id = l.policy_id

-- Filter out invalid rows for testing consistency
WHERE (f.first_quote_ts IS NOT NULL OR f.first_bind_ts IS NOT NULL OR f.first_cancel_ts IS NOT NULL)
  AND (
    (f.first_quote_ts IS NULL OR f.first_bind_ts IS NULL)
    OR TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE) >= 0
  )
  AND (
    (f.first_bind_ts IS NULL OR f.first_cancel_ts IS NULL)
    OR TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE) >= 0
  )
  AND (
    CASE
      WHEN f.first_cancel_ts IS NOT NULL AND l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN f.first_bind_ts IS NOT NULL THEN 'bound'
      ELSE 'quoted'
    END IN ('quoted', 'bound', 'cancelled')
  )
    );
  
[0m18:38:32.749149 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:51d2f4c6-68b4-4ddc-babe-c6f38f296357&page=queryresults
[0m18:38:35.074947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29cdd601-2b87-4ab9-b22d-678e3f3f4004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126c23d70>]}
[0m18:38:35.076618 [info ] [Thread-1 (]: 2 of 2 OK created sql table model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 3.43s]
[0m18:38:35.077753 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m18:38:35.079692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:38:35.139232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:35.139531 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m18:38:35.139730 [info ] [MainThread]: 
[0m18:38:35.139931 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 9.97 seconds (9.97s).
[0m18:38:35.140398 [debug] [MainThread]: Command end result
[0m18:38:35.153895 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:38:35.154811 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:38:35.158041 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m18:38:35.158244 [info ] [MainThread]: 
[0m18:38:35.158446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:38:35.158593 [info ] [MainThread]: 
[0m18:38:35.158754 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:38:35.159023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.079758, "process_in_blocks": "0", "process_kernel_time": 1.011575, "process_mem_max_rss": "408010752", "process_out_blocks": "0", "process_user_time": 3.842176}
[0m18:38:35.159315 [debug] [MainThread]: Command `dbt run` succeeded at 18:38:35.159269 after 12.08 seconds
[0m18:38:35.159502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1269596d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125d4ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126168500>]}
[0m18:38:35.159667 [debug] [MainThread]: Flushing usage events
[0m18:38:36.733138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:38:53.386336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115e1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e345c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e34320>]}


============================== 18:38:53.387747 | ed073287-9d5a-426d-8396-524ece66b08d ==============================
[0m18:38:53.387747 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:38:53.388144 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'quiet': 'False', 'introspect': 'True', 'invocation_command': 'dbt test', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'partial_parse': 'True', 'empty': 'None', 'version_check': 'True', 'log_format': 'default', 'printer_width': '80', 'static_parser': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'no_print': 'None'}
[0m18:38:54.992072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed073287-9d5a-426d-8396-524ece66b08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107453470>]}
[0m18:38:55.016992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed073287-9d5a-426d-8396-524ece66b08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16e304500>]}
[0m18:38:55.017305 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:38:55.130096 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:38:55.209151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:55.209372 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:55.228085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed073287-9d5a-426d-8396-524ece66b08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b544350>]}
[0m18:38:55.271815 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:38:55.273781 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:38:55.288776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed073287-9d5a-426d-8396-524ece66b08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f1506e0>]}
[0m18:38:55.289003 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m18:38:55.289188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed073287-9d5a-426d-8396-524ece66b08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f075310>]}
[0m18:38:55.289984 [info ] [MainThread]: 
[0m18:38:55.290173 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m18:38:55.290308 [info ] [MainThread]: 
[0m18:38:55.290549 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:38:55.292226 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9_single_view_policy_assignment'
[0m18:38:55.292426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:55.986730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed073287-9d5a-426d-8396-524ece66b08d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f00fe60>]}
[0m18:38:55.987176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:38:56.050112 [debug] [Thread-1 (]: Began running node test.my_project.EVENT_MONTH
[0m18:38:56.050429 [info ] [Thread-1 (]: 1 of 5 START test EVENT_MONTH .................................................. [RUN]
[0m18:38:56.050725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now test.my_project.EVENT_MONTH)
[0m18:38:56.050941 [debug] [Thread-1 (]: Began compiling node test.my_project.EVENT_MONTH
[0m18:38:56.055956 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.EVENT_MONTH"
[0m18:38:56.056495 [debug] [Thread-1 (]: Began executing node test.my_project.EVENT_MONTH
[0m18:38:56.069507 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.EVENT_MONTH"
[0m18:38:56.069968 [debug] [Thread-1 (]: On test.my_project.EVENT_MONTH: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.EVENT_MONTH"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT *
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
WHERE FORMAT_DATE('%B', DATE_TRUNC(DATE(event_ts), MONTH)) IS NULL
  
  
      
    ) dbt_internal_test
[0m18:38:56.070197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:57.317059 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:439c8d27-dca1-48f7-b3f9-8dc2f734d96b&page=queryresults
[0m18:38:57.729483 [info ] [Thread-1 (]: 1 of 5 PASS EVENT_MONTH ........................................................ [[32mPASS[0m in 1.68s]
[0m18:38:57.731074 [debug] [Thread-1 (]: Finished running node test.my_project.EVENT_MONTH
[0m18:38:57.731801 [debug] [Thread-1 (]: Began running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:38:57.732507 [info ] [Thread-1 (]: 2 of 5 START test FIRST_EVENT_TIMESTAMP ........................................ [RUN]
[0m18:38:57.733183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.EVENT_MONTH, now test.my_project.FIRST_EVENT_TIMESTAMP)
[0m18:38:57.733712 [debug] [Thread-1 (]: Began compiling node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:38:57.738717 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m18:38:57.739810 [debug] [Thread-1 (]: Began executing node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:38:57.743774 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m18:38:57.744762 [debug] [Thread-1 (]: On test.my_project.FIRST_EVENT_TIMESTAMP: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.FIRST_EVENT_TIMESTAMP"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE first_quote_ts IS NULL 
AND first_bind_ts IS NULL 
AND first_cancel_ts IS NULL
  
  
      
    ) dbt_internal_test
[0m18:38:57.745256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:58.662551 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:e031b801-1b23-4c74-a2e6-3a06848afdbb&page=queryresults
[0m18:38:59.033911 [error] [Thread-1 (]: 2 of 5 FAIL 1 FIRST_EVENT_TIMESTAMP ............................................ [[31mFAIL 1[0m in 1.30s]
[0m18:38:59.035477 [debug] [Thread-1 (]: Finished running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:38:59.036222 [debug] [Thread-1 (]: Began running node test.my_project.NEGATIVE_DURATION
[0m18:38:59.037008 [info ] [Thread-1 (]: 3 of 5 START test NEGATIVE_DURATION ............................................ [RUN]
[0m18:38:59.037910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.FIRST_EVENT_TIMESTAMP, now test.my_project.NEGATIVE_DURATION)
[0m18:38:59.038522 [debug] [Thread-1 (]: Began compiling node test.my_project.NEGATIVE_DURATION
[0m18:38:59.043526 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.NEGATIVE_DURATION"
[0m18:38:59.044887 [debug] [Thread-1 (]: Began executing node test.my_project.NEGATIVE_DURATION
[0m18:38:59.048697 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.NEGATIVE_DURATION"
[0m18:38:59.049763 [debug] [Thread-1 (]: On test.my_project.NEGATIVE_DURATION: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.NEGATIVE_DURATION"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_mins < 0 
OR bind_to_cancel_mins < 0
  
  
      
    ) dbt_internal_test
[0m18:38:59.050275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:00.038842 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:5c86cbf1-6da9-4637-83a2-5c6f5fdfda27&page=queryresults
[0m18:39:00.537128 [error] [Thread-1 (]: 3 of 5 FAIL 1 NEGATIVE_DURATION ................................................ [[31mFAIL 1[0m in 1.50s]
[0m18:39:00.539101 [debug] [Thread-1 (]: Finished running node test.my_project.NEGATIVE_DURATION
[0m18:39:00.539918 [debug] [Thread-1 (]: Began running node test.my_project.NO_NULL
[0m18:39:00.540654 [info ] [Thread-1 (]: 4 of 5 START test NO_NULL ...................................................... [RUN]
[0m18:39:00.541430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.NEGATIVE_DURATION, now test.my_project.NO_NULL)
[0m18:39:00.542072 [debug] [Thread-1 (]: Began compiling node test.my_project.NO_NULL
[0m18:39:00.547344 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.NO_NULL"
[0m18:39:00.548881 [debug] [Thread-1 (]: Began executing node test.my_project.NO_NULL
[0m18:39:00.552723 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.NO_NULL"
[0m18:39:00.553799 [debug] [Thread-1 (]: On test.my_project.NO_NULL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.NO_NULL"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT *
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
WHERE policy_id IS NULL OR event_type IS NULL
  
  
      
    ) dbt_internal_test
[0m18:39:00.554405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:01.922940 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:25c0d075-010f-4726-9d94-cbba55488102&page=queryresults
[0m18:39:02.267014 [info ] [Thread-1 (]: 4 of 5 PASS NO_NULL ............................................................ [[32mPASS[0m in 1.73s]
[0m18:39:02.269167 [debug] [Thread-1 (]: Finished running node test.my_project.NO_NULL
[0m18:39:02.269980 [debug] [Thread-1 (]: Began running node test.my_project.STATUS_VALUE_RANGE
[0m18:39:02.270669 [info ] [Thread-1 (]: 5 of 5 START test STATUS_VALUE_RANGE ........................................... [RUN]
[0m18:39:02.271383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.NO_NULL, now test.my_project.STATUS_VALUE_RANGE)
[0m18:39:02.271918 [debug] [Thread-1 (]: Began compiling node test.my_project.STATUS_VALUE_RANGE
[0m18:39:02.276808 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.STATUS_VALUE_RANGE"
[0m18:39:02.277891 [debug] [Thread-1 (]: Began executing node test.my_project.STATUS_VALUE_RANGE
[0m18:39:02.281025 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.STATUS_VALUE_RANGE"
[0m18:39:02.281808 [debug] [Thread-1 (]: On test.my_project.STATUS_VALUE_RANGE: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.STATUS_VALUE_RANGE"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT COUNT(*) FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE current_status NOT IN ('quoted', 'bound', 'cancelled')
  
  
      
    ) dbt_internal_test
[0m18:39:02.282273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:03.199637 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:d2ff5d0c-44b1-4b6e-baa6-71353ec964e0&page=queryresults
[0m18:39:03.786021 [error] [Thread-1 (]: 5 of 5 FAIL 1 STATUS_VALUE_RANGE ............................................... [[31mFAIL 1[0m in 1.51s]
[0m18:39:03.787764 [debug] [Thread-1 (]: Finished running node test.my_project.STATUS_VALUE_RANGE
[0m18:39:03.789964 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:39:03.850098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:03.850511 [debug] [MainThread]: Connection 'test.my_project.STATUS_VALUE_RANGE' was properly closed.
[0m18:39:03.850754 [info ] [MainThread]: 
[0m18:39:03.851006 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 8.56 seconds (8.56s).
[0m18:39:03.851788 [debug] [MainThread]: Command end result
[0m18:39:03.864735 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:39:03.865545 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:39:03.868950 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m18:39:03.869131 [info ] [MainThread]: 
[0m18:39:03.869318 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m18:39:03.869466 [info ] [MainThread]: 
[0m18:39:03.869654 [error] [MainThread]: [31mFailure in test FIRST_EVENT_TIMESTAMP (tests/FIRST_EVENT_TIMESTAMP.sql)[0m
[0m18:39:03.869827 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:39:03.869953 [info ] [MainThread]: 
[0m18:39:03.870101 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/FIRST_EVENT_TIMESTAMP.sql
[0m18:39:03.870237 [info ] [MainThread]: 
[0m18:39:03.870388 [error] [MainThread]: [31mFailure in test NEGATIVE_DURATION (tests/NEGATIVE_DURATION.sql)[0m
[0m18:39:03.870540 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:39:03.870656 [info ] [MainThread]: 
[0m18:39:03.870798 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/NEGATIVE_DURATION.sql
[0m18:39:03.871014 [info ] [MainThread]: 
[0m18:39:03.871242 [error] [MainThread]: [31mFailure in test STATUS_VALUE_RANGE (tests/STATUS_VALUE_RANGE.sql)[0m
[0m18:39:03.871420 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:39:03.871551 [info ] [MainThread]: 
[0m18:39:03.871704 [info ] [MainThread]:   compiled code at target/compiled/my_project/tests/STATUS_VALUE_RANGE.sql
[0m18:39:03.871838 [info ] [MainThread]: 
[0m18:39:03.871994 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=5
[0m18:39:03.872248 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 10.516401, "process_in_blocks": "0", "process_kernel_time": 1.377773, "process_mem_max_rss": "406487040", "process_out_blocks": "0", "process_user_time": 3.536951}
[0m18:39:03.872523 [debug] [MainThread]: Command `dbt test` failed at 18:39:03.872480 after 10.52 seconds
[0m18:39:03.872705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16e298050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111321820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dea7e0>]}
[0m18:39:03.872874 [debug] [MainThread]: Flushing usage events
[0m18:39:04.994935 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:40:56.951635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aee930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e83e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e8140>]}


============================== 18:40:56.952880 | 28cc6a8f-9a89-4260-bbc3-ca2da487e678 ==============================
[0m18:40:56.952880 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:40:56.953226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'warn_error': 'None', 'empty': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'static_parser': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'version_check': 'True', 'write_json': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --full-refresh', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'quiet': 'False', 'indirect_selection': 'eager'}
[0m18:40:58.351071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28cc6a8f-9a89-4260-bbc3-ca2da487e678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653c350>]}
[0m18:40:58.375986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28cc6a8f-9a89-4260-bbc3-ca2da487e678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b209550>]}
[0m18:40:58.376309 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:40:58.486070 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:40:58.565802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:40:58.566129 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/policy_lifecycle_enriched.sql
[0m18:40:58.680917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28cc6a8f-9a89-4260-bbc3-ca2da487e678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149c3f740>]}
[0m18:40:58.720294 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:40:58.722224 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:40:58.732870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28cc6a8f-9a89-4260-bbc3-ca2da487e678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149d50800>]}
[0m18:40:58.733105 [info ] [MainThread]: Found 2 analyses, 5 data tests, 3 models, 496 macros
[0m18:40:58.733292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28cc6a8f-9a89-4260-bbc3-ca2da487e678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149ac8c20>]}
[0m18:40:58.734019 [info ] [MainThread]: 
[0m18:40:58.734210 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m18:40:58.734349 [info ] [MainThread]: 
[0m18:40:58.734573 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:40:58.736194 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m18:40:58.736402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:59.890198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m18:40:59.891403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:00.653785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28cc6a8f-9a89-4260-bbc3-ca2da487e678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149d785c0>]}
[0m18:41:00.654117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:41:00.692774 [debug] [Thread-1 (]: Began running node model.my_project.load_policy
[0m18:41:00.692984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.load_policy)
[0m18:41:00.693155 [debug] [Thread-1 (]: Began compiling node model.my_project.load_policy
[0m18:41:00.696458 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.load_policy"
[0m18:41:00.696806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:00.729423 [debug] [Thread-1 (]: Finished running node model.my_project.load_policy
[0m18:41:00.729828 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m18:41:00.730118 [info ] [Thread-1 (]: 1 of 2 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m18:41:00.730333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.load_policy, now model.my_project.stg_policy_events)
[0m18:41:00.730485 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m18:41:00.733796 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m18:41:00.734116 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m18:41:00.754308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:01.518736 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m18:41:01.519800 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    partition by timestamp_trunc(event_ts, day)
    cluster by policy_id, event_type

    
    OPTIONS()
    as (
      

WITH  __dbt__cte__load_policy as (


SELECT *
FROM `horizontal-ray-467611-f9.single_view_policy_assignment.POLICY_EVENTS`
), deduped AS (
  SELECT
    DISTINCT policy_id,
    event_type,
    SAFE_CAST(event_timestamp AS TIMESTAMP) AS event_ts
  FROM __dbt__cte__load_policy  
  WHERE 
    policy_id IS NOT NULL
    AND event_type IN ('quote', 'bind', 'cancel')
    AND SAFE_CAST(event_timestamp AS TIMESTAMP) IS NOT NULL
)

SELECT
  policy_id,
  event_type,
  event_ts,
  FORMAT_DATE('%B', DATE_TRUNC(DATE(event_ts), MONTH)) AS event_month
FROM deduped
    );
  
[0m18:41:02.039494 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:2d96cb7b-7132-4f44-b512-d6ae4bf7ae74&page=queryresults
[0m18:41:05.355971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28cc6a8f-9a89-4260-bbc3-ca2da487e678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b1c39b0>]}
[0m18:41:05.356797 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (0.0 rows, 15.2 KiB processed)[0m in 4.62s]
[0m18:41:05.357360 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m18:41:05.357995 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m18:41:05.358460 [info ] [Thread-1 (]: 2 of 2 START sql table model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m18:41:05.358886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m18:41:05.359203 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m18:41:05.362487 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m18:41:05.363151 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m18:41:05.371339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:06.101348 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m18:41:06.103999 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    partition by timestamp_trunc(first_bind_ts, day)
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
    MAX(event_ts) AS last_event_ts
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      event_ts,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,

    -- Status logic
    CASE
      WHEN f.first_cancel_ts IS NOT NULL AND l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN f.first_bind_ts IS NOT NULL THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
      ELSE NULL
    END AS quote_to_bind_mins,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
      ELSE NULL
    END AS bind_to_cancel_mins,

    -- Month name
    FORMAT_DATE('%B', DATE_TRUNC(DATE(COALESCE(f.first_quote_ts, f.first_bind_ts, f.first_cancel_ts)), MONTH)) AS event_month

  FROM firsts f
  LEFT JOIN last_evt l ON f.policy_id = l.policy_id
),

filtered AS (
  SELECT *
  FROM final
  WHERE
    -- At least one timestamp
    (first_quote_ts IS NOT NULL OR first_bind_ts IS NOT NULL OR first_cancel_ts IS NOT NULL)

    -- Valid durations
    AND (quote_to_bind_mins IS NULL OR quote_to_bind_mins >= 0)
    AND (bind_to_cancel_mins IS NULL OR bind_to_cancel_mins >= 0)

    -- Valid statuses
    AND current_status IN ('quoted', 'bound', 'cancelled')
)

SELECT * FROM filtered
    );
  
[0m18:41:06.563998 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:43ad8177-6a31-4d1d-a2f6-214ff9bf562f&page=queryresults
[0m18:41:09.145681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28cc6a8f-9a89-4260-bbc3-ca2da487e678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149f60410>]}
[0m18:41:09.147381 [info ] [Thread-1 (]: 2 of 2 OK created sql table model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 3.79s]
[0m18:41:09.148476 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m18:41:09.150448 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:41:09.212129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:09.212440 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m18:41:09.212667 [info ] [MainThread]: 
[0m18:41:09.212879 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 10.48 seconds (10.48s).
[0m18:41:09.213362 [debug] [MainThread]: Command end result
[0m18:41:09.227099 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:41:09.227986 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:41:09.230879 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m18:41:09.231062 [info ] [MainThread]: 
[0m18:41:09.231266 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:09.231412 [info ] [MainThread]: 
[0m18:41:09.231579 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:41:09.231853 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.309635, "process_in_blocks": "0", "process_kernel_time": 1.50785, "process_mem_max_rss": "409026560", "process_out_blocks": "0", "process_user_time": 3.388758}
[0m18:41:09.232144 [debug] [MainThread]: Command `dbt run` succeeded at 18:41:09.232097 after 12.31 seconds
[0m18:41:09.232328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149332930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149de4110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149c33020>]}
[0m18:41:09.232500 [debug] [MainThread]: Flushing usage events
[0m18:41:10.740592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:45:48.757498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101f2dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463bb60>]}


============================== 18:45:48.759176 | ade7cd65-d27b-4327-946a-58329e1dcd00 ==============================
[0m18:45:48.759176 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:45:48.759584 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'write_json': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'invocation_command': 'dbt clean', 'warn_error': 'None', 'quiet': 'False', 'debug': 'False', 'no_print': 'None', 'target_path': 'None', 'version_check': 'True', 'empty': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m18:45:48.836965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ade7cd65-d27b-4327-946a-58329e1dcd00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d7fe0>]}
[0m18:45:48.848344 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.123150125, "process_in_blocks": "0", "process_kernel_time": 0.122155, "process_mem_max_rss": "106823680", "process_out_blocks": "0", "process_user_time": 0.682578}
[0m18:45:48.848649 [debug] [MainThread]: Command `dbt clean` succeeded at 18:45:48.848602 after 0.12 seconds
[0m18:45:48.848830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057bfe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057bfd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046397c0>]}
[0m18:45:48.848998 [debug] [MainThread]: Flushing usage events
[0m18:45:50.081398 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:46:01.233752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f655e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118450410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118450170>]}


============================== 18:46:01.235067 | aa666a39-56df-43fd-afa5-62c016727d18 ==============================
[0m18:46:01.235067 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:46:01.235428 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'fail_fast': 'False', 'write_json': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'debug': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select policy_lifecycle_enriched --full-refresh', 'indirect_selection': 'eager', 'target_path': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'printer_width': '80', 'log_format': 'default'}
[0m18:46:03.127823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa666a39-56df-43fd-afa5-62c016727d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1519ced50>]}
[0m18:46:03.152559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa666a39-56df-43fd-afa5-62c016727d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152865be0>]}
[0m18:46:03.152872 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:46:03.268086 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:46:03.268570 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:46:03.268785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa666a39-56df-43fd-afa5-62c016727d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152864fe0>]}
[0m18:46:03.782146 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m18:46:03.782782 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/example/schema.yml'
[0m18:46:03.816218 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.unique_my_first_dbt_model_id.16e066b321' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m18:46:03.816573 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.not_null_my_first_dbt_model_id.5fb22c2710' (models/example/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m18:46:03.816766 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.unique_my_second_dbt_model_id.57a0f8c493' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m18:46:03.816940 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_project.not_null_my_second_dbt_model_id.151b76d778' (models/example/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m18:46:03.861823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa666a39-56df-43fd-afa5-62c016727d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe6c00>]}
[0m18:46:03.998955 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:46:04.000389 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:46:04.012100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa666a39-56df-43fd-afa5-62c016727d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153070530>]}
[0m18:46:04.012362 [info ] [MainThread]: Found 3 models, 2 analyses, 5 data tests, 496 macros
[0m18:46:04.012541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa666a39-56df-43fd-afa5-62c016727d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1504f5010>]}
[0m18:46:04.013161 [info ] [MainThread]: 
[0m18:46:04.013347 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m18:46:04.013484 [info ] [MainThread]: 
[0m18:46:04.013713 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:46:04.014139 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m18:46:04.014335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:05.101232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m18:46:05.102044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:46:05.876455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa666a39-56df-43fd-afa5-62c016727d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152f92960>]}
[0m18:46:05.877256 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:46:05.933620 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m18:46:05.933973 [info ] [Thread-1 (]: 1 of 1 START sql table model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m18:46:05.934238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.policy_lifecycle_enriched)
[0m18:46:05.934439 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m18:46:05.938950 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m18:46:05.939531 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m18:46:05.950476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:06.699250 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m18:46:06.700596 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    partition by timestamp_trunc(first_bind_ts, day)
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
    MAX(event_ts) AS last_event_ts
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      event_ts,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,

    -- Status logic
    CASE
      WHEN f.first_cancel_ts IS NOT NULL AND l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN f.first_bind_ts IS NOT NULL THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
      ELSE NULL
    END AS quote_to_bind_mins,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
      ELSE NULL
    END AS bind_to_cancel_mins,

    -- Month name
    FORMAT_DATE('%B', DATE_TRUNC(DATE(COALESCE(f.first_quote_ts, f.first_bind_ts, f.first_cancel_ts)), MONTH)) AS event_month

  FROM firsts f
  LEFT JOIN last_evt l ON f.policy_id = l.policy_id
),

filtered AS (
  SELECT *
  FROM final
  WHERE
    -- At least one timestamp
    (first_quote_ts IS NOT NULL OR first_bind_ts IS NOT NULL OR first_cancel_ts IS NOT NULL)

    -- Valid durations
    AND (quote_to_bind_mins IS NULL OR quote_to_bind_mins >= 0)
    AND (bind_to_cancel_mins IS NULL OR bind_to_cancel_mins >= 0)

    -- Valid statuses
    AND current_status IN ('quoted', 'bound', 'cancelled')
)

SELECT * FROM filtered
    );
  
[0m18:46:07.393610 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:9a73ecd3-35a0-4818-bbbd-05fbe432d168&page=queryresults
[0m18:46:10.028872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa666a39-56df-43fd-afa5-62c016727d18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1530640e0>]}
[0m18:46:10.029958 [info ] [Thread-1 (]: 1 of 1 OK created sql table model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE TABLE (0.0 rows, 0 processed)[0m in 4.09s]
[0m18:46:10.030648 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m18:46:10.031784 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:46:10.079715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:10.079941 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m18:46:10.080115 [info ] [MainThread]: 
[0m18:46:10.080286 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m18:46:10.080633 [debug] [MainThread]: Command end result
[0m18:46:10.094062 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:46:10.094841 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:46:10.097411 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m18:46:10.097566 [info ] [MainThread]: 
[0m18:46:10.097751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:46:10.097890 [info ] [MainThread]: 
[0m18:46:10.098049 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:46:10.098297 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.89252, "process_in_blocks": "0", "process_kernel_time": 1.039911, "process_mem_max_rss": "408993792", "process_out_blocks": "0", "process_user_time": 4.088562}
[0m18:46:10.098554 [debug] [MainThread]: Command `dbt run` succeeded at 18:46:10.098516 after 8.89 seconds
[0m18:46:10.098717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152ffb9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1530abef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1530abc20>]}
[0m18:46:10.098880 [debug] [MainThread]: Flushing usage events
[0m18:46:11.488449 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:46:20.552675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067531d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109404770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8c230>]}


============================== 18:46:20.554139 | cd2582bf-114a-4c7f-be07-7566af23c78c ==============================
[0m18:46:20.554139 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:46:20.554494 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'printer_width': '80', 'write_json': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'introspect': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'fail_fast': 'False', 'log_format': 'default', 'invocation_command': 'dbt test'}
[0m18:46:22.218799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd2582bf-114a-4c7f-be07-7566af23c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c7ab440>]}
[0m18:46:22.242977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd2582bf-114a-4c7f-be07-7566af23c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d164ef0>]}
[0m18:46:22.243281 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:46:22.355244 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:46:22.433953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:46:22.434164 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:46:22.455642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd2582bf-114a-4c7f-be07-7566af23c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d18e390>]}
[0m18:46:22.495998 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:46:22.497064 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:46:22.512428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd2582bf-114a-4c7f-be07-7566af23c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d750fb0>]}
[0m18:46:22.512675 [info ] [MainThread]: Found 3 models, 2 analyses, 5 data tests, 496 macros
[0m18:46:22.512854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd2582bf-114a-4c7f-be07-7566af23c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d166450>]}
[0m18:46:22.513633 [info ] [MainThread]: 
[0m18:46:22.513832 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m18:46:22.513973 [info ] [MainThread]: 
[0m18:46:22.514210 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:46:22.515875 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9_single_view_policy_assignment'
[0m18:46:22.516066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:23.257753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd2582bf-114a-4c7f-be07-7566af23c78c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d54b7d0>]}
[0m18:46:23.259022 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:46:23.320083 [debug] [Thread-1 (]: Began running node test.my_project.EVENT_MONTH
[0m18:46:23.320451 [info ] [Thread-1 (]: 1 of 5 START test EVENT_MONTH .................................................. [RUN]
[0m18:46:23.320747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now test.my_project.EVENT_MONTH)
[0m18:46:23.320964 [debug] [Thread-1 (]: Began compiling node test.my_project.EVENT_MONTH
[0m18:46:23.326119 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.EVENT_MONTH"
[0m18:46:23.326579 [debug] [Thread-1 (]: Began executing node test.my_project.EVENT_MONTH
[0m18:46:23.339174 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.EVENT_MONTH"
[0m18:46:23.339663 [debug] [Thread-1 (]: On test.my_project.EVENT_MONTH: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.EVENT_MONTH"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT *
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
WHERE FORMAT_DATE('%B', DATE_TRUNC(DATE(event_ts), MONTH)) IS NULL
  
  
      
    ) dbt_internal_test
[0m18:46:23.339882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:24.673597 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:3309ba88-3083-4b62-95b8-62182fd5cfc5&page=queryresults
[0m18:46:25.528228 [info ] [Thread-1 (]: 1 of 5 PASS EVENT_MONTH ........................................................ [[32mPASS[0m in 2.21s]
[0m18:46:25.529771 [debug] [Thread-1 (]: Finished running node test.my_project.EVENT_MONTH
[0m18:46:25.530447 [debug] [Thread-1 (]: Began running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:46:25.531149 [info ] [Thread-1 (]: 2 of 5 START test FIRST_EVENT_TIMESTAMP ........................................ [RUN]
[0m18:46:25.532037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.EVENT_MONTH, now test.my_project.FIRST_EVENT_TIMESTAMP)
[0m18:46:25.532673 [debug] [Thread-1 (]: Began compiling node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:46:25.536979 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m18:46:25.538136 [debug] [Thread-1 (]: Began executing node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:46:25.541247 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m18:46:25.542193 [debug] [Thread-1 (]: On test.my_project.FIRST_EVENT_TIMESTAMP: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.FIRST_EVENT_TIMESTAMP"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/FIRST_EVENT_TIMESTAMP.sql
SELECT *
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE first_quote_ts IS NULL 
  AND first_bind_ts IS NULL 
  AND first_cancel_ts IS NULL
  
  
      
    ) dbt_internal_test
[0m18:46:25.542694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:26.951868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:45439731-5466-463c-b466-7a6c2a52c135&page=queryresults
[0m18:46:27.587474 [info ] [Thread-1 (]: 2 of 5 PASS FIRST_EVENT_TIMESTAMP .............................................. [[32mPASS[0m in 2.05s]
[0m18:46:27.589347 [debug] [Thread-1 (]: Finished running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:46:27.590122 [debug] [Thread-1 (]: Began running node test.my_project.NEGATIVE_DURATION
[0m18:46:27.590848 [info ] [Thread-1 (]: 3 of 5 START test NEGATIVE_DURATION ............................................ [RUN]
[0m18:46:27.591521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.FIRST_EVENT_TIMESTAMP, now test.my_project.NEGATIVE_DURATION)
[0m18:46:27.592082 [debug] [Thread-1 (]: Began compiling node test.my_project.NEGATIVE_DURATION
[0m18:46:27.597322 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.NEGATIVE_DURATION"
[0m18:46:27.598472 [debug] [Thread-1 (]: Began executing node test.my_project.NEGATIVE_DURATION
[0m18:46:27.602144 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.NEGATIVE_DURATION"
[0m18:46:27.603012 [debug] [Thread-1 (]: On test.my_project.NEGATIVE_DURATION: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.NEGATIVE_DURATION"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT * FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_mins < 0 
OR bind_to_cancel_mins < 0
  
  
      
    ) dbt_internal_test
[0m18:46:27.603496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:28.999531 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a2659ebb-ed36-402e-ac50-a28da4a96f5e&page=queryresults
[0m18:46:29.381916 [info ] [Thread-1 (]: 3 of 5 PASS NEGATIVE_DURATION .................................................. [[32mPASS[0m in 1.79s]
[0m18:46:29.383453 [debug] [Thread-1 (]: Finished running node test.my_project.NEGATIVE_DURATION
[0m18:46:29.384364 [debug] [Thread-1 (]: Began running node test.my_project.NO_NULL
[0m18:46:29.385059 [info ] [Thread-1 (]: 4 of 5 START test NO_NULL ...................................................... [RUN]
[0m18:46:29.385657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.NEGATIVE_DURATION, now test.my_project.NO_NULL)
[0m18:46:29.386121 [debug] [Thread-1 (]: Began compiling node test.my_project.NO_NULL
[0m18:46:29.390205 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.NO_NULL"
[0m18:46:29.391079 [debug] [Thread-1 (]: Began executing node test.my_project.NO_NULL
[0m18:46:29.394098 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.NO_NULL"
[0m18:46:29.394930 [debug] [Thread-1 (]: On test.my_project.NO_NULL: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.NO_NULL"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT *
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
WHERE policy_id IS NULL OR event_type IS NULL
  
  
      
    ) dbt_internal_test
[0m18:46:29.395391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:30.662022 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:52e0ca67-e0ef-467e-a57c-e230529ba73a&page=queryresults
[0m18:46:31.175745 [info ] [Thread-1 (]: 4 of 5 PASS NO_NULL ............................................................ [[32mPASS[0m in 1.79s]
[0m18:46:31.177355 [debug] [Thread-1 (]: Finished running node test.my_project.NO_NULL
[0m18:46:31.178016 [debug] [Thread-1 (]: Began running node test.my_project.STATUS_VALUE_RANGE
[0m18:46:31.178663 [info ] [Thread-1 (]: 5 of 5 START test STATUS_VALUE_RANGE ........................................... [RUN]
[0m18:46:31.179493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.NO_NULL, now test.my_project.STATUS_VALUE_RANGE)
[0m18:46:31.180434 [debug] [Thread-1 (]: Began compiling node test.my_project.STATUS_VALUE_RANGE
[0m18:46:31.185240 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.STATUS_VALUE_RANGE"
[0m18:46:31.186452 [debug] [Thread-1 (]: Began executing node test.my_project.STATUS_VALUE_RANGE
[0m18:46:31.189279 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.STATUS_VALUE_RANGE"
[0m18:46:31.190153 [debug] [Thread-1 (]: On test.my_project.STATUS_VALUE_RANGE: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.STATUS_VALUE_RANGE"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT * FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE current_status NOT IN ('quoted', 'bound', 'cancelled')
  
  
      
    ) dbt_internal_test
[0m18:46:31.190622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:46:32.482566 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:36bb5ea4-881b-4874-ad0d-643a1583f858&page=queryresults
[0m18:46:32.937013 [info ] [Thread-1 (]: 5 of 5 PASS STATUS_VALUE_RANGE ................................................. [[32mPASS[0m in 1.76s]
[0m18:46:32.938982 [debug] [Thread-1 (]: Finished running node test.my_project.STATUS_VALUE_RANGE
[0m18:46:32.941095 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:46:33.001712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:33.002045 [debug] [MainThread]: Connection 'test.my_project.STATUS_VALUE_RANGE' was properly closed.
[0m18:46:33.002278 [info ] [MainThread]: 
[0m18:46:33.002529 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 10.49 seconds (10.49s).
[0m18:46:33.003401 [debug] [MainThread]: Command end result
[0m18:46:33.017080 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:46:33.017885 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:46:33.021425 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m18:46:33.021592 [info ] [MainThread]: 
[0m18:46:33.021835 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:46:33.022098 [info ] [MainThread]: 
[0m18:46:33.022302 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m18:46:33.022572 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.500187, "process_in_blocks": "0", "process_kernel_time": 1.222028, "process_mem_max_rss": "403046400", "process_out_blocks": "0", "process_user_time": 3.6775}
[0m18:46:33.022851 [debug] [MainThread]: Command `dbt test` succeeded at 18:46:33.022808 after 12.50 seconds
[0m18:46:33.023027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c708c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d559c40>]}
[0m18:46:33.023202 [debug] [MainThread]: Flushing usage events
[0m18:46:34.246181 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:53:53.764750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107220470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072200e0>]}


============================== 18:53:53.766356 | 2417928f-1971-44c5-99a0-2665c42297ac ==============================
[0m18:53:53.766356 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:53:53.766773 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'version_check': 'True', 'empty': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'use_colors': 'True', 'partial_parse': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select policy_lifecycle_enriched', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'no_print': 'None', 'write_json': 'True', 'debug': 'False'}
[0m18:53:55.712392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2417928f-1971-44c5-99a0-2665c42297ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162a99d30>]}
[0m18:53:55.736627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2417928f-1971-44c5-99a0-2665c42297ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d3c20>]}
[0m18:53:55.736917 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:53:55.850975 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:53:55.932228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:53:55.932594 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/schema.yml
[0m18:53:56.053490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2417928f-1971-44c5-99a0-2665c42297ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16378a330>]}
[0m18:53:56.095001 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:53:56.096267 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:53:56.111663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2417928f-1971-44c5-99a0-2665c42297ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164148b90>]}
[0m18:53:56.111912 [info ] [MainThread]: Found 3 models, 2 analyses, 13 data tests, 496 macros
[0m18:53:56.112090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2417928f-1971-44c5-99a0-2665c42297ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1636b8770>]}
[0m18:53:56.112921 [info ] [MainThread]: 
[0m18:53:56.113125 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m18:53:56.113262 [info ] [MainThread]: 
[0m18:53:56.113499 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:53:56.115162 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9_single_view_policy_assignment'
[0m18:53:56.115350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:57.041210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2417928f-1971-44c5-99a0-2665c42297ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163648950>]}
[0m18:53:57.042525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:53:57.102423 [debug] [Thread-1 (]: Began running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:53:57.102792 [info ] [Thread-1 (]: 1 of 11 START test FIRST_EVENT_TIMESTAMP ....................................... [RUN]
[0m18:53:57.103091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now test.my_project.FIRST_EVENT_TIMESTAMP)
[0m18:53:57.103419 [debug] [Thread-1 (]: Began compiling node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:53:57.107500 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m18:53:57.107884 [debug] [Thread-1 (]: Began executing node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:53:57.119870 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.FIRST_EVENT_TIMESTAMP"
[0m18:53:57.120329 [debug] [Thread-1 (]: On test.my_project.FIRST_EVENT_TIMESTAMP: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.FIRST_EVENT_TIMESTAMP"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- tests/FIRST_EVENT_TIMESTAMP.sql
SELECT *
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE first_quote_ts IS NULL 
  AND first_bind_ts IS NULL 
  AND first_cancel_ts IS NULL
  
  
      
    ) dbt_internal_test
[0m18:53:57.120564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:53:58.326474 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:d2983a7d-cd41-4fc7-a692-605f6bdf6e22&page=queryresults
[0m18:53:59.219904 [info ] [Thread-1 (]: 1 of 11 PASS FIRST_EVENT_TIMESTAMP ............................................. [[32mPASS[0m in 2.12s]
[0m18:53:59.220715 [debug] [Thread-1 (]: Finished running node test.my_project.FIRST_EVENT_TIMESTAMP
[0m18:53:59.221126 [debug] [Thread-1 (]: Began running node test.my_project.NEGATIVE_DURATION
[0m18:53:59.221531 [info ] [Thread-1 (]: 2 of 11 START test NEGATIVE_DURATION ........................................... [RUN]
[0m18:53:59.221951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.FIRST_EVENT_TIMESTAMP, now test.my_project.NEGATIVE_DURATION)
[0m18:53:59.222285 [debug] [Thread-1 (]: Began compiling node test.my_project.NEGATIVE_DURATION
[0m18:53:59.225011 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.NEGATIVE_DURATION"
[0m18:53:59.225663 [debug] [Thread-1 (]: Began executing node test.my_project.NEGATIVE_DURATION
[0m18:53:59.227534 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.NEGATIVE_DURATION"
[0m18:53:59.228097 [debug] [Thread-1 (]: On test.my_project.NEGATIVE_DURATION: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.NEGATIVE_DURATION"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT * FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_mins < 0 
OR bind_to_cancel_mins < 0
  
  
      
    ) dbt_internal_test
[0m18:53:59.228414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:00.275839 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:b4c3b54f-134b-491f-8568-5d1521a00b5c&page=queryresults
[0m18:54:00.914943 [info ] [Thread-1 (]: 2 of 11 PASS NEGATIVE_DURATION ................................................. [[32mPASS[0m in 1.69s]
[0m18:54:00.917251 [debug] [Thread-1 (]: Finished running node test.my_project.NEGATIVE_DURATION
[0m18:54:00.917888 [debug] [Thread-1 (]: Began running node test.my_project.STATUS_VALUE_RANGE
[0m18:54:00.918597 [info ] [Thread-1 (]: 3 of 11 START test STATUS_VALUE_RANGE .......................................... [RUN]
[0m18:54:00.919328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.NEGATIVE_DURATION, now test.my_project.STATUS_VALUE_RANGE)
[0m18:54:00.919858 [debug] [Thread-1 (]: Began compiling node test.my_project.STATUS_VALUE_RANGE
[0m18:54:00.926576 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.STATUS_VALUE_RANGE"
[0m18:54:00.927918 [debug] [Thread-1 (]: Began executing node test.my_project.STATUS_VALUE_RANGE
[0m18:54:00.930105 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.STATUS_VALUE_RANGE"
[0m18:54:00.930823 [debug] [Thread-1 (]: On test.my_project.STATUS_VALUE_RANGE: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.STATUS_VALUE_RANGE"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  SELECT * FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE current_status NOT IN ('quoted', 'bound', 'cancelled')
  
  
      
    ) dbt_internal_test
[0m18:54:00.931227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:02.014990 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:b86a3e36-4184-47cb-ac9e-385913a272b4&page=queryresults
[0m18:54:02.429031 [info ] [Thread-1 (]: 3 of 11 PASS STATUS_VALUE_RANGE ................................................ [[32mPASS[0m in 1.51s]
[0m18:54:02.430733 [debug] [Thread-1 (]: Finished running node test.my_project.STATUS_VALUE_RANGE
[0m18:54:02.431463 [debug] [Thread-1 (]: Began running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m18:54:02.432160 [info ] [Thread-1 (]: 4 of 11 START test accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled  [RUN]
[0m18:54:02.432837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.STATUS_VALUE_RANGE, now test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715)
[0m18:54:02.433350 [debug] [Thread-1 (]: Began compiling node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m18:54:02.442153 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"
[0m18:54:02.443457 [debug] [Thread-1 (]: Began executing node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m18:54:02.446030 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"
[0m18:54:02.446839 [debug] [Thread-1 (]: On test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        current_status as value_field,
        count(*) as n_records

    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    group by current_status

)

select *
from all_values
where value_field not in (
    'quoted','bound','cancelled'
)



  
  
      
    ) dbt_internal_test
[0m18:54:02.447295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:03.884475 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:d2d50e1b-99aa-4eb2-a62f-857ae0894066&page=queryresults
[0m18:54:04.569149 [info ] [Thread-1 (]: 4 of 11 PASS accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled  [[32mPASS[0m in 2.14s]
[0m18:54:04.570820 [debug] [Thread-1 (]: Finished running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m18:54:04.571617 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m18:54:04.572307 [info ] [Thread-1 (]: 5 of 11 START test not_null_policy_lifecycle_enriched_current_status ........... [RUN]
[0m18:54:04.572995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715, now test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a)
[0m18:54:04.573568 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m18:54:04.584969 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"
[0m18:54:04.585985 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m18:54:04.588607 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"
[0m18:54:04.589758 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select current_status
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where current_status is null



  
  
      
    ) dbt_internal_test
[0m18:54:04.590222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:05.906696 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:5415133d-13e1-4b32-af59-a8686fc4e659&page=queryresults
[0m18:54:06.288346 [info ] [Thread-1 (]: 5 of 11 PASS not_null_policy_lifecycle_enriched_current_status ................. [[32mPASS[0m in 1.71s]
[0m18:54:06.289576 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m18:54:06.290198 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m18:54:06.290862 [info ] [Thread-1 (]: 6 of 11 START test not_null_policy_lifecycle_enriched_event_month .............. [RUN]
[0m18:54:06.291589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a, now test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87)
[0m18:54:06.292122 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m18:54:06.297677 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"
[0m18:54:06.298665 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m18:54:06.301750 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"
[0m18:54:06.302479 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_month
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where event_month is null



  
  
      
    ) dbt_internal_test
[0m18:54:06.302900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:07.596824 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:f81948f3-62b8-4fa3-aca8-e6bb1e04481c&page=queryresults
[0m18:54:07.976512 [info ] [Thread-1 (]: 6 of 11 PASS not_null_policy_lifecycle_enriched_event_month .................... [[32mPASS[0m in 1.68s]
[0m18:54:07.978417 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m18:54:07.979193 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m18:54:07.979968 [info ] [Thread-1 (]: 7 of 11 START test not_null_policy_lifecycle_enriched_first_bind_ts ............ [RUN]
[0m18:54:07.980747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87, now test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8)
[0m18:54:07.981376 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m18:54:07.989107 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8"
[0m18:54:07.990337 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m18:54:07.994428 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8"
[0m18:54:07.995558 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_bind_ts
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where first_bind_ts is null



  
  
      
    ) dbt_internal_test
[0m18:54:07.996159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:09.387354 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:960b0850-0a97-47fd-8af7-a2e8bc7b4835&page=queryresults
[0m18:54:09.762027 [info ] [Thread-1 (]: 7 of 11 PASS not_null_policy_lifecycle_enriched_first_bind_ts .................. [[32mPASS[0m in 1.78s]
[0m18:54:09.763663 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m18:54:09.764439 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m18:54:09.765199 [info ] [Thread-1 (]: 8 of 11 START test not_null_policy_lifecycle_enriched_first_quote_ts ........... [RUN]
[0m18:54:09.765972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8, now test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0)
[0m18:54:09.766627 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m18:54:09.774789 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"
[0m18:54:09.776487 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m18:54:09.779698 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"
[0m18:54:09.780555 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_quote_ts
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where first_quote_ts is null



  
  
      
    ) dbt_internal_test
[0m18:54:09.781048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:11.026955 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:b4340e1a-0006-49f3-99d3-5a610ae4b89e&page=queryresults
[0m18:54:11.378789 [info ] [Thread-1 (]: 8 of 11 PASS not_null_policy_lifecycle_enriched_first_quote_ts ................. [[32mPASS[0m in 1.61s]
[0m18:54:11.380453 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m18:54:11.381215 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m18:54:11.381931 [info ] [Thread-1 (]: 9 of 11 START test not_null_policy_lifecycle_enriched_policy_id ................ [RUN]
[0m18:54:11.382663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0, now test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b)
[0m18:54:11.383283 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m18:54:11.392995 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"
[0m18:54:11.394165 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m18:54:11.397501 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"
[0m18:54:11.398408 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select policy_id
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where policy_id is null



  
  
      
    ) dbt_internal_test
[0m18:54:11.398951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:12.665675 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:5a656358-91a8-4bde-a21a-e32b16840672&page=queryresults
[0m18:54:13.018457 [info ] [Thread-1 (]: 9 of 11 PASS not_null_policy_lifecycle_enriched_policy_id ...................... [[32mPASS[0m in 1.64s]
[0m18:54:13.019631 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m18:54:13.020195 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21
[0m18:54:13.020707 [info ] [Thread-1 (]: 10 of 11 START test not_null_policy_lifecycle_enriched_quote_to_bind_mins ...... [RUN]
[0m18:54:13.021243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b, now test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21)
[0m18:54:13.021671 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21
[0m18:54:13.027965 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21"
[0m18:54:13.029272 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21
[0m18:54:13.032772 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21"
[0m18:54:13.033642 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select quote_to_bind_mins
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where quote_to_bind_mins is null



  
  
      
    ) dbt_internal_test
[0m18:54:13.034161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:14.398878 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:81df9f55-ad2d-43a9-a2a2-99c2201aacdf&page=queryresults
[0m18:54:14.887152 [info ] [Thread-1 (]: 10 of 11 PASS not_null_policy_lifecycle_enriched_quote_to_bind_mins ............ [[32mPASS[0m in 1.87s]
[0m18:54:14.888954 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21
[0m18:54:14.889757 [debug] [Thread-1 (]: Began running node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m18:54:14.890507 [info ] [Thread-1 (]: 11 of 11 START test unique_policy_lifecycle_enriched_policy_id ................. [RUN]
[0m18:54:14.891294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21, now test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745)
[0m18:54:14.891914 [debug] [Thread-1 (]: Began compiling node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m18:54:14.902956 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745"
[0m18:54:14.904114 [debug] [Thread-1 (]: Began executing node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m18:54:14.906878 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745"
[0m18:54:14.907712 [debug] [Thread-1 (]: On test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select policy_id as unique_field
  from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
  where policy_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:54:14.908209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:16.253359 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:7d4b6212-5759-4a19-a1ca-33cd321c872b&page=queryresults
[0m18:54:16.695777 [info ] [Thread-1 (]: 11 of 11 PASS unique_policy_lifecycle_enriched_policy_id ....................... [[32mPASS[0m in 1.80s]
[0m18:54:16.697852 [debug] [Thread-1 (]: Finished running node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m18:54:16.700129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:54:16.762797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:16.763099 [debug] [MainThread]: Connection 'test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745' was properly closed.
[0m18:54:16.763316 [info ] [MainThread]: 
[0m18:54:16.763521 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 20.65 seconds (20.65s).
[0m18:54:16.764582 [debug] [MainThread]: Command end result
[0m18:54:16.778945 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m18:54:16.779777 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m18:54:16.783154 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m18:54:16.783327 [info ] [MainThread]: 
[0m18:54:16.783510 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:54:16.783657 [info ] [MainThread]: 
[0m18:54:16.783822 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m18:54:16.784082 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 23.046474, "process_in_blocks": "0", "process_kernel_time": 0.927589, "process_mem_max_rss": "407863296", "process_out_blocks": "0", "process_user_time": 4.852087}
[0m18:54:16.784346 [debug] [MainThread]: Command `dbt test` succeeded at 18:54:16.784306 after 23.05 seconds
[0m18:54:16.784526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162ad0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164112060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106041790>]}
[0m18:54:16.784688 [debug] [MainThread]: Flushing usage events
[0m18:54:18.299007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:00:25.165080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b13c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b13fb0>]}


============================== 19:00:25.167186 | d25c3786-5b51-486b-a691-0802d806cee8 ==============================
[0m19:00:25.167186 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:00:25.167569 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'empty': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'introspect': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'no_print': 'None', 'write_json': 'True', 'version_check': 'True', 'debug': 'False', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'static_parser': 'True', 'use_colors': 'True', 'fail_fast': 'False'}
[0m19:00:27.280531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd25c3786-5b51-486b-a691-0802d806cee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15af6a0c0>]}
[0m19:00:27.305864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd25c3786-5b51-486b-a691-0802d806cee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1579aad20>]}
[0m19:00:27.306208 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:00:27.420605 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:00:27.506539 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 3 files added, 1 files changed.
[0m19:00:27.506856 [debug] [MainThread]: Partial parsing: added file: my_project://analyses/cancelled_within_30_days_analysis.sql
[0m19:00:27.507022 [debug] [MainThread]: Partial parsing: added file: my_project://analyses/avg_quote_to_bind_by_month_analysis.sql
[0m19:00:27.507159 [debug] [MainThread]: Partial parsing: added file: my_project://analyses/quoted_never_bound_analysis.sql
[0m19:00:27.507358 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/schema.yml
[0m19:00:27.507481 [debug] [MainThread]: Partial parsing: deleted file: my_project://analyses/Avg_time_from_quote_to_bind_per_month.sql
[0m19:00:27.507598 [debug] [MainThread]: Partial parsing: deleted file: my_project://analyses/Total_policies_cancelled_30_days.sql
[0m19:00:27.507708 [debug] [MainThread]: Partial parsing: deleted file: my_project://tests/STATUS_VALUE_RANGE.sql
[0m19:00:27.507814 [debug] [MainThread]: Partial parsing: deleted file: my_project://tests/FIRST_EVENT_TIMESTAMP.sql
[0m19:00:27.507925 [debug] [MainThread]: Partial parsing: deleted file: my_project://tests/NEGATIVE_DURATION.sql
[0m19:00:27.581296 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'cancelled_within_30_days' in the 'analyses' section of file 'models/example/schema.yml'
[0m19:00:27.581897 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'avg_quote_to_bind_by_month' in the 'analyses' section of file 'models/example/schema.yml'
[0m19:00:27.645945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd25c3786-5b51-486b-a691-0802d806cee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c3afb60>]}
[0m19:00:27.687586 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:00:27.688915 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:00:27.699637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd25c3786-5b51-486b-a691-0802d806cee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c446120>]}
[0m19:00:27.699891 [info ] [MainThread]: Found 3 models, 10 data tests, 3 analyses, 496 macros
[0m19:00:27.700072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd25c3786-5b51-486b-a691-0802d806cee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159935160>]}
[0m19:00:27.701031 [info ] [MainThread]: 
[0m19:00:27.701237 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m19:00:27.701380 [info ] [MainThread]: 
[0m19:00:27.701623 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:00:27.703289 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9_single_view_policy_assignment'
[0m19:00:27.703491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:28.580011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd25c3786-5b51-486b-a691-0802d806cee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b2a0c50>]}
[0m19:00:28.581278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:00:28.645528 [debug] [Thread-1 (]: Began running node model.my_project.load_policy
[0m19:00:28.645907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.load_policy)
[0m19:00:28.646137 [debug] [Thread-1 (]: Began compiling node model.my_project.load_policy
[0m19:00:28.650711 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.load_policy"
[0m19:00:28.651151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:28.686703 [debug] [Thread-1 (]: Finished running node model.my_project.load_policy
[0m19:00:28.687053 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m19:00:28.687297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.load_policy, now model.my_project.stg_policy_events)
[0m19:00:28.687536 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m19:00:28.690867 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m19:00:28.691200 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m19:00:28.691375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:28.724425 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m19:00:28.724771 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m19:00:28.724972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m19:00:28.725155 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m19:00:28.726877 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m19:00:28.727212 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m19:00:28.727384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:28.760513 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m19:00:28.760708 [debug] [Thread-1 (]: Began running node test.my_project.EVENT_MONTH
[0m19:00:28.760874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_lifecycle_enriched, now test.my_project.EVENT_MONTH)
[0m19:00:28.761262 [debug] [Thread-1 (]: Began compiling node test.my_project.EVENT_MONTH
[0m19:00:28.762385 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.EVENT_MONTH"
[0m19:00:28.762872 [debug] [Thread-1 (]: Began executing node test.my_project.EVENT_MONTH
[0m19:00:28.763039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:28.796063 [debug] [Thread-1 (]: Finished running node test.my_project.EVENT_MONTH
[0m19:00:28.796301 [debug] [Thread-1 (]: Began running node test.my_project.NO_NULL
[0m19:00:28.796500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.EVENT_MONTH, now test.my_project.NO_NULL)
[0m19:00:28.796663 [debug] [Thread-1 (]: Began compiling node test.my_project.NO_NULL
[0m19:00:28.797761 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.NO_NULL"
[0m19:00:28.798228 [debug] [Thread-1 (]: Began executing node test.my_project.NO_NULL
[0m19:00:28.798390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:28.831273 [debug] [Thread-1 (]: Finished running node test.my_project.NO_NULL
[0m19:00:28.831472 [debug] [Thread-1 (]: Began running node analysis.my_project.avg_quote_to_bind_by_month_analysis
[0m19:00:28.831663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.NO_NULL, now analysis.my_project.avg_quote_to_bind_by_month_analysis)
[0m19:00:28.831825 [debug] [Thread-1 (]: Began compiling node analysis.my_project.avg_quote_to_bind_by_month_analysis
[0m19:00:28.833006 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.my_project.avg_quote_to_bind_by_month_analysis"
[0m19:00:28.833372 [debug] [Thread-1 (]: Began executing node analysis.my_project.avg_quote_to_bind_by_month_analysis
[0m19:00:28.833538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:28.866495 [debug] [Thread-1 (]: Finished running node analysis.my_project.avg_quote_to_bind_by_month_analysis
[0m19:00:28.866699 [debug] [Thread-1 (]: Began running node analysis.my_project.cancelled_within_30_days_analysis
[0m19:00:28.866865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.my_project.avg_quote_to_bind_by_month_analysis, now analysis.my_project.cancelled_within_30_days_analysis)
[0m19:00:28.867042 [debug] [Thread-1 (]: Began compiling node analysis.my_project.cancelled_within_30_days_analysis
[0m19:00:28.868119 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.my_project.cancelled_within_30_days_analysis"
[0m19:00:28.868433 [debug] [Thread-1 (]: Began executing node analysis.my_project.cancelled_within_30_days_analysis
[0m19:00:28.868593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:28.901552 [debug] [Thread-1 (]: Finished running node analysis.my_project.cancelled_within_30_days_analysis
[0m19:00:28.901747 [debug] [Thread-1 (]: Began running node analysis.my_project.quoted_never_bound_analysis
[0m19:00:28.901935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.my_project.cancelled_within_30_days_analysis, now analysis.my_project.quoted_never_bound_analysis)
[0m19:00:28.902088 [debug] [Thread-1 (]: Began compiling node analysis.my_project.quoted_never_bound_analysis
[0m19:00:28.903140 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.my_project.quoted_never_bound_analysis"
[0m19:00:28.903423 [debug] [Thread-1 (]: Began executing node analysis.my_project.quoted_never_bound_analysis
[0m19:00:28.903584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:28.936323 [debug] [Thread-1 (]: Finished running node analysis.my_project.quoted_never_bound_analysis
[0m19:00:28.936520 [debug] [Thread-1 (]: Began running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m19:00:28.936691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.my_project.quoted_never_bound_analysis, now test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715)
[0m19:00:28.936889 [debug] [Thread-1 (]: Began compiling node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m19:00:28.942667 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"
[0m19:00:28.943028 [debug] [Thread-1 (]: Began executing node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m19:00:28.943213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:28.976429 [debug] [Thread-1 (]: Finished running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m19:00:28.976651 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m19:00:28.976878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715, now test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a)
[0m19:00:28.977092 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m19:00:28.980714 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"
[0m19:00:28.981112 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m19:00:28.981281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:29.014108 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m19:00:29.014290 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m19:00:29.014482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a, now test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87)
[0m19:00:29.014639 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m19:00:29.017164 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"
[0m19:00:29.017464 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m19:00:29.017623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:29.050624 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m19:00:29.050843 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m19:00:29.051045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87, now test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8)
[0m19:00:29.051225 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m19:00:29.052856 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8"
[0m19:00:29.053200 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m19:00:29.053362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:29.086150 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m19:00:29.086347 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m19:00:29.086515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8, now test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0)
[0m19:00:29.086694 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m19:00:29.088262 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"
[0m19:00:29.088553 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m19:00:29.088722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:29.121829 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m19:00:29.122059 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m19:00:29.122272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0, now test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b)
[0m19:00:29.122453 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m19:00:29.124131 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"
[0m19:00:29.124437 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m19:00:29.124610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:29.157834 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m19:00:29.158068 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21
[0m19:00:29.158281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b, now test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21)
[0m19:00:29.158565 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21
[0m19:00:29.160244 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21"
[0m19:00:29.160554 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21
[0m19:00:29.160718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:29.193991 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21
[0m19:00:29.194214 [debug] [Thread-1 (]: Began running node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m19:00:29.194452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21, now test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745)
[0m19:00:29.194660 [debug] [Thread-1 (]: Began compiling node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m19:00:29.197345 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745"
[0m19:00:29.197672 [debug] [Thread-1 (]: Began executing node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m19:00:29.197836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:29.230385 [debug] [Thread-1 (]: Finished running node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m19:00:29.230843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:29.230980 [debug] [MainThread]: Connection 'test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745' was properly closed.
[0m19:00:29.231967 [debug] [MainThread]: Command end result
[0m19:00:29.244325 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:00:29.245030 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:00:29.248327 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m19:00:29.248597 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.119966, "process_in_blocks": "0", "process_kernel_time": 0.971452, "process_mem_max_rss": "402161664", "process_out_blocks": "0", "process_user_time": 4.154846}
[0m19:00:29.248903 [debug] [MainThread]: Command `dbt compile` succeeded at 19:00:29.248850 after 4.12 seconds
[0m19:00:29.249107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155909bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b21cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b3c170>]}
[0m19:00:29.249291 [debug] [MainThread]: Flushing usage events
[0m19:00:30.402085 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:01:50.488464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e95010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e4140>]}


============================== 19:01:50.489915 | b605c923-95e7-446d-8a0c-2822b9fa0b59 ==============================
[0m19:01:50.489915 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:01:50.490247 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt compile', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'empty': 'False', 'introspect': 'True', 'static_parser': 'True', 'use_colors': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'debug': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'partial_parse': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'write_json': 'True', 'quiet': 'False', 'fail_fast': 'False'}
[0m19:01:51.827374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b605c923-95e7-446d-8a0c-2822b9fa0b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067971d0>]}
[0m19:01:51.851827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b605c923-95e7-446d-8a0c-2822b9fa0b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ad1ad20>]}
[0m19:01:51.852128 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:01:51.961517 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:01:52.043940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:01:52.044266 [debug] [MainThread]: Partial parsing: added file: my_project://analyses/schema.yml
[0m19:01:52.044520 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/schema.yml
[0m19:01:52.111338 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'cancelled_within_30_days' in the 'analyses' section of file 'analyses/schema.yml'
[0m19:01:52.111875 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'avg_quote_to_bind_by_month' in the 'analyses' section of file 'analyses/schema.yml'
[0m19:01:52.150865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b605c923-95e7-446d-8a0c-2822b9fa0b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bd4daf0>]}
[0m19:01:52.191576 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:01:52.192483 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:01:52.202711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b605c923-95e7-446d-8a0c-2822b9fa0b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bb2d580>]}
[0m19:01:52.202945 [info ] [MainThread]: Found 3 models, 10 data tests, 3 analyses, 496 macros
[0m19:01:52.203121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b605c923-95e7-446d-8a0c-2822b9fa0b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bd27020>]}
[0m19:01:52.203980 [info ] [MainThread]: 
[0m19:01:52.204183 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m19:01:52.204320 [info ] [MainThread]: 
[0m19:01:52.204557 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:01:52.206175 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9_single_view_policy_assignment'
[0m19:01:52.206393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:52.975844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b605c923-95e7-446d-8a0c-2822b9fa0b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bd36b40>]}
[0m19:01:52.977021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:01:53.036627 [debug] [Thread-1 (]: Began running node model.my_project.load_policy
[0m19:01:53.036996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.load_policy)
[0m19:01:53.037216 [debug] [Thread-1 (]: Began compiling node model.my_project.load_policy
[0m19:01:53.041221 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.load_policy"
[0m19:01:53.041648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.077055 [debug] [Thread-1 (]: Finished running node model.my_project.load_policy
[0m19:01:53.077446 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m19:01:53.077714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.load_policy, now model.my_project.stg_policy_events)
[0m19:01:53.077933 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m19:01:53.081257 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m19:01:53.081569 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m19:01:53.081769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.114976 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m19:01:53.115336 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m19:01:53.115546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m19:01:53.115747 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m19:01:53.117907 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m19:01:53.118210 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m19:01:53.118369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.151552 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m19:01:53.151771 [debug] [Thread-1 (]: Began running node test.my_project.EVENT_MONTH
[0m19:01:53.152004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_lifecycle_enriched, now test.my_project.EVENT_MONTH)
[0m19:01:53.152348 [debug] [Thread-1 (]: Began compiling node test.my_project.EVENT_MONTH
[0m19:01:53.153500 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.EVENT_MONTH"
[0m19:01:53.153848 [debug] [Thread-1 (]: Began executing node test.my_project.EVENT_MONTH
[0m19:01:53.154010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.187117 [debug] [Thread-1 (]: Finished running node test.my_project.EVENT_MONTH
[0m19:01:53.187332 [debug] [Thread-1 (]: Began running node test.my_project.NO_NULL
[0m19:01:53.187538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.EVENT_MONTH, now test.my_project.NO_NULL)
[0m19:01:53.187713 [debug] [Thread-1 (]: Began compiling node test.my_project.NO_NULL
[0m19:01:53.188804 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.NO_NULL"
[0m19:01:53.189100 [debug] [Thread-1 (]: Began executing node test.my_project.NO_NULL
[0m19:01:53.189261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.222339 [debug] [Thread-1 (]: Finished running node test.my_project.NO_NULL
[0m19:01:53.222544 [debug] [Thread-1 (]: Began running node analysis.my_project.avg_quote_to_bind_by_month_analysis
[0m19:01:53.222740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.NO_NULL, now analysis.my_project.avg_quote_to_bind_by_month_analysis)
[0m19:01:53.222899 [debug] [Thread-1 (]: Began compiling node analysis.my_project.avg_quote_to_bind_by_month_analysis
[0m19:01:53.223995 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.my_project.avg_quote_to_bind_by_month_analysis"
[0m19:01:53.224337 [debug] [Thread-1 (]: Began executing node analysis.my_project.avg_quote_to_bind_by_month_analysis
[0m19:01:53.224494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.257442 [debug] [Thread-1 (]: Finished running node analysis.my_project.avg_quote_to_bind_by_month_analysis
[0m19:01:53.257651 [debug] [Thread-1 (]: Began running node analysis.my_project.cancelled_within_30_days_analysis
[0m19:01:53.257842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.my_project.avg_quote_to_bind_by_month_analysis, now analysis.my_project.cancelled_within_30_days_analysis)
[0m19:01:53.258031 [debug] [Thread-1 (]: Began compiling node analysis.my_project.cancelled_within_30_days_analysis
[0m19:01:53.259122 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.my_project.cancelled_within_30_days_analysis"
[0m19:01:53.259415 [debug] [Thread-1 (]: Began executing node analysis.my_project.cancelled_within_30_days_analysis
[0m19:01:53.259568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.292570 [debug] [Thread-1 (]: Finished running node analysis.my_project.cancelled_within_30_days_analysis
[0m19:01:53.292813 [debug] [Thread-1 (]: Began running node analysis.my_project.quoted_never_bound_analysis
[0m19:01:53.293004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.my_project.cancelled_within_30_days_analysis, now analysis.my_project.quoted_never_bound_analysis)
[0m19:01:53.293169 [debug] [Thread-1 (]: Began compiling node analysis.my_project.quoted_never_bound_analysis
[0m19:01:53.294232 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.my_project.quoted_never_bound_analysis"
[0m19:01:53.294501 [debug] [Thread-1 (]: Began executing node analysis.my_project.quoted_never_bound_analysis
[0m19:01:53.294646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.327618 [debug] [Thread-1 (]: Finished running node analysis.my_project.quoted_never_bound_analysis
[0m19:01:53.327825 [debug] [Thread-1 (]: Began running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m19:01:53.328015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.my_project.quoted_never_bound_analysis, now test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715)
[0m19:01:53.328187 [debug] [Thread-1 (]: Began compiling node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m19:01:53.333717 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"
[0m19:01:53.334032 [debug] [Thread-1 (]: Began executing node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m19:01:53.334207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.366766 [debug] [Thread-1 (]: Finished running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m19:01:53.366967 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m19:01:53.367155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715, now test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a)
[0m19:01:53.367307 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m19:01:53.370765 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"
[0m19:01:53.371068 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m19:01:53.371227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.403660 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m19:01:53.403849 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m19:01:53.404038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a, now test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87)
[0m19:01:53.404251 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m19:01:53.405906 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"
[0m19:01:53.406196 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m19:01:53.406358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.438867 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m19:01:53.439057 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m19:01:53.439240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87, now test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8)
[0m19:01:53.439394 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m19:01:53.441659 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8"
[0m19:01:53.441963 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m19:01:53.442116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.474604 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m19:01:53.474788 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m19:01:53.474969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8, now test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0)
[0m19:01:53.475115 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m19:01:53.476691 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"
[0m19:01:53.476980 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m19:01:53.477136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.509565 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m19:01:53.509756 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m19:01:53.509916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0, now test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b)
[0m19:01:53.510082 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m19:01:53.511660 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"
[0m19:01:53.511952 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m19:01:53.512107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.544590 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m19:01:53.544776 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21
[0m19:01:53.544953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b, now test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21)
[0m19:01:53.545096 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21
[0m19:01:53.546728 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21"
[0m19:01:53.547011 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21
[0m19:01:53.547167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.579679 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21
[0m19:01:53.579867 [debug] [Thread-1 (]: Began running node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m19:01:53.580044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21, now test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745)
[0m19:01:53.580188 [debug] [Thread-1 (]: Began compiling node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m19:01:53.582656 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745"
[0m19:01:53.582928 [debug] [Thread-1 (]: Began executing node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m19:01:53.583082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:53.615700 [debug] [Thread-1 (]: Finished running node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m19:01:53.616119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:53.616253 [debug] [MainThread]: Connection 'test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745' was properly closed.
[0m19:01:53.617111 [debug] [MainThread]: Command end result
[0m19:01:53.629057 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:01:53.629745 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:01:53.632576 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m19:01:53.632839 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.174076, "process_in_blocks": "0", "process_kernel_time": 1.758639, "process_mem_max_rss": "404242432", "process_out_blocks": "0", "process_user_time": 3.232162}
[0m19:01:53.633109 [debug] [MainThread]: Command `dbt compile` succeeded at 19:01:53.633066 after 3.17 seconds
[0m19:01:53.633270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc0b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106705c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106705670>]}
[0m19:01:53.633418 [debug] [MainThread]: Flushing usage events
[0m19:01:55.315225 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:03:49.518364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707c1a0>]}


============================== 19:03:49.519677 | ca5208ad-505e-48c4-af67-0345f7ffe448 ==============================
[0m19:03:49.519677 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:03:49.520034 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'target_path': 'None', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'partial_parse': 'True', 'version_check': 'True', 'debug': 'False', 'empty': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'invocation_command': 'dbt compile', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'introspect': 'True', 'cache_selected_only': 'False'}
[0m19:03:50.900308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca5208ad-505e-48c4-af67-0345f7ffe448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702d0d0>]}
[0m19:03:50.924446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca5208ad-505e-48c4-af67-0345f7ffe448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140c6b2f0>]}
[0m19:03:50.924746 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:03:51.031720 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:03:51.105653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:03:51.105982 [debug] [MainThread]: Partial parsing: updated file: my_project://analyses/schema.yml
[0m19:03:51.162731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca5208ad-505e-48c4-af67-0345f7ffe448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141648530>]}
[0m19:03:51.203192 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:03:51.204026 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:03:51.209932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca5208ad-505e-48c4-af67-0345f7ffe448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1414b5400>]}
[0m19:03:51.210160 [info ] [MainThread]: Found 3 models, 10 data tests, 3 analyses, 496 macros
[0m19:03:51.210338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca5208ad-505e-48c4-af67-0345f7ffe448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1416e7260>]}
[0m19:03:51.211193 [info ] [MainThread]: 
[0m19:03:51.211391 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m19:03:51.211526 [info ] [MainThread]: 
[0m19:03:51.211757 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:03:51.213386 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9_single_view_policy_assignment'
[0m19:03:51.213590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:52.011598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca5208ad-505e-48c4-af67-0345f7ffe448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1412663c0>]}
[0m19:03:52.012897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:03:52.074694 [debug] [Thread-1 (]: Began running node model.my_project.load_policy
[0m19:03:52.075117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.load_policy)
[0m19:03:52.075364 [debug] [Thread-1 (]: Began compiling node model.my_project.load_policy
[0m19:03:52.079489 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.load_policy"
[0m19:03:52.079939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.115307 [debug] [Thread-1 (]: Finished running node model.my_project.load_policy
[0m19:03:52.115652 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m19:03:52.115960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.load_policy, now model.my_project.stg_policy_events)
[0m19:03:52.116192 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m19:03:52.119469 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m19:03:52.119792 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m19:03:52.119967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.152409 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m19:03:52.152733 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m19:03:52.152920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m19:03:52.153098 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m19:03:52.155213 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m19:03:52.155529 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m19:03:52.155695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.188357 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m19:03:52.188544 [debug] [Thread-1 (]: Began running node test.my_project.EVENT_MONTH
[0m19:03:52.188703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_lifecycle_enriched, now test.my_project.EVENT_MONTH)
[0m19:03:52.189059 [debug] [Thread-1 (]: Began compiling node test.my_project.EVENT_MONTH
[0m19:03:52.190167 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.EVENT_MONTH"
[0m19:03:52.190449 [debug] [Thread-1 (]: Began executing node test.my_project.EVENT_MONTH
[0m19:03:52.190606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.222931 [debug] [Thread-1 (]: Finished running node test.my_project.EVENT_MONTH
[0m19:03:52.223115 [debug] [Thread-1 (]: Began running node test.my_project.NO_NULL
[0m19:03:52.223369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.EVENT_MONTH, now test.my_project.NO_NULL)
[0m19:03:52.223513 [debug] [Thread-1 (]: Began compiling node test.my_project.NO_NULL
[0m19:03:52.224557 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.NO_NULL"
[0m19:03:52.224829 [debug] [Thread-1 (]: Began executing node test.my_project.NO_NULL
[0m19:03:52.224983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.257463 [debug] [Thread-1 (]: Finished running node test.my_project.NO_NULL
[0m19:03:52.257655 [debug] [Thread-1 (]: Began running node analysis.my_project.avg_quote_to_bind_by_month_analysis
[0m19:03:52.257831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.NO_NULL, now analysis.my_project.avg_quote_to_bind_by_month_analysis)
[0m19:03:52.257978 [debug] [Thread-1 (]: Began compiling node analysis.my_project.avg_quote_to_bind_by_month_analysis
[0m19:03:52.259055 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.my_project.avg_quote_to_bind_by_month_analysis"
[0m19:03:52.259337 [debug] [Thread-1 (]: Began executing node analysis.my_project.avg_quote_to_bind_by_month_analysis
[0m19:03:52.259493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.291973 [debug] [Thread-1 (]: Finished running node analysis.my_project.avg_quote_to_bind_by_month_analysis
[0m19:03:52.292161 [debug] [Thread-1 (]: Began running node analysis.my_project.cancelled_within_30_days_analysis
[0m19:03:52.292341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.my_project.avg_quote_to_bind_by_month_analysis, now analysis.my_project.cancelled_within_30_days_analysis)
[0m19:03:52.292489 [debug] [Thread-1 (]: Began compiling node analysis.my_project.cancelled_within_30_days_analysis
[0m19:03:52.293544 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.my_project.cancelled_within_30_days_analysis"
[0m19:03:52.293818 [debug] [Thread-1 (]: Began executing node analysis.my_project.cancelled_within_30_days_analysis
[0m19:03:52.293970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.326383 [debug] [Thread-1 (]: Finished running node analysis.my_project.cancelled_within_30_days_analysis
[0m19:03:52.326575 [debug] [Thread-1 (]: Began running node analysis.my_project.quoted_never_bound_analysis
[0m19:03:52.326754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.my_project.cancelled_within_30_days_analysis, now analysis.my_project.quoted_never_bound_analysis)
[0m19:03:52.326911 [debug] [Thread-1 (]: Began compiling node analysis.my_project.quoted_never_bound_analysis
[0m19:03:52.327969 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.my_project.quoted_never_bound_analysis"
[0m19:03:52.328244 [debug] [Thread-1 (]: Began executing node analysis.my_project.quoted_never_bound_analysis
[0m19:03:52.328395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.360850 [debug] [Thread-1 (]: Finished running node analysis.my_project.quoted_never_bound_analysis
[0m19:03:52.361040 [debug] [Thread-1 (]: Began running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m19:03:52.361236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly analysis.my_project.quoted_never_bound_analysis, now test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715)
[0m19:03:52.361386 [debug] [Thread-1 (]: Began compiling node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m19:03:52.366686 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"
[0m19:03:52.366999 [debug] [Thread-1 (]: Began executing node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m19:03:52.367164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.399569 [debug] [Thread-1 (]: Finished running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m19:03:52.399752 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m19:03:52.399936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715, now test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a)
[0m19:03:52.400083 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m19:03:52.403568 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"
[0m19:03:52.403869 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m19:03:52.404033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.436402 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m19:03:52.436583 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m19:03:52.436760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a, now test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87)
[0m19:03:52.436906 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m19:03:52.438547 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"
[0m19:03:52.438807 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m19:03:52.438962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.471368 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m19:03:52.471551 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m19:03:52.471727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87, now test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8)
[0m19:03:52.471875 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m19:03:52.474131 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8"
[0m19:03:52.474397 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m19:03:52.474551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.507000 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m19:03:52.507186 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m19:03:52.507344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8, now test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0)
[0m19:03:52.507515 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m19:03:52.509074 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"
[0m19:03:52.509339 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m19:03:52.509495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.542187 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m19:03:52.542366 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m19:03:52.542538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0, now test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b)
[0m19:03:52.542688 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m19:03:52.544272 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"
[0m19:03:52.544543 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m19:03:52.544704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.577384 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m19:03:52.577564 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21
[0m19:03:52.577720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b, now test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21)
[0m19:03:52.577907 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21
[0m19:03:52.579543 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21"
[0m19:03:52.579805 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21
[0m19:03:52.579963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.613013 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21
[0m19:03:52.613215 [debug] [Thread-1 (]: Began running node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m19:03:52.613406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_quote_to_bind_mins.a1b90e9a21, now test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745)
[0m19:03:52.613552 [debug] [Thread-1 (]: Began compiling node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m19:03:52.616301 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745"
[0m19:03:52.616643 [debug] [Thread-1 (]: Began executing node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m19:03:52.616842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:03:52.651426 [debug] [Thread-1 (]: Finished running node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m19:03:52.651852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:52.651982 [debug] [MainThread]: Connection 'test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745' was properly closed.
[0m19:03:52.652847 [debug] [MainThread]: Command end result
[0m19:03:52.665527 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:03:52.666207 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:03:52.672295 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m19:03:52.672557 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.1834855, "process_in_blocks": "0", "process_kernel_time": 1.291315, "process_mem_max_rss": "400982016", "process_out_blocks": "0", "process_user_time": 3.682306}
[0m19:03:52.672820 [debug] [MainThread]: Command `dbt compile` succeeded at 19:03:52.672780 after 3.18 seconds
[0m19:03:52.673006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14128bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e994c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1414b60c0>]}
[0m19:03:52.673168 [debug] [MainThread]: Flushing usage events
[0m19:03:54.098611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:10:15.093159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103740350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107460560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074600e0>]}


============================== 19:10:15.094608 | a49fb6fa-9a9f-48c9-93b5-de7866d57a76 ==============================
[0m19:10:15.094608 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:10:15.094939 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'use_colors': 'True', 'introspect': 'True', 'quiet': 'False', 'target_path': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'warn_error': 'None', 'invocation_command': 'dbt run', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'static_parser': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'debug': 'False', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True'}
[0m19:10:16.789697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a49fb6fa-9a9f-48c9-93b5-de7866d57a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150874980>]}
[0m19:10:16.814025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a49fb6fa-9a9f-48c9-93b5-de7866d57a76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1505d2d20>]}
[0m19:10:16.814332 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:10:16.927536 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:10:16.993936 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at analyses/schema.yml is invalid because the value of 'analyses' is not a list
[0m19:10:16.994298 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.931926, "process_in_blocks": "0", "process_kernel_time": 1.011756, "process_mem_max_rss": "392658944", "process_out_blocks": "0", "process_user_time": 3.039094}
[0m19:10:16.994604 [debug] [MainThread]: Command `dbt run` failed at 19:10:16.994546 after 1.93 seconds
[0m19:10:16.994817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107460740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1506d4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150d14680>]}
[0m19:10:16.994992 [debug] [MainThread]: Flushing usage events
[0m19:10:18.918165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:56:11.717592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfa1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d0a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107adc0e0>]}


============================== 14:56:11.719731 | 01c4d9a6-38cb-4404-941d-79b2b87cea7f ==============================
[0m14:56:11.719731 [info ] [MainThread]: Running with dbt=1.10.6
[0m14:56:11.720077 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'empty': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'static_parser': 'True', 'write_json': 'True', 'use_colors': 'True', 'quiet': 'False', 'fail_fast': 'False', 'printer_width': '80', 'warn_error': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'invocation_command': 'dbt seed', 'version_check': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt'}
[0m14:56:14.298293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01c4d9a6-38cb-4404-941d-79b2b87cea7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16376afc0>]}
[0m14:56:14.323028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01c4d9a6-38cb-4404-941d-79b2b87cea7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16357ad20>]}
[0m14:56:14.323360 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m14:56:14.439013 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m14:56:14.502400 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:56:14.502705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '01c4d9a6-38cb-4404-941d-79b2b87cea7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0aff0>]}
[0m14:56:14.508190 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at analyses/schema.yml is invalid because the value of 'analyses' is not a list
[0m14:56:14.508549 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.8278468, "process_in_blocks": "0", "process_kernel_time": 1.019063, "process_mem_max_rss": "393052160", "process_out_blocks": "0", "process_user_time": 3.327585}
[0m14:56:14.508998 [debug] [MainThread]: Command `dbt seed` failed at 14:56:14.508922 after 2.83 seconds
[0m14:56:14.509262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107adc200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe7c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052dd370>]}
[0m14:56:14.509443 [debug] [MainThread]: Flushing usage events
[0m14:56:15.909476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:57:27.273709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6cef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086085c0>]}


============================== 14:57:27.275743 | 43de98d9-fc99-4e44-b8be-cf129f0efd8a ==============================
[0m14:57:27.275743 [info ] [MainThread]: Running with dbt=1.10.6
[0m14:57:27.276102 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'debug': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'printer_width': '80', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'no_print': 'None', 'empty': 'None', 'static_parser': 'True', 'use_colors': 'True'}
[0m14:57:29.268748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43de98d9-fc99-4e44-b8be-cf129f0efd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153b3e240>]}
[0m14:57:29.292935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43de98d9-fc99-4e44-b8be-cf129f0efd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15426d070>]}
[0m14:57:29.293223 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m14:57:29.407852 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m14:57:29.471226 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:57:29.471514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43de98d9-fc99-4e44-b8be-cf129f0efd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15453ab70>]}
[0m14:57:30.180722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43de98d9-fc99-4e44-b8be-cf129f0efd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15518c230>]}
[0m14:57:30.220854 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m14:57:30.222136 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m14:57:30.234770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43de98d9-fc99-4e44-b8be-cf129f0efd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15503d1c0>]}
[0m14:57:30.235014 [info ] [MainThread]: Found 6 models, 10 data tests, 1 seed, 496 macros
[0m14:57:30.235199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43de98d9-fc99-4e44-b8be-cf129f0efd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15475eb40>]}
[0m14:57:30.235954 [info ] [MainThread]: 
[0m14:57:30.236140 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m14:57:30.236274 [info ] [MainThread]: 
[0m14:57:30.236501 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:57:30.236908 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m14:57:30.237109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:31.306988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m14:57:31.307882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:32.039554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43de98d9-fc99-4e44-b8be-cf129f0efd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc3140>]}
[0m14:57:32.040820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:32.107243 [debug] [Thread-1 (]: Began running node seed.my_project.policy_events
[0m14:57:32.107728 [info ] [Thread-1 (]: 1 of 1 START seed file single_view_policy_assignment.policy_events ............. [RUN]
[0m14:57:32.108027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now seed.my_project.policy_events)
[0m14:57:32.108254 [debug] [Thread-1 (]: Began compiling node seed.my_project.policy_events
[0m14:57:32.108468 [debug] [Thread-1 (]: Began executing node seed.my_project.policy_events
[0m14:57:32.183831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:37.499918 [debug] [Thread-1 (]: On seed.my_project.policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "seed.my_project.policy_events"} */

    alter table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events` set OPTIONS()
  
[0m14:57:38.123945 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:f1f13702-cff0-4da4-9c1c-cc096c64fc4a&page=queryresults
[0m14:57:38.457593 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.my_project.policy_events"
[0m14:57:38.481586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43de98d9-fc99-4e44-b8be-cf129f0efd8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15561fdd0>]}
[0m14:57:38.482172 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file single_view_policy_assignment.policy_events ......... [[32mINSERT 718[0m in 6.37s]
[0m14:57:38.482717 [debug] [Thread-1 (]: Finished running node seed.my_project.policy_events
[0m14:57:38.483716 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:57:38.529495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:38.529742 [debug] [MainThread]: Connection 'seed.my_project.policy_events' was properly closed.
[0m14:57:38.529919 [info ] [MainThread]: 
[0m14:57:38.530093 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 8.29 seconds (8.29s).
[0m14:57:38.530432 [debug] [MainThread]: Command end result
[0m14:57:38.542942 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m14:57:38.543720 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m14:57:38.546653 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m14:57:38.546827 [info ] [MainThread]: 
[0m14:57:38.547028 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:57:38.547172 [info ] [MainThread]: 
[0m14:57:38.547354 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:57:38.547598 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 11.310183, "process_in_blocks": "0", "process_kernel_time": 0.768392, "process_mem_max_rss": "406011904", "process_out_blocks": "0", "process_user_time": 4.621156}
[0m14:57:38.547855 [debug] [MainThread]: Command `dbt seed` succeeded at 14:57:38.547816 after 11.31 seconds
[0m14:57:38.548024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15548f500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1553895b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6e270>]}
[0m14:57:38.548187 [debug] [MainThread]: Flushing usage events
[0m14:57:40.574451 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:17:57.991355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cc650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dcc500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dcc0e0>]}


============================== 16:17:57.993442 | 5852493c-5d4d-48ee-9a53-80cd9031f559 ==============================
[0m16:17:57.993442 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:17:57.993796 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'invocation_command': 'dbt run --select ext_policy_events', 'fail_fast': 'False', 'empty': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'partial_parse': 'True', 'introspect': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'target_path': 'None', 'printer_width': '80', 'static_parser': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'indirect_selection': 'eager', 'no_print': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default'}
[0m16:18:00.300417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5852493c-5d4d-48ee-9a53-80cd9031f559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d525d0>]}
[0m16:18:00.326073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5852493c-5d4d-48ee-9a53-80cd9031f559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1659732f0>]}
[0m16:18:00.326417 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:18:00.450717 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:18:00.517276 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:18:00.517638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5852493c-5d4d-48ee-9a53-80cd9031f559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f6fc0>]}
[0m16:18:01.225203 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m16:18:01.227728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5852493c-5d4d-48ee-9a53-80cd9031f559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16645c980>]}
[0m16:18:01.270733 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:18:01.272200 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:18:01.286550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5852493c-5d4d-48ee-9a53-80cd9031f559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1664565a0>]}
[0m16:18:01.286824 [info ] [MainThread]: Found 6 models, 10 data tests, 1 seed, 496 macros
[0m16:18:01.286997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5852493c-5d4d-48ee-9a53-80cd9031f559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1664734a0>]}
[0m16:18:01.287656 [info ] [MainThread]: 
[0m16:18:01.287833 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m16:18:01.287965 [info ] [MainThread]: 
[0m16:18:01.288195 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:18:01.288604 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m16:18:01.288806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:02.378047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m16:18:02.379896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:18:03.161982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5852493c-5d4d-48ee-9a53-80cd9031f559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1664445c0>]}
[0m16:18:03.163376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:18:03.228683 [debug] [Thread-1 (]: Began running node model.my_project.ext_policy_events
[0m16:18:03.229069 [info ] [Thread-1 (]: 1 of 1 START sql external model single_view_policy_assignment.ext_policy_events  [RUN]
[0m16:18:03.229341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.ext_policy_events)
[0m16:18:03.229548 [debug] [Thread-1 (]: Began compiling node model.my_project.ext_policy_events
[0m16:18:03.233892 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.ext_policy_events"
[0m16:18:03.234281 [debug] [Thread-1 (]: Began executing node model.my_project.ext_policy_events
[0m16:18:03.236123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:18:03.273020 [debug] [Thread-1 (]: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  No materialization 'external' was found for adapter bigquery! (searched types 'default' and 'bigquery')
[0m16:18:03.273980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5852493c-5d4d-48ee-9a53-80cd9031f559', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166454e00>]}
[0m16:18:03.274307 [error] [Thread-1 (]: 1 of 1 ERROR creating sql external model single_view_policy_assignment.ext_policy_events  [[31mERROR[0m in 0.04s]
[0m16:18:03.274607 [debug] [Thread-1 (]: Finished running node model.my_project.ext_policy_events
[0m16:18:03.274870 [debug] [Thread-4 (]: Marking all children of 'model.my_project.ext_policy_events' to be skipped because of status 'error'.  Reason: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  No materialization 'external' was found for adapter bigquery! (searched types 'default' and 'bigquery').
[0m16:18:03.275427 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:18:03.309003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:18:03.309188 [debug] [MainThread]: Connection 'model.my_project.ext_policy_events' was properly closed.
[0m16:18:03.309332 [info ] [MainThread]: 
[0m16:18:03.309494 [info ] [MainThread]: Finished running 1 external model in 0 hours 0 minutes and 2.02 seconds (2.02s).
[0m16:18:03.309805 [debug] [MainThread]: Command end result
[0m16:18:03.321519 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:18:03.322558 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:18:03.325004 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m16:18:03.325158 [info ] [MainThread]: 
[0m16:18:03.325340 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:18:03.325479 [info ] [MainThread]: 
[0m16:18:03.325662 [error] [MainThread]: [31mFailure in model ext_policy_events (models/example/ext_policy_events.sql)[0m
[0m16:18:03.325848 [error] [MainThread]:   Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  No materialization 'external' was found for adapter bigquery! (searched types 'default' and 'bigquery')
[0m16:18:03.325978 [info ] [MainThread]: 
[0m16:18:03.326131 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/ext_policy_events.sql
[0m16:18:03.326261 [info ] [MainThread]: 
[0m16:18:03.326416 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:18:03.326632 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.371365, "process_in_blocks": "0", "process_kernel_time": 0.8317, "process_mem_max_rss": "402587648", "process_out_blocks": "0", "process_user_time": 4.506233}
[0m16:18:03.326873 [debug] [MainThread]: Command `dbt run` failed at 16:18:03.326834 after 5.37 seconds
[0m16:18:03.327085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be97f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1601096a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16630d8e0>]}
[0m16:18:03.327280 [debug] [MainThread]: Flushing usage events
[0m16:18:05.332762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:19:43.311951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f783b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f780b0>]}


============================== 16:19:43.313870 | 97e8fe64-d76f-4197-b5fd-4d83f57e1e05 ==============================
[0m16:19:43.313870 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:19:43.314235 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'empty': 'False', 'quiet': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'version_check': 'True', 'log_format': 'default', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select ext_policy_events', 'target_path': 'None', 'introspect': 'True', 'partial_parse': 'True', 'no_print': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'use_experimental_parser': 'False', 'printer_width': '80', 'debug': 'False'}
[0m16:19:45.375723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97e8fe64-d76f-4197-b5fd-4d83f57e1e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eff050>]}
[0m16:19:45.400218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97e8fe64-d76f-4197-b5fd-4d83f57e1e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a99e9c0>]}
[0m16:19:45.400502 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:19:45.516385 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:19:45.598185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:19:45.598506 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/ext_policy_events.sql
[0m16:19:45.598728 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/policy_lifecycle_enriched.sql
[0m16:19:45.785081 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m16:19:45.787348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97e8fe64-d76f-4197-b5fd-4d83f57e1e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b457c80>]}
[0m16:19:45.828526 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:19:45.829758 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:19:45.840390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97e8fe64-d76f-4197-b5fd-4d83f57e1e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b654440>]}
[0m16:19:45.840638 [info ] [MainThread]: Found 6 models, 10 data tests, 1 seed, 496 macros
[0m16:19:45.840809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97e8fe64-d76f-4197-b5fd-4d83f57e1e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b2f2060>]}
[0m16:19:45.841454 [info ] [MainThread]: 
[0m16:19:45.841655 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m16:19:45.841789 [info ] [MainThread]: 
[0m16:19:45.842029 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:19:45.842443 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m16:19:45.842644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:46.958016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m16:19:46.959235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:47.736997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97e8fe64-d76f-4197-b5fd-4d83f57e1e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b4f7710>]}
[0m16:19:47.738392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:47.804039 [debug] [Thread-1 (]: Began running node model.my_project.ext_policy_events
[0m16:19:47.804544 [info ] [Thread-1 (]: 1 of 1 START sql external model single_view_policy_assignment.ext_policy_events  [RUN]
[0m16:19:47.804870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.ext_policy_events)
[0m16:19:47.805094 [debug] [Thread-1 (]: Began compiling node model.my_project.ext_policy_events
[0m16:19:47.809719 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.ext_policy_events"
[0m16:19:47.810120 [debug] [Thread-1 (]: Began executing node model.my_project.ext_policy_events
[0m16:19:47.811047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:47.848479 [debug] [Thread-1 (]: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  No materialization 'external' was found for adapter bigquery! (searched types 'default' and 'bigquery')
[0m16:19:47.849558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97e8fe64-d76f-4197-b5fd-4d83f57e1e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b6d38f0>]}
[0m16:19:47.849902 [error] [Thread-1 (]: 1 of 1 ERROR creating sql external model single_view_policy_assignment.ext_policy_events  [[31mERROR[0m in 0.04s]
[0m16:19:47.850217 [debug] [Thread-1 (]: Finished running node model.my_project.ext_policy_events
[0m16:19:47.850505 [debug] [Thread-4 (]: Marking all children of 'model.my_project.ext_policy_events' to be skipped because of status 'error'.  Reason: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  No materialization 'external' was found for adapter bigquery! (searched types 'default' and 'bigquery').
[0m16:19:47.851115 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:47.884339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:47.884541 [debug] [MainThread]: Connection 'model.my_project.ext_policy_events' was properly closed.
[0m16:19:47.884693 [info ] [MainThread]: 
[0m16:19:47.884865 [info ] [MainThread]: Finished running 1 external model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m16:19:47.885193 [debug] [MainThread]: Command end result
[0m16:19:47.896610 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:19:47.897373 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:19:47.900125 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m16:19:47.900285 [info ] [MainThread]: 
[0m16:19:47.900468 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:19:47.900614 [info ] [MainThread]: 
[0m16:19:47.900795 [error] [MainThread]: [31mFailure in model ext_policy_events (models/example/ext_policy_events.sql)[0m
[0m16:19:47.900969 [error] [MainThread]:   Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  No materialization 'external' was found for adapter bigquery! (searched types 'default' and 'bigquery')
[0m16:19:47.901102 [info ] [MainThread]: 
[0m16:19:47.901252 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/ext_policy_events.sql
[0m16:19:47.901393 [info ] [MainThread]: 
[0m16:19:47.901551 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:19:47.901793 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.6225524, "process_in_blocks": "0", "process_kernel_time": 0.809961, "process_mem_max_rss": "407666688", "process_out_blocks": "0", "process_user_time": 3.940168}
[0m16:19:47.902053 [debug] [MainThread]: Command `dbt run` failed at 16:19:47.902013 after 4.62 seconds
[0m16:19:47.902221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b289be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b12df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fcd2b0>]}
[0m16:19:47.902369 [debug] [MainThread]: Flushing usage events
[0m16:19:49.289481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:55.781563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10973aab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10868c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10868f0b0>]}


============================== 16:21:55.783605 | 11535ef5-ac20-434a-85bf-b34a55bea8b4 ==============================
[0m16:21:55.783605 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:21:55.783959 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'empty': 'None', 'log_format': 'default', 'fail_fast': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'quiet': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'no_print': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'debug': 'False', 'use_experimental_parser': 'False'}
[0m16:21:55.910798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11535ef5-ac20-434a-85bf-b34a55bea8b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c2720>]}
[0m16:21:55.922162 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-wp39vpqd'
[0m16:21:55.922448 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:21:56.455396 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:21:56.456992 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m16:21:56.800551 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m16:21:56.816954 [info ] [MainThread]: Updating lock file in file path: /Users/pratibhagangavarapu/my_project/package-lock.yml
[0m16:21:56.820173 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-056g4kt1'
[0m16:21:56.822340 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m16:21:58.408859 [info ] [MainThread]: Installed from version 0.8.6
[0m16:21:58.409227 [info ] [MainThread]: Updated version available: 0.11.1
[0m16:21:58.409510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '11535ef5-ac20-434a-85bf-b34a55bea8b4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5a7cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8b6240>]}
[0m16:21:58.409782 [info ] [MainThread]: 
[0m16:21:58.410021 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_external_tables']                 
Update your versions in packages.yml, then run dbt deps
[0m16:21:58.412314 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.670533, "process_in_blocks": "0", "process_kernel_time": 0.180111, "process_mem_max_rss": "111394816", "process_out_blocks": "0", "process_user_time": 0.758879}
[0m16:21:58.412738 [debug] [MainThread]: Command `dbt deps` succeeded at 16:21:58.412666 after 2.67 seconds
[0m16:21:58.412989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8b6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5398b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c2720>]}
[0m16:21:58.413232 [debug] [MainThread]: Flushing usage events
[0m16:22:00.459327 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:22:23.025054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105210da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11093c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11093c230>]}


============================== 16:22:23.027308 | 2bc162db-89fb-42ac-af1d-718e216f0f90 ==============================
[0m16:22:23.027308 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:22:23.027665 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'introspect': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select ext_policy_events', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'log_cache_events': 'False', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'no_print': 'None', 'warn_error': 'None', 'use_colors': 'True', 'debug': 'False', 'quiet': 'False'}
[0m16:22:25.121535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bc162db-89fb-42ac-af1d-718e216f0f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ceb380>]}
[0m16:22:25.146451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bc162db-89fb-42ac-af1d-718e216f0f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15680ad20>]}
[0m16:22:25.146748 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:22:25.270668 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:22:25.334243 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m16:22:25.334547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2bc162db-89fb-42ac-af1d-718e216f0f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bab2000>]}
[0m16:22:26.065881 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m16:22:26.068333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bc162db-89fb-42ac-af1d-718e216f0f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cce8800>]}
[0m16:22:26.109530 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:22:26.110898 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:22:26.121135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bc162db-89fb-42ac-af1d-718e216f0f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cba8050>]}
[0m16:22:26.121378 [info ] [MainThread]: Found 6 models, 10 data tests, 1 seed, 543 macros
[0m16:22:26.121551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bc162db-89fb-42ac-af1d-718e216f0f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cbe0800>]}
[0m16:22:26.122191 [info ] [MainThread]: 
[0m16:22:26.122382 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m16:22:26.122519 [info ] [MainThread]: 
[0m16:22:26.122750 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:22:26.123159 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m16:22:26.123357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:27.087461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m16:22:27.088229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:27.853217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bc162db-89fb-42ac-af1d-718e216f0f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cb62ae0>]}
[0m16:22:27.854611 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:22:27.917817 [debug] [Thread-1 (]: Began running node model.my_project.ext_policy_events
[0m16:22:27.918313 [info ] [Thread-1 (]: 1 of 1 START sql external model single_view_policy_assignment.ext_policy_events  [RUN]
[0m16:22:27.918629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.ext_policy_events)
[0m16:22:27.918855 [debug] [Thread-1 (]: Began compiling node model.my_project.ext_policy_events
[0m16:22:27.923248 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.ext_policy_events"
[0m16:22:27.923640 [debug] [Thread-1 (]: Began executing node model.my_project.ext_policy_events
[0m16:22:27.924611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:27.960894 [debug] [Thread-1 (]: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  No materialization 'external' was found for adapter bigquery! (searched types 'default' and 'bigquery')
[0m16:22:27.961876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bc162db-89fb-42ac-af1d-718e216f0f90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cc48cb0>]}
[0m16:22:27.962202 [error] [Thread-1 (]: 1 of 1 ERROR creating sql external model single_view_policy_assignment.ext_policy_events  [[31mERROR[0m in 0.04s]
[0m16:22:27.962498 [debug] [Thread-1 (]: Finished running node model.my_project.ext_policy_events
[0m16:22:27.962768 [debug] [Thread-4 (]: Marking all children of 'model.my_project.ext_policy_events' to be skipped because of status 'error'.  Reason: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  No materialization 'external' was found for adapter bigquery! (searched types 'default' and 'bigquery').
[0m16:22:27.963304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:22:27.996596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:27.996754 [debug] [MainThread]: Connection 'model.my_project.ext_policy_events' was properly closed.
[0m16:22:27.996889 [info ] [MainThread]: 
[0m16:22:27.997048 [info ] [MainThread]: Finished running 1 external model in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m16:22:27.997354 [debug] [MainThread]: Command end result
[0m16:22:28.009826 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:22:28.010548 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:22:28.013616 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m16:22:28.013792 [info ] [MainThread]: 
[0m16:22:28.013988 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:22:28.014133 [info ] [MainThread]: 
[0m16:22:28.014315 [error] [MainThread]: [31mFailure in model ext_policy_events (models/example/ext_policy_events.sql)[0m
[0m16:22:28.014489 [error] [MainThread]:   Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  No materialization 'external' was found for adapter bigquery! (searched types 'default' and 'bigquery')
[0m16:22:28.014616 [info ] [MainThread]: 
[0m16:22:28.014765 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/ext_policy_events.sql
[0m16:22:28.014890 [info ] [MainThread]: 
[0m16:22:28.015041 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:22:28.015277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0232787, "process_in_blocks": "0", "process_kernel_time": 0.885157, "process_mem_max_rss": "405831680", "process_out_blocks": "0", "process_user_time": 4.404019}
[0m16:22:28.015519 [debug] [MainThread]: Command `dbt run` failed at 16:22:28.015481 after 5.02 seconds
[0m16:22:28.015683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d48f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052fe630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c58a70>]}
[0m16:22:28.015833 [debug] [MainThread]: Flushing usage events
[0m16:22:29.245636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:13.093329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108729af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e4bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106647bf0>]}


============================== 16:24:13.095200 | 3296da35-e428-44d8-a12a-7fde23d7183e ==============================
[0m16:24:13.095200 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:24:13.095571 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'version_check': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'empty': 'None', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'printer_width': '80', 'write_json': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'static_parser': 'True', 'no_print': 'None', 'partial_parse': 'True', 'introspect': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'debug': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False'}
[0m16:24:13.225136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3296da35-e428-44d8-a12a-7fde23d7183e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a73b0>]}
[0m16:24:13.247121 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-htn1em1s'
[0m16:24:13.247389 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:24:13.446271 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:24:13.447582 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m16:24:13.553589 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m16:24:13.558726 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m16:24:14.130371 [info ] [MainThread]: Installed from version 0.8.6
[0m16:24:14.130762 [info ] [MainThread]: Updated version available: 0.11.1
[0m16:24:14.131044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3296da35-e428-44d8-a12a-7fde23d7183e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106646e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a9ac0>]}
[0m16:24:14.131328 [info ] [MainThread]: 
[0m16:24:14.131573 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_external_tables']                 
Update your versions in packages.yml, then run dbt deps
[0m16:24:14.133838 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0734084, "process_in_blocks": "0", "process_kernel_time": 0.190662, "process_mem_max_rss": "111935488", "process_out_blocks": "0", "process_user_time": 0.766102}
[0m16:24:14.134270 [debug] [MainThread]: Command `dbt deps` succeeded at 16:24:14.134200 after 1.07 seconds
[0m16:24:14.134518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106644560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109835df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a5520>]}
[0m16:24:14.134754 [debug] [MainThread]: Flushing usage events
[0m16:24:15.419145 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:26:27.883525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e428a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a18410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a180e0>]}


============================== 16:26:27.885573 | 0b19900b-5b5d-4f0e-9b54-84099145077f ==============================
[0m16:26:27.885573 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:26:27.885937 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --select ext_policy_events', 'fail_fast': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'introspect': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'use_experimental_parser': 'False', 'static_parser': 'True', 'use_colors': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error': 'None', 'version_check': 'True', 'log_format': 'default'}
[0m16:26:30.075130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b19900b-5b5d-4f0e-9b54-84099145077f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1438a6e10>]}
[0m16:26:30.100318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b19900b-5b5d-4f0e-9b54-84099145077f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143c63650>]}
[0m16:26:30.100611 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:26:30.218096 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:26:30.284845 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:26:30.285149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b19900b-5b5d-4f0e-9b54-84099145077f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143c54800>]}
[0m16:26:31.015791 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m16:26:31.018170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b19900b-5b5d-4f0e-9b54-84099145077f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144367170>]}
[0m16:26:31.059511 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:26:31.060691 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:26:31.072066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b19900b-5b5d-4f0e-9b54-84099145077f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144185490>]}
[0m16:26:31.072313 [info ] [MainThread]: Found 6 models, 10 data tests, 1 seed, 543 macros
[0m16:26:31.072489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b19900b-5b5d-4f0e-9b54-84099145077f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14417c950>]}
[0m16:26:31.073112 [info ] [MainThread]: 
[0m16:26:31.073290 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m16:26:31.073421 [info ] [MainThread]: 
[0m16:26:31.073644 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:26:31.074037 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m16:26:31.074228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:32.159067 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m16:26:32.160219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:32.926740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b19900b-5b5d-4f0e-9b54-84099145077f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144185280>]}
[0m16:26:32.927907 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:32.992265 [debug] [Thread-1 (]: Began running node model.my_project.ext_policy_events
[0m16:26:32.992788 [info ] [Thread-1 (]: 1 of 1 START sql external model single_view_policy_assignment.ext_policy_events  [RUN]
[0m16:26:32.993108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.ext_policy_events)
[0m16:26:32.993346 [debug] [Thread-1 (]: Began compiling node model.my_project.ext_policy_events
[0m16:26:32.999235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:33.038846 [debug] [Thread-1 (]: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:26:33.039794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b19900b-5b5d-4f0e-9b54-84099145077f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c6d50>]}
[0m16:26:33.040125 [error] [Thread-1 (]: 1 of 1 ERROR creating sql external model single_view_policy_assignment.ext_policy_events  [[31mERROR[0m in 0.05s]
[0m16:26:33.040409 [debug] [Thread-1 (]: Finished running node model.my_project.ext_policy_events
[0m16:26:33.040644 [debug] [Thread-4 (]: Marking all children of 'model.my_project.ext_policy_events' to be skipped because of status 'error'.  Reason: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m16:26:33.041237 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:26:33.074338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:33.074532 [debug] [MainThread]: Connection 'model.my_project.ext_policy_events' was properly closed.
[0m16:26:33.074684 [info ] [MainThread]: 
[0m16:26:33.074855 [info ] [MainThread]: Finished running 1 external model in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m16:26:33.075162 [debug] [MainThread]: Command end result
[0m16:26:33.088085 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:26:33.088808 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:26:33.091180 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m16:26:33.091338 [info ] [MainThread]: 
[0m16:26:33.091524 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:26:33.091689 [info ] [MainThread]: 
[0m16:26:33.091876 [error] [MainThread]: [31mFailure in model ext_policy_events (models/example/ext_policy_events.sql)[0m
[0m16:26:33.092055 [error] [MainThread]:   Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:26:33.092187 [info ] [MainThread]: 
[0m16:26:33.092340 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:26:33.092582 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.2423425, "process_in_blocks": "0", "process_kernel_time": 0.888964, "process_mem_max_rss": "402407424", "process_out_blocks": "0", "process_user_time": 4.403076}
[0m16:26:33.092870 [debug] [MainThread]: Command `dbt run` failed at 16:26:33.092810 after 5.24 seconds
[0m16:26:33.093116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108836690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108835d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143e7a4b0>]}
[0m16:26:33.093295 [debug] [MainThread]: Flushing usage events
[0m16:26:34.291272 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:26:43.631323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ded20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b30500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b300e0>]}


============================== 16:26:43.632757 | 2c08c308-931a-4858-a51d-b30e3c5ef303 ==============================
[0m16:26:43.632757 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:26:43.633089 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'empty': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --select ext_policy_events', 'no_print': 'None', 'log_format': 'default', 'printer_width': '80', 'static_parser': 'True', 'introspect': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs'}
[0m16:26:45.339078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c08c308-931a-4858-a51d-b30e3c5ef303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031c7470>]}
[0m16:26:45.364091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c08c308-931a-4858-a51d-b30e3c5ef303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103298f20>]}
[0m16:26:45.364375 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:26:45.481643 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:26:45.568276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:26:45.568486 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:26:45.570946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m16:26:45.591917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c08c308-931a-4858-a51d-b30e3c5ef303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159165340>]}
[0m16:26:45.633639 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:26:45.634757 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:26:45.645105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c08c308-931a-4858-a51d-b30e3c5ef303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15954fe90>]}
[0m16:26:45.645340 [info ] [MainThread]: Found 6 models, 10 data tests, 1 seed, 543 macros
[0m16:26:45.645516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c08c308-931a-4858-a51d-b30e3c5ef303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1591925a0>]}
[0m16:26:45.646169 [info ] [MainThread]: 
[0m16:26:45.646355 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m16:26:45.646486 [info ] [MainThread]: 
[0m16:26:45.646741 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:26:45.647169 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m16:26:45.647374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:46.641247 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m16:26:46.642468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:47.356577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c08c308-931a-4858-a51d-b30e3c5ef303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159440770>]}
[0m16:26:47.357916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:47.418989 [debug] [Thread-1 (]: Began running node model.my_project.ext_policy_events
[0m16:26:47.419435 [info ] [Thread-1 (]: 1 of 1 START sql external model single_view_policy_assignment.ext_policy_events  [RUN]
[0m16:26:47.419727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.ext_policy_events)
[0m16:26:47.420088 [debug] [Thread-1 (]: Began compiling node model.my_project.ext_policy_events
[0m16:26:47.427995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:47.466644 [debug] [Thread-1 (]: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:26:47.467561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c08c308-931a-4858-a51d-b30e3c5ef303', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1587af2f0>]}
[0m16:26:47.467895 [error] [Thread-1 (]: 1 of 1 ERROR creating sql external model single_view_policy_assignment.ext_policy_events  [[31mERROR[0m in 0.05s]
[0m16:26:47.468187 [debug] [Thread-1 (]: Finished running node model.my_project.ext_policy_events
[0m16:26:47.468440 [debug] [Thread-4 (]: Marking all children of 'model.my_project.ext_policy_events' to be skipped because of status 'error'.  Reason: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m16:26:47.468989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:26:47.502251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:47.502469 [debug] [MainThread]: Connection 'model.my_project.ext_policy_events' was properly closed.
[0m16:26:47.502619 [info ] [MainThread]: 
[0m16:26:47.502796 [info ] [MainThread]: Finished running 1 external model in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m16:26:47.503091 [debug] [MainThread]: Command end result
[0m16:26:47.515154 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:26:47.515905 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:26:47.518427 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m16:26:47.518594 [info ] [MainThread]: 
[0m16:26:47.518780 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:26:47.518925 [info ] [MainThread]: 
[0m16:26:47.519120 [error] [MainThread]: [31mFailure in model ext_policy_events (models/example/ext_policy_events.sql)[0m
[0m16:26:47.519306 [error] [MainThread]:   Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:26:47.519445 [info ] [MainThread]: 
[0m16:26:47.519596 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:26:47.519838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.9176376, "process_in_blocks": "0", "process_kernel_time": 1.18984, "process_mem_max_rss": "400080896", "process_out_blocks": "0", "process_user_time": 3.246159}
[0m16:26:47.520111 [debug] [MainThread]: Command `dbt run` failed at 16:26:47.520071 after 3.92 seconds
[0m16:26:47.520285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15954fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1473f39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103299100>]}
[0m16:26:47.520441 [debug] [MainThread]: Flushing usage events
[0m16:26:48.774850 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:27:43.997850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d26c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108607cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108607c20>]}


============================== 16:27:43.999522 | e118928c-2ec1-4e75-99f8-26f228801a44 ==============================
[0m16:27:43.999522 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:27:43.999873 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_cache_events': 'False', 'empty': 'None', 'version_check': 'True', 'log_format': 'default', 'partial_parse': 'True', 'warn_error': 'None', 'write_json': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'printer_width': '80', 'quiet': 'False', 'use_colors': 'True', 'invocation_command': 'dbt deps'}
[0m16:27:44.070842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e118928c-2ec1-4e75-99f8-26f228801a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098535c0>]}
[0m16:27:44.082662 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-h21rd0d_'
[0m16:27:44.082951 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:27:45.289739 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:27:45.292482 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m16:27:45.395378 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m16:27:45.400351 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package dbt-labs/dbt_external_tables
  Requested range: =0.9.2, =0.9.2
  Compatible versions: ['0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.2.0', '0.3.0', '0.3.1', '0.3.2', '0.4.0', '0.5.0', '0.6.0', '0.6.1', '0.6.2', '0.6.3', '0.6.4', '0.7.0', '0.7.1', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.8.6', '0.8.7', '0.9.0', '0.10.0', '0.10.1', '0.11.0', '0.11.1']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m16:27:45.405189 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/main.py", line 461, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/task/deps.py", line 223, in run
    self.lock()
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/deps/resolver.py", line 131, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/deps/registry.py", line 124, in resolved
    raise PackageVersionNotFoundError(
dbt.exceptions.PackageVersionNotFoundError: Could not find a matching compatible version for package dbt-labs/dbt_external_tables
  Requested range: =0.9.2, =0.9.2
  Compatible versions: ['0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.2.0', '0.3.0', '0.3.1', '0.3.2', '0.4.0', '0.5.0', '0.6.0', '0.6.1', '0.6.2', '0.6.3', '0.6.4', '0.7.0', '0.7.1', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.8.6', '0.8.7', '0.9.0', '0.10.0', '0.10.1', '0.11.0', '0.11.1']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'

[0m16:27:45.409009 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 1.4424021, "process_in_blocks": "0", "process_kernel_time": 0.144396, "process_mem_max_rss": "110182400", "process_out_blocks": "0", "process_user_time": 0.717417}
[0m16:27:45.409706 [debug] [MainThread]: Command `dbt deps` failed at 16:27:45.409580 after 1.44 seconds
[0m16:27:45.410144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109741160>]}
[0m16:27:45.410550 [debug] [MainThread]: Flushing usage events
[0m16:27:46.711099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:29:14.337118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104306210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043845c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104387e00>]}


============================== 16:29:14.339034 | 80a68e27-28ce-4cca-b126-bf8390b6e8c6 ==============================
[0m16:29:14.339034 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:29:14.339410 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'debug': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'empty': 'None', 'log_format': 'default', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'write_json': 'True', 'printer_width': '80', 'invocation_command': 'dbt deps', 'static_parser': 'True'}
[0m16:29:14.418823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80a68e27-28ce-4cca-b126-bf8390b6e8c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10683a030>]}
[0m16:29:14.429761 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-iv7xe62y'
[0m16:29:14.430043 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:29:14.597860 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:29:14.598954 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m16:29:14.707236 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m16:29:14.721595 [info ] [MainThread]: Updating lock file in file path: /Users/pratibhagangavarapu/my_project/package-lock.yml
[0m16:29:14.737553 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-citq6bgg'
[0m16:29:14.739195 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m16:29:15.269811 [info ] [MainThread]: Installed from version 0.11.1
[0m16:29:15.270103 [info ] [MainThread]: Up to date!
[0m16:29:15.270356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '80a68e27-28ce-4cca-b126-bf8390b6e8c6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a1e80>]}
[0m16:29:15.272551 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9686202, "process_in_blocks": "0", "process_kernel_time": 0.201111, "process_mem_max_rss": "111853568", "process_out_blocks": "0", "process_user_time": 0.759}
[0m16:29:15.273012 [debug] [MainThread]: Command `dbt deps` succeeded at 16:29:15.272936 after 0.97 seconds
[0m16:29:15.273276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106923ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069232f0>]}
[0m16:29:15.273511 [debug] [MainThread]: Flushing usage events
[0m16:29:16.451319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:29:22.043310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105757800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106160500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106160260>]}


============================== 16:29:22.044569 | 85467488-bb32-4dc0-b371-dee4ac7c5d2b ==============================
[0m16:29:22.044569 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:29:22.044928 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'debug': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'write_json': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select ext_policy_events', 'use_colors': 'True', 'warn_error': 'None', 'log_format': 'default', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'empty': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'no_print': 'None'}
[0m16:29:24.248787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85467488-bb32-4dc0-b371-dee4ac7c5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1722837d0>]}
[0m16:29:24.274183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85467488-bb32-4dc0-b371-dee4ac7c5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x171f05730>]}
[0m16:29:24.274486 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:29:24.390685 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:29:24.480836 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 6 files added, 8 files changed.
[0m16:29:24.481121 [debug] [MainThread]: Partial parsing: added file: dbt_external_tables://macros/common/update_external_table_columns.sql
[0m16:29:24.481290 [debug] [MainThread]: Partial parsing: added file: dbt_external_tables://macros/plugins/fabric/get_external_build_plan.sql
[0m16:29:24.481427 [debug] [MainThread]: Partial parsing: added file: dbt_external_tables://macros/plugins/fabric/helpers/dropif.sql
[0m16:29:24.481553 [debug] [MainThread]: Partial parsing: added file: dbt_external_tables://macros/plugins/bigquery/update_external_table_columns.sql
[0m16:29:24.481680 [debug] [MainThread]: Partial parsing: added file: dbt_external_tables://macros/plugins/fabric/create_external_schema.sql
[0m16:29:24.481800 [debug] [MainThread]: Partial parsing: added file: dbt_external_tables://macros/plugins/fabric/create_external_table.sql
[0m16:29:24.481914 [debug] [MainThread]: Partial parsing: deleted file: dbt_external_tables://macros/plugins/sqlserver/create_external_schema.sql
[0m16:29:24.482025 [debug] [MainThread]: Partial parsing: deleted file: dbt_external_tables://macros/plugins/sqlserver/helpers/dropif.sql
[0m16:29:24.482135 [debug] [MainThread]: Partial parsing: deleted file: dbt_external_tables://macros/plugins/sqlserver/create_external_table.sql
[0m16:29:24.482237 [debug] [MainThread]: Partial parsing: deleted file: dbt_external_tables://macros/plugins/sqlserver/get_external_build_plan.sql
[0m16:29:24.482381 [debug] [MainThread]: Partial parsing: updated file: dbt_external_tables://macros/plugins/snowflake/refresh_external_table.sql
[0m16:29:24.482632 [debug] [MainThread]: Partial parsing: updated file: dbt_external_tables://macros/plugins/bigquery/create_external_schema.sql
[0m16:29:24.482758 [debug] [MainThread]: Partial parsing: updated file: dbt_external_tables://macros/plugins/bigquery/get_external_build_plan.sql
[0m16:29:24.482934 [debug] [MainThread]: Partial parsing: updated file: dbt_external_tables://macros/plugins/bigquery/create_external_table.sql
[0m16:29:24.483074 [debug] [MainThread]: Partial parsing: updated file: dbt_external_tables://macros/plugins/snowflake/snowpipe/create_empty_table.sql
[0m16:29:24.483229 [debug] [MainThread]: Partial parsing: updated file: dbt_external_tables://macros/plugins/snowflake/snowpipe/get_copy_sql.sql
[0m16:29:24.483348 [debug] [MainThread]: Partial parsing: updated file: dbt_external_tables://macros/common/stage_external_sources.sql
[0m16:29:24.483484 [debug] [MainThread]: Partial parsing: updated file: dbt_external_tables://macros/plugins/snowflake/create_external_table.sql
[0m16:29:24.558017 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m16:29:24.560490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85467488-bb32-4dc0-b371-dee4ac7c5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1721a2600>]}
[0m16:29:24.602788 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:29:24.604424 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:29:24.616653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85467488-bb32-4dc0-b371-dee4ac7c5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172675b50>]}
[0m16:29:24.616898 [info ] [MainThread]: Found 6 models, 10 data tests, 1 seed, 546 macros
[0m16:29:24.617075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85467488-bb32-4dc0-b371-dee4ac7c5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172655c70>]}
[0m16:29:24.617708 [info ] [MainThread]: 
[0m16:29:24.617922 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m16:29:24.618057 [info ] [MainThread]: 
[0m16:29:24.618295 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:29:24.618717 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m16:29:24.618918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:25.584029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m16:29:25.585149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:26.335141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85467488-bb32-4dc0-b371-dee4ac7c5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172466a20>]}
[0m16:29:26.336053 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:26.401404 [debug] [Thread-1 (]: Began running node model.my_project.ext_policy_events
[0m16:29:26.401887 [info ] [Thread-1 (]: 1 of 1 START sql external model single_view_policy_assignment.ext_policy_events  [RUN]
[0m16:29:26.402184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.ext_policy_events)
[0m16:29:26.402815 [debug] [Thread-1 (]: Began compiling node model.my_project.ext_policy_events
[0m16:29:26.409722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:26.449292 [debug] [Thread-1 (]: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:29:26.450184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85467488-bb32-4dc0-b371-dee4ac7c5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172146120>]}
[0m16:29:26.450520 [error] [Thread-1 (]: 1 of 1 ERROR creating sql external model single_view_policy_assignment.ext_policy_events  [[31mERROR[0m in 0.05s]
[0m16:29:26.450805 [debug] [Thread-1 (]: Finished running node model.my_project.ext_policy_events
[0m16:29:26.451079 [debug] [Thread-4 (]: Marking all children of 'model.my_project.ext_policy_events' to be skipped because of status 'error'.  Reason: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m16:29:26.451627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:26.484558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:26.484727 [debug] [MainThread]: Connection 'model.my_project.ext_policy_events' was properly closed.
[0m16:29:26.484868 [info ] [MainThread]: 
[0m16:29:26.485029 [info ] [MainThread]: Finished running 1 external model in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m16:29:26.485328 [debug] [MainThread]: Command end result
[0m16:29:26.498160 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:29:26.498973 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:29:26.501494 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m16:29:26.501658 [info ] [MainThread]: 
[0m16:29:26.501853 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:29:26.502008 [info ] [MainThread]: 
[0m16:29:26.502198 [error] [MainThread]: [31mFailure in model ext_policy_events (models/example/ext_policy_events.sql)[0m
[0m16:29:26.502380 [error] [MainThread]:   Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:29:26.502519 [info ] [MainThread]: 
[0m16:29:26.502669 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:29:26.502912 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.4880657, "process_in_blocks": "0", "process_kernel_time": 0.953317, "process_mem_max_rss": "400277504", "process_out_blocks": "0", "process_user_time": 3.702278}
[0m16:29:26.503174 [debug] [MainThread]: Command `dbt run` failed at 16:29:26.503133 after 4.49 seconds
[0m16:29:26.503348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17264f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e2cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16fa146b0>]}
[0m16:29:26.503493 [debug] [MainThread]: Flushing usage events
[0m16:29:27.591736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:40.554831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c94860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e3c170>]}


============================== 16:31:40.556798 | 02ded01f-1ee5-4bf9-ab6e-73d76601eac5 ==============================
[0m16:31:40.556798 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:31:40.557152 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'debug': 'False', 'write_json': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --select ext_policy_events', 'version_check': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'printer_width': '80', 'empty': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'log_format': 'default'}
[0m16:31:42.729188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02ded01f-1ee5-4bf9-ab6e-73d76601eac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ded0d0>]}
[0m16:31:42.754564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02ded01f-1ee5-4bf9-ab6e-73d76601eac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b966d20>]}
[0m16:31:42.754860 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:31:42.871598 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:31:42.963621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:31:42.964047 [debug] [MainThread]: Partial parsing: added file: my_project://models/example/ext_policy_events.yml
[0m16:31:42.964275 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/ext_policy_events.sql
[0m16:31:43.111125 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m16:31:43.113527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02ded01f-1ee5-4bf9-ab6e-73d76601eac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cb0a870>]}
[0m16:31:43.154389 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:31:43.155559 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:31:43.165860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02ded01f-1ee5-4bf9-ab6e-73d76601eac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bdc45f0>]}
[0m16:31:43.166108 [info ] [MainThread]: Found 6 models, 10 data tests, 1 seed, 546 macros
[0m16:31:43.166289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02ded01f-1ee5-4bf9-ab6e-73d76601eac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15afa0530>]}
[0m16:31:43.166936 [info ] [MainThread]: 
[0m16:31:43.167131 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m16:31:43.167268 [info ] [MainThread]: 
[0m16:31:43.167508 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:31:43.167937 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m16:31:43.168141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:44.227506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m16:31:44.228339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:45.380634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02ded01f-1ee5-4bf9-ab6e-73d76601eac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cb36540>]}
[0m16:31:45.382009 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:45.443331 [debug] [Thread-1 (]: Began running node model.my_project.ext_policy_events
[0m16:31:45.443837 [info ] [Thread-1 (]: 1 of 1 START sql external model single_view_policy_assignment.ext_policy_events  [RUN]
[0m16:31:45.444154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.ext_policy_events)
[0m16:31:45.444383 [debug] [Thread-1 (]: Began compiling node model.my_project.ext_policy_events
[0m16:31:45.449208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:45.488507 [debug] [Thread-1 (]: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:31:45.489581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02ded01f-1ee5-4bf9-ab6e-73d76601eac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15bdc66f0>]}
[0m16:31:45.489940 [error] [Thread-1 (]: 1 of 1 ERROR creating sql external model single_view_policy_assignment.ext_policy_events  [[31mERROR[0m in 0.04s]
[0m16:31:45.490244 [debug] [Thread-1 (]: Finished running node model.my_project.ext_policy_events
[0m16:31:45.490493 [debug] [Thread-4 (]: Marking all children of 'model.my_project.ext_policy_events' to be skipped because of status 'error'.  Reason: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m16:31:45.491032 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:45.524115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:45.524263 [debug] [MainThread]: Connection 'model.my_project.ext_policy_events' was properly closed.
[0m16:31:45.524394 [info ] [MainThread]: 
[0m16:31:45.524561 [info ] [MainThread]: Finished running 1 external model in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m16:31:45.524844 [debug] [MainThread]: Command end result
[0m16:31:45.538252 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:31:45.539459 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:31:45.541843 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m16:31:45.542000 [info ] [MainThread]: 
[0m16:31:45.542184 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:31:45.542329 [info ] [MainThread]: 
[0m16:31:45.542529 [error] [MainThread]: [31mFailure in model ext_policy_events (models/example/ext_policy_events.sql)[0m
[0m16:31:45.542716 [error] [MainThread]:   Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:31:45.542865 [info ] [MainThread]: 
[0m16:31:45.543018 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:31:45.543282 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.022159, "process_in_blocks": "0", "process_kernel_time": 0.774351, "process_mem_max_rss": "403423232", "process_out_blocks": "0", "process_user_time": 3.930123}
[0m16:31:45.543568 [debug] [MainThread]: Command `dbt run` failed at 16:31:45.543526 after 5.02 seconds
[0m16:31:45.543748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10707c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cace4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cb36f60>]}
[0m16:31:45.543909 [debug] [MainThread]: Flushing usage events
[0m16:31:46.860258 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:32.924256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10507af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac3bf0>]}


============================== 16:32:32.925975 | 3b9069cc-f466-4539-9ea9-458b8d204d78 ==============================
[0m16:32:32.925975 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:32:32.926349 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'no_print': 'None', 'target_path': 'None', 'empty': 'None', 'write_json': 'True', 'invocation_command': 'dbt deps', 'log_cache_events': 'False', 'fail_fast': 'False', 'version_check': 'True', 'quiet': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'introspect': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'printer_width': '80', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:32:33.025718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b9069cc-f466-4539-9ea9-458b8d204d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052232f0>]}
[0m16:32:33.037946 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-abc17_53'
[0m16:32:33.038244 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:32:33.949771 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:32:33.951934 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m16:32:34.062827 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m16:32:34.074848 [info ] [MainThread]: Updating lock file in file path: /Users/pratibhagangavarapu/my_project/package-lock.yml
[0m16:32:34.094917 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-36w4lf_g'
[0m16:32:34.096343 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m16:32:34.733147 [info ] [MainThread]: Installed from version 0.10.1
[0m16:32:34.733480 [info ] [MainThread]: Updated version available: 0.11.1
[0m16:32:34.733746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3b9069cc-f466-4539-9ea9-458b8d204d78', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c74110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1f200>]}
[0m16:32:34.734025 [info ] [MainThread]: 
[0m16:32:34.734261 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_external_tables']                 
Update your versions in packages.yml, then run dbt deps
[0m16:32:34.736404 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.8438034, "process_in_blocks": "0", "process_kernel_time": 0.18457, "process_mem_max_rss": "111214592", "process_out_blocks": "0", "process_user_time": 0.756078}
[0m16:32:34.736869 [debug] [MainThread]: Command `dbt deps` succeeded at 16:32:34.736792 after 1.84 seconds
[0m16:32:34.737119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c4ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce22d0>]}
[0m16:32:34.737349 [debug] [MainThread]: Flushing usage events
[0m16:32:36.061432 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:42.799802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033c3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc7ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc45f0>]}


============================== 16:32:42.801288 | 9c7a48ac-3183-45e5-a62c-c5db435c518f ==============================
[0m16:32:42.801288 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:32:42.801645 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_cache_events': 'False', 'use_colors': 'True', 'invocation_command': 'dbt --no-version-check deps', 'partial_parse': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'static_parser': 'True', 'quiet': 'False', 'no_print': 'None', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'target_path': 'None', 'fail_fast': 'False', 'write_json': 'True', 'printer_width': '80', 'debug': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'version_check': 'False'}
[0m16:32:42.872210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c7a48ac-3183-45e5-a62c-c5db435c518f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f85f0>]}
[0m16:32:42.895173 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-bh5jxb1c'
[0m16:32:42.895445 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:32:43.013392 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:32:43.014063 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m16:32:43.110279 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m16:32:43.111662 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m16:32:43.665424 [info ] [MainThread]: Installed from version 0.10.1
[0m16:32:43.665808 [info ] [MainThread]: Updated version available: 0.11.1
[0m16:32:43.666095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9c7a48ac-3183-45e5-a62c-c5db435c518f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd0ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060235c0>]}
[0m16:32:43.666377 [info ] [MainThread]: 
[0m16:32:43.666619 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_external_tables']                 
Update your versions in packages.yml, then run dbt deps
[0m16:32:43.668145 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9003489, "process_in_blocks": "0", "process_kernel_time": 0.148749, "process_mem_max_rss": "111706112", "process_out_blocks": "0", "process_user_time": 0.721136}
[0m16:32:43.668552 [debug] [MainThread]: Command `dbt deps` succeeded at 16:32:43.668481 after 0.90 seconds
[0m16:32:43.668786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048101a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e00e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee1f70>]}
[0m16:32:43.669004 [debug] [MainThread]: Flushing usage events
[0m16:32:44.762662 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:33:35.372156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e28a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fdc4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fdc200>]}


============================== 16:33:35.373976 | 6137c792-4eae-405a-b598-09f3b0b157ac ==============================
[0m16:33:35.373976 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:33:35.374353 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_format': 'default', 'quiet': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'indirect_selection': 'eager', 'version_check': 'True', 'write_json': 'True', 'static_parser': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'debug': 'False', 'no_print': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'invocation_command': 'dbt run --select ext_policy_events'}
[0m16:33:37.380030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6137c792-4eae-405a-b598-09f3b0b157ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164dac050>]}
[0m16:33:37.405104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6137c792-4eae-405a-b598-09f3b0b157ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164d6bc80>]}
[0m16:33:37.405387 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:33:37.522689 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:33:37.621852 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 4 files added, 0 files changed.
[0m16:33:37.622153 [debug] [MainThread]: Partial parsing: added file: dbt_external_tables://macros/plugins/sqlserver/helpers/dropif.sql
[0m16:33:37.622320 [debug] [MainThread]: Partial parsing: added file: dbt_external_tables://macros/plugins/sqlserver/create_external_schema.sql
[0m16:33:37.622457 [debug] [MainThread]: Partial parsing: added file: dbt_external_tables://macros/plugins/sqlserver/create_external_table.sql
[0m16:33:37.622585 [debug] [MainThread]: Partial parsing: added file: dbt_external_tables://macros/plugins/sqlserver/get_external_build_plan.sql
[0m16:33:37.622704 [debug] [MainThread]: Partial parsing: deleted file: dbt_external_tables://macros/plugins/fabric/get_external_build_plan.sql
[0m16:33:37.622817 [debug] [MainThread]: Partial parsing: deleted file: dbt_external_tables://macros/plugins/fabric/create_external_table.sql
[0m16:33:37.622928 [debug] [MainThread]: Partial parsing: deleted file: dbt_external_tables://macros/plugins/fabric/helpers/dropif.sql
[0m16:33:37.623034 [debug] [MainThread]: Partial parsing: deleted file: dbt_external_tables://macros/plugins/fabric/create_external_schema.sql
[0m16:33:37.671076 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m16:33:37.673526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6137c792-4eae-405a-b598-09f3b0b157ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165819cd0>]}
[0m16:33:37.715161 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:33:37.716759 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:33:37.727226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6137c792-4eae-405a-b598-09f3b0b157ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165ad9550>]}
[0m16:33:37.727476 [info ] [MainThread]: Found 6 models, 10 data tests, 1 seed, 546 macros
[0m16:33:37.727651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6137c792-4eae-405a-b598-09f3b0b157ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164e57a40>]}
[0m16:33:37.728294 [info ] [MainThread]: 
[0m16:33:37.728488 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m16:33:37.728629 [info ] [MainThread]: 
[0m16:33:37.728862 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:33:37.729289 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m16:33:37.729510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:38.794854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m16:33:38.795844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:33:39.547818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6137c792-4eae-405a-b598-09f3b0b157ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090354c0>]}
[0m16:33:39.549254 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:33:39.610595 [debug] [Thread-1 (]: Began running node model.my_project.ext_policy_events
[0m16:33:39.611030 [info ] [Thread-1 (]: 1 of 1 START sql external model single_view_policy_assignment.ext_policy_events  [RUN]
[0m16:33:39.611308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.ext_policy_events)
[0m16:33:39.611520 [debug] [Thread-1 (]: Began compiling node model.my_project.ext_policy_events
[0m16:33:39.616688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:39.655791 [debug] [Thread-1 (]: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:33:39.656666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6137c792-4eae-405a-b598-09f3b0b157ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165a77ce0>]}
[0m16:33:39.656995 [error] [Thread-1 (]: 1 of 1 ERROR creating sql external model single_view_policy_assignment.ext_policy_events  [[31mERROR[0m in 0.04s]
[0m16:33:39.657280 [debug] [Thread-1 (]: Finished running node model.my_project.ext_policy_events
[0m16:33:39.657527 [debug] [Thread-4 (]: Marking all children of 'model.my_project.ext_policy_events' to be skipped because of status 'error'.  Reason: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m16:33:39.658057 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:33:39.691103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:39.691284 [debug] [MainThread]: Connection 'model.my_project.ext_policy_events' was properly closed.
[0m16:33:39.691435 [info ] [MainThread]: 
[0m16:33:39.691607 [info ] [MainThread]: Finished running 1 external model in 0 hours 0 minutes and 1.96 seconds (1.96s).
[0m16:33:39.691899 [debug] [MainThread]: Command end result
[0m16:33:39.704685 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:33:39.705377 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:33:39.707802 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m16:33:39.707958 [info ] [MainThread]: 
[0m16:33:39.708141 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:33:39.708284 [info ] [MainThread]: 
[0m16:33:39.708479 [error] [MainThread]: [31mFailure in model ext_policy_events (models/example/ext_policy_events.sql)[0m
[0m16:33:39.708659 [error] [MainThread]:   Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:33:39.708796 [info ] [MainThread]: 
[0m16:33:39.708967 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:33:39.709207 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.368428, "process_in_blocks": "0", "process_kernel_time": 0.787888, "process_mem_max_rss": "401162240", "process_out_blocks": "0", "process_user_time": 3.833793}
[0m16:33:39.709476 [debug] [MainThread]: Command `dbt run` failed at 16:33:39.709439 after 4.37 seconds
[0m16:33:39.709656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164ad60f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165a54860>]}
[0m16:33:39.709809 [debug] [MainThread]: Flushing usage events
[0m16:33:41.618854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:35:12.717581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106848500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a4080>]}


============================== 16:35:12.719549 | f9b7c330-461e-4b66-b6b6-043a7ceada7b ==============================
[0m16:35:12.719549 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:35:12.719955 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'no_print': 'None', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'static_parser': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'printer_width': '80', 'empty': 'False', 'debug': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select ext_policy_events', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'write_json': 'True', 'version_check': 'True', 'quiet': 'False'}
[0m16:35:14.913334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9b7c330-461e-4b66-b6b6-043a7ceada7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef8d1f0>]}
[0m16:35:14.938698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9b7c330-461e-4b66-b6b6-043a7ceada7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e14e60>]}
[0m16:35:14.939002 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:35:15.055750 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:35:15.128646 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'models' in "<unicode string>", line 53, column 1 in file
`models/example/schema.yml`
[0m16:35:15.128978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f9b7c330-461e-4b66-b6b6-043a7ceada7b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b6c470>]}
[0m16:35:15.150915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:35:15.151404 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/schema.yml
[0m16:35:15.151614 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/ext_policy_events.sql
[0m16:35:15.265690 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named ext_policy_events. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for ext_policy_events in one of these files:
   - models/example/ext_policy_events.yml
  models/example/schema.yml
[0m16:35:15.266078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a4440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158f09ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159d36210>]}
[0m16:35:15.266260 [debug] [MainThread]: Flushing usage events
[0m16:35:16.468176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:36:51.666584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d6a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7fbc0>]}


============================== 16:36:51.668293 | 19649302-5d26-462c-90e0-43941c09e653 ==============================
[0m16:36:51.668293 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:36:51.668652 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'printer_width': '80', 'empty': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'quiet': 'False', 'write_json': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_cache_events': 'False', 'target_path': 'None', 'warn_error': 'None', 'debug': 'False', 'introspect': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'use_colors': 'True'}
[0m16:36:51.740014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19649302-5d26-462c-90e0-43941c09e653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0bef0>]}
[0m16:36:51.766049 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.13133559, "process_in_blocks": "0", "process_kernel_time": 0.142344, "process_mem_max_rss": "107462656", "process_out_blocks": "0", "process_user_time": 0.678823}
[0m16:36:51.766371 [debug] [MainThread]: Command `dbt clean` succeeded at 16:36:51.766315 after 0.13 seconds
[0m16:36:51.766563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a85c0>]}
[0m16:36:51.766740 [debug] [MainThread]: Flushing usage events
[0m16:36:53.678973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:37:04.660485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107189670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106baa540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106babcb0>]}


============================== 16:37:04.661768 | af21fff6-4be1-4990-a08d-792bfb3185fc ==============================
[0m16:37:04.661768 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:37:04.662128 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'debug': 'False', 'write_json': 'True', 'warn_error': 'None', 'use_colors': 'True', 'no_print': 'None', 'empty': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'introspect': 'True', 'quiet': 'False', 'printer_width': '80', 'partial_parse': 'True'}
[0m16:37:04.730823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af21fff6-4be1-4990-a08d-792bfb3185fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3e600>]}
[0m16:37:04.740994 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-hs411yh7'
[0m16:37:04.741197 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:37:05.665818 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:37:05.667546 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m16:37:05.787137 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m16:37:05.793859 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m16:37:06.479830 [info ] [MainThread]: Installed from version 0.10.1
[0m16:37:06.480118 [info ] [MainThread]: Updated version available: 0.11.1
[0m16:37:06.480340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'af21fff6-4be1-4990-a08d-792bfb3185fc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ecdaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f247d0>]}
[0m16:37:06.480552 [info ] [MainThread]: 
[0m16:37:06.480726 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_external_tables']                 
Update your versions in packages.yml, then run dbt deps
[0m16:37:06.482433 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.8503947, "process_in_blocks": "0", "process_kernel_time": 0.134052, "process_mem_max_rss": "112263168", "process_out_blocks": "0", "process_user_time": 0.73829}
[0m16:37:06.482812 [debug] [MainThread]: Command `dbt deps` succeeded at 16:37:06.482745 after 1.85 seconds
[0m16:37:06.483018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076dc7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ecdac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d33f20>]}
[0m16:37:06.483205 [debug] [MainThread]: Flushing usage events
[0m16:37:07.607418 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:37:11.806026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d8c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598c260>]}


============================== 16:37:11.807283 | 2115c3ac-c071-4221-bdc8-80ce6f2eb221 ==============================
[0m16:37:11.807283 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:37:11.807623 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'invocation_command': 'dbt run --select ext_policy_events', 'debug': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'printer_width': '80', 'write_json': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_cache_events': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'fail_fast': 'False', 'log_format': 'default', 'quiet': 'False', 'empty': 'False', 'target_path': 'None'}
[0m16:37:13.794500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2115c3ac-c071-4221-bdc8-80ce6f2eb221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16156b170>]}
[0m16:37:13.819699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2115c3ac-c071-4221-bdc8-80ce6f2eb221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030f4f50>]}
[0m16:37:13.819996 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:37:13.937519 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:37:13.938024 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:37:13.938243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2115c3ac-c071-4221-bdc8-80ce6f2eb221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1603cccb0>]}
[0m16:37:14.689856 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m16:37:14.692373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2115c3ac-c071-4221-bdc8-80ce6f2eb221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1620d0140>]}
[0m16:37:14.736943 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:37:14.738134 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:37:14.746052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2115c3ac-c071-4221-bdc8-80ce6f2eb221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16203e6c0>]}
[0m16:37:14.746284 [info ] [MainThread]: Found 6 models, 10 data tests, 1 seed, 546 macros
[0m16:37:14.746450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2115c3ac-c071-4221-bdc8-80ce6f2eb221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161c280b0>]}
[0m16:37:14.747059 [info ] [MainThread]: 
[0m16:37:14.747236 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m16:37:14.747365 [info ] [MainThread]: 
[0m16:37:14.747589 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:37:14.747985 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m16:37:14.748192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:15.726987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m16:37:15.728207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:16.458244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2115c3ac-c071-4221-bdc8-80ce6f2eb221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161c55d00>]}
[0m16:37:16.458751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:16.503284 [debug] [Thread-1 (]: Began running node model.my_project.ext_policy_events
[0m16:37:16.503639 [info ] [Thread-1 (]: 1 of 1 START sql external model single_view_policy_assignment.ext_policy_events  [RUN]
[0m16:37:16.503893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.ext_policy_events)
[0m16:37:16.504078 [debug] [Thread-1 (]: Began compiling node model.my_project.ext_policy_events
[0m16:37:16.508812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:16.547103 [debug] [Thread-1 (]: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:37:16.548079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2115c3ac-c071-4221-bdc8-80ce6f2eb221', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1605be5a0>]}
[0m16:37:16.548420 [error] [Thread-1 (]: 1 of 1 ERROR creating sql external model single_view_policy_assignment.ext_policy_events  [[31mERROR[0m in 0.04s]
[0m16:37:16.548724 [debug] [Thread-1 (]: Finished running node model.my_project.ext_policy_events
[0m16:37:16.548972 [debug] [Thread-4 (]: Marking all children of 'model.my_project.ext_policy_events' to be skipped because of status 'error'.  Reason: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m16:37:16.549516 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:37:16.582949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:16.583152 [debug] [MainThread]: Connection 'model.my_project.ext_policy_events' was properly closed.
[0m16:37:16.583305 [info ] [MainThread]: 
[0m16:37:16.583477 [info ] [MainThread]: Finished running 1 external model in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m16:37:16.583772 [debug] [MainThread]: Command end result
[0m16:37:16.596372 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:37:16.597138 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:37:16.599534 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m16:37:16.599689 [info ] [MainThread]: 
[0m16:37:16.599868 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:37:16.600010 [info ] [MainThread]: 
[0m16:37:16.600200 [error] [MainThread]: [31mFailure in model ext_policy_events (models/example/ext_policy_events.sql)[0m
[0m16:37:16.600382 [error] [MainThread]:   Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:37:16.600517 [info ] [MainThread]: 
[0m16:37:16.600668 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:37:16.600894 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.8233376, "process_in_blocks": "0", "process_kernel_time": 1.058028, "process_mem_max_rss": "409092096", "process_out_blocks": "0", "process_user_time": 4.111426}
[0m16:37:16.601131 [debug] [MainThread]: Command `dbt run` failed at 16:37:16.601094 after 4.82 seconds
[0m16:37:16.601296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1611681a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047aa6c0>]}
[0m16:37:16.601443 [debug] [MainThread]: Flushing usage events
[0m16:37:17.698503 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:47.658101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c80bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10462bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104628380>]}


============================== 16:38:47.660047 | b8aa06f0-41c9-4ca6-9ce4-134f052026de ==============================
[0m16:38:47.660047 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:38:47.660420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'version_check': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'log_format': 'default', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'empty': 'None', 'indirect_selection': 'eager', 'no_print': 'None', 'invocation_command': 'dbt deps', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'static_parser': 'True', 'debug': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_colors': 'True', 'quiet': 'False'}
[0m16:38:47.734253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8aa06f0-41c9-4ca6-9ce4-134f052026de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fce8d0>]}
[0m16:38:47.745317 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-h_pdnx86'
[0m16:38:47.745592 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:38:48.696243 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:38:48.698459 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m16:38:48.807829 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m16:38:48.819721 [info ] [MainThread]: Updating lock file in file path: /Users/pratibhagangavarapu/my_project/package-lock.yml
[0m16:38:48.836621 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-ikp5twi5'
[0m16:38:48.838231 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m16:38:49.380248 [info ] [MainThread]: Installed from version 0.11.1
[0m16:38:49.380577 [info ] [MainThread]: Up to date!
[0m16:38:49.380847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b8aa06f0-41c9-4ca6-9ce4-134f052026de', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d9f40>]}
[0m16:38:49.383050 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.759393, "process_in_blocks": "0", "process_kernel_time": 0.198999, "process_mem_max_rss": "111345664", "process_out_blocks": "0", "process_user_time": 0.765045}
[0m16:38:49.383449 [debug] [MainThread]: Command `dbt deps` succeeded at 16:38:49.383382 after 1.76 seconds
[0m16:38:49.383688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058445f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fce8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10462ae10>]}
[0m16:38:49.383906 [debug] [MainThread]: Flushing usage events
[0m16:38:50.617791 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:06.521953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072566c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba3b00>]}


============================== 16:40:06.523580 | 5e59cc57-ef63-4eb4-bdfc-9ae3c5c38958 ==============================
[0m16:40:06.523580 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:40:06.523907 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'use_experimental_parser': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_cache_events': 'False', 'empty': 'None', 'printer_width': '80', 'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'introspect': 'True', 'partial_parse': 'True', 'write_json': 'True', 'debug': 'False', 'quiet': 'False', 'fail_fast': 'False'}
[0m16:40:06.652783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e59cc57-ef63-4eb4-bdfc-9ae3c5c38958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b1d60>]}
[0m16:40:06.673572 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18154183, "process_in_blocks": "0", "process_kernel_time": 0.145399, "process_mem_max_rss": "107757568", "process_out_blocks": "0", "process_user_time": 0.680854}
[0m16:40:06.673905 [debug] [MainThread]: Command `dbt clean` succeeded at 16:40:06.673841 after 0.18 seconds
[0m16:40:06.674182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2bfe0>]}
[0m16:40:06.674522 [debug] [MainThread]: Flushing usage events
[0m16:40:07.868078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:14.830350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109793fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109793f80>]}


============================== 16:40:14.831911 | 732af894-84ff-4c7f-8812-ee3cca3085c2 ==============================
[0m16:40:14.831911 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:40:14.832256 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'empty': 'None', 'version_check': 'True', 'log_format': 'default', 'introspect': 'True', 'no_print': 'None', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'log_cache_events': 'False', 'partial_parse': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'printer_width': '80', 'debug': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt deps', 'quiet': 'False', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager'}
[0m16:40:14.901764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '732af894-84ff-4c7f-8812-ee3cca3085c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10985b740>]}
[0m16:40:14.914720 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-13rvc1vg'
[0m16:40:14.914977 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:40:15.843990 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:40:15.846208 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m16:40:15.964051 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m16:40:15.969350 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m16:40:16.485429 [info ] [MainThread]: Installed from version 0.11.1
[0m16:40:16.485795 [info ] [MainThread]: Up to date!
[0m16:40:16.486073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '732af894-84ff-4c7f-8812-ee3cca3085c2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109015bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109749160>]}
[0m16:40:16.487695 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.691202, "process_in_blocks": "0", "process_kernel_time": 0.148257, "process_mem_max_rss": "112443392", "process_out_blocks": "0", "process_user_time": 0.74816}
[0m16:40:16.488118 [debug] [MainThread]: Command `dbt deps` succeeded at 16:40:16.488048 after 1.69 seconds
[0m16:40:16.488359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109749280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109749160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109015bb0>]}
[0m16:40:16.488590 [debug] [MainThread]: Flushing usage events
[0m16:40:17.577316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:25.947786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10944b8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd04d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd0140>]}


============================== 16:40:25.949231 | 7e0110a6-b448-48e4-9ecc-a87d0874fa28 ==============================
[0m16:40:25.949231 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:40:25.949567 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select ext_policy_events', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'partial_parse': 'True', 'version_check': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_format': 'default', 'fail_fast': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'no_print': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'warn_error': 'None'}
[0m16:40:28.079131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e0110a6-b448-48e4-9ecc-a87d0874fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d9e77d0>]}
[0m16:40:28.104502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e0110a6-b448-48e4-9ecc-a87d0874fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca91c0>]}
[0m16:40:28.104801 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:40:28.223458 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:40:28.224033 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:40:28.224274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e0110a6-b448-48e4-9ecc-a87d0874fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b25940>]}
[0m16:40:28.990271 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m16:40:28.992778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e0110a6-b448-48e4-9ecc-a87d0874fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ecb1070>]}
[0m16:40:29.037594 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:40:29.038867 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:40:29.049823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e0110a6-b448-48e4-9ecc-a87d0874fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ec69e50>]}
[0m16:40:29.050068 [info ] [MainThread]: Found 6 models, 10 data tests, 1 seed, 546 macros
[0m16:40:29.050240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e0110a6-b448-48e4-9ecc-a87d0874fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ec46660>]}
[0m16:40:29.050877 [info ] [MainThread]: 
[0m16:40:29.051051 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m16:40:29.051180 [info ] [MainThread]: 
[0m16:40:29.051410 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:40:29.051817 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m16:40:29.052017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:30.137123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m16:40:30.137882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:30.883345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e0110a6-b448-48e4-9ecc-a87d0874fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d29520>]}
[0m16:40:30.884869 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:30.950501 [debug] [Thread-1 (]: Began running node model.my_project.ext_policy_events
[0m16:40:30.951124 [info ] [Thread-1 (]: 1 of 1 START sql external model single_view_policy_assignment.ext_policy_events  [RUN]
[0m16:40:30.951488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.ext_policy_events)
[0m16:40:30.951739 [debug] [Thread-1 (]: Began compiling node model.my_project.ext_policy_events
[0m16:40:30.957937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:30.997132 [debug] [Thread-1 (]: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:40:30.998072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e0110a6-b448-48e4-9ecc-a87d0874fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af1040>]}
[0m16:40:30.998395 [error] [Thread-1 (]: 1 of 1 ERROR creating sql external model single_view_policy_assignment.ext_policy_events  [[31mERROR[0m in 0.05s]
[0m16:40:30.998677 [debug] [Thread-1 (]: Finished running node model.my_project.ext_policy_events
[0m16:40:30.998927 [debug] [Thread-4 (]: Marking all children of 'model.my_project.ext_policy_events' to be skipped because of status 'error'.  Reason: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m16:40:30.999466 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:31.032545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:31.032736 [debug] [MainThread]: Connection 'model.my_project.ext_policy_events' was properly closed.
[0m16:40:31.032892 [info ] [MainThread]: 
[0m16:40:31.033049 [info ] [MainThread]: Finished running 1 external model in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m16:40:31.033337 [debug] [MainThread]: Command end result
[0m16:40:31.045882 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:40:31.046674 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:40:31.049072 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m16:40:31.049222 [info ] [MainThread]: 
[0m16:40:31.049412 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:40:31.049557 [info ] [MainThread]: 
[0m16:40:31.049737 [error] [MainThread]: [31mFailure in model ext_policy_events (models/example/ext_policy_events.sql)[0m
[0m16:40:31.049909 [error] [MainThread]:   Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:40:31.050041 [info ] [MainThread]: 
[0m16:40:31.050189 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:40:31.050420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.1324873, "process_in_blocks": "0", "process_kernel_time": 1.097238, "process_mem_max_rss": "402735104", "process_out_blocks": "0", "process_user_time": 4.13039}
[0m16:40:31.050708 [debug] [MainThread]: Command `dbt run` failed at 16:40:31.050666 after 5.13 seconds
[0m16:40:31.050869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109174c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10944b8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ed010>]}
[0m16:40:31.051033 [debug] [MainThread]: Flushing usage events
[0m16:40:32.308923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:41:35.129590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113109a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c60470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c601d0>]}


============================== 16:41:35.131660 | 71f0ed05-a00b-4a05-8a27-0c4958dd4b71 ==============================
[0m16:41:35.131660 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:41:35.132022 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'target_path': 'None', 'write_json': 'True', 'no_print': 'None', 'empty': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'partial_parse': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run --select ext_policy_events', 'introspect': 'True', 'static_parser': 'True', 'quiet': 'False', 'debug': 'False', 'log_format': 'default'}
[0m16:41:37.111144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71f0ed05-a00b-4a05-8a27-0c4958dd4b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f0d41a0>]}
[0m16:41:37.136127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71f0ed05-a00b-4a05-8a27-0c4958dd4b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107921160>]}
[0m16:41:37.136426 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:41:37.251610 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:41:37.341441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:41:37.341830 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/ext_policy_events.yml
[0m16:41:37.342006 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/ext_policy_events.sql
[0m16:41:37.486107 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m16:41:37.488448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71f0ed05-a00b-4a05-8a27-0c4958dd4b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f75b0b0>]}
[0m16:41:37.529857 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:41:37.531038 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:41:37.541359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71f0ed05-a00b-4a05-8a27-0c4958dd4b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b18ce30>]}
[0m16:41:37.541609 [info ] [MainThread]: Found 6 models, 10 data tests, 1 seed, 546 macros
[0m16:41:37.541791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71f0ed05-a00b-4a05-8a27-0c4958dd4b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16e4739b0>]}
[0m16:41:37.542432 [info ] [MainThread]: 
[0m16:41:37.542625 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m16:41:37.542757 [info ] [MainThread]: 
[0m16:41:37.543009 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:41:37.543457 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m16:41:37.543664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:38.505259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m16:41:38.505926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:39.218948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71f0ed05-a00b-4a05-8a27-0c4958dd4b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1700baff0>]}
[0m16:41:39.219399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:41:39.268303 [debug] [Thread-1 (]: Began running node model.my_project.ext_policy_events
[0m16:41:39.268606 [info ] [Thread-1 (]: 1 of 1 START sql external model single_view_policy_assignment.ext_policy_events  [RUN]
[0m16:41:39.268837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.ext_policy_events)
[0m16:41:39.269016 [debug] [Thread-1 (]: Began compiling node model.my_project.ext_policy_events
[0m16:41:39.273580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:39.312000 [debug] [Thread-1 (]: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:41:39.312912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f0ed05-a00b-4a05-8a27-0c4958dd4b71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x170030830>]}
[0m16:41:39.313226 [error] [Thread-1 (]: 1 of 1 ERROR creating sql external model single_view_policy_assignment.ext_policy_events  [[31mERROR[0m in 0.04s]
[0m16:41:39.313518 [debug] [Thread-1 (]: Finished running node model.my_project.ext_policy_events
[0m16:41:39.313770 [debug] [Thread-4 (]: Marking all children of 'model.my_project.ext_policy_events' to be skipped because of status 'error'.  Reason: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m16:41:39.314308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:41:39.347168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:39.347330 [debug] [MainThread]: Connection 'model.my_project.ext_policy_events' was properly closed.
[0m16:41:39.347490 [info ] [MainThread]: 
[0m16:41:39.347647 [info ] [MainThread]: Finished running 1 external model in 0 hours 0 minutes and 1.80 seconds (1.80s).
[0m16:41:39.347938 [debug] [MainThread]: Command end result
[0m16:41:39.361056 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:41:39.361827 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:41:39.364198 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m16:41:39.364359 [info ] [MainThread]: 
[0m16:41:39.364541 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:41:39.364693 [info ] [MainThread]: 
[0m16:41:39.364883 [error] [MainThread]: [31mFailure in model ext_policy_events (models/example/ext_policy_events.sql)[0m
[0m16:41:39.365065 [error] [MainThread]:   Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  'external_config' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:41:39.365202 [info ] [MainThread]: 
[0m16:41:39.365352 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:41:39.365594 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.2691636, "process_in_blocks": "0", "process_kernel_time": 1.039927, "process_mem_max_rss": "401014784", "process_out_blocks": "0", "process_user_time": 3.650727}
[0m16:41:39.365858 [debug] [MainThread]: Command `dbt run` failed at 16:41:39.365822 after 4.27 seconds
[0m16:41:39.366017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f70bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f64afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f7ce810>]}
[0m16:41:39.366164 [debug] [MainThread]: Flushing usage events
[0m16:41:40.626939 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:03.935654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df2a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700fe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700ff80>]}


============================== 16:43:03.937380 | ab95224c-5c55-4e9b-ad36-7fc8725b3b5c ==============================
[0m16:43:03.937380 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:43:03.937742 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'write_json': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'introspect': 'True', 'version_check': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'target_path': 'None', 'use_colors': 'True', 'empty': 'None', 'no_print': 'None', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'printer_width': '80', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'debug': 'False', 'invocation_command': 'dbt clean', 'warn_error': 'None'}
[0m16:43:04.064805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab95224c-5c55-4e9b-ad36-7fc8725b3b5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e8f2f0>]}
[0m16:43:04.085354 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18121654, "process_in_blocks": "0", "process_kernel_time": 0.148373, "process_mem_max_rss": "107626496", "process_out_blocks": "0", "process_user_time": 0.678787}
[0m16:43:04.085721 [debug] [MainThread]: Command `dbt clean` succeeded at 16:43:04.085657 after 0.18 seconds
[0m16:43:04.085933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700fec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579b980>]}
[0m16:43:04.086126 [debug] [MainThread]: Flushing usage events
[0m16:43:05.214796 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:12.172767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a8e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108303ec0>]}


============================== 16:43:12.174343 | 948bfd2b-bcf3-4bd0-ba14-61c23ad33eac ==============================
[0m16:43:12.174343 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:43:12.174707 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'printer_width': '80', 'write_json': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'quiet': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'target_path': 'None', 'version_check': 'True', 'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'no_print': 'None', 'warn_error': 'None', 'empty': 'None'}
[0m16:43:12.243357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '948bfd2b-bcf3-4bd0-ba14-61c23ad33eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d34a0>]}
[0m16:43:12.255594 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-ewao81r_'
[0m16:43:12.255874 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:43:13.877444 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:43:13.879217 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m16:43:13.989109 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m16:43:14.001561 [info ] [MainThread]: Updating lock file in file path: /Users/pratibhagangavarapu/my_project/package-lock.yml
[0m16:43:14.004555 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-hy1wnz4e'
[0m16:43:14.006685 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m16:43:14.545807 [info ] [MainThread]: Installed from version 0.11.1
[0m16:43:14.546135 [info ] [MainThread]: Up to date!
[0m16:43:14.546407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '948bfd2b-bcf3-4bd0-ba14-61c23ad33eac', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108423cb0>]}
[0m16:43:14.548005 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.4061236, "process_in_blocks": "0", "process_kernel_time": 0.145884, "process_mem_max_rss": "112443392", "process_out_blocks": "0", "process_user_time": 0.751956}
[0m16:43:14.548424 [debug] [MainThread]: Command `dbt deps` succeeded at 16:43:14.548361 after 2.41 seconds
[0m16:43:14.548665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d34a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106586fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108303fe0>]}
[0m16:43:14.548884 [debug] [MainThread]: Flushing usage events
[0m16:43:15.777965 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:46:45.061625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105449100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce4590>]}


============================== 16:46:45.063756 | 9a34efe9-811f-4ea6-8318-dad0b6d1d9bc ==============================
[0m16:46:45.063756 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:46:45.064114 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'introspect': 'True', 'log_format': 'default', 'fail_fast': 'False', 'write_json': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'no_print': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'warn_error': 'None', 'static_parser': 'True', 'printer_width': '80', 'target_path': 'None', 'use_colors': 'True', 'empty': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True'}
[0m16:46:45.196324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a34efe9-811f-4ea6-8318-dad0b6d1d9bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f330e0>]}
[0m16:46:45.208756 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-8_rx2yfa'
[0m16:46:45.209047 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:46:46.383377 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:46:46.385539 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m16:46:46.489987 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m16:46:46.505686 [info ] [MainThread]: Updating lock file in file path: /Users/pratibhagangavarapu/my_project/package-lock.yml
[0m16:46:46.508407 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-sn7pqjle'
[0m16:46:46.510522 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m16:46:47.885346 [info ] [MainThread]: Installed from version 0.11.1
[0m16:46:47.885679 [info ] [MainThread]: Up to date!
[0m16:46:47.885943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9a34efe9-811f-4ea6-8318-dad0b6d1d9bc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107feb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe8dd0>]}
[0m16:46:47.888144 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.8605583, "process_in_blocks": "0", "process_kernel_time": 0.188329, "process_mem_max_rss": "111984640", "process_out_blocks": "0", "process_user_time": 0.756089}
[0m16:46:47.888587 [debug] [MainThread]: Command `dbt deps` succeeded at 16:46:47.888513 after 2.86 seconds
[0m16:46:47.888835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce4590>]}
[0m16:46:47.889052 [debug] [MainThread]: Flushing usage events
[0m16:46:49.744810 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:18.121943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10859cb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090fc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090fc080>]}


============================== 16:53:18.124226 | c2622b19-1e2a-4537-a41f-9fa9d25e4b51 ==============================
[0m16:53:18.124226 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:53:18.124635 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'printer_width': '80', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'no_print': 'None', 'static_parser': 'True', 'debug': 'False', 'invocation_command': 'dbt run --select ext_policy_events', 'target_path': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False'}
[0m16:53:20.297091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2622b19-1e2a-4537-a41f-9fa9d25e4b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164db3200>]}
[0m16:53:20.322421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2622b19-1e2a-4537-a41f-9fa9d25e4b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164226d20>]}
[0m16:53:20.322714 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:53:20.439282 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:53:20.439759 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:53:20.439981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c2622b19-1e2a-4537-a41f-9fa9d25e4b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164e61d90>]}
[0m16:53:21.190083 [error] [MainThread]: Encountered an error:
Cannot serialize Undefined
[0m16:53:21.194186 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/manifest.py", line 513, in load
    self.write_manifest_for_partial_parse()
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/manifest.py", line 821, in write_manifest_for_partial_parse
    manifest_msgpack = self.manifest.to_msgpack(extended_mashumaro_encoder)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 3, in __mashumaro_to_msgpack__
  File "<string>", line 91, in __mashumaro_to_msgpack__
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/manifest.py", line 136, in extended_mashumaro_encoder
    return msgpack.packb(data, default=extended_msgpack_encoder, use_bin_type=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/__init__.py", line 35, in packb
    return Packer(**kwargs).pack(o)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 885, in pack
    self._pack(obj)
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 864, in _pack
    return self._pack_map_pairs(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 970, in _pack_map_pairs
    self._pack(v, nest_limit - 1)
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 864, in _pack
    return self._pack_map_pairs(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 970, in _pack_map_pairs
    self._pack(v, nest_limit - 1)
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 864, in _pack
    return self._pack_map_pairs(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 970, in _pack_map_pairs
    self._pack(v, nest_limit - 1)
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 864, in _pack
    return self._pack_map_pairs(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 970, in _pack_map_pairs
    self._pack(v, nest_limit - 1)
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 881, in _pack
    raise TypeError("Cannot serialize %r" % (obj,))
TypeError: Cannot serialize Undefined

[0m16:53:21.194750 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1207101, "process_in_blocks": "0", "process_kernel_time": 0.857323, "process_mem_max_rss": "398393344", "process_out_blocks": "0", "process_user_time": 4.031944}
[0m16:53:21.195016 [debug] [MainThread]: Command `dbt run` failed at 16:53:21.194971 after 3.12 seconds
[0m16:53:21.195202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090d01d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16595aab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16595b800>]}
[0m16:53:21.195361 [debug] [MainThread]: Flushing usage events
[0m16:53:22.419354 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:56:47.850209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107100e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aabd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aabc80>]}


============================== 18:56:47.852252 | ba2fc89d-093a-4839-b9e1-2efcc31236e3 ==============================
[0m18:56:47.852252 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:56:47.852633 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'invocation_command': 'dbt clean', 'use_experimental_parser': 'False', 'use_colors': 'True', 'static_parser': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'empty': 'None', 'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'version_check': 'True', 'target_path': 'None', 'warn_error': 'None', 'quiet': 'False', 'printer_width': '80', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs'}
[0m18:56:47.984611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba2fc89d-093a-4839-b9e1-2efcc31236e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccb4a0>]}
[0m18:56:48.008465 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19106887, "process_in_blocks": "0", "process_kernel_time": 0.165653, "process_mem_max_rss": "107659264", "process_out_blocks": "0", "process_user_time": 0.683472}
[0m18:56:48.008779 [debug] [MainThread]: Command `dbt clean` succeeded at 18:56:48.008726 after 0.19 seconds
[0m18:56:48.008956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c3bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c5c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744e540>]}
[0m18:56:48.009115 [debug] [MainThread]: Flushing usage events
[0m18:56:49.955040 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:56:54.298830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d63bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a2d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a2efc0>]}


============================== 18:56:54.300061 | 16e7fa4f-c66d-49e2-a536-ca72e8dbf85b ==============================
[0m18:56:54.300061 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:56:54.300417 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'use_experimental_parser': 'False', 'write_json': 'True', 'introspect': 'True', 'quiet': 'False', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'no_print': 'None', 'empty': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'printer_width': '80', 'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'debug': 'False'}
[0m18:56:54.368077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16e7fa4f-c66d-49e2-a536-ca72e8dbf85b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c735c0>]}
[0m18:56:54.378250 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-6ymuccpd'
[0m18:56:54.378446 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:56:54.568825 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:56:54.570153 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m18:56:54.930897 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m18:56:54.935418 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m18:56:55.468193 [info ] [MainThread]: Installed from version 0.11.1
[0m18:56:55.468573 [info ] [MainThread]: Up to date!
[0m18:56:55.468832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '16e7fa4f-c66d-49e2-a536-ca72e8dbf85b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c72a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da40b0>]}
[0m18:56:55.470370 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.1995587, "process_in_blocks": "0", "process_kernel_time": 0.138112, "process_mem_max_rss": "113426432", "process_out_blocks": "0", "process_user_time": 0.732867}
[0m18:56:55.470816 [debug] [MainThread]: Command `dbt deps` succeeded at 18:56:55.470737 after 1.20 seconds
[0m18:56:55.471073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fbb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c73620>]}
[0m18:56:55.471287 [debug] [MainThread]: Flushing usage events
[0m18:56:56.632470 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:43.925712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108338320>]}


============================== 18:57:43.927551 | a4a4a619-6ab1-45b7-ba85-ab8b39f2a530 ==============================
[0m18:57:43.927551 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:57:43.927904 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'introspect': 'True', 'printer_width': '80', 'invocation_command': 'dbt run -d', 'debug': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'empty': 'False', 'quiet': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'target_path': 'None', 'partial_parse': 'True', 'no_print': 'None'}
[0m18:57:46.080553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4a4a619-6ab1-45b7-ba85-ab8b39f2a530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a866600>]}
[0m18:57:46.107626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4a4a619-6ab1-45b7-ba85-ab8b39f2a530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8cb60>]}
[0m18:57:46.108009 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m18:57:46.226410 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:57:46.226987 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:57:46.227201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a4a4a619-6ab1-45b7-ba85-ab8b39f2a530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c1850>]}
[0m18:57:46.981571 [error] [MainThread]: Encountered an error:
Cannot serialize Undefined
[0m18:57:46.986807 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/manifest.py", line 513, in load
    self.write_manifest_for_partial_parse()
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/manifest.py", line 821, in write_manifest_for_partial_parse
    manifest_msgpack = self.manifest.to_msgpack(extended_mashumaro_encoder)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 3, in __mashumaro_to_msgpack__
  File "<string>", line 91, in __mashumaro_to_msgpack__
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/manifest.py", line 136, in extended_mashumaro_encoder
    return msgpack.packb(data, default=extended_msgpack_encoder, use_bin_type=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/__init__.py", line 35, in packb
    return Packer(**kwargs).pack(o)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 885, in pack
    self._pack(obj)
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 864, in _pack
    return self._pack_map_pairs(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 970, in _pack_map_pairs
    self._pack(v, nest_limit - 1)
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 864, in _pack
    return self._pack_map_pairs(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 970, in _pack_map_pairs
    self._pack(v, nest_limit - 1)
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 864, in _pack
    return self._pack_map_pairs(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 970, in _pack_map_pairs
    self._pack(v, nest_limit - 1)
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 864, in _pack
    return self._pack_map_pairs(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 970, in _pack_map_pairs
    self._pack(v, nest_limit - 1)
  File "/opt/anaconda3/lib/python3.12/site-packages/msgpack/fallback.py", line 881, in _pack
    raise TypeError("Cannot serialize %r" % (obj,))
TypeError: Cannot serialize Undefined

[0m18:57:46.987575 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0946195, "process_in_blocks": "0", "process_kernel_time": 0.961678, "process_mem_max_rss": "405078016", "process_out_blocks": "0", "process_user_time": 3.924453}
[0m18:57:46.987955 [debug] [MainThread]: Command `dbt run` failed at 18:57:46.987904 after 3.10 seconds
[0m18:57:46.988186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eec320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a81dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b55aa20>]}
[0m18:57:46.988394 [debug] [MainThread]: Flushing usage events
[0m18:57:48.109624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:19.943813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d74a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3ba70>]}


============================== 19:04:19.945937 | 106851ee-fa76-428a-87b7-a79be3a5f507 ==============================
[0m19:04:19.945937 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:04:19.946324 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'target_path': 'None', 'debug': 'False', 'use_colors': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'partial_parse': 'True', 'introspect': 'True', 'static_parser': 'True', 'empty': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'invocation_command': 'dbt clean', 'quiet': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'indirect_selection': 'eager'}
[0m19:04:20.076651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '106851ee-fa76-428a-87b7-a79be3a5f507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c55d60>]}
[0m19:04:20.100446 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18911858, "process_in_blocks": "0", "process_kernel_time": 0.158833, "process_mem_max_rss": "108740608", "process_out_blocks": "0", "process_user_time": 0.683489}
[0m19:04:20.100760 [debug] [MainThread]: Command `dbt clean` succeeded at 19:04:20.100711 after 0.19 seconds
[0m19:04:20.100956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a38320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107caa330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3b3e0>]}
[0m19:04:20.101130 [debug] [MainThread]: Flushing usage events
[0m19:04:21.273253 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:39.982946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab2ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b03e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b0050>]}


============================== 19:04:39.984579 | 8d2fed7d-efce-40d7-b021-5cef29e6376e ==============================
[0m19:04:39.984579 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:04:39.984908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'fail_fast': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'introspect': 'True', 'quiet': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'version_check': 'True', 'log_cache_events': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'invocation_command': 'dbt run', 'write_json': 'True', 'target_path': 'None', 'no_print': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:04:42.115154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d2fed7d-efce-40d7-b021-5cef29e6376e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149d277d0>]}
[0m19:04:42.141551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d2fed7d-efce-40d7-b021-5cef29e6376e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10768a6f0>]}
[0m19:04:42.141907 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:04:42.253858 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:04:42.254385 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.302725, "process_in_blocks": "0", "process_kernel_time": 0.788782, "process_mem_max_rss": "383598592", "process_out_blocks": "0", "process_user_time": 3.31724}
[0m19:04:42.254700 [debug] [MainThread]: Command `dbt run` failed at 19:04:42.254646 after 2.30 seconds
[0m19:04:42.254946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b0230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106563110>]}
[0m19:04:42.255176 [debug] [MainThread]: Flushing usage events
[0m19:04:43.354778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:04:53.814422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d07b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864bb30>]}


============================== 19:04:53.815679 | 4f719f92-e238-459c-8668-5b17c8b35ea2 ==============================
[0m19:04:53.815679 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:04:53.816042 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'introspect': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error': 'None', 'printer_width': '80', 'quiet': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'no_print': 'None', 'log_format': 'default', 'debug': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:04:53.884628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f719f92-e238-459c-8668-5b17c8b35ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098975c0>]}
[0m19:04:53.898036 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-ozks2ctf'
[0m19:04:53.898266 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:04:54.094669 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:04:54.095969 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json
[0m19:04:54.205597 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_external_tables.json 200
[0m19:04:54.208001 [info ] [MainThread]: Installing dbt-labs/dbt_external_tables
[0m19:04:55.500900 [info ] [MainThread]: Installed from version 0.11.1
[0m19:04:55.501264 [info ] [MainThread]: Up to date!
[0m19:04:55.501525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4f719f92-e238-459c-8668-5b17c8b35ea2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098e58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c8140>]}
[0m19:04:55.502882 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.7168417, "process_in_blocks": "0", "process_kernel_time": 0.142153, "process_mem_max_rss": "112558080", "process_out_blocks": "0", "process_user_time": 0.732958}
[0m19:04:55.503285 [debug] [MainThread]: Command `dbt deps` succeeded at 19:04:55.503216 after 1.72 seconds
[0m19:04:55.503524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c27e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109897b60>]}
[0m19:04:55.503741 [debug] [MainThread]: Flushing usage events
[0m19:04:56.602676 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:05:00.836331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a8ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055bfef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055bff20>]}


============================== 19:05:00.837749 | e3d1aa60-994b-44ed-8516-a5845c4cf977 ==============================
[0m19:05:00.837749 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:05:00.838120 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'debug': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'quiet': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'log_cache_events': 'False', 'introspect': 'True', 'version_check': 'True', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'target_path': 'None'}
[0m19:05:02.794433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3d1aa60-994b-44ed-8516-a5845c4cf977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f508a40>]}
[0m19:05:02.819937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3d1aa60-994b-44ed-8516-a5845c4cf977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e3e630>]}
[0m19:05:02.820234 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:05:02.937143 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:05:02.937664 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:05:02.937879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e3d1aa60-994b-44ed-8516-a5845c4cf977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f693530>]}
[0m19:05:03.701298 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m19:05:03.703808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3d1aa60-994b-44ed-8516-a5845c4cf977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150ca09e0>]}
[0m19:05:03.748694 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:05:03.750027 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:05:03.761396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3d1aa60-994b-44ed-8516-a5845c4cf977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150c28260>]}
[0m19:05:03.761648 [info ] [MainThread]: Found 6 models, 10 data tests, 1 seed, 546 macros
[0m19:05:03.761818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3d1aa60-994b-44ed-8516-a5845c4cf977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150c175c0>]}
[0m19:05:03.762641 [info ] [MainThread]: 
[0m19:05:03.762824 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m19:05:03.762953 [info ] [MainThread]: 
[0m19:05:03.763176 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:05:03.764934 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m19:05:03.765131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:04.842867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m19:05:04.844168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:05.703056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3d1aa60-994b-44ed-8516-a5845c4cf977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150c28b60>]}
[0m19:05:05.704006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:05:05.762950 [debug] [Thread-1 (]: Began running node model.my_project.ext_policy_events
[0m19:05:05.763330 [info ] [Thread-1 (]: 1 of 6 START sql external model single_view_policy_assignment.ext_policy_events  [RUN]
[0m19:05:05.763612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.ext_policy_events)
[0m19:05:05.763832 [debug] [Thread-1 (]: Began compiling node model.my_project.ext_policy_events
[0m19:05:05.768944 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.ext_policy_events"
[0m19:05:05.769491 [debug] [Thread-1 (]: Began executing node model.my_project.ext_policy_events
[0m19:05:05.770546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:05.806892 [debug] [Thread-1 (]: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  No materialization 'external' was found for adapter bigquery! (searched types 'default' and 'bigquery')
[0m19:05:05.807864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3d1aa60-994b-44ed-8516-a5845c4cf977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044086b0>]}
[0m19:05:05.808183 [error] [Thread-1 (]: 1 of 6 ERROR creating sql external model single_view_policy_assignment.ext_policy_events  [[31mERROR[0m in 0.04s]
[0m19:05:05.808485 [debug] [Thread-1 (]: Finished running node model.my_project.ext_policy_events
[0m19:05:05.808683 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m19:05:05.808910 [debug] [Thread-4 (]: Marking all children of 'model.my_project.ext_policy_events' to be skipped because of status 'error'.  Reason: Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  No materialization 'external' was found for adapter bigquery! (searched types 'default' and 'bigquery').
[0m19:05:05.809146 [info ] [Thread-1 (]: 2 of 6 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m19:05:05.809444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.ext_policy_events, now model.my_project.stg_policy_events)
[0m19:05:05.809612 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m19:05:05.811262 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m19:05:05.811571 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m19:05:05.831982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:06.587490 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m19:05:06.589124 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events` as DBT_INTERNAL_DEST
        using (

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  WHERE policy_id IS NOT NULL
    AND event_type IS NOT NULL
    AND event_timestamp IS NOT NULL
)

SELECT
  *,
  CAST(event_timestamp AS TIMESTAMP) AS event_ts,
  CAST(premium_amount AS FLOAT64) AS premium_amount,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.policy_id = DBT_INTERNAL_DEST.policy_id
                ) and (
                    DBT_INTERNAL_SOURCE.event_type = DBT_INTERNAL_DEST.event_type
                ) and (
                    DBT_INTERNAL_SOURCE.product_type = DBT_INTERNAL_DEST.product_type
                )

    
    when matched then update set
        `policy_id` = DBT_INTERNAL_SOURCE.`policy_id`,`event_type` = DBT_INTERNAL_SOURCE.`event_type`,`event_ts` = DBT_INTERNAL_SOURCE.`event_ts`,`event_month` = DBT_INTERNAL_SOURCE.`event_month`
    

    when not matched then insert
        (`policy_id`, `event_type`, `event_ts`, `event_month`)
    values
        (`policy_id`, `event_type`, `event_ts`, `event_month`)


    
[0m19:05:07.252615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:f4e1bd1d-6f45-4aef-ae26-9cffc2dafad7&page=queryresults
[0m19:05:07.253842 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:f4e1bd1d-6f45-4aef-ae26-9cffc2dafad7&page=queryresults
[0m19:05:07.264976 [debug] [Thread-1 (]: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Not found: Table horizontal-ray-467611-f9:single_view_policy_assignment.policy_events was not found in location australia-southeast1
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m19:05:07.265693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3d1aa60-994b-44ed-8516-a5845c4cf977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150c298e0>]}
[0m19:05:07.266454 [error] [Thread-1 (]: 2 of 6 ERROR creating sql incremental model single_view_policy_assignment.stg_policy_events  [[31mERROR[0m in 1.46s]
[0m19:05:07.267112 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m19:05:07.267737 [debug] [Thread-4 (]: Marking all children of 'model.my_project.stg_policy_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Not found: Table horizontal-ray-467611-f9:single_view_policy_assignment.policy_events was not found in location australia-southeast1
  compiled code at target/run/my_project/models/example/stg_policy_events.sql.
[0m19:05:07.268629 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m19:05:07.269213 [info ] [Thread-1 (]: 3 of 6 SKIP relation single_view_policy_assignment.policy_lifecycle_enriched ... [[33mSKIP[0m]
[0m19:05:07.269690 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m19:05:07.270233 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:05:07.270668 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m19:05:07.271076 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:05:07.271417 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m19:05:07.271799 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m19:05:07.272286 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m19:05:07.272862 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m19:05:07.273319 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m19:05:07.273708 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m19:05:07.274552 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:05:07.320914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:07.321133 [debug] [MainThread]: Connection 'model.my_project.stg_policy_events' was properly closed.
[0m19:05:07.321343 [info ] [MainThread]: 
[0m19:05:07.321523 [info ] [MainThread]: Finished running 1 external model, 1 incremental model, 1 table model, 3 view models in 0 hours 0 minutes and 3.56 seconds (3.56s).
[0m19:05:07.321981 [debug] [MainThread]: Command end result
[0m19:05:07.337343 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:05:07.338154 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:05:07.341099 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m19:05:07.341259 [info ] [MainThread]: 
[0m19:05:07.341434 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:05:07.341572 [info ] [MainThread]: 
[0m19:05:07.341752 [error] [MainThread]: [31mFailure in model ext_policy_events (models/example/ext_policy_events.sql)[0m
[0m19:05:07.341928 [error] [MainThread]:   Compilation Error in model ext_policy_events (models/example/ext_policy_events.sql)
  No materialization 'external' was found for adapter bigquery! (searched types 'default' and 'bigquery')
[0m19:05:07.342056 [info ] [MainThread]: 
[0m19:05:07.342207 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/ext_policy_events.sql
[0m19:05:07.342335 [info ] [MainThread]: 
[0m19:05:07.342486 [error] [MainThread]: [31mFailure in model stg_policy_events (models/example/stg_policy_events.sql)[0m
[0m19:05:07.342647 [error] [MainThread]:   Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Not found: Table horizontal-ray-467611-f9:single_view_policy_assignment.policy_events was not found in location australia-southeast1
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m19:05:07.342773 [info ] [MainThread]: 
[0m19:05:07.342918 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/stg_policy_events.sql
[0m19:05:07.343041 [info ] [MainThread]: 
[0m19:05:07.343192 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=4 NO-OP=0 TOTAL=6
[0m19:05:07.343422 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.541114, "process_in_blocks": "0", "process_kernel_time": 0.801949, "process_mem_max_rss": "406765568", "process_out_blocks": "0", "process_user_time": 4.600001}
[0m19:05:07.343674 [debug] [MainThread]: Command `dbt run` failed at 19:05:07.343634 after 6.54 seconds
[0m19:05:07.343844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fae1e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150c15160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150c16180>]}
[0m19:05:07.343998 [debug] [MainThread]: Flushing usage events
[0m19:05:08.452129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:30:59.729477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058cdcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd9760>]}


============================== 19:30:59.731362 | 6df3ab1d-de74-4b0c-b43e-d6d9f0cc2ee9 ==============================
[0m19:30:59.731362 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:30:59.731755 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt clean', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'printer_width': '80', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'use_experimental_parser': 'False', 'log_format': 'default', 'empty': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'partial_parse': 'True', 'introspect': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True'}
[0m19:30:59.864021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6df3ab1d-de74-4b0c-b43e-d6d9f0cc2ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10927b6e0>]}
[0m19:30:59.891147 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19570458, "process_in_blocks": "0", "process_kernel_time": 0.155016, "process_mem_max_rss": "107036672", "process_out_blocks": "0", "process_user_time": 0.691006}
[0m19:30:59.891481 [debug] [MainThread]: Command `dbt clean` succeeded at 19:30:59.891428 after 0.20 seconds
[0m19:30:59.891679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10916bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ffd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f95e0>]}
[0m19:30:59.891860 [debug] [MainThread]: Flushing usage events
[0m19:31:01.171881 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:31:07.425850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e2f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053dc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053dc0e0>]}


============================== 19:31:07.427108 | ad61fb76-b3f9-411b-8562-8c4cd78e94c0 ==============================
[0m19:31:07.427108 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:31:07.427467 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'use_colors': 'True', 'printer_width': '80', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'target_path': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'quiet': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'write_json': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'empty': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True'}
[0m19:31:09.543154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad61fb76-b3f9-411b-8562-8c4cd78e94c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032bb0e0>]}
[0m19:31:09.568437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad61fb76-b3f9-411b-8562-8c4cd78e94c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1585d2ab0>]}
[0m19:31:09.568739 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:31:09.680113 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:31:09.680614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2831223, "process_in_blocks": "0", "process_kernel_time": 0.691929, "process_mem_max_rss": "389365760", "process_out_blocks": "0", "process_user_time": 3.387158}
[0m19:31:09.680936 [debug] [MainThread]: Command `dbt run` failed at 19:31:09.680879 after 2.28 seconds
[0m19:31:09.681190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10418b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158089700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158a65d30>]}
[0m19:31:09.681386 [debug] [MainThread]: Flushing usage events
[0m19:31:10.804544 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:31:35.440128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b40200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106588500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106588b90>]}


============================== 19:31:35.441389 | 00392877-ea77-414c-8d67-330e56c4e585 ==============================
[0m19:31:35.441389 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:31:35.441765 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'write_json': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'warn_error': 'None', 'static_parser': 'True', 'no_print': 'None', 'empty': 'None', 'fail_fast': 'False', 'debug': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'use_colors': 'True', 'partial_parse': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:31:35.506549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00392877-ea77-414c-8d67-330e56c4e585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107797d10>]}
[0m19:31:35.516890 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1071385, "process_in_blocks": "0", "process_kernel_time": 0.104248, "process_mem_max_rss": "107905024", "process_out_blocks": "0", "process_user_time": 0.675402}
[0m19:31:35.517156 [debug] [MainThread]: Command `dbt clean` succeeded at 19:31:35.517110 after 0.11 seconds
[0m19:31:35.517312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107717d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a85c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106836cc0>]}
[0m19:31:35.517462 [debug] [MainThread]: Flushing usage events
[0m19:31:36.634798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:31:40.808625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108562a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085040e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a19c70>]}


============================== 19:31:40.809923 | 68301780-da62-4686-b185-1ab2b4865826 ==============================
[0m19:31:40.809923 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:31:40.810262 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'empty': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'introspect': 'True', 'printer_width': '80', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m19:31:42.266241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68301780-da62-4686-b185-1ab2b4865826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1541e6600>]}
[0m19:31:42.290291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68301780-da62-4686-b185-1ab2b4865826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1508e6d20>]}
[0m19:31:42.290575 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:31:42.406091 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:31:42.406573 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:31:42.406783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '68301780-da62-4686-b185-1ab2b4865826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b0d970>]}
[0m19:31:43.017468 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two resources with the database representation "`horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`".
  dbt cannot create two resources with identical database representations. To fix this,
  change the configuration of one of these resources:
  - model.my_project.policy_events (models/example/policy_events.sql)
  - seed.my_project.policy_events (seeds/policy_events.csv)
[0m19:31:43.017853 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.237714, "process_in_blocks": "0", "process_kernel_time": 1.926799, "process_mem_max_rss": "405209088", "process_out_blocks": "0", "process_user_time": 2.757892}
[0m19:31:43.018147 [debug] [MainThread]: Command `dbt run` failed at 19:31:43.018095 after 2.24 seconds
[0m19:31:43.018339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096b0290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155586fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15427fda0>]}
[0m19:31:43.018508 [debug] [MainThread]: Flushing usage events
[0m19:31:44.224547 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:28.023751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b28f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c6a80>]}


============================== 19:33:28.025438 | 27f3dbe8-7edb-4807-8f1b-d4b49d71ff2d ==============================
[0m19:33:28.025438 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:33:28.025803 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'static_parser': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'target_path': 'None', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'quiet': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m19:33:28.091408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27f3dbe8-7edb-4807-8f1b-d4b49d71ff2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1cef0>]}
[0m19:33:28.101867 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10872858, "process_in_blocks": "0", "process_kernel_time": 0.141405, "process_mem_max_rss": "107380736", "process_out_blocks": "0", "process_user_time": 0.675888}
[0m19:33:28.102166 [debug] [MainThread]: Command `dbt clean` succeeded at 19:33:28.102112 after 0.11 seconds
[0m19:33:28.102342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10697dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107547fb0>]}
[0m19:33:28.102495 [debug] [MainThread]: Flushing usage events
[0m19:33:30.014138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:34:07.678601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc0f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109610590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096102f0>]}


============================== 19:34:07.680663 | 92a0ca21-4748-4d46-9ce3-dd0d0cc6748d ==============================
[0m19:34:07.680663 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:34:07.681030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'empty': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error': 'None', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'cache_selected_only': 'False', 'use_colors': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'introspect': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'debug': 'False', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'quiet': 'False'}
[0m19:34:09.838754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92a0ca21-4748-4d46-9ce3-dd0d0cc6748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e4bc0>]}
[0m19:34:09.863122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92a0ca21-4748-4d46-9ce3-dd0d0cc6748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084c3200>]}
[0m19:34:09.863426 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:34:09.978173 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:34:09.978653 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:34:09.978867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '92a0ca21-4748-4d46-9ce3-dd0d0cc6748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b9025a0>]}
[0m19:34:10.523730 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m19:34:10.526066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92a0ca21-4748-4d46-9ce3-dd0d0cc6748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c9404a0>]}
[0m19:34:10.565832 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:34:10.567990 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:34:10.580199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92a0ca21-4748-4d46-9ce3-dd0d0cc6748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ecde20>]}
[0m19:34:10.580461 [info ] [MainThread]: Found 6 models, 10 data tests, 496 macros
[0m19:34:10.580640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92a0ca21-4748-4d46-9ce3-dd0d0cc6748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bf8bfb0>]}
[0m19:34:10.581467 [info ] [MainThread]: 
[0m19:34:10.581673 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m19:34:10.581810 [info ] [MainThread]: 
[0m19:34:10.582045 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:34:10.583851 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m19:34:10.584057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:11.712522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m19:34:11.713127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:12.447055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92a0ca21-4748-4d46-9ce3-dd0d0cc6748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c8bc9e0>]}
[0m19:34:12.448004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:34:12.512940 [debug] [Thread-1 (]: Began running node model.my_project.policy_events
[0m19:34:12.513384 [info ] [Thread-1 (]: 1 of 6 START sql view model single_view_policy_assignment.policy_events ........ [RUN]
[0m19:34:12.513694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.policy_events)
[0m19:34:12.513921 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_events
[0m19:34:12.517565 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_events"
[0m19:34:12.518145 [debug] [Thread-1 (]: Began executing node model.my_project.policy_events
[0m19:34:12.533482 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_events"
[0m19:34:12.534044 [debug] [Thread-1 (]: On model.my_project.policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_events"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  OPTIONS()
  as SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP),
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT)
FROM
    horizontal-ray-467611-f9.single_view_policy_assignment.policy_events_external_table;


[0m19:34:12.534269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:34:14.145014 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:88d89827-ec1b-4154-8363-cc4d120dd6d9&page=queryresults
[0m19:34:14.676731 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:88d89827-ec1b-4154-8363-cc4d120dd6d9&page=queryresults
[0m19:34:14.689964 [debug] [Thread-1 (]: Database Error in model policy_events (models/example/policy_events.sql)
  Type not found: FLOAT at [13:28]
  compiled code at target/run/my_project/models/example/policy_events.sql
[0m19:34:14.692309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a0ca21-4748-4d46-9ce3-dd0d0cc6748d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14bfbcce0>]}
[0m19:34:14.693067 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model single_view_policy_assignment.policy_events  [[31mERROR[0m in 2.18s]
[0m19:34:14.693691 [debug] [Thread-1 (]: Finished running node model.my_project.policy_events
[0m19:34:14.694175 [debug] [Thread-4 (]: Marking all children of 'model.my_project.policy_events' to be skipped because of status 'error'.  Reason: Database Error in model policy_events (models/example/policy_events.sql)
  Type not found: FLOAT at [13:28]
  compiled code at target/run/my_project/models/example/policy_events.sql.
[0m19:34:14.694968 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m19:34:14.695517 [info ] [Thread-1 (]: 2 of 6 SKIP relation single_view_policy_assignment.stg_policy_events ........... [[33mSKIP[0m]
[0m19:34:14.695924 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m19:34:14.696468 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m19:34:14.696944 [info ] [Thread-1 (]: 3 of 6 SKIP relation single_view_policy_assignment.policy_lifecycle_enriched ... [[33mSKIP[0m]
[0m19:34:14.697309 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m19:34:14.697831 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:34:14.698164 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m19:34:14.698513 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:34:14.698804 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m19:34:14.699110 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m19:34:14.699408 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m19:34:14.699682 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m19:34:14.699986 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m19:34:14.700276 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m19:34:14.701028 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:34:14.746117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:34:14.746327 [debug] [MainThread]: Connection 'model.my_project.policy_events' was properly closed.
[0m19:34:14.746523 [info ] [MainThread]: 
[0m19:34:14.746700 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 4 view models in 0 hours 0 minutes and 4.16 seconds (4.16s).
[0m19:34:14.747088 [debug] [MainThread]: Command end result
[0m19:34:14.855802 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:34:14.856724 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:34:14.859497 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m19:34:14.859677 [info ] [MainThread]: 
[0m19:34:14.859882 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:34:14.860042 [info ] [MainThread]: 
[0m19:34:14.860239 [error] [MainThread]: [31mFailure in model policy_events (models/example/policy_events.sql)[0m
[0m19:34:14.860415 [error] [MainThread]:   Database Error in model policy_events (models/example/policy_events.sql)
  Type not found: FLOAT at [13:28]
  compiled code at target/run/my_project/models/example/policy_events.sql
[0m19:34:14.860551 [info ] [MainThread]: 
[0m19:34:14.860713 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/policy_events.sql
[0m19:34:14.860848 [info ] [MainThread]: 
[0m19:34:14.861019 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=5 NO-OP=0 TOTAL=6
[0m19:34:14.861263 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.2152724, "process_in_blocks": "0", "process_kernel_time": 0.812623, "process_mem_max_rss": "408043520", "process_out_blocks": "0", "process_user_time": 4.357999}
[0m19:34:14.861522 [debug] [MainThread]: Command `dbt run` failed at 19:34:14.861483 after 7.22 seconds
[0m19:34:14.861692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a9738c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f2b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca8e60>]}
[0m19:34:14.861850 [debug] [MainThread]: Flushing usage events
[0m19:34:15.974615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:35:48.410402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102461a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b243e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b24050>]}


============================== 19:35:48.412115 | 95ef3efb-5c19-47d4-83a7-b14c2d53588a ==============================
[0m19:35:48.412115 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:35:48.412450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'use_colors': 'True', 'no_print': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'debug': 'False', 'quiet': 'False', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'version_check': 'True'}
[0m19:35:50.377382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95ef3efb-5c19-47d4-83a7-b14c2d53588a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bdce600>]}
[0m19:35:50.402067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95ef3efb-5c19-47d4-83a7-b14c2d53588a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f5fad20>]}
[0m19:35:50.402368 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:35:50.517562 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:35:50.596760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:35:50.597078 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/policy_events.sql
[0m19:35:50.709704 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m19:35:50.712026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95ef3efb-5c19-47d4-83a7-b14c2d53588a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1482c74d0>]}
[0m19:35:50.749236 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:35:50.750364 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:35:50.760686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95ef3efb-5c19-47d4-83a7-b14c2d53588a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fe6b110>]}
[0m19:35:50.760930 [info ] [MainThread]: Found 6 models, 10 data tests, 496 macros
[0m19:35:50.761111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95ef3efb-5c19-47d4-83a7-b14c2d53588a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fec3290>]}
[0m19:35:50.761920 [info ] [MainThread]: 
[0m19:35:50.762110 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m19:35:50.762250 [info ] [MainThread]: 
[0m19:35:50.762485 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:35:50.764254 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m19:35:50.764457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:51.728663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m19:35:51.730149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:35:52.481901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95ef3efb-5c19-47d4-83a7-b14c2d53588a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105adbb30>]}
[0m19:35:52.482401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:52.532157 [debug] [Thread-1 (]: Began running node model.my_project.policy_events
[0m19:35:52.532505 [info ] [Thread-1 (]: 1 of 6 START sql view model single_view_policy_assignment.policy_events ........ [RUN]
[0m19:35:52.532754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.policy_events)
[0m19:35:52.532942 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_events
[0m19:35:52.536174 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_events"
[0m19:35:52.536565 [debug] [Thread-1 (]: Began executing node model.my_project.policy_events
[0m19:35:52.550853 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_events"
[0m19:35:52.551285 [debug] [Thread-1 (]: On model.my_project.policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_events"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  OPTIONS()
  as SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP),
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64)
FROM
    horizontal-ray-467611-f9.single_view_policy_assignment.policy_events_external_table;


[0m19:35:52.551500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:53.971315 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:bee05bf1-1aeb-4a47-b695-b456b020dc8c&page=queryresults
[0m19:35:54.395894 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:bee05bf1-1aeb-4a47-b695-b456b020dc8c&page=queryresults
[0m19:35:54.407657 [debug] [Thread-1 (]: Database Error in model policy_events (models/example/policy_events.sql)
  CREATE VIEW columns must be named, but column 3 has no name at [6:6]
  compiled code at target/run/my_project/models/example/policy_events.sql
[0m19:35:54.409860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95ef3efb-5c19-47d4-83a7-b14c2d53588a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1483064b0>]}
[0m19:35:54.410590 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model single_view_policy_assignment.policy_events  [[31mERROR[0m in 1.88s]
[0m19:35:54.412047 [debug] [Thread-1 (]: Finished running node model.my_project.policy_events
[0m19:35:54.412666 [debug] [Thread-4 (]: Marking all children of 'model.my_project.policy_events' to be skipped because of status 'error'.  Reason: Database Error in model policy_events (models/example/policy_events.sql)
  CREATE VIEW columns must be named, but column 3 has no name at [6:6]
  compiled code at target/run/my_project/models/example/policy_events.sql.
[0m19:35:54.413361 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m19:35:54.413807 [info ] [Thread-1 (]: 2 of 6 SKIP relation single_view_policy_assignment.stg_policy_events ........... [[33mSKIP[0m]
[0m19:35:54.414224 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m19:35:54.414695 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m19:35:54.415088 [info ] [Thread-1 (]: 3 of 6 SKIP relation single_view_policy_assignment.policy_lifecycle_enriched ... [[33mSKIP[0m]
[0m19:35:54.415462 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m19:35:54.415927 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:35:54.416217 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m19:35:54.416554 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:35:54.416952 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m19:35:54.417329 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m19:35:54.417710 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m19:35:54.418025 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m19:35:54.418343 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m19:35:54.418652 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m19:35:54.419395 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:35:54.464441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:54.464687 [debug] [MainThread]: Connection 'model.my_project.policy_events' was properly closed.
[0m19:35:54.464893 [info ] [MainThread]: 
[0m19:35:54.465089 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 4 view models in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m19:35:54.465488 [debug] [MainThread]: Command end result
[0m19:35:54.479065 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:35:54.479927 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:35:54.482984 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m19:35:54.483153 [info ] [MainThread]: 
[0m19:35:54.483338 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:35:54.483481 [info ] [MainThread]: 
[0m19:35:54.483670 [error] [MainThread]: [31mFailure in model policy_events (models/example/policy_events.sql)[0m
[0m19:35:54.483847 [error] [MainThread]:   Database Error in model policy_events (models/example/policy_events.sql)
  CREATE VIEW columns must be named, but column 3 has no name at [6:6]
  compiled code at target/run/my_project/models/example/policy_events.sql
[0m19:35:54.483977 [info ] [MainThread]: 
[0m19:35:54.484128 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/policy_events.sql
[0m19:35:54.484258 [info ] [MainThread]: 
[0m19:35:54.484411 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=5 NO-OP=0 TOTAL=6
[0m19:35:54.484653 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.107139, "process_in_blocks": "0", "process_kernel_time": 0.895752, "process_mem_max_rss": "405274624", "process_out_blocks": "0", "process_user_time": 3.819594}
[0m19:35:54.484925 [debug] [MainThread]: Command `dbt run` failed at 19:35:54.484886 after 6.11 seconds
[0m19:35:54.485093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c45880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fc073e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f9784d0>]}
[0m19:35:54.485251 [debug] [MainThread]: Flushing usage events
[0m19:35:55.614128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:37:35.163806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104355d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f54560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f542c0>]}


============================== 19:37:35.165713 | d2c54e59-6ae7-4fba-b7ca-94a14cf38d80 ==============================
[0m19:37:35.165713 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:37:35.166119 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'use_colors': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'warn_error': 'None', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'introspect': 'True', 'log_format': 'default', 'no_print': 'None', 'log_cache_events': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'write_json': 'True', 'cache_selected_only': 'False'}
[0m19:37:37.410876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2c54e59-6ae7-4fba-b7ca-94a14cf38d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15846b110>]}
[0m19:37:37.435687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2c54e59-6ae7-4fba-b7ca-94a14cf38d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f29190>]}
[0m19:37:37.436006 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:37:37.551989 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:37:37.627898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:37:37.628216 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/policy_events.sql
[0m19:37:37.740645 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m19:37:37.742920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2c54e59-6ae7-4fba-b7ca-94a14cf38d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159cc72f0>]}
[0m19:37:37.779784 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:37:37.781109 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:37:37.792376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2c54e59-6ae7-4fba-b7ca-94a14cf38d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159c772c0>]}
[0m19:37:37.792626 [info ] [MainThread]: Found 6 models, 10 data tests, 496 macros
[0m19:37:37.792804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2c54e59-6ae7-4fba-b7ca-94a14cf38d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b782c0>]}
[0m19:37:37.793594 [info ] [MainThread]: 
[0m19:37:37.793801 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m19:37:37.793942 [info ] [MainThread]: 
[0m19:37:37.794198 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:37:37.795987 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m19:37:37.796195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:38.758857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m19:37:38.760202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:39.507640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2c54e59-6ae7-4fba-b7ca-94a14cf38d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b7adb0>]}
[0m19:37:39.508638 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:39.561518 [debug] [Thread-1 (]: Began running node model.my_project.policy_events
[0m19:37:39.561905 [info ] [Thread-1 (]: 1 of 6 START sql view model single_view_policy_assignment.policy_events ........ [RUN]
[0m19:37:39.562175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.policy_events)
[0m19:37:39.562377 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_events
[0m19:37:39.565747 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_events"
[0m19:37:39.566166 [debug] [Thread-1 (]: Began executing node model.my_project.policy_events
[0m19:37:39.581433 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_events"
[0m19:37:39.581928 [debug] [Thread-1 (]: On model.my_project.policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_events"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  OPTIONS()
  as SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    horizontal-ray-467611-f9.single_view_policy_assignment.policy_events_external_table;


[0m19:37:39.582162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:40.804993 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:5deed251-4dae-4504-94b6-aa5b35dbd9bf&page=queryresults
[0m19:37:41.071800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2c54e59-6ae7-4fba-b7ca-94a14cf38d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159eaa2a0>]}
[0m19:37:41.072272 [info ] [Thread-1 (]: 1 of 6 OK created sql view model single_view_policy_assignment.policy_events ... [[32mCREATE VIEW (0 processed)[0m in 1.51s]
[0m19:37:41.072619 [debug] [Thread-1 (]: Finished running node model.my_project.policy_events
[0m19:37:41.072996 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m19:37:41.073257 [info ] [Thread-1 (]: 2 of 6 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m19:37:41.073536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_events, now model.my_project.stg_policy_events)
[0m19:37:41.073749 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m19:37:41.075795 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m19:37:41.076223 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m19:37:41.096108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:41.847974 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m19:37:41.849200 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events` as DBT_INTERNAL_DEST
        using (

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  WHERE policy_id IS NOT NULL
    AND event_type IS NOT NULL
    AND event_timestamp IS NOT NULL
)

SELECT
  *,
  CAST(event_timestamp AS TIMESTAMP) AS event_ts,
  CAST(premium_amount AS FLOAT64) AS premium_amount,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.policy_id = DBT_INTERNAL_DEST.policy_id
                ) and (
                    DBT_INTERNAL_SOURCE.event_type = DBT_INTERNAL_DEST.event_type
                ) and (
                    DBT_INTERNAL_SOURCE.product_type = DBT_INTERNAL_DEST.product_type
                )

    
    when matched then update set
        `policy_id` = DBT_INTERNAL_SOURCE.`policy_id`,`event_type` = DBT_INTERNAL_SOURCE.`event_type`,`event_ts` = DBT_INTERNAL_SOURCE.`event_ts`,`event_month` = DBT_INTERNAL_SOURCE.`event_month`
    

    when not matched then insert
        (`policy_id`, `event_type`, `event_ts`, `event_month`)
    values
        (`policy_id`, `event_type`, `event_ts`, `event_month`)


    
[0m19:37:43.015950 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:f1ee7a2e-122f-4c67-a7bd-9b1c5f6bf234&page=queryresults
[0m19:37:43.100267 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:f1ee7a2e-122f-4c67-a7bd-9b1c5f6bf234&page=queryresults
[0m19:37:43.113995 [debug] [Thread-1 (]: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Name product_type not found inside DBT_INTERNAL_DEST at [53:74]
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m19:37:43.114863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2c54e59-6ae7-4fba-b7ca-94a14cf38d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159fb3680>]}
[0m19:37:43.116007 [error] [Thread-1 (]: 2 of 6 ERROR creating sql incremental model single_view_policy_assignment.stg_policy_events  [[31mERROR[0m in 2.04s]
[0m19:37:43.117170 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m19:37:43.117901 [debug] [Thread-4 (]: Marking all children of 'model.my_project.stg_policy_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Name product_type not found inside DBT_INTERNAL_DEST at [53:74]
  compiled code at target/run/my_project/models/example/stg_policy_events.sql.
[0m19:37:43.118899 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m19:37:43.119510 [info ] [Thread-1 (]: 3 of 6 SKIP relation single_view_policy_assignment.policy_lifecycle_enriched ... [[33mSKIP[0m]
[0m19:37:43.120011 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m19:37:43.120688 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:37:43.121131 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m19:37:43.121623 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:37:43.122102 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m19:37:43.122572 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m19:37:43.123010 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m19:37:43.123394 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m19:37:43.123763 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m19:37:43.124125 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m19:37:43.125018 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:37:43.173795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:43.174036 [debug] [MainThread]: Connection 'model.my_project.stg_policy_events' was properly closed.
[0m19:37:43.174256 [info ] [MainThread]: 
[0m19:37:43.174447 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 4 view models in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m19:37:43.174968 [debug] [MainThread]: Command end result
[0m19:37:43.189325 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:37:43.190247 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:37:43.193301 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m19:37:43.193467 [info ] [MainThread]: 
[0m19:37:43.193652 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:37:43.193800 [info ] [MainThread]: 
[0m19:37:43.193987 [error] [MainThread]: [31mFailure in model stg_policy_events (models/example/stg_policy_events.sql)[0m
[0m19:37:43.194167 [error] [MainThread]:   Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Name product_type not found inside DBT_INTERNAL_DEST at [53:74]
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m19:37:43.194301 [info ] [MainThread]: 
[0m19:37:43.194464 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/stg_policy_events.sql
[0m19:37:43.194598 [info ] [MainThread]: 
[0m19:37:43.194752 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=6
[0m19:37:43.195012 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.064939, "process_in_blocks": "0", "process_kernel_time": 0.774507, "process_mem_max_rss": "400457728", "process_out_blocks": "0", "process_user_time": 4.106462}
[0m19:37:43.195288 [debug] [MainThread]: Command `dbt run` failed at 19:37:43.195245 after 8.07 seconds
[0m19:37:43.195468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d725d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d71670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f54470>]}
[0m19:37:43.195629 [debug] [MainThread]: Flushing usage events
[0m19:37:44.469177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:03.856232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109184230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109930140>]}


============================== 19:39:03.858307 | f21d4118-d60b-4f41-a39e-06c2d288eeb5 ==============================
[0m19:39:03.858307 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:39:03.858694 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'introspect': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'quiet': 'False', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'use_colors': 'True', 'invocation_command': 'dbt run --full-refresh', 'version_check': 'True', 'debug': 'False'}
[0m19:39:05.836985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f21d4118-d60b-4f41-a39e-06c2d288eeb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13450ac60>]}
[0m19:39:05.861239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f21d4118-d60b-4f41-a39e-06c2d288eeb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143865070>]}
[0m19:39:05.861536 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:39:05.976693 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:39:06.052729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:39:06.052939 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:39:06.055667 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m19:39:06.072807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f21d4118-d60b-4f41-a39e-06c2d288eeb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14388acf0>]}
[0m19:39:06.110952 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:39:06.112075 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:39:06.122396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f21d4118-d60b-4f41-a39e-06c2d288eeb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143d04b90>]}
[0m19:39:06.122640 [info ] [MainThread]: Found 6 models, 10 data tests, 496 macros
[0m19:39:06.122819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f21d4118-d60b-4f41-a39e-06c2d288eeb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bba180>]}
[0m19:39:06.123782 [info ] [MainThread]: 
[0m19:39:06.124008 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m19:39:06.124158 [info ] [MainThread]: 
[0m19:39:06.124400 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:39:06.126205 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m19:39:06.126418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:07.221621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m19:39:07.222842 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:08.012085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f21d4118-d60b-4f41-a39e-06c2d288eeb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1435a4aa0>]}
[0m19:39:08.013388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:08.074275 [debug] [Thread-1 (]: Began running node model.my_project.policy_events
[0m19:39:08.074705 [info ] [Thread-1 (]: 1 of 6 START sql view model single_view_policy_assignment.policy_events ........ [RUN]
[0m19:39:08.075000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.policy_events)
[0m19:39:08.075209 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_events
[0m19:39:08.079599 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_events"
[0m19:39:08.079987 [debug] [Thread-1 (]: Began executing node model.my_project.policy_events
[0m19:39:08.094718 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_events"
[0m19:39:08.095143 [debug] [Thread-1 (]: On model.my_project.policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_events"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  OPTIONS()
  as SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    horizontal-ray-467611-f9.single_view_policy_assignment.policy_events_external_table;


[0m19:39:08.095364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:09.069337 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:ef4c2864-7fd4-461a-8046-a2ab24b742d0&page=queryresults
[0m19:39:10.047103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f21d4118-d60b-4f41-a39e-06c2d288eeb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1344bbb90>]}
[0m19:39:10.047632 [info ] [Thread-1 (]: 1 of 6 OK created sql view model single_view_policy_assignment.policy_events ... [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m19:39:10.048041 [debug] [Thread-1 (]: Finished running node model.my_project.policy_events
[0m19:39:10.048489 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m19:39:10.048818 [info ] [Thread-1 (]: 2 of 6 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m19:39:10.049112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_events, now model.my_project.stg_policy_events)
[0m19:39:10.049344 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m19:39:10.051445 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m19:39:10.051854 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m19:39:10.073755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:10.772968 [debug] [Thread-1 (]: Hard refreshing `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events` because it is not replaceable
[0m19:39:10.949715 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m19:39:10.950625 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    cluster by policy_id, event_type

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  WHERE policy_id IS NOT NULL
    AND event_type IS NOT NULL
    AND event_timestamp IS NOT NULL
)

SELECT
  *,
  CAST(event_timestamp AS TIMESTAMP) AS event_ts,
  CAST(premium_amount AS FLOAT64) AS premium_amount,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m19:39:11.906318 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:55e0dc00-e1ae-40c7-a045-15175eb68c7d&page=queryresults
[0m19:39:12.330417 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:55e0dc00-e1ae-40c7-a045-15175eb68c7d&page=queryresults
[0m19:39:12.344175 [debug] [Thread-1 (]: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  CREATE TABLE has columns with duplicate name premium_amount at [16:1]
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m19:39:12.345046 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f21d4118-d60b-4f41-a39e-06c2d288eeb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143b10ec0>]}
[0m19:39:12.345820 [error] [Thread-1 (]: 2 of 6 ERROR creating sql incremental model single_view_policy_assignment.stg_policy_events  [[31mERROR[0m in 2.30s]
[0m19:39:12.346452 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m19:39:12.347438 [debug] [Thread-4 (]: Marking all children of 'model.my_project.stg_policy_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  CREATE TABLE has columns with duplicate name premium_amount at [16:1]
  compiled code at target/run/my_project/models/example/stg_policy_events.sql.
[0m19:39:12.348308 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m19:39:12.348982 [info ] [Thread-1 (]: 3 of 6 SKIP relation single_view_policy_assignment.policy_lifecycle_enriched ... [[33mSKIP[0m]
[0m19:39:12.349530 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m19:39:12.350210 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:39:12.350767 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m19:39:12.351226 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:39:12.351728 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m19:39:12.352166 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m19:39:12.352599 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m19:39:12.352985 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m19:39:12.353384 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m19:39:12.353773 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m19:39:12.354617 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:12.402856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:12.403052 [debug] [MainThread]: Connection 'model.my_project.stg_policy_events' was properly closed.
[0m19:39:12.403251 [info ] [MainThread]: 
[0m19:39:12.403429 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 4 view models in 0 hours 0 minutes and 6.28 seconds (6.28s).
[0m19:39:12.403893 [debug] [MainThread]: Command end result
[0m19:39:12.417471 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:39:12.418338 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:39:12.421333 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m19:39:12.421503 [info ] [MainThread]: 
[0m19:39:12.421691 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:39:12.421843 [info ] [MainThread]: 
[0m19:39:12.422036 [error] [MainThread]: [31mFailure in model stg_policy_events (models/example/stg_policy_events.sql)[0m
[0m19:39:12.422215 [error] [MainThread]:   Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  CREATE TABLE has columns with duplicate name premium_amount at [16:1]
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m19:39:12.422356 [info ] [MainThread]: 
[0m19:39:12.422516 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/stg_policy_events.sql
[0m19:39:12.422654 [info ] [MainThread]: 
[0m19:39:12.422813 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=6
[0m19:39:12.423179 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.60295, "process_in_blocks": "0", "process_kernel_time": 1.006183, "process_mem_max_rss": "400113664", "process_out_blocks": "0", "process_user_time": 3.858441}
[0m19:39:12.423451 [debug] [MainThread]: Command `dbt run` failed at 19:39:12.423409 after 8.60 seconds
[0m19:39:12.423625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e6f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144108230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109930320>]}
[0m19:39:12.423786 [debug] [MainThread]: Flushing usage events
[0m19:39:13.572953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:53.053507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d3e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da8170>]}


============================== 19:39:53.055689 | 0e67334c-aefe-495b-b8be-fce19baa07a0 ==============================
[0m19:39:53.055689 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:39:53.056071 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'write_json': 'True', 'version_check': 'True', 'printer_width': '80', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'warn_error': 'None', 'debug': 'False', 'quiet': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'empty': 'False', 'target_path': 'None', 'use_colors': 'True'}
[0m19:39:55.244958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e67334c-aefe-495b-b8be-fce19baa07a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15da834a0>]}
[0m19:39:55.270012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e67334c-aefe-495b-b8be-fce19baa07a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d6d30e0>]}
[0m19:39:55.270509 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:39:55.391791 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:39:55.472843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:39:55.473225 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/stg_policy_events.sql
[0m19:39:55.589651 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m19:39:55.592082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e67334c-aefe-495b-b8be-fce19baa07a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e2c76e0>]}
[0m19:39:55.630287 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:39:55.631519 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:39:55.644134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e67334c-aefe-495b-b8be-fce19baa07a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e28b620>]}
[0m19:39:55.644394 [info ] [MainThread]: Found 6 models, 10 data tests, 496 macros
[0m19:39:55.644571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e67334c-aefe-495b-b8be-fce19baa07a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15de121b0>]}
[0m19:39:55.645385 [info ] [MainThread]: 
[0m19:39:55.645596 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m19:39:55.645738 [info ] [MainThread]: 
[0m19:39:55.645975 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:39:55.647861 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m19:39:55.648078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:56.613819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m19:39:56.615045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:57.403037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e67334c-aefe-495b-b8be-fce19baa07a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d8a4c50>]}
[0m19:39:57.404407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:57.464869 [debug] [Thread-1 (]: Began running node model.my_project.policy_events
[0m19:39:57.465244 [info ] [Thread-1 (]: 1 of 6 START sql view model single_view_policy_assignment.policy_events ........ [RUN]
[0m19:39:57.465525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.policy_events)
[0m19:39:57.465741 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_events
[0m19:39:57.469159 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_events"
[0m19:39:57.469561 [debug] [Thread-1 (]: Began executing node model.my_project.policy_events
[0m19:39:57.484271 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_events"
[0m19:39:57.484734 [debug] [Thread-1 (]: On model.my_project.policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_events"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  OPTIONS()
  as SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    horizontal-ray-467611-f9.single_view_policy_assignment.policy_events_external_table;


[0m19:39:57.484974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:58.656186 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:f5a8a763-ad06-4916-b7cb-e58707179ae1&page=queryresults
[0m19:39:59.411363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e67334c-aefe-495b-b8be-fce19baa07a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d0590>]}
[0m19:39:59.411793 [info ] [Thread-1 (]: 1 of 6 OK created sql view model single_view_policy_assignment.policy_events ... [[32mCREATE VIEW (0 processed)[0m in 1.95s]
[0m19:39:59.412145 [debug] [Thread-1 (]: Finished running node model.my_project.policy_events
[0m19:39:59.412526 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m19:39:59.412824 [info ] [Thread-1 (]: 2 of 6 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m19:39:59.413040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_events, now model.my_project.stg_policy_events)
[0m19:39:59.413214 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m19:39:59.415009 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m19:39:59.415334 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m19:39:59.445786 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m19:39:59.446449 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    cluster by policy_id, event_type

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  WHERE policy_id IS NOT NULL
    AND event_type IS NOT NULL
    AND event_timestamp IS NOT NULL
)

SELECT
  *,
  CAST(event_timestamp AS TIMESTAMP) AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m19:39:59.446708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:00.625981 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:f7dd3bb9-8b02-44ec-9d98-f322a406ea12&page=queryresults
[0m19:40:00.923193 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:f7dd3bb9-8b02-44ec-9d98-f322a406ea12&page=queryresults
[0m19:40:00.940483 [debug] [Thread-1 (]: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Access Denied: BigQuery BigQuery: Permission denied while globbing file pattern. dbt-runner@horizontal-ray-467611-f9.iam.gserviceaccount.com does not have storage.objects.get access to the Google Cloud Storage object. Permission 'storage.objects.get' denied on resource (or it may not exist). Please make sure gs://horizontal-ray-467611-f9/load_policy_events/policy_events.csv is accessible via appropriate IAM roles, e.g. Storage Object Viewer or Storage Object Creator.
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m19:40:00.941258 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e67334c-aefe-495b-b8be-fce19baa07a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e353950>]}
[0m19:40:00.942037 [error] [Thread-1 (]: 2 of 6 ERROR creating sql incremental model single_view_policy_assignment.stg_policy_events  [[31mERROR[0m in 1.53s]
[0m19:40:00.942727 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m19:40:00.943395 [debug] [Thread-4 (]: Marking all children of 'model.my_project.stg_policy_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Access Denied: BigQuery BigQuery: Permission denied while globbing file pattern. dbt-runner@horizontal-ray-467611-f9.iam.gserviceaccount.com does not have storage.objects.get access to the Google Cloud Storage object. Permission 'storage.objects.get' denied on resource (or it may not exist). Please make sure gs://horizontal-ray-467611-f9/load_policy_events/policy_events.csv is accessible via appropriate IAM roles, e.g. Storage Object Viewer or Storage Object Creator.
  compiled code at target/run/my_project/models/example/stg_policy_events.sql.
[0m19:40:00.944262 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m19:40:00.944880 [info ] [Thread-1 (]: 3 of 6 SKIP relation single_view_policy_assignment.policy_lifecycle_enriched ... [[33mSKIP[0m]
[0m19:40:00.945409 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m19:40:00.945931 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:40:00.946350 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m19:40:00.946728 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:40:00.947062 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m19:40:00.947406 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m19:40:00.947791 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m19:40:00.948221 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m19:40:00.948606 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m19:40:00.948957 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m19:40:00.949775 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:00.997500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:00.997713 [debug] [MainThread]: Connection 'model.my_project.stg_policy_events' was properly closed.
[0m19:40:00.997917 [info ] [MainThread]: 
[0m19:40:00.998097 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 4 view models in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m19:40:00.998582 [debug] [MainThread]: Command end result
[0m19:40:01.021734 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:40:01.022654 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:40:01.026337 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m19:40:01.026514 [info ] [MainThread]: 
[0m19:40:01.026695 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:40:01.026841 [info ] [MainThread]: 
[0m19:40:01.027036 [error] [MainThread]: [31mFailure in model stg_policy_events (models/example/stg_policy_events.sql)[0m
[0m19:40:01.027231 [error] [MainThread]:   Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Access Denied: BigQuery BigQuery: Permission denied while globbing file pattern. dbt-runner@horizontal-ray-467611-f9.iam.gserviceaccount.com does not have storage.objects.get access to the Google Cloud Storage object. Permission 'storage.objects.get' denied on resource (or it may not exist). Please make sure gs://horizontal-ray-467611-f9/load_policy_events/policy_events.csv is accessible via appropriate IAM roles, e.g. Storage Object Viewer or Storage Object Creator.
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m19:40:01.027381 [info ] [MainThread]: 
[0m19:40:01.027539 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/stg_policy_events.sql
[0m19:40:01.027674 [info ] [MainThread]: 
[0m19:40:01.027830 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=6
[0m19:40:01.028087 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.015564, "process_in_blocks": "0", "process_kernel_time": 0.916899, "process_mem_max_rss": "407158784", "process_out_blocks": "0", "process_user_time": 4.014478}
[0m19:40:01.028370 [debug] [MainThread]: Command `dbt run` failed at 19:40:01.028327 after 8.02 seconds
[0m19:40:01.028548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ce22de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15daaeb70>]}
[0m19:40:01.028714 [debug] [MainThread]: Flushing usage events
[0m19:40:02.168266 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:44:07.058621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a64dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c3c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c3c1d0>]}


============================== 19:44:07.060946 | 25df55f2-e53b-4bc0-9f44-bcd90231a9d6 ==============================
[0m19:44:07.060946 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:44:07.061358 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'printer_width': '80', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'invocation_command': 'dbt run --full-refresh', 'empty': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'partial_parse': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'no_print': 'None', 'warn_error': 'None'}
[0m19:44:09.432440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25df55f2-e53b-4bc0-9f44-bcd90231a9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168089fa0>]}
[0m19:44:09.464906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25df55f2-e53b-4bc0-9f44-bcd90231a9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1685d2b40>]}
[0m19:44:09.465360 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:44:09.595254 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:44:09.677225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:44:09.677500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:44:09.680730 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m19:44:09.699621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25df55f2-e53b-4bc0-9f44-bcd90231a9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1687a3650>]}
[0m19:44:09.743276 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:44:09.744555 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:44:09.755005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25df55f2-e53b-4bc0-9f44-bcd90231a9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168f367e0>]}
[0m19:44:09.755283 [info ] [MainThread]: Found 6 models, 10 data tests, 496 macros
[0m19:44:09.755486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25df55f2-e53b-4bc0-9f44-bcd90231a9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168606ea0>]}
[0m19:44:09.756385 [info ] [MainThread]: 
[0m19:44:09.756604 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m19:44:09.756745 [info ] [MainThread]: 
[0m19:44:09.757021 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:44:09.758978 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m19:44:09.759190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:10.802546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m19:44:10.803389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:11.561144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25df55f2-e53b-4bc0-9f44-bcd90231a9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1687a0ce0>]}
[0m19:44:11.562019 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:44:11.628739 [debug] [Thread-1 (]: Began running node model.my_project.policy_events
[0m19:44:11.629170 [info ] [Thread-1 (]: 1 of 6 START sql view model single_view_policy_assignment.policy_events ........ [RUN]
[0m19:44:11.629478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.policy_events)
[0m19:44:11.629702 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_events
[0m19:44:11.634114 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_events"
[0m19:44:11.634563 [debug] [Thread-1 (]: Began executing node model.my_project.policy_events
[0m19:44:11.651839 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_events"
[0m19:44:11.652417 [debug] [Thread-1 (]: On model.my_project.policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_events"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  OPTIONS()
  as SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    horizontal-ray-467611-f9.single_view_policy_assignment.policy_events_external_table;


[0m19:44:11.652658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:12.626250 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:0987ebe4-1a89-444a-bbaf-75e3a59b95c7&page=queryresults
[0m19:44:13.323803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25df55f2-e53b-4bc0-9f44-bcd90231a9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b6d3ad0>]}
[0m19:44:13.324344 [info ] [Thread-1 (]: 1 of 6 OK created sql view model single_view_policy_assignment.policy_events ... [[32mCREATE VIEW (0 processed)[0m in 1.69s]
[0m19:44:13.324769 [debug] [Thread-1 (]: Finished running node model.my_project.policy_events
[0m19:44:13.325195 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m19:44:13.325631 [info ] [Thread-1 (]: 2 of 6 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m19:44:13.325952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_events, now model.my_project.stg_policy_events)
[0m19:44:13.326187 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m19:44:13.328942 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m19:44:13.329380 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m19:44:13.366770 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m19:44:13.367486 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    cluster by policy_id, event_type

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  WHERE policy_id IS NOT NULL
    AND event_type IS NOT NULL
    AND event_timestamp IS NOT NULL
)

SELECT
  *,
  CAST(event_timestamp AS TIMESTAMP) AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m19:44:13.367739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:14.866997 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:26785bb6-9f21-4728-91ca-0223028ac8bb&page=queryresults
[0m19:44:17.015698 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:26785bb6-9f21-4728-91ca-0223028ac8bb&page=queryresults
[0m19:44:17.030582 [debug] [Thread-1 (]: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Invalid timestamp: 'event_timestamp'
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m19:44:17.031959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25df55f2-e53b-4bc0-9f44-bcd90231a9d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d1fe750>]}
[0m19:44:17.033075 [error] [Thread-1 (]: 2 of 6 ERROR creating sql incremental model single_view_policy_assignment.stg_policy_events  [[31mERROR[0m in 3.71s]
[0m19:44:17.033614 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m19:44:17.034063 [debug] [Thread-4 (]: Marking all children of 'model.my_project.stg_policy_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Invalid timestamp: 'event_timestamp'
  compiled code at target/run/my_project/models/example/stg_policy_events.sql.
[0m19:44:17.034658 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m19:44:17.035119 [info ] [Thread-1 (]: 3 of 6 SKIP relation single_view_policy_assignment.policy_lifecycle_enriched ... [[33mSKIP[0m]
[0m19:44:17.035472 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m19:44:17.035997 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:44:17.036430 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m19:44:17.036857 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:44:17.037284 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m19:44:17.037643 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m19:44:17.038179 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m19:44:17.038559 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m19:44:17.039020 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m19:44:17.039682 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m19:44:17.041407 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:44:17.093423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:44:17.093726 [debug] [MainThread]: Connection 'model.my_project.stg_policy_events' was properly closed.
[0m19:44:17.093964 [info ] [MainThread]: 
[0m19:44:17.094174 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 4 view models in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m19:44:17.095422 [debug] [MainThread]: Command end result
[0m19:44:17.110561 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:44:17.111794 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:44:17.114699 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m19:44:17.114877 [info ] [MainThread]: 
[0m19:44:17.115079 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:44:17.115230 [info ] [MainThread]: 
[0m19:44:17.115447 [error] [MainThread]: [31mFailure in model stg_policy_events (models/example/stg_policy_events.sql)[0m
[0m19:44:17.115667 [error] [MainThread]:   Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Invalid timestamp: 'event_timestamp'
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m19:44:17.115826 [info ] [MainThread]: 
[0m19:44:17.116003 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/stg_policy_events.sql
[0m19:44:17.116163 [info ] [MainThread]: 
[0m19:44:17.116358 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=6
[0m19:44:17.116678 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.097126, "process_in_blocks": "0", "process_kernel_time": 1.038996, "process_mem_max_rss": "398917632", "process_out_blocks": "0", "process_user_time": 4.194368}
[0m19:44:17.117017 [debug] [MainThread]: Command `dbt run` failed at 19:44:17.116965 after 10.10 seconds
[0m19:44:17.117203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110309880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168dc1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168909220>]}
[0m19:44:17.117376 [debug] [MainThread]: Flushing usage events
[0m19:44:18.278964 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:44:51.300984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f25520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab60560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab600e0>]}


============================== 19:44:51.303149 | 361d3a98-84fc-4697-add7-75c0bb285a0b ==============================
[0m19:44:51.303149 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:44:51.303521 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_cache_events': 'False', 'fail_fast': 'False', 'version_check': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_format': 'default', 'debug': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'no_print': 'None', 'indirect_selection': 'eager', 'printer_width': '80'}
[0m19:44:53.616124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '361d3a98-84fc-4697-add7-75c0bb285a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x175b789e0>]}
[0m19:44:53.651222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '361d3a98-84fc-4697-add7-75c0bb285a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1759d2d20>]}
[0m19:44:53.651709 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:44:53.782042 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:44:53.866887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:44:53.867207 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:44:53.871659 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m19:44:53.892002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '361d3a98-84fc-4697-add7-75c0bb285a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x175e07f50>]}
[0m19:44:53.937951 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:44:53.939258 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:44:53.951368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '361d3a98-84fc-4697-add7-75c0bb285a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1768364b0>]}
[0m19:44:53.951679 [info ] [MainThread]: Found 6 models, 10 data tests, 496 macros
[0m19:44:53.951879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '361d3a98-84fc-4697-add7-75c0bb285a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x175a09280>]}
[0m19:44:53.952746 [info ] [MainThread]: 
[0m19:44:53.952949 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m19:44:53.953086 [info ] [MainThread]: 
[0m19:44:53.953340 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:44:53.955472 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m19:44:53.955669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:54.941763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m19:44:54.942556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:55.725870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '361d3a98-84fc-4697-add7-75c0bb285a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x175cc8fb0>]}
[0m19:44:55.726908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:44:55.793000 [debug] [Thread-1 (]: Began running node model.my_project.policy_events
[0m19:44:55.793557 [info ] [Thread-1 (]: 1 of 6 START sql view model single_view_policy_assignment.policy_events ........ [RUN]
[0m19:44:55.793903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.policy_events)
[0m19:44:55.794184 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_events
[0m19:44:55.798633 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_events"
[0m19:44:55.799066 [debug] [Thread-1 (]: Began executing node model.my_project.policy_events
[0m19:44:55.816104 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_events"
[0m19:44:55.816680 [debug] [Thread-1 (]: On model.my_project.policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_events"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  OPTIONS()
  as SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    horizontal-ray-467611-f9.single_view_policy_assignment.policy_events_external_table;


[0m19:44:55.816921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:56.830500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:78d72d80-910a-42dc-a4bc-00c42491a284&page=queryresults
[0m19:44:57.245090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '361d3a98-84fc-4697-add7-75c0bb285a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x170ad3890>]}
[0m19:44:57.245647 [info ] [Thread-1 (]: 1 of 6 OK created sql view model single_view_policy_assignment.policy_events ... [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m19:44:57.246076 [debug] [Thread-1 (]: Finished running node model.my_project.policy_events
[0m19:44:57.246532 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m19:44:57.246858 [info ] [Thread-1 (]: 2 of 6 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m19:44:57.247115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_events, now model.my_project.stg_policy_events)
[0m19:44:57.247307 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m19:44:57.250311 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m19:44:57.250865 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m19:44:57.288915 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m19:44:57.289463 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    cluster by policy_id, event_type

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  WHERE policy_id IS NOT NULL
    AND event_type IS NOT NULL
    AND event_timestamp IS NOT NULL
)

SELECT
  *,
  CAST(event_timestamp AS TIMESTAMP) AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m19:44:57.289704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:58.769478 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:457e03a1-b586-488b-8771-017b41190e69&page=queryresults
[0m19:45:00.860438 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:457e03a1-b586-488b-8771-017b41190e69&page=queryresults
[0m19:45:00.878174 [debug] [Thread-1 (]: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Invalid timestamp: 'event_timestamp'
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m19:45:00.878705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '361d3a98-84fc-4697-add7-75c0bb285a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x175e052e0>]}
[0m19:45:00.879189 [error] [Thread-1 (]: 2 of 6 ERROR creating sql incremental model single_view_policy_assignment.stg_policy_events  [[31mERROR[0m in 3.63s]
[0m19:45:00.879710 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m19:45:00.880035 [debug] [Thread-4 (]: Marking all children of 'model.my_project.stg_policy_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Invalid timestamp: 'event_timestamp'
  compiled code at target/run/my_project/models/example/stg_policy_events.sql.
[0m19:45:00.880571 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m19:45:00.881006 [info ] [Thread-1 (]: 3 of 6 SKIP relation single_view_policy_assignment.policy_lifecycle_enriched ... [[33mSKIP[0m]
[0m19:45:00.883571 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m19:45:00.884648 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:45:00.884960 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m19:45:00.885256 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:45:00.885576 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m19:45:00.886285 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m19:45:00.888390 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m19:45:00.889124 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m19:45:00.889801 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m19:45:00.890081 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m19:45:00.890654 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:45:00.936890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:00.937258 [debug] [MainThread]: Connection 'model.my_project.stg_policy_events' was properly closed.
[0m19:45:00.937973 [info ] [MainThread]: 
[0m19:45:00.938518 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 4 view models in 0 hours 0 minutes and 6.98 seconds (6.98s).
[0m19:45:00.939474 [debug] [MainThread]: Command end result
[0m19:45:00.955806 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:45:00.957136 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:45:00.962169 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m19:45:00.962516 [info ] [MainThread]: 
[0m19:45:00.963162 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:45:00.963483 [info ] [MainThread]: 
[0m19:45:00.963846 [error] [MainThread]: [31mFailure in model stg_policy_events (models/example/stg_policy_events.sql)[0m
[0m19:45:00.964317 [error] [MainThread]:   Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Invalid timestamp: 'event_timestamp'
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m19:45:00.964609 [info ] [MainThread]: 
[0m19:45:00.965088 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/stg_policy_events.sql
[0m19:45:00.965434 [info ] [MainThread]: 
[0m19:45:00.965819 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=6
[0m19:45:00.966129 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.700386, "process_in_blocks": "0", "process_kernel_time": 1.117243, "process_mem_max_rss": "389873664", "process_out_blocks": "0", "process_user_time": 4.091778}
[0m19:45:00.966419 [debug] [MainThread]: Command `dbt run` failed at 19:45:00.966369 after 9.70 seconds
[0m19:45:00.966614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f25520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x175c089b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab2d2e0>]}
[0m19:45:00.966793 [debug] [MainThread]: Flushing usage events
[0m19:45:02.059825 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:49:42.050313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a53830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134504d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113450230>]}


============================== 19:49:42.052415 | ad0e4a9b-9503-46cd-a681-e3101f04b311 ==============================
[0m19:49:42.052415 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:49:42.052835 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'fail_fast': 'False', 'no_print': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'empty': 'False', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_format': 'default', 'debug': 'False', 'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'cache_selected_only': 'False'}
[0m19:49:44.462291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad0e4a9b-9503-46cd-a681-e3101f04b311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15aee0f80>]}
[0m19:49:44.489633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad0e4a9b-9503-46cd-a681-e3101f04b311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ae78950>]}
[0m19:49:44.490002 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:49:44.622821 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:49:44.715654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:49:44.716069 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/stg_policy_events.sql
[0m19:49:44.843175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m19:49:44.845881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad0e4a9b-9503-46cd-a681-e3101f04b311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b712e70>]}
[0m19:49:44.887042 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:49:44.888723 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:49:44.902123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad0e4a9b-9503-46cd-a681-e3101f04b311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c087080>]}
[0m19:49:44.902419 [info ] [MainThread]: Found 6 models, 10 data tests, 496 macros
[0m19:49:44.902601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad0e4a9b-9503-46cd-a681-e3101f04b311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b781700>]}
[0m19:49:44.903525 [info ] [MainThread]: 
[0m19:49:44.903750 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m19:49:44.903887 [info ] [MainThread]: 
[0m19:49:44.904133 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:49:44.906289 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m19:49:44.907143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:45.912792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m19:49:45.913795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:46.648818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad0e4a9b-9503-46cd-a681-e3101f04b311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b712d50>]}
[0m19:49:46.649716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:49:46.716085 [debug] [Thread-1 (]: Began running node model.my_project.policy_events
[0m19:49:46.716552 [info ] [Thread-1 (]: 1 of 6 START sql view model single_view_policy_assignment.policy_events ........ [RUN]
[0m19:49:46.716874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.policy_events)
[0m19:49:46.717090 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_events
[0m19:49:46.720746 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_events"
[0m19:49:46.721360 [debug] [Thread-1 (]: Began executing node model.my_project.policy_events
[0m19:49:46.739440 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_events"
[0m19:49:46.740343 [debug] [Thread-1 (]: On model.my_project.policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_events"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  OPTIONS()
  as SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    horizontal-ray-467611-f9.single_view_policy_assignment.policy_events_external_table;


[0m19:49:46.740605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:47.895626 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:cf2cfb5b-43e2-4dd5-a7b3-b8265f92e24b&page=queryresults
[0m19:49:48.547681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad0e4a9b-9503-46cd-a681-e3101f04b311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155cd3950>]}
[0m19:49:48.548204 [info ] [Thread-1 (]: 1 of 6 OK created sql view model single_view_policy_assignment.policy_events ... [[32mCREATE VIEW (0 processed)[0m in 1.83s]
[0m19:49:48.548592 [debug] [Thread-1 (]: Finished running node model.my_project.policy_events
[0m19:49:48.549035 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m19:49:48.549398 [info ] [Thread-1 (]: 2 of 6 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m19:49:48.549705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_events, now model.my_project.stg_policy_events)
[0m19:49:48.549935 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m19:49:48.551834 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m19:49:48.552351 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m19:49:48.584903 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m19:49:48.585615 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    cluster by policy_id, event_type

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  WHERE policy_id IS NOT NULL
    AND event_type IS NOT NULL
    AND event_timestamp IS NOT NULL
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m19:49:48.585856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:49.764565 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:00d1f50d-4abe-489d-b39a-4aa3b2c3a897&page=queryresults
[0m19:49:53.995832 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:00d1f50d-4abe-489d-b39a-4aa3b2c3a897&page=queryresults
[0m19:49:54.010253 [debug] [Thread-1 (]: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Invalid timestamp: 'event_timestamp'
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m19:49:54.012232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad0e4a9b-9503-46cd-a681-e3101f04b311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c37e8d0>]}
[0m19:49:54.013049 [error] [Thread-1 (]: 2 of 6 ERROR creating sql incremental model single_view_policy_assignment.stg_policy_events  [[31mERROR[0m in 5.46s]
[0m19:49:54.013776 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m19:49:54.014347 [debug] [Thread-4 (]: Marking all children of 'model.my_project.stg_policy_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Invalid timestamp: 'event_timestamp'
  compiled code at target/run/my_project/models/example/stg_policy_events.sql.
[0m19:49:54.015181 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m19:49:54.015742 [info ] [Thread-1 (]: 3 of 6 SKIP relation single_view_policy_assignment.policy_lifecycle_enriched ... [[33mSKIP[0m]
[0m19:49:54.016300 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m19:49:54.016967 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:49:54.017440 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m19:49:54.017937 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:49:54.018443 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m19:49:54.018888 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m19:49:54.019325 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m19:49:54.019709 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m19:49:54.020100 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m19:49:54.020493 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m19:49:54.021756 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:49:54.077046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:49:54.077358 [debug] [MainThread]: Connection 'model.my_project.stg_policy_events' was properly closed.
[0m19:49:54.077664 [info ] [MainThread]: 
[0m19:49:54.077926 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 4 view models in 0 hours 0 minutes and 9.17 seconds (9.17s).
[0m19:49:54.078417 [debug] [MainThread]: Command end result
[0m19:49:54.094132 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:49:54.095363 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:49:54.098867 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m19:49:54.099057 [info ] [MainThread]: 
[0m19:49:54.099271 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:49:54.099428 [info ] [MainThread]: 
[0m19:49:54.099800 [error] [MainThread]: [31mFailure in model stg_policy_events (models/example/stg_policy_events.sql)[0m
[0m19:49:54.101058 [error] [MainThread]:   Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Invalid timestamp: 'event_timestamp'
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m19:49:54.101831 [info ] [MainThread]: 
[0m19:49:54.102718 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/stg_policy_events.sql
[0m19:49:54.105210 [info ] [MainThread]: 
[0m19:49:54.105838 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=6
[0m19:49:54.106586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.095862, "process_in_blocks": "0", "process_kernel_time": 1.229074, "process_mem_max_rss": "399966208", "process_out_blocks": "0", "process_user_time": 4.064874}
[0m19:49:54.106970 [debug] [MainThread]: Command `dbt run` failed at 19:49:54.106910 after 12.10 seconds
[0m19:49:54.107191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c5a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ce4ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134509b0>]}
[0m19:49:54.107599 [debug] [MainThread]: Flushing usage events
[0m19:49:55.268406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:57:16.635041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca80b0>]}


============================== 19:57:16.637659 | c0608e84-9372-4e1f-a2bb-04bca5048c50 ==============================
[0m19:57:16.637659 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:57:16.638052 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'quiet': 'False', 'debug': 'False', 'empty': 'False', 'log_format': 'default', 'version_check': 'True', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'log_cache_events': 'False'}
[0m19:57:19.591346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0608e84-9372-4e1f-a2bb-04bca5048c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1693d1160>]}
[0m19:57:19.621752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0608e84-9372-4e1f-a2bb-04bca5048c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f6480>]}
[0m19:57:19.622214 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m19:57:19.756886 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:57:19.852542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:57:19.853082 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/schema.yml
[0m19:57:19.853302 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/stg_policy_events.sql
[0m19:57:20.072270 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m19:57:20.075018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0608e84-9372-4e1f-a2bb-04bca5048c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a1efa40>]}
[0m19:57:20.120128 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:57:20.122024 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:57:20.134477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0608e84-9372-4e1f-a2bb-04bca5048c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a28ab70>]}
[0m19:57:20.134758 [info ] [MainThread]: Found 6 models, 13 data tests, 496 macros
[0m19:57:20.134932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0608e84-9372-4e1f-a2bb-04bca5048c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a03f380>]}
[0m19:57:20.135787 [info ] [MainThread]: 
[0m19:57:20.135983 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m19:57:20.136118 [info ] [MainThread]: 
[0m19:57:20.136365 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:57:20.139245 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m19:57:20.139777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:21.134386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m19:57:21.135276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:21.870619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0608e84-9372-4e1f-a2bb-04bca5048c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050aad80>]}
[0m19:57:21.871453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:57:21.938181 [debug] [Thread-1 (]: Began running node model.my_project.policy_events
[0m19:57:21.938624 [info ] [Thread-1 (]: 1 of 6 START sql view model single_view_policy_assignment.policy_events ........ [RUN]
[0m19:57:21.938925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.policy_events)
[0m19:57:21.939139 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_events
[0m19:57:21.943026 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_events"
[0m19:57:21.943883 [debug] [Thread-1 (]: Began executing node model.my_project.policy_events
[0m19:57:21.960059 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_events"
[0m19:57:21.960704 [debug] [Thread-1 (]: On model.my_project.policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_events"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  OPTIONS()
  as SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    horizontal-ray-467611-f9.single_view_policy_assignment.policy_events_external_table;


[0m19:57:21.960957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:23.153890 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:d99274b6-3a5d-41b8-9fdc-7fd483b9c936&page=queryresults
[0m19:57:23.794615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0608e84-9372-4e1f-a2bb-04bca5048c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b4bb9e0>]}
[0m19:57:23.795068 [info ] [Thread-1 (]: 1 of 6 OK created sql view model single_view_policy_assignment.policy_events ... [[32mCREATE VIEW (0 processed)[0m in 1.86s]
[0m19:57:23.795435 [debug] [Thread-1 (]: Finished running node model.my_project.policy_events
[0m19:57:23.795851 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m19:57:23.796147 [info ] [Thread-1 (]: 2 of 6 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m19:57:23.796388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_events, now model.my_project.stg_policy_events)
[0m19:57:23.796564 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m19:57:23.799053 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m19:57:23.799770 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m19:57:23.833038 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m19:57:23.833782 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    cluster by policy_id, event_type

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m19:57:23.834089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:25.164607 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:1d79b950-b426-4cf9-91bf-35b93fccea87&page=queryresults
[0m19:57:27.336881 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:1d79b950-b426-4cf9-91bf-35b93fccea87&page=queryresults
[0m19:57:27.347761 [debug] [Thread-1 (]: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Invalid timestamp: 'event_timestamp'
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m19:57:27.349273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0608e84-9372-4e1f-a2bb-04bca5048c50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a341dc0>]}
[0m19:57:27.349855 [error] [Thread-1 (]: 2 of 6 ERROR creating sql incremental model single_view_policy_assignment.stg_policy_events  [[31mERROR[0m in 3.55s]
[0m19:57:27.350336 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m19:57:27.350749 [debug] [Thread-4 (]: Marking all children of 'model.my_project.stg_policy_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Invalid timestamp: 'event_timestamp'
  compiled code at target/run/my_project/models/example/stg_policy_events.sql.
[0m19:57:27.351300 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m19:57:27.351720 [info ] [Thread-1 (]: 3 of 6 SKIP relation single_view_policy_assignment.policy_lifecycle_enriched ... [[33mSKIP[0m]
[0m19:57:27.352022 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m19:57:27.352500 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:57:27.352896 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m19:57:27.353239 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m19:57:27.353539 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m19:57:27.353827 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m19:57:27.354104 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m19:57:27.354364 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m19:57:27.354657 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m19:57:27.355019 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m19:57:27.356016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:57:27.404910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:27.405208 [debug] [MainThread]: Connection 'model.my_project.stg_policy_events' was properly closed.
[0m19:57:27.405442 [info ] [MainThread]: 
[0m19:57:27.405646 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 4 view models in 0 hours 0 minutes and 7.27 seconds (7.27s).
[0m19:57:27.406105 [debug] [MainThread]: Command end result
[0m19:57:27.560770 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m19:57:27.562377 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m19:57:27.565477 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m19:57:27.565666 [info ] [MainThread]: 
[0m19:57:27.565860 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:57:27.566014 [info ] [MainThread]: 
[0m19:57:27.566204 [error] [MainThread]: [31mFailure in model stg_policy_events (models/example/stg_policy_events.sql)[0m
[0m19:57:27.566416 [error] [MainThread]:   Database Error in model stg_policy_events (models/example/stg_policy_events.sql)
  Invalid timestamp: 'event_timestamp'
  compiled code at target/run/my_project/models/example/stg_policy_events.sql
[0m19:57:27.566601 [info ] [MainThread]: 
[0m19:57:27.566783 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/stg_policy_events.sql
[0m19:57:27.566958 [info ] [MainThread]: 
[0m19:57:27.567173 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=4 NO-OP=0 TOTAL=6
[0m19:57:27.567498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.974905, "process_in_blocks": "0", "process_kernel_time": 1.000053, "process_mem_max_rss": "404111360", "process_out_blocks": "0", "process_user_time": 4.721327}
[0m19:57:27.567798 [debug] [MainThread]: Command `dbt run` failed at 19:57:27.567749 after 10.98 seconds
[0m19:57:27.567997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a656b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a656a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a657e60>]}
[0m19:57:27.568178 [debug] [MainThread]: Flushing usage events
[0m19:57:28.737051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:14:45.836351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060844a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106087c20>]}


============================== 20:14:45.838471 | 623ec063-e656-4b5e-9f83-6785ecc5f49f ==============================
[0m20:14:45.838471 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:14:45.838853 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'use_experimental_parser': 'False', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'invocation_command': 'dbt clean', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_format': 'default', 'use_colors': 'True', 'debug': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'static_parser': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'no_print': 'None', 'target_path': 'None', 'indirect_selection': 'eager'}
[0m20:14:45.961637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '623ec063-e656-4b5e-9f83-6785ecc5f49f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110021910>]}
[0m20:14:45.979616 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18056479, "process_in_blocks": "0", "process_kernel_time": 0.172272, "process_mem_max_rss": "107708416", "process_out_blocks": "0", "process_user_time": 0.756703}
[0m20:14:45.979967 [debug] [MainThread]: Command `dbt clean` succeeded at 20:14:45.979915 after 0.18 seconds
[0m20:14:45.980176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107737dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106087c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110047e60>]}
[0m20:14:45.980387 [debug] [MainThread]: Flushing usage events
[0m20:14:47.133952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:14:51.820588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107502240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201b2660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a3c110>]}


============================== 20:14:51.822495 | 4671374c-b0a4-4cd3-9029-ed1f40f93afb ==============================
[0m20:14:51.822495 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:14:51.822934 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --full-refresh', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'False', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'warn_error': 'None', 'version_check': 'True', 'target_path': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'introspect': 'True', 'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'debug': 'False'}
[0m20:14:54.140418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4671374c-b0a4-4cd3-9029-ed1f40f93afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a9318b0>]}
[0m20:14:54.167347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4671374c-b0a4-4cd3-9029-ed1f40f93afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12028c170>]}
[0m20:14:54.167734 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:14:54.298852 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:14:54.299344 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:14:54.299613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4671374c-b0a4-4cd3-9029-ed1f40f93afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ae64110>]}
[0m20:14:54.904107 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m20:14:54.906600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4671374c-b0a4-4cd3-9029-ed1f40f93afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b3a43b0>]}
[0m20:14:54.953521 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m20:14:54.954867 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m20:14:54.970301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4671374c-b0a4-4cd3-9029-ed1f40f93afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b56e4b0>]}
[0m20:14:54.970651 [info ] [MainThread]: Found 6 models, 13 data tests, 496 macros
[0m20:14:54.970844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4671374c-b0a4-4cd3-9029-ed1f40f93afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b014c20>]}
[0m20:14:54.971800 [info ] [MainThread]: 
[0m20:14:54.972098 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m20:14:54.972284 [info ] [MainThread]: 
[0m20:14:54.972556 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:14:54.974526 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m20:14:54.974755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:55.998903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m20:14:55.999725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:56.767023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4671374c-b0a4-4cd3-9029-ed1f40f93afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b388f50>]}
[0m20:14:56.768015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:14:56.832294 [debug] [Thread-1 (]: Began running node model.my_project.policy_events
[0m20:14:56.832778 [info ] [Thread-1 (]: 1 of 6 START sql view model single_view_policy_assignment.policy_events ........ [RUN]
[0m20:14:56.833116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.policy_events)
[0m20:14:56.833341 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_events
[0m20:14:56.837537 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_events"
[0m20:14:56.838393 [debug] [Thread-1 (]: Began executing node model.my_project.policy_events
[0m20:14:56.854784 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_events"
[0m20:14:56.855483 [debug] [Thread-1 (]: On model.my_project.policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_events"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
  OPTIONS()
  as SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    horizontal-ray-467611-f9.single_view_policy_assignment.policy_events_external_table;


[0m20:14:56.855744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:58.041325 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:660aaa27-d502-4ef0-b493-de49a9188406&page=queryresults
[0m20:14:58.523952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4671374c-b0a4-4cd3-9029-ed1f40f93afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154fd3950>]}
[0m20:14:58.524450 [info ] [Thread-1 (]: 1 of 6 OK created sql view model single_view_policy_assignment.policy_events ... [[32mCREATE VIEW (0 processed)[0m in 1.69s]
[0m20:14:58.524903 [debug] [Thread-1 (]: Finished running node model.my_project.policy_events
[0m20:14:58.525367 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m20:14:58.525678 [info ] [Thread-1 (]: 2 of 6 START sql incremental model single_view_policy_assignment.stg_policy_events  [RUN]
[0m20:14:58.525957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_events, now model.my_project.stg_policy_events)
[0m20:14:58.526194 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m20:14:58.527962 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m20:14:58.528304 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m20:14:58.563115 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m20:14:58.563719 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    cluster by policy_id, event_type

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m20:14:58.563967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:00.298343 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:74ff0120-5506-447e-82bd-b4eabfcab6a0&page=queryresults
[0m20:15:02.661394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4671374c-b0a4-4cd3-9029-ed1f40f93afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107558860>]}
[0m20:15:02.662631 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 4.14s]
[0m20:15:02.663644 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m20:15:02.664966 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m20:15:02.665767 [info ] [Thread-1 (]: 3 of 6 START sql table model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m20:15:02.666440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m20:15:02.667007 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m20:15:02.674021 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m20:15:02.675440 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m20:15:02.695801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:03.426617 [debug] [Thread-1 (]: Hard refreshing `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched` because it is not replaceable
[0m20:15:03.615997 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m20:15:03.617207 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type,
    event_ts
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      --event_ts,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    
    -- Status logic
    CASE
      WHEN f.first_cancel_ts IS NOT NULL AND l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN f.first_bind_ts IS NOT NULL THEN 'bound'
      ELSE 'quoted'
    END AS current_status,
--not required since last_evt is giving the last_evt
    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
      ELSE NULL
    END AS quote_to_bind_mins,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
      ELSE NULL
    END AS bind_to_cancel_mins,

    -- Month name 
    FORMAT_DATE('%Y-%m', event_timestamp)) AS event_month
-- should be just event_timestamp
  FROM firsts f
  LEFT JOIN last_evt l ON f.policy_id = l.policy_id
),

filtered AS (
  SELECT *
  FROM final
  WHERE
    -- At least one timestamp
    (first_quote_ts IS NOT NULL OR first_bind_ts IS NOT NULL OR first_cancel_ts IS NOT NULL)

    -- Valid durations
    AND (quote_to_bind_mins IS NULL OR quote_to_bind_mins >= 0)
    AND (bind_to_cancel_mins IS NULL OR bind_to_cancel_mins >= 0)

    -- Valid statuses
    AND current_status IN ('quoted', 'bound', 'cancelled')
)

SELECT * FROM filtered
    );
  
[0m20:15:04.500433 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:3f196a7f-8285-4c6d-9770-804320116ed0&page=queryresults
[0m20:15:04.502463 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:3f196a7f-8285-4c6d-9770-804320116ed0&page=queryresults
[0m20:15:04.514953 [debug] [Thread-1 (]: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Syntax error: Unexpected keyword AS at [70:44]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:15:04.516232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4671374c-b0a4-4cd3-9029-ed1f40f93afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b174950>]}
[0m20:15:04.517552 [error] [Thread-1 (]: 3 of 6 ERROR creating sql table model single_view_policy_assignment.policy_lifecycle_enriched  [[31mERROR[0m in 1.85s]
[0m20:15:04.518428 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m20:15:04.519080 [debug] [Thread-4 (]: Marking all children of 'model.my_project.policy_lifecycle_enriched' to be skipped because of status 'error'.  Reason: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Syntax error: Unexpected keyword AS at [70:44]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql.
[0m20:15:04.519937 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m20:15:04.520556 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m20:15:04.521016 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m20:15:04.521424 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m20:15:04.521839 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m20:15:04.522248 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m20:15:04.522631 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m20:15:04.523111 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m20:15:04.523657 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m20:15:04.525330 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:15:04.577639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:04.577971 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m20:15:04.578222 [info ] [MainThread]: 
[0m20:15:04.578419 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 4 view models in 0 hours 0 minutes and 9.61 seconds (9.61s).
[0m20:15:04.578951 [debug] [MainThread]: Command end result
[0m20:15:04.595857 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m20:15:04.597266 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m20:15:04.600231 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m20:15:04.600414 [info ] [MainThread]: 
[0m20:15:04.600604 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:15:04.600747 [info ] [MainThread]: 
[0m20:15:04.600939 [error] [MainThread]: [31mFailure in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)[0m
[0m20:15:04.601117 [error] [MainThread]:   Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Syntax error: Unexpected keyword AS at [70:44]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:15:04.601246 [info ] [MainThread]: 
[0m20:15:04.601402 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:15:04.601533 [info ] [MainThread]: 
[0m20:15:04.601689 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=6
[0m20:15:04.601937 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.818601, "process_in_blocks": "0", "process_kernel_time": 1.214877, "process_mem_max_rss": "397557760", "process_out_blocks": "0", "process_user_time": 4.57553}
[0m20:15:04.602184 [debug] [MainThread]: Command `dbt run` failed at 20:15:04.602144 after 12.82 seconds
[0m20:15:04.602363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b5cd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b2f9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b2f8aa0>]}
[0m20:15:04.602520 [debug] [MainThread]: Flushing usage events
[0m20:15:05.681941 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:44:32.442841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115653920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115f0bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a84fe0>]}


============================== 20:44:32.445194 | 1e183076-9737-47ed-b051-d0cad2711a2f ==============================
[0m20:44:32.445194 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:44:32.445654 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'no_print': 'None', 'write_json': 'True', 'empty': 'None', 'version_check': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'target_path': 'None', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_format': 'default', 'debug': 'False', 'quiet': 'False', 'invocation_command': 'dbt clean', 'introspect': 'True', 'fail_fast': 'False'}
[0m20:44:32.586573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e183076-9737-47ed-b051-d0cad2711a2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a84470>]}
[0m20:44:32.599876 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19564795, "process_in_blocks": "0", "process_kernel_time": 0.185083, "process_mem_max_rss": "107610112", "process_out_blocks": "0", "process_user_time": 0.786305}
[0m20:44:32.600290 [debug] [MainThread]: Command `dbt clean` succeeded at 20:44:32.600225 after 0.20 seconds
[0m20:44:32.600495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114aeb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116947e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d95160>]}
[0m20:44:32.600672 [debug] [MainThread]: Flushing usage events
[0m20:44:34.510547 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:32.517490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0aa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd3b90>]}


============================== 20:51:32.519356 | 1ba04c12-3555-4b72-a3c5-6e9ccc74168a ==============================
[0m20:51:32.519356 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:51:32.519723 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'quiet': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'version_check': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'invocation_command': 'dbt clean', 'write_json': 'True', 'log_format': 'default', 'printer_width': '80', 'introspect': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'target_path': 'None'}
[0m20:51:32.594170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ba04c12-3555-4b72-a3c5-6e9ccc74168a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c370b0>]}
[0m20:51:32.606593 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12582554, "process_in_blocks": "0", "process_kernel_time": 0.142682, "process_mem_max_rss": "108347392", "process_out_blocks": "0", "process_user_time": 0.740092}
[0m20:51:32.606908 [debug] [MainThread]: Command `dbt clean` succeeded at 20:51:32.606855 after 0.13 seconds
[0m20:51:32.607090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d57f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d80620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c370b0>]}
[0m20:51:32.607259 [debug] [MainThread]: Flushing usage events
[0m20:51:34.515268 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:47.140066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e02690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c05c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c0320>]}


============================== 20:51:47.141624 | 92c4007c-5a1d-4403-93da-9c1b31cbae4a ==============================
[0m20:51:47.141624 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:51:47.142069 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'indirect_selection': 'eager', 'warn_error': 'None', 'debug': 'False', 'empty': 'False', 'version_check': 'True', 'introspect': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'fail_fast': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --full-refresh', 'printer_width': '80', 'cache_selected_only': 'False', 'partial_parse': 'True'}
[0m20:51:49.502630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92c4007c-5a1d-4403-93da-9c1b31cbae4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15279e540>]}
[0m20:51:49.529001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92c4007c-5a1d-4403-93da-9c1b31cbae4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152b66420>]}
[0m20:51:49.529373 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:51:49.658245 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:51:49.658824 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:51:49.659052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '92c4007c-5a1d-4403-93da-9c1b31cbae4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152b04470>]}
[0m20:51:50.329576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m20:51:50.332190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92c4007c-5a1d-4403-93da-9c1b31cbae4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab6300>]}
[0m20:51:50.382228 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m20:51:50.383647 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m20:51:50.395975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92c4007c-5a1d-4403-93da-9c1b31cbae4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153bae8a0>]}
[0m20:51:50.396485 [info ] [MainThread]: Found 6 models, 12 data tests, 496 macros
[0m20:51:50.396729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92c4007c-5a1d-4403-93da-9c1b31cbae4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153a6f5c0>]}
[0m20:51:50.397707 [info ] [MainThread]: 
[0m20:51:50.398140 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m20:51:50.398312 [info ] [MainThread]: 
[0m20:51:50.398579 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:51:50.400540 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m20:51:50.400736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:51.397401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m20:51:51.398135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:52.151110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92c4007c-5a1d-4403-93da-9c1b31cbae4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153bdcf50>]}
[0m20:51:52.152437 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:52.215700 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m20:51:52.216183 [info ] [Thread-1 (]: 1 of 6 START sql table model single_view_policy_assignment.raw_policy_events ... [RUN]
[0m20:51:52.216539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m20:51:52.216776 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m20:51:52.220807 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m20:51:52.221853 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m20:51:52.246613 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m20:51:52.247351 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    horizontal-ray-467611-f9.single_view_policy_assignment.policy_events_external_table
    );
  
[0m20:51:52.247599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:54.326790 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:8e6c63bf-2bad-4574-83a6-afd4edd2ccbf&page=queryresults
[0m20:51:56.490231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92c4007c-5a1d-4403-93da-9c1b31cbae4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1538e8590>]}
[0m20:51:56.491070 [info ] [Thread-1 (]: 1 of 6 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 4.27s]
[0m20:51:56.491904 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m20:51:56.492911 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m20:51:56.493449 [info ] [Thread-1 (]: 2 of 6 START sql table model single_view_policy_assignment.stg_policy_events ... [RUN]
[0m20:51:56.493807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m20:51:56.494066 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m20:51:56.496244 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m20:51:56.496962 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m20:51:56.498621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:57.208291 [debug] [Thread-1 (]: Hard refreshing `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events` because it is not replaceable
[0m20:51:57.354203 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m20:51:57.355820 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m20:51:58.014979 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:b88b7eb5-6086-4dec-a6bb-6ec0bf577638&page=queryresults
[0m20:51:59.941982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92c4007c-5a1d-4403-93da-9c1b31cbae4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153c9a570>]}
[0m20:51:59.942923 [info ] [Thread-1 (]: 2 of 6 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.45s]
[0m20:51:59.943801 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m20:51:59.944859 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m20:51:59.945642 [info ] [Thread-1 (]: 3 of 6 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m20:51:59.946350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m20:51:59.946873 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m20:51:59.953213 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m20:51:59.954460 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m20:51:59.997352 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m20:51:59.998087 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type,
    event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      event_month
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    l.event_ts
    l.source_channel,
    l.state,
    l.product_type,
    l.premium_amount
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
      ELSE NULL
    END AS quote_to_bind_mins,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
      ELSE NULL
    END AS bind_to_cancel_mins,
    l.event_month
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
),


SELECT * FROM final
    );
  
[0m20:51:59.998432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:01.483236 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:e011fbd7-6c4a-4945-934f-c8e64c15ae3a&page=queryresults
[0m20:52:01.484196 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:e011fbd7-6c4a-4945-934f-c8e64c15ae3a&page=queryresults
[0m20:52:01.493996 [debug] [Thread-1 (]: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Syntax error: Expected ")" but got "(" at [41:17]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:52:01.494619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92c4007c-5a1d-4403-93da-9c1b31cbae4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152edeb70>]}
[0m20:52:01.496119 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[31mERROR[0m in 1.55s]
[0m20:52:01.497650 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m20:52:01.498523 [debug] [Thread-4 (]: Marking all children of 'model.my_project.policy_lifecycle_enriched' to be skipped because of status 'error'.  Reason: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Syntax error: Expected ")" but got "(" at [41:17]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql.
[0m20:52:01.499187 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m20:52:01.500091 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m20:52:01.500592 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m20:52:01.500887 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m20:52:01.501183 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m20:52:01.501464 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m20:52:01.501725 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m20:52:01.502003 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m20:52:01.502433 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m20:52:01.503269 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:01.547219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:01.547531 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m20:52:01.547794 [info ] [MainThread]: 
[0m20:52:01.548016 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 11.15 seconds (11.15s).
[0m20:52:01.548632 [debug] [MainThread]: Command end result
[0m20:52:01.563097 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m20:52:01.564276 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m20:52:01.567179 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m20:52:01.567363 [info ] [MainThread]: 
[0m20:52:01.567564 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:52:01.567727 [info ] [MainThread]: 
[0m20:52:01.567938 [error] [MainThread]: [31mFailure in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)[0m
[0m20:52:01.568127 [error] [MainThread]:   Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Syntax error: Expected ")" but got "(" at [41:17]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:52:01.568265 [info ] [MainThread]: 
[0m20:52:01.568433 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:52:01.568579 [info ] [MainThread]: 
[0m20:52:01.568741 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=6
[0m20:52:01.568990 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.463328, "process_in_blocks": "0", "process_kernel_time": 0.984195, "process_mem_max_rss": "395247616", "process_out_blocks": "0", "process_user_time": 4.844259}
[0m20:52:01.569217 [debug] [MainThread]: Command `dbt run` failed at 20:52:01.569179 after 14.46 seconds
[0m20:52:01.569388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1538df620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1538dd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152f7a0c0>]}
[0m20:52:01.569541 [debug] [MainThread]: Flushing usage events
[0m20:52:02.665347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:53:46.241731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b4b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109207b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109230110>]}


============================== 20:53:46.243795 | c5362222-2b10-49f0-bd9b-96b61030b058 ==============================
[0m20:53:46.243795 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:53:46.244310 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'static_parser': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'fail_fast': 'False', 'partial_parse': 'True', 'debug': 'False', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m20:53:48.461102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5362222-2b10-49f0-bd9b-96b61030b058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16df6b890>]}
[0m20:53:48.487377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5362222-2b10-49f0-bd9b-96b61030b058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d2f6d20>]}
[0m20:53:48.487870 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:53:48.614327 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:53:48.702069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:53:48.702588 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/policy_lifecycle_enriched.sql
[0m20:53:48.910351 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m20:53:48.912947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5362222-2b10-49f0-bd9b-96b61030b058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16feddac0>]}
[0m20:53:48.952837 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m20:53:48.954108 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m20:53:48.965898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5362222-2b10-49f0-bd9b-96b61030b058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ff29550>]}
[0m20:53:48.966166 [info ] [MainThread]: Found 6 models, 12 data tests, 496 macros
[0m20:53:48.966337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5362222-2b10-49f0-bd9b-96b61030b058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bc4f080>]}
[0m20:53:48.967284 [info ] [MainThread]: 
[0m20:53:48.967528 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m20:53:48.967754 [info ] [MainThread]: 
[0m20:53:48.968204 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:53:48.971622 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m20:53:48.971955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:49.935164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m20:53:49.936010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:50.683688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5362222-2b10-49f0-bd9b-96b61030b058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16e6aa1b0>]}
[0m20:53:50.684949 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:53:50.751335 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m20:53:50.751824 [info ] [Thread-1 (]: 1 of 6 START sql table model single_view_policy_assignment.raw_policy_events ... [RUN]
[0m20:53:50.752242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m20:53:50.752478 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m20:53:50.758572 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m20:53:50.759427 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m20:53:50.769482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:51.495318 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m20:53:51.496394 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    horizontal-ray-467611-f9.single_view_policy_assignment.policy_events_external_table
    );
  
[0m20:53:52.196321 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:1dd71a8b-4ac5-4d4d-95e4-b3fb56703649&page=queryresults
[0m20:53:54.094328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5362222-2b10-49f0-bd9b-96b61030b058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f2bbbc0>]}
[0m20:53:54.095204 [info ] [Thread-1 (]: 1 of 6 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 3.34s]
[0m20:53:54.095904 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m20:53:54.096601 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m20:53:54.097353 [info ] [Thread-1 (]: 2 of 6 START sql table model single_view_policy_assignment.stg_policy_events ... [RUN]
[0m20:53:54.097884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m20:53:54.098463 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m20:53:54.102975 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m20:53:54.103753 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m20:53:54.105519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:54.785083 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m20:53:54.787279 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m20:53:55.276134 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:62987295-f6e5-4c13-becd-354086a45f33&page=queryresults
[0m20:53:57.359769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5362222-2b10-49f0-bd9b-96b61030b058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16e6a89e0>]}
[0m20:53:57.361079 [info ] [Thread-1 (]: 2 of 6 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.26s]
[0m20:53:57.362201 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m20:53:57.363202 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m20:53:57.364072 [info ] [Thread-1 (]: 3 of 6 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m20:53:57.364674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m20:53:57.365123 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m20:53:57.371816 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m20:53:57.373488 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m20:53:57.415742 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m20:53:57.416402 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type,
    event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      event_month,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    l.event_ts
    l.source_channel,
    l.state,
    l.product_type,
    l.premium_amount
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
      ELSE NULL
    END AS quote_to_bind_mins,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
      ELSE NULL
    END AS bind_to_cancel_mins,
    l.event_month
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
),


SELECT * FROM final
    );
  
[0m20:53:57.416725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:58.411202 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:3b3ed16d-f5c3-4447-b3cd-55061742a65b&page=queryresults
[0m20:53:58.412848 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:3b3ed16d-f5c3-4447-b3cd-55061742a65b&page=queryresults
[0m20:53:58.425362 [debug] [Thread-1 (]: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Syntax error: Expected ")" but got "." at [51:6]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:53:58.427722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5362222-2b10-49f0-bd9b-96b61030b058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x171312720>]}
[0m20:53:58.428664 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[31mERROR[0m in 1.06s]
[0m20:53:58.430518 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m20:53:58.431410 [debug] [Thread-4 (]: Marking all children of 'model.my_project.policy_lifecycle_enriched' to be skipped because of status 'error'.  Reason: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Syntax error: Expected ")" but got "." at [51:6]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql.
[0m20:53:58.432361 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m20:53:58.432991 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m20:53:58.433633 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m20:53:58.434373 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m20:53:58.434952 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m20:53:58.435596 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m20:53:58.436441 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m20:53:58.437329 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m20:53:58.438120 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m20:53:58.439195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:53:58.493519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:58.493834 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m20:53:58.494098 [info ] [MainThread]: 
[0m20:53:58.494364 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 9.53 seconds (9.53s).
[0m20:53:58.494950 [debug] [MainThread]: Command end result
[0m20:53:58.632566 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m20:53:58.633491 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m20:53:58.636428 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m20:53:58.636615 [info ] [MainThread]: 
[0m20:53:58.636811 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:53:58.636960 [info ] [MainThread]: 
[0m20:53:58.637170 [error] [MainThread]: [31mFailure in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)[0m
[0m20:53:58.637349 [error] [MainThread]:   Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Syntax error: Expected ")" but got "." at [51:6]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:53:58.637482 [info ] [MainThread]: 
[0m20:53:58.637635 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:53:58.637764 [info ] [MainThread]: 
[0m20:53:58.637919 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=6
[0m20:53:58.638155 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.433687, "process_in_blocks": "0", "process_kernel_time": 1.035316, "process_mem_max_rss": "408387584", "process_out_blocks": "0", "process_user_time": 4.541622}
[0m20:53:58.638400 [debug] [MainThread]: Command `dbt run` failed at 20:53:58.638364 after 12.43 seconds
[0m20:53:58.638557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17135a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17135bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17135a630>]}
[0m20:53:58.638705 [debug] [MainThread]: Flushing usage events
[0m20:53:59.777554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:19.765267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b385f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bdce30>]}


============================== 20:54:19.767945 | ba3bd4ca-82a6-4275-a334-3ac3c002cdb7 ==============================
[0m20:54:19.767945 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:54:19.768373 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'warn_error': 'None', 'use_colors': 'True', 'no_print': 'None', 'quiet': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'printer_width': '80', 'fail_fast': 'False', 'version_check': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'target_path': 'None', 'empty': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh'}
[0m20:54:22.024615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba3bd4ca-82a6-4275-a334-3ac3c002cdb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16af6b200>]}
[0m20:54:22.051275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba3bd4ca-82a6-4275-a334-3ac3c002cdb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ac36c00>]}
[0m20:54:22.051692 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:54:22.190527 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:54:22.273433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:54:22.273898 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/policy_lifecycle_enriched.sql
[0m20:54:22.482844 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m20:54:22.485445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba3bd4ca-82a6-4275-a334-3ac3c002cdb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16be88d10>]}
[0m20:54:22.527192 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m20:54:22.528545 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m20:54:22.539793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba3bd4ca-82a6-4275-a334-3ac3c002cdb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ba66960>]}
[0m20:54:22.540077 [info ] [MainThread]: Found 6 models, 12 data tests, 496 macros
[0m20:54:22.540262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba3bd4ca-82a6-4275-a334-3ac3c002cdb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bc8bda0>]}
[0m20:54:22.541142 [info ] [MainThread]: 
[0m20:54:22.541362 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m20:54:22.541504 [info ] [MainThread]: 
[0m20:54:22.541752 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:54:22.543788 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m20:54:22.544047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:23.513909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m20:54:23.514871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:24.230566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba3bd4ca-82a6-4275-a334-3ac3c002cdb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f210a0>]}
[0m20:54:24.231920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:24.296473 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m20:54:24.297243 [info ] [Thread-1 (]: 1 of 6 START sql table model single_view_policy_assignment.raw_policy_events ... [RUN]
[0m20:54:24.298231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m20:54:24.298774 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m20:54:24.303385 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m20:54:24.304232 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m20:54:24.314255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:25.066203 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m20:54:25.067181 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    horizontal-ray-467611-f9.single_view_policy_assignment.policy_events_external_table
    );
  
[0m20:54:25.497220 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:25303e6a-66a0-4a46-af3f-d5e4a1e803da&page=queryresults
[0m20:54:27.570313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba3bd4ca-82a6-4275-a334-3ac3c002cdb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165cbba70>]}
[0m20:54:27.571359 [info ] [Thread-1 (]: 1 of 6 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 3.27s]
[0m20:54:27.572723 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m20:54:27.573594 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m20:54:27.574230 [info ] [Thread-1 (]: 2 of 6 START sql table model single_view_policy_assignment.stg_policy_events ... [RUN]
[0m20:54:27.574719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m20:54:27.575083 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m20:54:27.579591 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m20:54:27.580271 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m20:54:27.582082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:28.262911 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m20:54:28.264850 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m20:54:28.613434 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:0568a722-55a8-4258-b100-7ccb7a602a26&page=queryresults
[0m20:54:30.716602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba3bd4ca-82a6-4275-a334-3ac3c002cdb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16fbbc620>]}
[0m20:54:30.718020 [info ] [Thread-1 (]: 2 of 6 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.14s]
[0m20:54:30.719187 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m20:54:30.720539 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m20:54:30.721435 [info ] [Thread-1 (]: 3 of 6 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m20:54:30.722095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m20:54:30.722622 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m20:54:30.729534 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m20:54:30.730771 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m20:54:30.773611 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m20:54:30.774292 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type,
    event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      event_month,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    l.event_ts
    l.source_channel,
    l.state,
    l.product_type,
    l.premium_amount,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
      ELSE NULL
    END AS quote_to_bind_mins,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
      ELSE NULL
    END AS bind_to_cancel_mins,
    l.event_month
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
),


SELECT * FROM final
    );
  
[0m20:54:30.774687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:31.780736 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:ae461652-7859-464c-8629-6091bad10403&page=queryresults
[0m20:54:31.782482 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:ae461652-7859-464c-8629-6091bad10403&page=queryresults
[0m20:54:31.795777 [debug] [Thread-1 (]: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Syntax error: Expected ")" but got "." at [51:6]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:54:31.796738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba3bd4ca-82a6-4275-a334-3ac3c002cdb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bfd0950>]}
[0m20:54:31.797501 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[31mERROR[0m in 1.07s]
[0m20:54:31.798206 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m20:54:31.798736 [debug] [Thread-4 (]: Marking all children of 'model.my_project.policy_lifecycle_enriched' to be skipped because of status 'error'.  Reason: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Syntax error: Expected ")" but got "." at [51:6]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql.
[0m20:54:31.799780 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m20:54:31.801546 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m20:54:31.802219 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m20:54:31.802694 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m20:54:31.803192 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m20:54:31.803899 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m20:54:31.804827 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m20:54:31.805547 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m20:54:31.806006 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m20:54:31.807167 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:54:31.858752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:31.859121 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m20:54:31.859378 [info ] [MainThread]: 
[0m20:54:31.859610 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 9.32 seconds (9.32s).
[0m20:54:31.860227 [debug] [MainThread]: Command end result
[0m20:54:31.998850 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m20:54:32.000072 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m20:54:32.004324 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m20:54:32.004562 [info ] [MainThread]: 
[0m20:54:32.004770 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:54:32.004945 [info ] [MainThread]: 
[0m20:54:32.005201 [error] [MainThread]: [31mFailure in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)[0m
[0m20:54:32.005468 [error] [MainThread]:   Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Syntax error: Expected ")" but got "." at [51:6]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:54:32.005643 [info ] [MainThread]: 
[0m20:54:32.005835 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:54:32.005982 [info ] [MainThread]: 
[0m20:54:32.006148 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=6
[0m20:54:32.006406 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.278485, "process_in_blocks": "0", "process_kernel_time": 1.217827, "process_mem_max_rss": "397312000", "process_out_blocks": "0", "process_user_time": 4.393285}
[0m20:54:32.006656 [debug] [MainThread]: Command `dbt run` failed at 20:54:32.006617 after 12.28 seconds
[0m20:54:32.006821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b4a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109928d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ed520>]}
[0m20:54:32.006984 [debug] [MainThread]: Flushing usage events
[0m20:54:33.118732 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:54:47.396436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107607440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11123c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11123c1a0>]}


============================== 20:54:47.398196 | 26c315e7-e8ae-4c67-9485-aef08e6a1d8c ==============================
[0m20:54:47.398196 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:54:47.398668 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'empty': 'False', 'no_print': 'None', 'printer_width': '80', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'target_path': 'None', 'quiet': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'introspect': 'True', 'version_check': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'invocation_command': 'dbt run --full-refresh', 'log_cache_events': 'False', 'use_colors': 'True'}
[0m20:54:49.743641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26c315e7-e8ae-4c67-9485-aef08e6a1d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111210da0>]}
[0m20:54:49.771599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26c315e7-e8ae-4c67-9485-aef08e6a1d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17229ad20>]}
[0m20:54:49.772038 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:54:49.899204 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:54:49.984464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:54:49.984960 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/policy_lifecycle_enriched.sql
[0m20:54:50.188034 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m20:54:50.190629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26c315e7-e8ae-4c67-9485-aef08e6a1d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x173dd4980>]}
[0m20:54:50.231768 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m20:54:50.233130 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m20:54:50.244556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26c315e7-e8ae-4c67-9485-aef08e6a1d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x173e1f9e0>]}
[0m20:54:50.244827 [info ] [MainThread]: Found 6 models, 12 data tests, 496 macros
[0m20:54:50.245013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26c315e7-e8ae-4c67-9485-aef08e6a1d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16fa3f710>]}
[0m20:54:50.245863 [info ] [MainThread]: 
[0m20:54:50.246078 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m20:54:50.246225 [info ] [MainThread]: 
[0m20:54:50.246479 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:54:50.248413 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m20:54:50.248683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:54:51.214388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m20:54:51.215331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:54:51.929280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26c315e7-e8ae-4c67-9485-aef08e6a1d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172b521e0>]}
[0m20:54:51.929772 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:54:51.973938 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m20:54:51.974325 [info ] [Thread-1 (]: 1 of 6 START sql table model single_view_policy_assignment.raw_policy_events ... [RUN]
[0m20:54:51.974601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m20:54:51.974789 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m20:54:51.979034 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m20:54:51.979802 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m20:54:51.988555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:52.721421 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m20:54:52.722896 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    horizontal-ray-467611-f9.single_view_policy_assignment.policy_events_external_table
    );
  
[0m20:54:53.053181 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a0b40452-71d2-4b1d-ba4d-613ba66536f2&page=queryresults
[0m20:54:55.114167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26c315e7-e8ae-4c67-9485-aef08e6a1d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b4bbc20>]}
[0m20:54:55.115181 [info ] [Thread-1 (]: 1 of 6 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 3.14s]
[0m20:54:55.115849 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m20:54:55.116670 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m20:54:55.117427 [info ] [Thread-1 (]: 2 of 6 START sql table model single_view_policy_assignment.stg_policy_events ... [RUN]
[0m20:54:55.118209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m20:54:55.118554 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m20:54:55.122243 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m20:54:55.122873 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m20:54:55.124515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:55.800812 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m20:54:55.802091 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m20:54:56.146285 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:2153a97c-d50d-401e-a6a2-93824375edb2&page=queryresults
[0m20:54:58.136928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26c315e7-e8ae-4c67-9485-aef08e6a1d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17403b590>]}
[0m20:54:58.138103 [info ] [Thread-1 (]: 2 of 6 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.02s]
[0m20:54:58.139102 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m20:54:58.140104 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m20:54:58.140878 [info ] [Thread-1 (]: 3 of 6 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m20:54:58.141547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m20:54:58.142138 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m20:54:58.149973 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m20:54:58.150883 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m20:54:58.181276 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m20:54:58.182097 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type,
    event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      event_month,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    l.event_ts,
    l.source_channel,
    l.state,
    l.product_type,
    l.premium_amount,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
      ELSE NULL
    END AS quote_to_bind_mins,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
      ELSE NULL
    END AS bind_to_cancel_mins,
    l.event_month
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
),


SELECT * FROM final
    );
  
[0m20:54:58.182531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:54:59.092504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:0a6fd2cc-235b-4eb2-8048-4350d504ceb4&page=queryresults
[0m20:54:59.094243 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:0a6fd2cc-235b-4eb2-8048-4350d504ceb4&page=queryresults
[0m20:54:59.105742 [debug] [Thread-1 (]: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [84:1]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:54:59.106983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26c315e7-e8ae-4c67-9485-aef08e6a1d8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17541f830>]}
[0m20:54:59.108025 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[31mERROR[0m in 0.97s]
[0m20:54:59.109029 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m20:54:59.109772 [debug] [Thread-4 (]: Marking all children of 'model.my_project.policy_lifecycle_enriched' to be skipped because of status 'error'.  Reason: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [84:1]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql.
[0m20:54:59.111076 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m20:54:59.111689 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m20:54:59.112342 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m20:54:59.112801 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m20:54:59.113281 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m20:54:59.113884 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m20:54:59.114302 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m20:54:59.114761 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m20:54:59.115186 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m20:54:59.116222 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:54:59.171378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:54:59.171706 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m20:54:59.171969 [info ] [MainThread]: 
[0m20:54:59.172190 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 8.93 seconds (8.93s).
[0m20:54:59.172806 [debug] [MainThread]: Command end result
[0m20:54:59.307381 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m20:54:59.308364 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m20:54:59.311098 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m20:54:59.311280 [info ] [MainThread]: 
[0m20:54:59.311473 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:54:59.311619 [info ] [MainThread]: 
[0m20:54:59.311808 [error] [MainThread]: [31mFailure in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)[0m
[0m20:54:59.311997 [error] [MainThread]:   Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [84:1]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:54:59.312132 [info ] [MainThread]: 
[0m20:54:59.312286 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:54:59.312417 [info ] [MainThread]: 
[0m20:54:59.312572 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=6
[0m20:54:59.312815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.950224, "process_in_blocks": "0", "process_kernel_time": 1.109442, "process_mem_max_rss": "405209088", "process_out_blocks": "0", "process_user_time": 4.3759}
[0m20:54:59.313071 [debug] [MainThread]: Command `dbt run` failed at 20:54:59.313031 after 11.95 seconds
[0m20:54:59.313241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e00f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5a6f0>]}
[0m20:54:59.313392 [debug] [MainThread]: Flushing usage events
[0m20:55:00.415991 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:55:22.773222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10581b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10613c5c0>]}


============================== 20:55:22.774885 | 4dd483e4-5173-45f7-867e-1434d83fd883 ==============================
[0m20:55:22.774885 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:55:22.775268 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'indirect_selection': 'eager', 'debug': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'empty': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'quiet': 'False', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'introspect': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'warn_error': 'None', 'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m20:55:24.772245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dd483e4-5173-45f7-867e-1434d83fd883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1724d2570>]}
[0m20:55:24.798148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dd483e4-5173-45f7-867e-1434d83fd883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172a64110>]}
[0m20:55:24.798503 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:55:24.932758 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:55:25.016328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:55:25.016866 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/policy_lifecycle_enriched.sql
[0m20:55:25.216295 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m20:55:25.218917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dd483e4-5173-45f7-867e-1434d83fd883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x173eb2150>]}
[0m20:55:25.260185 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m20:55:25.261406 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m20:55:25.275042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dd483e4-5173-45f7-867e-1434d83fd883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x173f34170>]}
[0m20:55:25.275343 [info ] [MainThread]: Found 6 models, 12 data tests, 496 macros
[0m20:55:25.275537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dd483e4-5173-45f7-867e-1434d83fd883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x173ef0da0>]}
[0m20:55:25.276441 [info ] [MainThread]: 
[0m20:55:25.276752 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m20:55:25.276915 [info ] [MainThread]: 
[0m20:55:25.277246 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:55:25.280675 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m20:55:25.280927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:26.252859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m20:55:26.253873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:26.974701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dd483e4-5173-45f7-867e-1434d83fd883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172c52900>]}
[0m20:55:26.975784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:55:27.041276 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m20:55:27.041725 [info ] [Thread-1 (]: 1 of 6 START sql table model single_view_policy_assignment.raw_policy_events ... [RUN]
[0m20:55:27.042041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m20:55:27.042261 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m20:55:27.046866 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m20:55:27.047627 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m20:55:27.056594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:27.777870 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m20:55:27.778908 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    horizontal-ray-467611-f9.single_view_policy_assignment.policy_events_external_table
    );
  
[0m20:55:28.365075 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:371dece2-de44-4264-8d84-85bb73252dac&page=queryresults
[0m20:55:30.385074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dd483e4-5173-45f7-867e-1434d83fd883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bcbb9b0>]}
[0m20:55:30.386232 [info ] [Thread-1 (]: 1 of 6 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 3.34s]
[0m20:55:30.387056 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m20:55:30.387926 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m20:55:30.388486 [info ] [Thread-1 (]: 2 of 6 START sql table model single_view_policy_assignment.stg_policy_events ... [RUN]
[0m20:55:30.388953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m20:55:30.389273 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m20:55:30.393471 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m20:55:30.394477 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m20:55:30.396304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:31.175546 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m20:55:31.177433 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m20:55:31.518101 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:2d6203cd-feeb-4010-b9c7-281305948643&page=queryresults
[0m20:55:33.618036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dd483e4-5173-45f7-867e-1434d83fd883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x173df4830>]}
[0m20:55:33.619354 [info ] [Thread-1 (]: 2 of 6 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.23s]
[0m20:55:33.620519 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m20:55:33.621664 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m20:55:33.622352 [info ] [Thread-1 (]: 3 of 6 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m20:55:33.622979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m20:55:33.623586 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m20:55:33.630212 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m20:55:33.631533 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m20:55:33.674338 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m20:55:33.675105 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type,
    event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      policy_id, 
      event_type, 
      event_month,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    l.event_ts,
    l.source_channel,
    l.state,
    l.product_type,
    l.premium_amount,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
      ELSE NULL
    END AS quote_to_bind_mins,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
      ELSE NULL
    END AS bind_to_cancel_mins,
    l.event_month
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
)


SELECT * FROM final
    );
  
[0m20:55:33.675491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:34.607443 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:5075a1d0-f3f1-4d87-a472-0b7aecfecbb8&page=queryresults
[0m20:55:34.792463 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:5075a1d0-f3f1-4d87-a472-0b7aecfecbb8&page=queryresults
[0m20:55:34.803932 [debug] [Thread-1 (]: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Unrecognized name: event_ts; Did you mean event_type? at [30:5]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:55:34.805371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dd483e4-5173-45f7-867e-1434d83fd883', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x174202720>]}
[0m20:55:34.807199 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[31mERROR[0m in 1.18s]
[0m20:55:34.808295 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m20:55:34.809703 [debug] [Thread-4 (]: Marking all children of 'model.my_project.policy_lifecycle_enriched' to be skipped because of status 'error'.  Reason: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Unrecognized name: event_ts; Did you mean event_type? at [30:5]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql.
[0m20:55:34.810870 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m20:55:34.811553 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m20:55:34.812126 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m20:55:34.812584 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m20:55:34.813029 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m20:55:34.813687 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m20:55:34.814195 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m20:55:34.814683 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m20:55:34.815215 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m20:55:34.816379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:55:34.869398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:34.869801 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m20:55:34.870100 [info ] [MainThread]: 
[0m20:55:34.870415 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 9.59 seconds (9.59s).
[0m20:55:34.871703 [debug] [MainThread]: Command end result
[0m20:55:35.013775 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m20:55:35.014687 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m20:55:35.017493 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m20:55:35.017738 [info ] [MainThread]: 
[0m20:55:35.017955 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:55:35.018110 [info ] [MainThread]: 
[0m20:55:35.018302 [error] [MainThread]: [31mFailure in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)[0m
[0m20:55:35.018483 [error] [MainThread]:   Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Unrecognized name: event_ts; Did you mean event_type? at [30:5]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:55:35.018619 [info ] [MainThread]: 
[0m20:55:35.018770 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/policy_lifecycle_enriched.sql
[0m20:55:35.018902 [info ] [MainThread]: 
[0m20:55:35.019062 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=6
[0m20:55:35.019311 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.280987, "process_in_blocks": "0", "process_kernel_time": 1.093123, "process_mem_max_rss": "398180352", "process_out_blocks": "0", "process_user_time": 4.319628}
[0m20:55:35.019570 [debug] [MainThread]: Command `dbt run` failed at 20:55:35.019530 after 12.28 seconds
[0m20:55:35.019744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1743de510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1743de660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1743dfe60>]}
[0m20:55:35.019902 [debug] [MainThread]: Flushing usage events
[0m20:55:36.155982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:08.315799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a851b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c233ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c233f50>]}


============================== 20:57:08.318200 | aa57cbd2-204b-4fc3-86b3-6b35243928ec ==============================
[0m20:57:08.318200 [info ] [MainThread]: Running with dbt=1.10.6
[0m20:57:08.318734 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'fail_fast': 'False', 'empty': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'cache_selected_only': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'use_colors': 'True', 'static_parser': 'True', 'no_print': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'warn_error': 'None'}
[0m20:57:10.787132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa57cbd2-204b-4fc3-86b3-6b35243928ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16556ae10>]}
[0m20:57:10.814481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa57cbd2-204b-4fc3-86b3-6b35243928ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1600ba990>]}
[0m20:57:10.814841 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:57:10.946517 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m20:57:11.037154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:57:11.037679 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/policy_lifecycle_enriched.sql
[0m20:57:11.237996 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_project.ext
[0m20:57:11.240826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa57cbd2-204b-4fc3-86b3-6b35243928ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1663fabd0>]}
[0m20:57:11.282841 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m20:57:11.284294 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m20:57:11.297537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa57cbd2-204b-4fc3-86b3-6b35243928ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1664e05f0>]}
[0m20:57:11.297913 [info ] [MainThread]: Found 6 models, 12 data tests, 496 macros
[0m20:57:11.298787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa57cbd2-204b-4fc3-86b3-6b35243928ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1662d9fa0>]}
[0m20:57:11.301822 [info ] [MainThread]: 
[0m20:57:11.302170 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m20:57:11.302366 [info ] [MainThread]: 
[0m20:57:11.302660 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:57:11.305843 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m20:57:11.306139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:12.265666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m20:57:12.266707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:12.964169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa57cbd2-204b-4fc3-86b3-6b35243928ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782cfb0>]}
[0m20:57:12.965165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:57:13.033606 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m20:57:13.034057 [info ] [Thread-1 (]: 1 of 6 START sql table model single_view_policy_assignment.raw_policy_events ... [RUN]
[0m20:57:13.034389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m20:57:13.034648 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m20:57:13.039439 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m20:57:13.039920 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m20:57:13.048091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:13.792741 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m20:57:13.794239 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    horizontal-ray-467611-f9.single_view_policy_assignment.policy_events_external_table
    );
  
[0m20:57:14.242090 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:71af4254-53fa-4275-ba58-4a83d43fbe1a&page=queryresults
[0m20:57:16.575040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa57cbd2-204b-4fc3-86b3-6b35243928ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a358ec0>]}
[0m20:57:16.575832 [info ] [Thread-1 (]: 1 of 6 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 3.54s]
[0m20:57:16.576504 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m20:57:16.577266 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m20:57:16.577687 [info ] [Thread-1 (]: 2 of 6 START sql table model single_view_policy_assignment.stg_policy_events ... [RUN]
[0m20:57:16.578092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m20:57:16.578516 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m20:57:16.581887 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m20:57:16.582494 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m20:57:16.584187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:17.275105 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m20:57:17.276910 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m20:57:17.614438 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:37b844e0-cc7e-48ea-b4ee-d945125a8e34&page=queryresults
[0m20:57:19.618848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa57cbd2-204b-4fc3-86b3-6b35243928ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16636c7d0>]}
[0m20:57:19.620065 [info ] [Thread-1 (]: 2 of 6 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.04s]
[0m20:57:19.621060 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m20:57:19.622179 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m20:57:19.622935 [info ] [Thread-1 (]: 3 of 6 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m20:57:19.623592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m20:57:19.624190 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m20:57:19.631164 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m20:57:19.632370 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m20:57:19.674189 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m20:57:19.675027 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type,
    event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      *,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    l.event_ts,
    l.source_channel,
    l.state,
    l.product_type,
    l.premium_amount,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, MINUTE)
      ELSE NULL
    END AS quote_to_bind_mins,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, MINUTE)
      ELSE NULL
    END AS bind_to_cancel_mins,
    l.event_month
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
)


SELECT * FROM final
    );
  
[0m20:57:19.675413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:20.730189 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:0319849c-ade5-4626-9997-267e6dfde2f5&page=queryresults
[0m20:57:23.117814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa57cbd2-204b-4fc3-86b3-6b35243928ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167120e00>]}
[0m20:57:23.120087 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE TABLE (351.0 rows, 38.8 KiB processed)[0m in 3.49s]
[0m20:57:23.121172 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m20:57:23.122432 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m20:57:23.123295 [info ] [Thread-1 (]: 4 of 6 START sql view model single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [RUN]
[0m20:57:23.123995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_lifecycle_enriched, now model.my_project.avg_quote_to_bind_by_month_analysis)
[0m20:57:23.124569 [debug] [Thread-1 (]: Began compiling node model.my_project.avg_quote_to_bind_by_month_analysis
[0m20:57:23.130243 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.avg_quote_to_bind_by_month_analysis"
[0m20:57:23.133068 [debug] [Thread-1 (]: Began executing node model.my_project.avg_quote_to_bind_by_month_analysis
[0m20:57:23.153678 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.avg_quote_to_bind_by_month_analysis"
[0m20:57:23.154539 [debug] [Thread-1 (]: On model.my_project.avg_quote_to_bind_by_month_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.avg_quote_to_bind_by_month_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`avg_quote_to_bind_by_month_analysis`
  OPTIONS()
  as 


SELECT event_month, 
AVG(quote_to_bind_mins) AS avg_quote_to_bind_mins
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_mins IS NOT NULL
GROUP BY event_month
ORDER BY event_month;


[0m20:57:23.154914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:24.953224 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:fc724b13-b16d-418a-a3a0-715a3e9d842c&page=queryresults
[0m20:57:25.589582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa57cbd2-204b-4fc3-86b3-6b35243928ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167201280>]}
[0m20:57:25.591304 [info ] [Thread-1 (]: 4 of 6 OK created sql view model single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[32mCREATE VIEW (0 processed)[0m in 2.47s]
[0m20:57:25.592420 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m20:57:25.593052 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m20:57:25.593976 [info ] [Thread-1 (]: 5 of 6 START sql view model single_view_policy_assignment.cancelled_within_30_days_analysis  [RUN]
[0m20:57:25.594806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.avg_quote_to_bind_by_month_analysis, now model.my_project.cancelled_within_30_days_analysis)
[0m20:57:25.595426 [debug] [Thread-1 (]: Began compiling node model.my_project.cancelled_within_30_days_analysis
[0m20:57:25.603174 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.cancelled_within_30_days_analysis"
[0m20:57:25.604718 [debug] [Thread-1 (]: Began executing node model.my_project.cancelled_within_30_days_analysis
[0m20:57:25.611332 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.cancelled_within_30_days_analysis"
[0m20:57:25.612893 [debug] [Thread-1 (]: On model.my_project.cancelled_within_30_days_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.cancelled_within_30_days_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`cancelled_within_30_days_analysis`
  OPTIONS()
  as 

SELECT COUNT(*) AS num_cancelled_within_30_days
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_mins IS NOT NULL
  AND bind_to_cancel_mins IS NOT NULL
  AND bind_to_cancel_mins <= 30*24*60;


[0m20:57:25.613625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:26.479733 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:4e839b0b-d37c-4200-8816-611e0b3c84d2&page=queryresults
[0m20:57:26.989928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa57cbd2-204b-4fc3-86b3-6b35243928ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167218110>]}
[0m20:57:26.991081 [info ] [Thread-1 (]: 5 of 6 OK created sql view model single_view_policy_assignment.cancelled_within_30_days_analysis  [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m20:57:26.992240 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m20:57:26.993031 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m20:57:26.993895 [info ] [Thread-1 (]: 6 of 6 START sql view model single_view_policy_assignment.quoted_never_bound_analysis  [RUN]
[0m20:57:26.994688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.cancelled_within_30_days_analysis, now model.my_project.quoted_never_bound_analysis)
[0m20:57:26.995332 [debug] [Thread-1 (]: Began compiling node model.my_project.quoted_never_bound_analysis
[0m20:57:26.999727 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.quoted_never_bound_analysis"
[0m20:57:27.000885 [debug] [Thread-1 (]: Began executing node model.my_project.quoted_never_bound_analysis
[0m20:57:27.005114 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.quoted_never_bound_analysis"
[0m20:57:27.006406 [debug] [Thread-1 (]: On model.my_project.quoted_never_bound_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.quoted_never_bound_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`quoted_never_bound_analysis`
  OPTIONS()
  as 

SELECT COUNT(*) AS num_quoted_never_bound
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE first_quote_ts IS NOT NULL 
    AND first_bind_ts IS NULL;


[0m20:57:27.007018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:27.915053 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:11dfa7bd-293b-4a5b-b7c3-412e142d9bae&page=queryresults
[0m20:57:28.419270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa57cbd2-204b-4fc3-86b3-6b35243928ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166399ac0>]}
[0m20:57:28.420501 [info ] [Thread-1 (]: 6 of 6 OK created sql view model single_view_policy_assignment.quoted_never_bound_analysis  [[32mCREATE VIEW (0 processed)[0m in 1.42s]
[0m20:57:28.421584 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m20:57:28.423375 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:57:28.485451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:28.486074 [debug] [MainThread]: Connection 'model.my_project.quoted_never_bound_analysis' was properly closed.
[0m20:57:28.486348 [info ] [MainThread]: 
[0m20:57:28.486573 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 17.18 seconds (17.18s).
[0m20:57:28.487393 [debug] [MainThread]: Command end result
[0m20:57:28.639528 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m20:57:28.641224 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m20:57:28.644332 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m20:57:28.644529 [info ] [MainThread]: 
[0m20:57:28.644728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:57:28.644922 [info ] [MainThread]: 
[0m20:57:28.645112 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m20:57:28.645375 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.368307, "process_in_blocks": "0", "process_kernel_time": 1.089215, "process_mem_max_rss": "401866752", "process_out_blocks": "0", "process_user_time": 4.958861}
[0m20:57:28.645676 [debug] [MainThread]: Command `dbt run` succeeded at 20:57:28.645634 after 20.37 seconds
[0m20:57:28.645886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093295b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16405e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1664373b0>]}
[0m20:57:28.646059 [debug] [MainThread]: Flushing usage events
[0m20:57:30.046644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:38:05.238438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b9b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10576c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10576c0e0>]}


============================== 21:38:05.240751 | 00983fb1-cadb-4b54-8ea8-854f18dfd8a0 ==============================
[0m21:38:05.240751 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:38:05.241128 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'empty': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'introspect': 'True', 'fail_fast': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'no_print': 'None', 'warn_error': 'None'}
[0m21:38:07.755938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00983fb1-cadb-4b54-8ea8-854f18dfd8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168c6b0b0>]}
[0m21:38:07.785479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00983fb1-cadb-4b54-8ea8-854f18dfd8a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105742d20>]}
[0m21:38:07.785961 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:38:07.919349 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:38:08.012061 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 1 files added, 2 files changed.
[0m21:38:08.012572 [debug] [MainThread]: Partial parsing: added file: my_project://models/example/src_raw_policy_events.yml
[0m21:38:08.012770 [debug] [MainThread]: Partial parsing: deleted file: my_project://tests/EVENT_MONTH.sql
[0m21:38:08.012908 [debug] [MainThread]: Partial parsing: deleted file: my_project://tests/NO_NULL.sql
[0m21:38:08.013091 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/raw_policy_events.sql
[0m21:38:08.013365 [debug] [MainThread]: Partial parsing: updated file: my_project://models/example/policy_lifecycle_enriched.sql
[0m21:38:08.192060 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_project.raw_policy_events' (models/example/raw_policy_events.sql) depends on a source named 'policy_events.policy_events_external_table' which was not found
[0m21:38:08.192539 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.9914567, "process_in_blocks": "0", "process_kernel_time": 1.101827, "process_mem_max_rss": "395313152", "process_out_blocks": "0", "process_user_time": 3.704955}
[0m21:38:08.192857 [debug] [MainThread]: Command `dbt run` failed at 21:38:08.192805 after 2.99 seconds
[0m21:38:08.193087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10576c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168f14620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169b4e960>]}
[0m21:38:08.193273 [debug] [MainThread]: Flushing usage events
[0m21:38:09.326659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:37:28.511313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b41040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063dcef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063de630>]}


============================== 11:37:28.513000 | 8971edc6-014d-495e-a513-c36866a4da8e ==============================
[0m11:37:28.513000 [info ] [MainThread]: Running with dbt=1.10.6
[0m11:37:28.513366 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'printer_width': '80', 'partial_parse': 'True', 'write_json': 'True', 'target_path': 'None', 'empty': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'fail_fast': 'False', 'no_print': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt debug', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'static_parser': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True'}
[0m11:37:28.523506 [info ] [MainThread]: dbt version: 1.10.6
[0m11:37:28.523748 [info ] [MainThread]: python version: 3.12.4
[0m11:37:28.523893 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m11:37:28.524026 [info ] [MainThread]: os info: macOS-14.6.1-arm64-arm-64bit
[0m11:37:30.753476 [info ] [MainThread]: Using profiles dir at /Users/pratibhagangavarapu/.dbt
[0m11:37:30.754000 [info ] [MainThread]: Using profiles.yml file at /Users/pratibhagangavarapu/.dbt/profiles.yml
[0m11:37:30.754160 [info ] [MainThread]: Using dbt_project.yml file at /Users/pratibhagangavarapu/my_project/dbt_project.yml
[0m11:37:30.754297 [info ] [MainThread]: adapter type: bigquery
[0m11:37:30.754428 [info ] [MainThread]: adapter version: 1.10.1
[0m11:37:30.800077 [info ] [MainThread]: Configuration:
[0m11:37:30.800380 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:37:30.800562 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:37:30.800709 [info ] [MainThread]: Required dependencies:
[0m11:37:30.800889 [debug] [MainThread]: Executing "git --help"
[0m11:37:30.820450 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:37:30.821102 [debug] [MainThread]: STDERR: "b''"
[0m11:37:30.821784 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:37:30.822016 [info ] [MainThread]: Connection:
[0m11:37:30.822212 [info ] [MainThread]:   method: service-account
[0m11:37:30.822339 [info ] [MainThread]:   database: horizontal-ray-467611-f9
[0m11:37:30.822462 [info ] [MainThread]:   execution_project: horizontal-ray-467611-f9
[0m11:37:30.822585 [info ] [MainThread]:   schema: single_view_policy_assignment
[0m11:37:30.822699 [info ] [MainThread]:   location: None
[0m11:37:30.822813 [info ] [MainThread]:   priority: None
[0m11:37:30.822929 [info ] [MainThread]:   maximum_bytes_billed: None
[0m11:37:30.823040 [info ] [MainThread]:   impersonate_service_account: None
[0m11:37:30.823153 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m11:37:30.823261 [info ] [MainThread]:   job_retries: 1
[0m11:37:30.823370 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m11:37:30.823480 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m11:37:30.823588 [info ] [MainThread]:   timeout_seconds: None
[0m11:37:30.823699 [info ] [MainThread]:   client_id: None
[0m11:37:30.823808 [info ] [MainThread]:   token_uri: None
[0m11:37:30.823916 [info ] [MainThread]:   compute_region: None
[0m11:37:30.824026 [info ] [MainThread]:   dataproc_cluster_name: None
[0m11:37:30.824135 [info ] [MainThread]:   gcs_bucket: None
[0m11:37:30.824241 [info ] [MainThread]:   dataproc_batch: None
[0m11:37:30.824557 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m11:37:30.938949 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m11:37:30.939344 [debug] [MainThread]: On debug: select 1 as id
[0m11:37:30.939528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:37:32.214361 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:27543e0a-cc61-42b7-970a-a575a97455a6&page=queryresults
[0m11:37:33.117170 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:37:33.118442 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:37:33.119707 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.642928, "process_in_blocks": "0", "process_kernel_time": 0.827433, "process_mem_max_rss": "395247616", "process_out_blocks": "0", "process_user_time": 3.510448}
[0m11:37:33.120668 [debug] [MainThread]: Command `dbt debug` succeeded at 11:37:33.120512 after 4.64 seconds
[0m11:37:33.121146 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:37:33.121647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e466f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b145550>]}
[0m11:37:33.122196 [debug] [MainThread]: Flushing usage events
[0m11:37:34.300335 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:37:39.941701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b52270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042ac410>]}


============================== 11:37:39.943015 | 97d5d978-ce7a-4868-8e1b-50437bcdc6ee ==============================
[0m11:37:39.943015 [info ] [MainThread]: Running with dbt=1.10.6
[0m11:37:39.943367 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'version_check': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'use_colors': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'target_path': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'partial_parse': 'True', 'debug': 'False', 'warn_error': 'None', 'write_json': 'True'}
[0m11:37:41.347847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97d5d978-ce7a-4868-8e1b-50437bcdc6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ea0c0>]}
[0m11:37:41.373150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97d5d978-ce7a-4868-8e1b-50437bcdc6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147fe3a70>]}
[0m11:37:41.373472 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m11:37:41.482471 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m11:37:41.540747 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:37:41.541043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '97d5d978-ce7a-4868-8e1b-50437bcdc6ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168c33590>]}
[0m11:37:41.844106 [error] [MainThread]: Encountered an error:
Field "persist_docs" of type Dict[str, Any] in ModelConfig has invalid value True
[0m11:37:41.846458 [error] [MainThread]: Traceback (most recent call last):
  File "<string>", line 57, in __mashumaro_from_dict__
AttributeError: 'bool' object has no attribute 'items'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 272, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 373, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 350, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 389, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/cli/requires.py", line 416, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/manifest.py", line 2115, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/manifest.py", line 315, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/manifest.py", line 420, in load
    self.parse_project(
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/manifest.py", line 743, in parse_project
    parser.parse_file(block)
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/base.py", line 520, in parse_file
    self.parse_node(file_block)
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/base.py", line 483, in parse_node
    node = self._create_parsetime_node(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/base.py", line 247, in _create_parsetime_node
    "config": self.config_dict(config),
              ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/parser/base.py", line 459, in config_dict
    config_dict = config.build_config_dict(base=True)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/context/context_config.py", line 340, in build_config_dict
    return src.calculate_node_config_dict(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/context/context_config.py", line 238, in calculate_node_config_dict
    config = self.calculate_node_config(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/context/context_config.py", line 161, in calculate_node_config
    result = self._update_from_config(result, fqn_config)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt/context/context_config.py", line 216, in _update_from_config
    updated = result.update_from(translated, adapter_config_cls, validate=validate)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/dbt_common/contracts/config/base.py", line 175, in update_from
    return self.from_dict(dct)
           ^^^^^^^^^^^^^^^^^^^
  File "<string>", line 59, in __mashumaro_from_dict__
mashumaro.exceptions.InvalidFieldValue: Field "persist_docs" of type Dict[str, Any] in ModelConfig has invalid value True

[0m11:37:41.846977 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9343575, "process_in_blocks": "0", "process_kernel_time": 1.6532, "process_mem_max_rss": "397934592", "process_out_blocks": "0", "process_user_time": 2.801458}
[0m11:37:41.847286 [debug] [MainThread]: Command `dbt run` failed at 11:37:41.847233 after 1.93 seconds
[0m11:37:41.847476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105460320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168965fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168b14b00>]}
[0m11:37:41.847638 [debug] [MainThread]: Flushing usage events
[0m11:37:42.943822 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:57.254371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f67e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740fe30>]}


============================== 11:38:57.255996 | 9c5f06cf-53c2-4116-be9b-cd5cd5079466 ==============================
[0m11:38:57.255996 [info ] [MainThread]: Running with dbt=1.10.6
[0m11:38:57.256348 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'quiet': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'target_path': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'debug': 'False', 'empty': 'False', 'version_check': 'True'}
[0m11:38:59.304434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c5f06cf-53c2-4116-be9b-cd5cd5079466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1693809e0>]}
[0m11:38:59.329162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c5f06cf-53c2-4116-be9b-cd5cd5079466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169465940>]}
[0m11:38:59.329503 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m11:38:59.444986 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m11:38:59.503795 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:38:59.504132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9c5f06cf-53c2-4116-be9b-cd5cd5079466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f67020>]}
[0m11:39:00.073006 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.ext
- models.my_project.persist_docs
[0m11:39:00.077245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c5f06cf-53c2-4116-be9b-cd5cd5079466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169c4ee10>]}
[0m11:39:00.213037 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m11:39:00.214637 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m11:39:00.225562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c5f06cf-53c2-4116-be9b-cd5cd5079466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169cae8d0>]}
[0m11:39:00.225829 [info ] [MainThread]: Found 6 models, 10 data tests, 1 source, 496 macros
[0m11:39:00.226016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c5f06cf-53c2-4116-be9b-cd5cd5079466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169d1f500>]}
[0m11:39:00.226846 [info ] [MainThread]: 
[0m11:39:00.227037 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m11:39:00.227177 [info ] [MainThread]: 
[0m11:39:00.227420 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:39:00.229203 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m11:39:00.229417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:01.235147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m11:39:01.236340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:39:01.996972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c5f06cf-53c2-4116-be9b-cd5cd5079466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169c9ebd0>]}
[0m11:39:01.998077 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:02.060301 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m11:39:02.060714 [info ] [Thread-1 (]: 1 of 6 START sql table model single_view_policy_assignment.raw_policy_events ... [RUN]
[0m11:39:02.061005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m11:39:02.061220 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m11:39:02.065717 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m11:39:02.066134 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m11:39:02.073526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:02.796097 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m11:39:02.800040 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    );
  
[0m11:39:03.811865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:ff799ddf-1520-4aa6-a947-9460febd3f33&page=queryresults
[0m11:39:06.107580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c5f06cf-53c2-4116-be9b-cd5cd5079466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105858e90>]}
[0m11:39:06.108456 [info ] [Thread-1 (]: 1 of 6 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 4.04s]
[0m11:39:06.109125 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m11:39:06.109970 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m11:39:06.110410 [info ] [Thread-1 (]: 2 of 6 START sql table model single_view_policy_assignment.stg_policy_events ... [RUN]
[0m11:39:06.110806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m11:39:06.111128 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m11:39:06.114081 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m11:39:06.115277 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m11:39:06.117164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:06.842831 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m11:39:06.846646 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m11:39:07.806582 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:1ceec13b-7627-46d8-a145-70b93abc1d22&page=queryresults
[0m11:39:09.675884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c5f06cf-53c2-4116-be9b-cd5cd5079466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169dacb00>]}
[0m11:39:09.677212 [info ] [Thread-1 (]: 2 of 6 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.56s]
[0m11:39:09.678137 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m11:39:09.679169 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m11:39:09.679789 [info ] [Thread-1 (]: 3 of 6 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m11:39:09.680382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m11:39:09.680860 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m11:39:09.685936 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m11:39:09.686862 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m11:39:09.719517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:39:10.475337 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m11:39:10.476223 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched` as DBT_INTERNAL_DEST
        using (

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type,
    event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      *,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, HOUR)
      ELSE NULL
    END AS quote_to_bind_hr,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, HOUR)
      ELSE NULL
    END AS bind_to_cancel_hr,
    l.event_month
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
)


SELECT * FROM final
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.policy_id = DBT_INTERNAL_DEST.policy_id
                ) and (
                    DBT_INTERNAL_SOURCE.event_type = DBT_INTERNAL_DEST.event_type
                ) and (
                    DBT_INTERNAL_SOURCE.product_type = DBT_INTERNAL_DEST.product_type
                )

    
    when matched then update set
        `policy_id` = DBT_INTERNAL_SOURCE.`policy_id`,`event_ts` = DBT_INTERNAL_SOURCE.`event_ts`,`source_channel` = DBT_INTERNAL_SOURCE.`source_channel`,`state` = DBT_INTERNAL_SOURCE.`state`,`product_type` = DBT_INTERNAL_SOURCE.`product_type`,`premium_amount` = DBT_INTERNAL_SOURCE.`premium_amount`,`first_quote_ts` = DBT_INTERNAL_SOURCE.`first_quote_ts`,`first_bind_ts` = DBT_INTERNAL_SOURCE.`first_bind_ts`,`first_cancel_ts` = DBT_INTERNAL_SOURCE.`first_cancel_ts`,`last_event_type` = DBT_INTERNAL_SOURCE.`last_event_type`,`current_status` = DBT_INTERNAL_SOURCE.`current_status`,`quote_to_bind_mins` = DBT_INTERNAL_SOURCE.`quote_to_bind_mins`,`bind_to_cancel_mins` = DBT_INTERNAL_SOURCE.`bind_to_cancel_mins`,`event_month` = DBT_INTERNAL_SOURCE.`event_month`
    

    when not matched then insert
        (`policy_id`, `event_ts`, `source_channel`, `state`, `product_type`, `premium_amount`, `first_quote_ts`, `first_bind_ts`, `first_cancel_ts`, `last_event_type`, `current_status`, `quote_to_bind_mins`, `bind_to_cancel_mins`, `event_month`)
    values
        (`policy_id`, `event_ts`, `source_channel`, `state`, `product_type`, `premium_amount`, `first_quote_ts`, `first_bind_ts`, `first_cancel_ts`, `last_event_type`, `current_status`, `quote_to_bind_mins`, `bind_to_cancel_mins`, `event_month`)


    
[0m11:39:11.424477 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:52e4e0f2-38e2-43c9-93ce-90a05188db3f&page=queryresults
[0m11:39:11.852510 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:52e4e0f2-38e2-43c9-93ce-90a05188db3f&page=queryresults
[0m11:39:11.864963 [debug] [Thread-1 (]: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Name event_type not found inside DBT_INTERNAL_SOURCE at [90:41]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m11:39:11.865637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c5f06cf-53c2-4116-be9b-cd5cd5079466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169f9ff20>]}
[0m11:39:11.866630 [error] [Thread-1 (]: 3 of 6 ERROR creating sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[31mERROR[0m in 2.19s]
[0m11:39:11.867378 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m11:39:11.867935 [debug] [Thread-4 (]: Marking all children of 'model.my_project.policy_lifecycle_enriched' to be skipped because of status 'error'.  Reason: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Name event_type not found inside DBT_INTERNAL_SOURCE at [90:41]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql.
[0m11:39:11.868747 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m11:39:11.869313 [info ] [Thread-1 (]: 4 of 6 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m11:39:11.869767 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m11:39:11.870166 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m11:39:11.870584 [info ] [Thread-1 (]: 5 of 6 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m11:39:11.870992 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m11:39:11.871343 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m11:39:11.871684 [info ] [Thread-1 (]: 6 of 6 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis . [[33mSKIP[0m]
[0m11:39:11.872063 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m11:39:11.872973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:11.921152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:11.921409 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m11:39:11.921642 [info ] [MainThread]: 
[0m11:39:11.921830 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 11.69 seconds (11.69s).
[0m11:39:11.922356 [debug] [MainThread]: Command end result
[0m11:39:11.936424 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m11:39:11.937306 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m11:39:11.940206 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m11:39:11.940375 [info ] [MainThread]: 
[0m11:39:11.940552 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:39:11.940695 [info ] [MainThread]: 
[0m11:39:11.940877 [error] [MainThread]: [31mFailure in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)[0m
[0m11:39:11.941067 [error] [MainThread]:   Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Name event_type not found inside DBT_INTERNAL_SOURCE at [90:41]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m11:39:11.941199 [info ] [MainThread]: 
[0m11:39:11.941354 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/policy_lifecycle_enriched.sql
[0m11:39:11.941487 [info ] [MainThread]: 
[0m11:39:11.941639 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=6
[0m11:39:11.941875 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.71938, "process_in_blocks": "0", "process_kernel_time": 0.907981, "process_mem_max_rss": "399228928", "process_out_blocks": "0", "process_user_time": 4.788792}
[0m11:39:11.942126 [debug] [MainThread]: Command `dbt run` failed at 11:39:11.942087 after 14.72 seconds
[0m11:39:11.942310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169c9cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169d669f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107438350>]}
[0m11:39:11.942472 [debug] [MainThread]: Flushing usage events
[0m11:39:14.302371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:42:01.538857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104162960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056fbc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056fbf20>]}


============================== 11:42:01.540606 | 1771c114-6f0e-488c-9cd7-303d5e07d894 ==============================
[0m11:42:01.540606 [info ] [MainThread]: Running with dbt=1.10.6
[0m11:42:01.541016 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'printer_width': '80', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'write_json': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --full-refresh', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'introspect': 'True'}
[0m11:42:03.512044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1771c114-6f0e-488c-9cd7-303d5e07d894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503cef0>]}
[0m11:42:03.538921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1771c114-6f0e-488c-9cd7-303d5e07d894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136a1ad20>]}
[0m11:42:03.539288 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m11:42:03.652715 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m11:42:03.730641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:42:03.730852 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:42:03.733289 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.ext
- models.my_project.persist_docs
[0m11:42:03.751709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1771c114-6f0e-488c-9cd7-303d5e07d894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f14f80>]}
[0m11:42:03.789751 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m11:42:03.790879 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m11:42:03.801193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1771c114-6f0e-488c-9cd7-303d5e07d894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f6a660>]}
[0m11:42:03.801433 [info ] [MainThread]: Found 6 models, 10 data tests, 1 source, 496 macros
[0m11:42:03.801619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1771c114-6f0e-488c-9cd7-303d5e07d894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d8aae0>]}
[0m11:42:03.802515 [info ] [MainThread]: 
[0m11:42:03.802735 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m11:42:03.802876 [info ] [MainThread]: 
[0m11:42:03.803130 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:42:03.804933 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m11:42:03.805146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:04.912778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m11:42:04.913969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:05.658956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1771c114-6f0e-488c-9cd7-303d5e07d894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d65ee0>]}
[0m11:42:05.660165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:42:05.718351 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m11:42:05.718754 [info ] [Thread-1 (]: 1 of 6 START sql table model single_view_policy_assignment.raw_policy_events ... [RUN]
[0m11:42:05.719045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m11:42:05.719258 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m11:42:05.724172 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m11:42:05.724574 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m11:42:05.733076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:06.475097 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m11:42:06.476018 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    );
  
[0m11:42:06.899015 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:dbab88f8-0749-466d-813f-f16d5db48df1&page=queryresults
[0m11:42:09.043058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1771c114-6f0e-488c-9cd7-303d5e07d894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127fbba40>]}
[0m11:42:09.043834 [info ] [Thread-1 (]: 1 of 6 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 3.32s]
[0m11:42:09.044456 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m11:42:09.045229 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m11:42:09.045711 [info ] [Thread-1 (]: 2 of 6 START sql table model single_view_policy_assignment.stg_policy_events ... [RUN]
[0m11:42:09.046060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m11:42:09.046333 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m11:42:09.048724 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m11:42:09.049268 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m11:42:09.050922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:09.789435 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m11:42:09.790950 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m11:42:10.699547 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:1aca0c64-964a-47f0-851f-c0b41e5dfbfa&page=queryresults
[0m11:42:12.580336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1771c114-6f0e-488c-9cd7-303d5e07d894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d66b40>]}
[0m11:42:12.581289 [info ] [Thread-1 (]: 2 of 6 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.53s]
[0m11:42:12.582104 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m11:42:12.583084 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m11:42:12.583585 [info ] [Thread-1 (]: 3 of 6 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m11:42:12.584026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m11:42:12.584396 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m11:42:12.589166 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m11:42:12.589961 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m11:42:12.621323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:13.338948 [debug] [Thread-1 (]: Hard refreshing `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched` because it is not replaceable
[0m11:42:13.488570 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m11:42:13.490457 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type,
    event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      *,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, HOUR)
      ELSE NULL
    END AS quote_to_bind_hr,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, HOUR)
      ELSE NULL
    END AS bind_to_cancel_hr,
    l.event_month
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
)


SELECT * FROM final
    );
  
[0m11:42:13.877884 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:d23391a9-89a9-4cbf-b0c1-7a15316e6aae&page=queryresults
[0m11:42:16.468760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1771c114-6f0e-488c-9cd7-303d5e07d894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136aa6030>]}
[0m11:42:16.469829 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE TABLE (351.0 rows, 21.5 KiB processed)[0m in 3.88s]
[0m11:42:16.470535 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m11:42:16.471408 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m11:42:16.471919 [info ] [Thread-1 (]: 4 of 6 START sql view model single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [RUN]
[0m11:42:16.472367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_lifecycle_enriched, now model.my_project.avg_quote_to_bind_by_month_analysis)
[0m11:42:16.472756 [debug] [Thread-1 (]: Began compiling node model.my_project.avg_quote_to_bind_by_month_analysis
[0m11:42:16.476232 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.avg_quote_to_bind_by_month_analysis"
[0m11:42:16.478128 [debug] [Thread-1 (]: Began executing node model.my_project.avg_quote_to_bind_by_month_analysis
[0m11:42:16.493846 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.avg_quote_to_bind_by_month_analysis"
[0m11:42:16.494512 [debug] [Thread-1 (]: On model.my_project.avg_quote_to_bind_by_month_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.avg_quote_to_bind_by_month_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`avg_quote_to_bind_by_month_analysis`
  OPTIONS()
  as 


SELECT event_month, 
AVG(quote_to_bind_hr) AS avg_quote_to_bind_hr
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_hr IS NOT NULL
GROUP BY event_month
ORDER BY event_month;


[0m11:42:16.494834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:17.763226 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a36cac5c-5492-4c2a-907e-197b326b709a&page=queryresults
[0m11:42:18.036545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1771c114-6f0e-488c-9cd7-303d5e07d894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13755c3b0>]}
[0m11:42:18.037254 [info ] [Thread-1 (]: 4 of 6 OK created sql view model single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[32mCREATE VIEW (0 processed)[0m in 1.56s]
[0m11:42:18.037792 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m11:42:18.038148 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m11:42:18.038582 [info ] [Thread-1 (]: 5 of 6 START sql view model single_view_policy_assignment.cancelled_within_30_days_analysis  [RUN]
[0m11:42:18.038965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.avg_quote_to_bind_by_month_analysis, now model.my_project.cancelled_within_30_days_analysis)
[0m11:42:18.039279 [debug] [Thread-1 (]: Began compiling node model.my_project.cancelled_within_30_days_analysis
[0m11:42:18.041754 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.cancelled_within_30_days_analysis"
[0m11:42:18.043765 [debug] [Thread-1 (]: Began executing node model.my_project.cancelled_within_30_days_analysis
[0m11:42:18.045651 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.cancelled_within_30_days_analysis"
[0m11:42:18.046575 [debug] [Thread-1 (]: On model.my_project.cancelled_within_30_days_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.cancelled_within_30_days_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`cancelled_within_30_days_analysis`
  OPTIONS()
  as 

SELECT COUNT(*) AS num_cancelled_within_30_days
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_hr IS NOT NULL
  AND bind_to_cancel_hr IS NOT NULL
  AND bind_to_cancel_hr <= 30*24;


[0m11:42:18.046937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:19.927596 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:12367194-8f67-41ef-9db3-9e4fc615c398&page=queryresults
[0m11:42:20.549719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1771c114-6f0e-488c-9cd7-303d5e07d894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1375cbad0>]}
[0m11:42:20.551414 [info ] [Thread-1 (]: 5 of 6 OK created sql view model single_view_policy_assignment.cancelled_within_30_days_analysis  [[32mCREATE VIEW (0 processed)[0m in 2.51s]
[0m11:42:20.552500 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m11:42:20.553245 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m11:42:20.554043 [info ] [Thread-1 (]: 6 of 6 START sql view model single_view_policy_assignment.quoted_never_bound_analysis  [RUN]
[0m11:42:20.554699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.cancelled_within_30_days_analysis, now model.my_project.quoted_never_bound_analysis)
[0m11:42:20.555251 [debug] [Thread-1 (]: Began compiling node model.my_project.quoted_never_bound_analysis
[0m11:42:20.560194 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.quoted_never_bound_analysis"
[0m11:42:20.561915 [debug] [Thread-1 (]: Began executing node model.my_project.quoted_never_bound_analysis
[0m11:42:20.565647 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.quoted_never_bound_analysis"
[0m11:42:20.566553 [debug] [Thread-1 (]: On model.my_project.quoted_never_bound_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.quoted_never_bound_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`quoted_never_bound_analysis`
  OPTIONS()
  as 

SELECT COUNT(*) AS num_quoted_never_bound
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE first_quote_ts IS NOT NULL 
    AND first_bind_ts IS NULL;


[0m11:42:20.567056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:21.458214 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:2c71ed9d-2b26-43c7-8f95-e1ae9d820c07&page=queryresults
[0m11:42:22.104885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1771c114-6f0e-488c-9cd7-303d5e07d894', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1375cb740>]}
[0m11:42:22.105750 [info ] [Thread-1 (]: 6 of 6 OK created sql view model single_view_policy_assignment.quoted_never_bound_analysis  [[32mCREATE VIEW (0 processed)[0m in 1.55s]
[0m11:42:22.106448 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m11:42:22.107604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:42:22.156987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:22.157186 [debug] [MainThread]: Connection 'model.my_project.quoted_never_bound_analysis' was properly closed.
[0m11:42:22.157386 [info ] [MainThread]: 
[0m11:42:22.157560 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 18.35 seconds (18.35s).
[0m11:42:22.158205 [debug] [MainThread]: Command end result
[0m11:42:22.171336 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m11:42:22.172158 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m11:42:22.175080 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m11:42:22.175257 [info ] [MainThread]: 
[0m11:42:22.175436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:42:22.175576 [info ] [MainThread]: 
[0m11:42:22.175740 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m11:42:22.175994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 20.671759, "process_in_blocks": "0", "process_kernel_time": 1.034047, "process_mem_max_rss": "404832256", "process_out_blocks": "0", "process_user_time": 4.342205}
[0m11:42:22.176258 [debug] [MainThread]: Command `dbt run` succeeded at 11:42:22.176217 after 20.67 seconds
[0m11:42:22.176434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104546720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d51d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056fbf20>]}
[0m11:42:22.176593 [debug] [MainThread]: Flushing usage events
[0m11:42:23.759351 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:11.210812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10663ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c00620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c00350>]}


============================== 11:47:11.212858 | ef269586-44c7-448d-8c55-ddecd907cb59 ==============================
[0m11:47:11.212858 [info ] [MainThread]: Running with dbt=1.10.6
[0m11:47:11.213227 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'cache_selected_only': 'False', 'invocation_command': 'dbt build', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'introspect': 'True', 'use_colors': 'True', 'debug': 'False', 'write_json': 'True', 'static_parser': 'True', 'no_print': 'None', 'fail_fast': 'False', 'empty': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'quiet': 'False'}
[0m11:47:13.364376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef269586-44c7-448d-8c55-ddecd907cb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1493d7860>]}
[0m11:47:13.389079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef269586-44c7-448d-8c55-ddecd907cb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14930a900>]}
[0m11:47:13.389386 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m11:47:13.504249 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m11:47:13.584894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:47:13.585121 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:47:13.587569 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.ext
- models.my_project.persist_docs
[0m11:47:13.605535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef269586-44c7-448d-8c55-ddecd907cb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ac14920>]}
[0m11:47:13.643673 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m11:47:13.644932 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m11:47:13.663298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef269586-44c7-448d-8c55-ddecd907cb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a98eb70>]}
[0m11:47:13.663549 [info ] [MainThread]: Found 6 models, 10 data tests, 1 source, 496 macros
[0m11:47:13.664725 [info ] [MainThread]: 
[0m11:47:13.664934 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m11:47:13.665085 [info ] [MainThread]: 
[0m11:47:13.665339 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:47:13.667095 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m11:47:13.667300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:14.712813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m11:47:14.714159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:15.442863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef269586-44c7-448d-8c55-ddecd907cb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ae6ca40>]}
[0m11:47:15.444170 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:47:15.504807 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m11:47:15.505247 [info ] [Thread-1 (]: 1 of 16 START sql table model single_view_policy_assignment.raw_policy_events .. [RUN]
[0m11:47:15.505656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m11:47:15.505888 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m11:47:15.510864 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m11:47:15.511255 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m11:47:15.518881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:16.265263 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m11:47:16.266992 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    );
  
[0m11:47:17.050377 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:715145af-04e1-464c-96df-007eb6a71ffd&page=queryresults
[0m11:47:19.077397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef269586-44c7-448d-8c55-ddecd907cb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cabbc80>]}
[0m11:47:19.078108 [info ] [Thread-1 (]: 1 of 16 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 3.57s]
[0m11:47:19.078639 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m11:47:19.079228 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m11:47:19.079736 [info ] [Thread-1 (]: 2 of 16 START sql table model single_view_policy_assignment.stg_policy_events .. [RUN]
[0m11:47:19.080089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m11:47:19.080354 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m11:47:19.082520 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m11:47:19.083019 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m11:47:19.084462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:19.771734 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m11:47:19.774800 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m11:47:20.444345 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:5f605c1f-2426-4c44-b49d-13ea6140a7ad&page=queryresults
[0m11:47:22.730317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef269586-44c7-448d-8c55-ddecd907cb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1495cc830>]}
[0m11:47:22.731907 [info ] [Thread-1 (]: 2 of 16 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.65s]
[0m11:47:22.732940 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m11:47:22.734085 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m11:47:22.734797 [info ] [Thread-1 (]: 3 of 16 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m11:47:22.735372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m11:47:22.735844 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m11:47:22.742282 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m11:47:22.743258 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m11:47:22.777096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:23.528073 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m11:47:23.529018 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched` as DBT_INTERNAL_DEST
        using (

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type,
    event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      *,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, HOUR)
      ELSE NULL
    END AS quote_to_bind_hr,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, HOUR)
      ELSE NULL
    END AS bind_to_cancel_hr,
    l.event_month
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
)


SELECT * FROM final
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.policy_id = DBT_INTERNAL_DEST.policy_id
                ) and (
                    DBT_INTERNAL_SOURCE.event_type = DBT_INTERNAL_DEST.event_type
                ) and (
                    DBT_INTERNAL_SOURCE.product_type = DBT_INTERNAL_DEST.product_type
                )

    
    when matched then update set
        `policy_id` = DBT_INTERNAL_SOURCE.`policy_id`,`first_quote_ts` = DBT_INTERNAL_SOURCE.`first_quote_ts`,`first_bind_ts` = DBT_INTERNAL_SOURCE.`first_bind_ts`,`first_cancel_ts` = DBT_INTERNAL_SOURCE.`first_cancel_ts`,`last_event_type` = DBT_INTERNAL_SOURCE.`last_event_type`,`current_status` = DBT_INTERNAL_SOURCE.`current_status`,`quote_to_bind_hr` = DBT_INTERNAL_SOURCE.`quote_to_bind_hr`,`bind_to_cancel_hr` = DBT_INTERNAL_SOURCE.`bind_to_cancel_hr`,`event_month` = DBT_INTERNAL_SOURCE.`event_month`
    

    when not matched then insert
        (`policy_id`, `first_quote_ts`, `first_bind_ts`, `first_cancel_ts`, `last_event_type`, `current_status`, `quote_to_bind_hr`, `bind_to_cancel_hr`, `event_month`)
    values
        (`policy_id`, `first_quote_ts`, `first_bind_ts`, `first_cancel_ts`, `last_event_type`, `current_status`, `quote_to_bind_hr`, `bind_to_cancel_hr`, `event_month`)


    
[0m11:47:24.018652 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:b7bb6f02-35e8-46e1-8a1d-d439f2cd4d07&page=queryresults
[0m11:47:24.404743 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:b7bb6f02-35e8-46e1-8a1d-d439f2cd4d07&page=queryresults
[0m11:47:24.417282 [debug] [Thread-1 (]: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Name event_type not found inside DBT_INTERNAL_SOURCE at [90:41]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m11:47:24.418297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef269586-44c7-448d-8c55-ddecd907cb59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14cb44fe0>]}
[0m11:47:24.419238 [error] [Thread-1 (]: 3 of 16 ERROR creating sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[31mERROR[0m in 1.68s]
[0m11:47:24.420023 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m11:47:24.421113 [debug] [Thread-4 (]: Marking all children of 'model.my_project.policy_lifecycle_enriched' to be skipped because of status 'error'.  Reason: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Name event_type not found inside DBT_INTERNAL_SOURCE at [90:41]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql.
[0m11:47:24.422556 [debug] [Thread-1 (]: Began running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m11:47:24.423031 [info ] [Thread-1 (]: 4 of 16 SKIP test accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled  [[33mSKIP[0m]
[0m11:47:24.423469 [debug] [Thread-1 (]: Finished running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m11:47:24.423862 [debug] [Thread-1 (]: Began running node test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840
[0m11:47:24.424210 [debug] [Thread-4 (]: Marking all children of 'test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715' to be skipped because of status 'skipped'. 
[0m11:47:24.424754 [info ] [Thread-1 (]: 5 of 16 SKIP test accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel  [[33mSKIP[0m]
[0m11:47:24.425456 [debug] [Thread-1 (]: Finished running node test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840
[0m11:47:24.425935 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m11:47:24.426278 [debug] [Thread-4 (]: Marking all children of 'test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840' to be skipped because of status 'skipped'. 
[0m11:47:24.426761 [info ] [Thread-1 (]: 6 of 16 SKIP test not_null_policy_lifecycle_enriched_current_status ............ [[33mSKIP[0m]
[0m11:47:24.427334 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m11:47:24.427738 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m11:47:24.428054 [debug] [Thread-4 (]: Marking all children of 'test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a' to be skipped because of status 'skipped'. 
[0m11:47:24.428445 [info ] [Thread-1 (]: 7 of 16 SKIP test not_null_policy_lifecycle_enriched_event_month ............... [[33mSKIP[0m]
[0m11:47:24.428932 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m11:47:24.429280 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8
[0m11:47:24.429551 [debug] [Thread-4 (]: Marking all children of 'test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87' to be skipped because of status 'skipped'. 
[0m11:47:24.429937 [info ] [Thread-1 (]: 8 of 16 SKIP test not_null_policy_lifecycle_enriched_event_timestamp ........... [[33mSKIP[0m]
[0m11:47:24.430390 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8
[0m11:47:24.430720 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c
[0m11:47:24.430977 [debug] [Thread-4 (]: Marking all children of 'test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8' to be skipped because of status 'skipped'. 
[0m11:47:24.431294 [info ] [Thread-1 (]: 9 of 16 SKIP test not_null_policy_lifecycle_enriched_event_type ................ [[33mSKIP[0m]
[0m11:47:24.431768 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c
[0m11:47:24.432128 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m11:47:24.432388 [debug] [Thread-4 (]: Marking all children of 'test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c' to be skipped because of status 'skipped'. 
[0m11:47:24.432700 [info ] [Thread-1 (]: 10 of 16 SKIP test not_null_policy_lifecycle_enriched_first_bind_ts ............ [[33mSKIP[0m]
[0m11:47:24.433134 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m11:47:24.433474 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m11:47:24.433743 [debug] [Thread-4 (]: Marking all children of 'test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8' to be skipped because of status 'skipped'. 
[0m11:47:24.434049 [info ] [Thread-1 (]: 11 of 16 SKIP test not_null_policy_lifecycle_enriched_first_quote_ts ........... [[33mSKIP[0m]
[0m11:47:24.434470 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m11:47:24.434800 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m11:47:24.435060 [debug] [Thread-4 (]: Marking all children of 'test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0' to be skipped because of status 'skipped'. 
[0m11:47:24.435364 [info ] [Thread-1 (]: 12 of 16 SKIP test not_null_policy_lifecycle_enriched_policy_id ................ [[33mSKIP[0m]
[0m11:47:24.435900 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m11:47:24.436241 [debug] [Thread-1 (]: Began running node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m11:47:24.436470 [debug] [Thread-4 (]: Marking all children of 'test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b' to be skipped because of status 'skipped'. 
[0m11:47:24.436727 [info ] [Thread-1 (]: 13 of 16 SKIP test unique_policy_lifecycle_enriched_policy_id .................. [[33mSKIP[0m]
[0m11:47:24.437085 [debug] [Thread-1 (]: Finished running node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m11:47:24.437324 [debug] [Thread-4 (]: Marking all children of 'test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745' to be skipped because of status 'skipped'. 
[0m11:47:24.437781 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m11:47:24.438195 [info ] [Thread-1 (]: 14 of 16 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m11:47:24.438682 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m11:47:24.438974 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m11:47:24.439202 [debug] [Thread-4 (]: Marking all children of 'model.my_project.avg_quote_to_bind_by_month_analysis' to be skipped because of status 'skipped'. 
[0m11:47:24.439492 [info ] [Thread-1 (]: 15 of 16 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m11:47:24.439867 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m11:47:24.440156 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m11:47:24.440434 [info ] [Thread-1 (]: 16 of 16 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis  [[33mSKIP[0m]
[0m11:47:24.440663 [debug] [Thread-4 (]: Marking all children of 'model.my_project.cancelled_within_30_days_analysis' to be skipped because of status 'skipped'. 
[0m11:47:24.440942 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m11:47:24.441225 [debug] [Thread-4 (]: Marking all children of 'model.my_project.quoted_never_bound_analysis' to be skipped because of status 'skipped'. 
[0m11:47:24.441938 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:47:24.485506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:24.485704 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m11:47:24.485911 [info ] [MainThread]: 
[0m11:47:24.486086 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 10 data tests, 3 view models in 0 hours 0 minutes and 10.82 seconds (10.82s).
[0m11:47:24.486704 [debug] [MainThread]: Command end result
[0m11:47:24.499381 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m11:47:24.500155 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m11:47:24.503944 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m11:47:24.504133 [info ] [MainThread]: 
[0m11:47:24.504316 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:47:24.504455 [info ] [MainThread]: 
[0m11:47:24.504643 [error] [MainThread]: [31mFailure in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)[0m
[0m11:47:24.504823 [error] [MainThread]:   Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Name event_type not found inside DBT_INTERNAL_SOURCE at [90:41]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m11:47:24.504964 [info ] [MainThread]: 
[0m11:47:24.505115 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/policy_lifecycle_enriched.sql
[0m11:47:24.505247 [info ] [MainThread]: 
[0m11:47:24.505401 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=13 NO-OP=0 TOTAL=16
[0m11:47:24.505672 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 13.328523, "process_in_blocks": "0", "process_kernel_time": 0.849109, "process_mem_max_rss": "404111360", "process_out_blocks": "0", "process_user_time": 4.189254}
[0m11:47:24.505946 [debug] [MainThread]: Command `dbt build` failed at 11:47:24.505906 after 13.33 seconds
[0m11:47:24.506122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149415a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149478c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ca32d20>]}
[0m11:47:24.506276 [debug] [MainThread]: Flushing usage events
[0m11:47:25.778735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:41.035820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fabef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cfc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cc110>]}


============================== 11:47:41.037530 | 8d23f84c-2737-44ec-b5be-9bd9b00e2294 ==============================
[0m11:47:41.037530 [info ] [MainThread]: Running with dbt=1.10.6
[0m11:47:41.037915 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'write_json': 'True', 'invocation_command': 'dbt clean', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'static_parser': 'True', 'introspect': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'target_path': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_format': 'default', 'printer_width': '80', 'partial_parse': 'True', 'version_check': 'True', 'debug': 'False'}
[0m11:47:41.104249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d23f84c-2737-44ec-b5be-9bd9b00e2294', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fab5f0>]}
[0m11:47:41.116463 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.11176038, "process_in_blocks": "0", "process_kernel_time": 0.130063, "process_mem_max_rss": "107134976", "process_out_blocks": "0", "process_user_time": 0.680788}
[0m11:47:41.116769 [debug] [MainThread]: Command `dbt clean` succeeded at 11:47:41.116719 after 0.11 seconds
[0m11:47:41.116954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fabef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cfbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cc110>]}
[0m11:47:41.117120 [debug] [MainThread]: Flushing usage events
[0m11:47:42.397592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:46.361638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c093a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109638530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109638260>]}


============================== 11:47:46.362936 | 81b88b9f-dc77-4f74-ac8b-2103c9151375 ==============================
[0m11:47:46.362936 [info ] [MainThread]: Running with dbt=1.10.6
[0m11:47:46.363322 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'fail_fast': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'static_parser': 'True', 'version_check': 'True', 'partial_parse': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build', 'log_format': 'default'}
[0m11:47:48.309848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81b88b9f-dc77-4f74-ac8b-2103c9151375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165c0ebd0>]}
[0m11:47:48.334113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81b88b9f-dc77-4f74-ac8b-2103c9151375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16ad6b140>]}
[0m11:47:48.334414 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m11:47:48.448147 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m11:47:48.448602 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:47:48.448828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '81b88b9f-dc77-4f74-ac8b-2103c9151375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16af03e30>]}
[0m11:47:49.005787 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.persist_docs
- models.my_project.ext
[0m11:47:49.009926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81b88b9f-dc77-4f74-ac8b-2103c9151375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b598230>]}
[0m11:47:49.048676 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m11:47:49.049786 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m11:47:49.066878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81b88b9f-dc77-4f74-ac8b-2103c9151375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c08b6e0>]}
[0m11:47:49.067188 [info ] [MainThread]: Found 6 models, 10 data tests, 1 source, 496 macros
[0m11:47:49.068431 [info ] [MainThread]: 
[0m11:47:49.068658 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m11:47:49.068806 [info ] [MainThread]: 
[0m11:47:49.069065 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:47:49.071024 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m11:47:49.071257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:50.068122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m11:47:50.069430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:50.792257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81b88b9f-dc77-4f74-ac8b-2103c9151375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106553140>]}
[0m11:47:50.793514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:47:50.853955 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m11:47:50.854452 [info ] [Thread-1 (]: 1 of 16 START sql table model single_view_policy_assignment.raw_policy_events .. [RUN]
[0m11:47:50.854764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m11:47:50.854992 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m11:47:50.860351 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m11:47:50.860909 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m11:47:50.964327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:51.673532 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m11:47:51.674895 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    );
  
[0m11:47:52.088636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:6a9ca073-6de3-436a-9876-ef83fc92e954&page=queryresults
[0m11:47:54.281744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b88b9f-dc77-4f74-ac8b-2103c9151375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1659c7a40>]}
[0m11:47:54.282449 [info ] [Thread-1 (]: 1 of 16 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 3.43s]
[0m11:47:54.283002 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m11:47:54.283655 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m11:47:54.284216 [info ] [Thread-1 (]: 2 of 16 START sql table model single_view_policy_assignment.stg_policy_events .. [RUN]
[0m11:47:54.284629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m11:47:54.284932 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m11:47:54.287339 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m11:47:54.287902 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m11:47:54.289335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:55.088760 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m11:47:55.090854 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m11:47:55.496812 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:f8d603b5-bf7e-43cd-8a29-e03559f64008&page=queryresults
[0m11:47:57.515336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b88b9f-dc77-4f74-ac8b-2103c9151375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d5fd4c0>]}
[0m11:47:57.517980 [info ] [Thread-1 (]: 2 of 16 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.23s]
[0m11:47:57.519145 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m11:47:57.520568 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m11:47:57.521372 [info ] [Thread-1 (]: 3 of 16 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m11:47:57.522066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m11:47:57.522598 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m11:47:57.531771 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m11:47:57.533021 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m11:47:57.567215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:58.291668 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m11:47:58.292489 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched` as DBT_INTERNAL_DEST
        using (

WITH firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type,
    event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      *,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, HOUR)
      ELSE NULL
    END AS quote_to_bind_hr,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, HOUR)
      ELSE NULL
    END AS bind_to_cancel_hr,
    l.event_month
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
)


SELECT * FROM final
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.policy_id = DBT_INTERNAL_DEST.policy_id
                ) and (
                    DBT_INTERNAL_SOURCE.event_type = DBT_INTERNAL_DEST.event_type
                ) and (
                    DBT_INTERNAL_SOURCE.product_type = DBT_INTERNAL_DEST.product_type
                )

    
    when matched then update set
        `policy_id` = DBT_INTERNAL_SOURCE.`policy_id`,`first_quote_ts` = DBT_INTERNAL_SOURCE.`first_quote_ts`,`first_bind_ts` = DBT_INTERNAL_SOURCE.`first_bind_ts`,`first_cancel_ts` = DBT_INTERNAL_SOURCE.`first_cancel_ts`,`last_event_type` = DBT_INTERNAL_SOURCE.`last_event_type`,`current_status` = DBT_INTERNAL_SOURCE.`current_status`,`quote_to_bind_hr` = DBT_INTERNAL_SOURCE.`quote_to_bind_hr`,`bind_to_cancel_hr` = DBT_INTERNAL_SOURCE.`bind_to_cancel_hr`,`event_month` = DBT_INTERNAL_SOURCE.`event_month`
    

    when not matched then insert
        (`policy_id`, `first_quote_ts`, `first_bind_ts`, `first_cancel_ts`, `last_event_type`, `current_status`, `quote_to_bind_hr`, `bind_to_cancel_hr`, `event_month`)
    values
        (`policy_id`, `first_quote_ts`, `first_bind_ts`, `first_cancel_ts`, `last_event_type`, `current_status`, `quote_to_bind_hr`, `bind_to_cancel_hr`, `event_month`)


    
[0m11:47:58.655731 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:be7b26bd-cd4c-44b2-96d0-ff365876871a&page=queryresults
[0m11:47:58.968911 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:be7b26bd-cd4c-44b2-96d0-ff365876871a&page=queryresults
[0m11:47:58.985823 [debug] [Thread-1 (]: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Name event_type not found inside DBT_INTERNAL_SOURCE at [90:41]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m11:47:58.987041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81b88b9f-dc77-4f74-ac8b-2103c9151375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16d5fdb50>]}
[0m11:47:58.988441 [error] [Thread-1 (]: 3 of 16 ERROR creating sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[31mERROR[0m in 1.46s]
[0m11:47:58.989378 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m11:47:58.989957 [debug] [Thread-4 (]: Marking all children of 'model.my_project.policy_lifecycle_enriched' to be skipped because of status 'error'.  Reason: Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Name event_type not found inside DBT_INTERNAL_SOURCE at [90:41]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql.
[0m11:47:58.991534 [debug] [Thread-1 (]: Began running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m11:47:58.992109 [info ] [Thread-1 (]: 4 of 16 SKIP test accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled  [[33mSKIP[0m]
[0m11:47:58.992626 [debug] [Thread-1 (]: Finished running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m11:47:58.993047 [debug] [Thread-1 (]: Began running node test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840
[0m11:47:58.993365 [debug] [Thread-4 (]: Marking all children of 'test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715' to be skipped because of status 'skipped'. 
[0m11:47:58.993821 [info ] [Thread-1 (]: 5 of 16 SKIP test accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel  [[33mSKIP[0m]
[0m11:47:58.994419 [debug] [Thread-1 (]: Finished running node test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840
[0m11:47:58.994823 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m11:47:58.995093 [debug] [Thread-4 (]: Marking all children of 'test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840' to be skipped because of status 'skipped'. 
[0m11:47:58.995418 [info ] [Thread-1 (]: 6 of 16 SKIP test not_null_policy_lifecycle_enriched_current_status ............ [[33mSKIP[0m]
[0m11:47:58.995884 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m11:47:58.996233 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m11:47:58.996504 [debug] [Thread-4 (]: Marking all children of 'test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a' to be skipped because of status 'skipped'. 
[0m11:47:58.996820 [info ] [Thread-1 (]: 7 of 16 SKIP test not_null_policy_lifecycle_enriched_event_month ............... [[33mSKIP[0m]
[0m11:47:58.997239 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m11:47:58.997558 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8
[0m11:47:58.997811 [debug] [Thread-4 (]: Marking all children of 'test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87' to be skipped because of status 'skipped'. 
[0m11:47:58.998138 [info ] [Thread-1 (]: 8 of 16 SKIP test not_null_policy_lifecycle_enriched_event_timestamp ........... [[33mSKIP[0m]
[0m11:47:58.998566 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8
[0m11:47:58.998887 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c
[0m11:47:58.999156 [debug] [Thread-4 (]: Marking all children of 'test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8' to be skipped because of status 'skipped'. 
[0m11:47:58.999461 [info ] [Thread-1 (]: 9 of 16 SKIP test not_null_policy_lifecycle_enriched_event_type ................ [[33mSKIP[0m]
[0m11:47:58.999860 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c
[0m11:47:59.000180 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m11:47:59.000486 [info ] [Thread-1 (]: 10 of 16 SKIP test not_null_policy_lifecycle_enriched_first_bind_ts ............ [[33mSKIP[0m]
[0m11:47:59.000771 [debug] [Thread-4 (]: Marking all children of 'test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c' to be skipped because of status 'skipped'. 
[0m11:47:59.001142 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m11:47:59.001539 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m11:47:59.001823 [debug] [Thread-4 (]: Marking all children of 'test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8' to be skipped because of status 'skipped'. 
[0m11:47:59.002190 [info ] [Thread-1 (]: 11 of 16 SKIP test not_null_policy_lifecycle_enriched_first_quote_ts ........... [[33mSKIP[0m]
[0m11:47:59.002642 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m11:47:59.002933 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m11:47:59.003199 [info ] [Thread-1 (]: 12 of 16 SKIP test not_null_policy_lifecycle_enriched_policy_id ................ [[33mSKIP[0m]
[0m11:47:59.003436 [debug] [Thread-4 (]: Marking all children of 'test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0' to be skipped because of status 'skipped'. 
[0m11:47:59.003705 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m11:47:59.004056 [debug] [Thread-1 (]: Began running node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m11:47:59.004284 [debug] [Thread-4 (]: Marking all children of 'test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b' to be skipped because of status 'skipped'. 
[0m11:47:59.004541 [info ] [Thread-1 (]: 13 of 16 SKIP test unique_policy_lifecycle_enriched_policy_id .................. [[33mSKIP[0m]
[0m11:47:59.004880 [debug] [Thread-1 (]: Finished running node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m11:47:59.005130 [debug] [Thread-4 (]: Marking all children of 'test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745' to be skipped because of status 'skipped'. 
[0m11:47:59.005739 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m11:47:59.006092 [info ] [Thread-1 (]: 14 of 16 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m11:47:59.006407 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m11:47:59.006684 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m11:47:59.006930 [debug] [Thread-4 (]: Marking all children of 'model.my_project.avg_quote_to_bind_by_month_analysis' to be skipped because of status 'skipped'. 
[0m11:47:59.007269 [info ] [Thread-1 (]: 15 of 16 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m11:47:59.007697 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m11:47:59.007975 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m11:47:59.008254 [info ] [Thread-1 (]: 16 of 16 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis  [[33mSKIP[0m]
[0m11:47:59.008497 [debug] [Thread-4 (]: Marking all children of 'model.my_project.cancelled_within_30_days_analysis' to be skipped because of status 'skipped'. 
[0m11:47:59.008798 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m11:47:59.009123 [debug] [Thread-4 (]: Marking all children of 'model.my_project.quoted_never_bound_analysis' to be skipped because of status 'skipped'. 
[0m11:47:59.009873 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:47:59.053306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:59.053510 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m11:47:59.053725 [info ] [MainThread]: 
[0m11:47:59.053903 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 10 data tests, 3 view models in 0 hours 0 minutes and 9.98 seconds (9.98s).
[0m11:47:59.054577 [debug] [MainThread]: Command end result
[0m11:47:59.068232 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m11:47:59.069553 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m11:47:59.072456 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m11:47:59.072636 [info ] [MainThread]: 
[0m11:47:59.072814 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:47:59.072958 [info ] [MainThread]: 
[0m11:47:59.073144 [error] [MainThread]: [31mFailure in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)[0m
[0m11:47:59.073327 [error] [MainThread]:   Database Error in model policy_lifecycle_enriched (models/example/policy_lifecycle_enriched.sql)
  Name event_type not found inside DBT_INTERNAL_SOURCE at [90:41]
  compiled code at target/run/my_project/models/example/policy_lifecycle_enriched.sql
[0m11:47:59.073462 [info ] [MainThread]: 
[0m11:47:59.073616 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/example/policy_lifecycle_enriched.sql
[0m11:47:59.073748 [info ] [MainThread]: 
[0m11:47:59.073904 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=13 NO-OP=0 TOTAL=16
[0m11:47:59.074148 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 12.740512, "process_in_blocks": "0", "process_kernel_time": 0.964995, "process_mem_max_rss": "410599424", "process_out_blocks": "0", "process_user_time": 4.581485}
[0m11:47:59.074408 [debug] [MainThread]: Command `dbt build` failed at 11:47:59.074368 after 12.74 seconds
[0m11:47:59.074594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c0d1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b297ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16c05a660>]}
[0m11:47:59.074762 [debug] [MainThread]: Flushing usage events
[0m11:48:00.182221 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:52.339858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c3cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106584440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108358110>]}


============================== 16:07:52.341985 | c62364d3-1609-4088-ba82-f446ba5a20fd ==============================
[0m16:07:52.341985 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:07:52.342365 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'fail_fast': 'False', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_cache_events': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'target_path': 'None', 'printer_width': '80', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt deps', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'introspect': 'True', 'no_print': 'None', 'write_json': 'True', 'quiet': 'False'}
[0m16:07:52.466644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c62364d3-1609-4088-ba82-f446ba5a20fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10830d8b0>]}
[0m16:07:52.477705 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-fl7e4e3a'
[0m16:07:52.478001 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:07:53.564251 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:07:53.566671 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m16:07:53.699529 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m16:07:53.701164 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m16:07:53.701875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c62364d3-1609-4088-ba82-f446ba5a20fd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853f8c0>]}
[0m16:07:53.707334 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m16:07:53.808581 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m16:07:53.818462 [info ] [MainThread]: Updating lock file in file path: /Users/pratibhagangavarapu/my_project/package-lock.yml
[0m16:07:53.821641 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-e93ewbkz'
[0m16:07:53.824762 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m16:07:54.824567 [info ] [MainThread]: Installed from version 0.10.4
[0m16:07:54.824839 [info ] [MainThread]: Up to date!
[0m16:07:54.825057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c62364d3-1609-4088-ba82-f446ba5a20fd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083faed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109070bf0>]}
[0m16:07:54.825237 [info ] [MainThread]: Installing calogica/dbt_date
[0m16:07:55.203303 [info ] [MainThread]: Installed from version 0.10.1
[0m16:07:55.203785 [info ] [MainThread]: Up to date!
[0m16:07:55.204129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c62364d3-1609-4088-ba82-f446ba5a20fd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109071af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090714c0>]}
[0m16:07:55.205219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085ace60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f8e00>]}
[0m16:07:55.205557 [debug] [MainThread]: Flushing usage events
[0m16:07:56.355962 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:59.943872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bab58e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3343b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c334110>]}


============================== 16:08:59.945536 | 75f00864-ca93-49bf-9f8b-66dfcc4717f5 ==============================
[0m16:08:59.945536 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:08:59.945906 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'debug': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'quiet': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'printer_width': '80', 'log_cache_events': 'False', 'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'cache_selected_only': 'False'}
[0m16:09:00.021072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75f00864-ca93-49bf-9f8b-66dfcc4717f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c30fef0>]}
[0m16:09:00.034690 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-wdoz6nav'
[0m16:09:00.035163 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:09:00.146531 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:09:00.147185 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m16:09:00.250666 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m16:09:00.261613 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m16:09:00.379878 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m16:09:00.396475 [info ] [MainThread]: Updating lock file in file path: /Users/pratibhagangavarapu/my_project/package-lock.yml
[0m16:09:00.427423 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-c_21udr5'
[0m16:09:00.430462 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:09:01.245662 [info ] [MainThread]: Installed from version 0.10.9
[0m16:09:01.245911 [info ] [MainThread]: Up to date!
[0m16:09:01.246100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '75f00864-ca93-49bf-9f8b-66dfcc4717f5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2c12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a7e810>]}
[0m16:09:01.246294 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m16:09:01.691543 [info ] [MainThread]: Installed from version 0.16.0
[0m16:09:01.692011 [info ] [MainThread]: Up to date!
[0m16:09:01.692334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '75f00864-ca93-49bf-9f8b-66dfcc4717f5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4dbda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4d9370>]}
[0m16:09:01.695325 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.782433, "process_in_blocks": "0", "process_kernel_time": 0.223849, "process_mem_max_rss": "119439360", "process_out_blocks": "0", "process_user_time": 0.851227}
[0m16:09:01.695805 [debug] [MainThread]: Command `dbt deps` succeeded at 16:09:01.695724 after 1.78 seconds
[0m16:09:01.696092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2c11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3a20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3ffa40>]}
[0m16:09:01.696351 [debug] [MainThread]: Flushing usage events
[0m16:09:02.775862 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:45.632381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a2f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a2fc80>]}


============================== 16:43:45.634494 | 933ac4ca-a5a3-4a34-800d-d6098390da56 ==============================
[0m16:43:45.634494 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:43:45.634839 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'quiet': 'False', 'version_check': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'invocation_command': 'dbt clean', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'target_path': 'None', 'debug': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'use_colors': 'True'}
[0m16:43:45.762648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '933ac4ca-a5a3-4a34-800d-d6098390da56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec7560>]}
[0m16:43:45.801921 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20260221, "process_in_blocks": "0", "process_kernel_time": 0.167705, "process_mem_max_rss": "107970560", "process_out_blocks": "0", "process_user_time": 0.682326}
[0m16:43:45.802257 [debug] [MainThread]: Command `dbt clean` succeeded at 16:43:45.802200 after 0.20 seconds
[0m16:43:45.802463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bbbe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bbbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4d5e0>]}
[0m16:43:45.802691 [debug] [MainThread]: Flushing usage events
[0m16:43:47.750682 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:54.901780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a04ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d9e270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a2570>]}


============================== 16:43:54.903264 | 93662224-c627-4b2a-8db7-d801b36a7158 ==============================
[0m16:43:54.903264 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:43:54.903615 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'introspect': 'True', 'invocation_command': 'dbt deps', 'version_check': 'True', 'fail_fast': 'False', 'target_path': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'no_print': 'None', 'partial_parse': 'True', 'empty': 'None'}
[0m16:43:54.971985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93662224-c627-4b2a-8db7-d801b36a7158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f8bc0>]}
[0m16:43:54.984715 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-64tyl3mf'
[0m16:43:54.984963 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:43:55.209478 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:43:55.210370 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m16:43:55.328694 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m16:43:55.334378 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m16:43:55.451528 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m16:43:55.458257 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:43:57.209415 [info ] [MainThread]: Installed from version 0.10.9
[0m16:43:57.209708 [info ] [MainThread]: Up to date!
[0m16:43:57.209902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '93662224-c627-4b2a-8db7-d801b36a7158', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054bd340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105574440>]}
[0m16:43:57.210096 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m16:43:57.641231 [info ] [MainThread]: Installed from version 0.16.0
[0m16:43:57.641747 [info ] [MainThread]: Up to date!
[0m16:43:57.642084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '93662224-c627-4b2a-8db7-d801b36a7158', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105510290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105620d70>]}
[0m16:43:57.645111 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.7742128, "process_in_blocks": "0", "process_kernel_time": 0.198353, "process_mem_max_rss": "119586816", "process_out_blocks": "0", "process_user_time": 0.86337}
[0m16:43:57.645757 [debug] [MainThread]: Command `dbt deps` succeeded at 16:43:57.645655 after 2.77 seconds
[0m16:43:57.646126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043581a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055125a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105541af0>]}
[0m16:43:57.646446 [debug] [MainThread]: Flushing usage events
[0m16:43:58.838703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:09.249424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c47290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107700350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077000b0>]}


============================== 16:44:09.250671 | 89e549c0-6b64-4c8b-9fed-99d2a512a103 ==============================
[0m16:44:09.250671 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:44:09.251057 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'printer_width': '80', 'no_print': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt run --full-refresh', 'cache_selected_only': 'False', 'static_parser': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'introspect': 'True', 'debug': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:44:11.546367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89e549c0-6b64-4c8b-9fed-99d2a512a103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14aa6ad50>]}
[0m16:44:11.571791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89e549c0-6b64-4c8b-9fed-99d2a512a103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a29ad20>]}
[0m16:44:11.572095 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:44:11.697474 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:44:11.697985 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:44:11.698195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '89e549c0-6b64-4c8b-9fed-99d2a512a103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ab0af30>]}
[0m16:44:12.701836 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_project.dim_state' (models/final/dim_state.sql) depends on a node named 'policy_event_fct' which was not found
[0m16:44:12.702301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4821486, "process_in_blocks": "0", "process_kernel_time": 0.793715, "process_mem_max_rss": "391462912", "process_out_blocks": "0", "process_user_time": 4.204859}
[0m16:44:12.702609 [debug] [MainThread]: Command `dbt run` failed at 16:44:12.702556 after 3.48 seconds
[0m16:44:12.702808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107700440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b0f5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b3ac920>]}
[0m16:44:12.702985 [debug] [MainThread]: Flushing usage events
[0m16:44:13.961508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:34.456737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a67380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106833c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106833fe0>]}


============================== 16:45:34.458420 | 4fc58cfe-e967-4331-8785-2769497c71f1 ==============================
[0m16:45:34.458420 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:45:34.458784 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'version_check': 'True', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'quiet': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'log_format': 'default', 'fail_fast': 'False', 'invocation_command': 'dbt run --full-refresh', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'write_json': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'empty': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt'}
[0m16:45:36.397904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160a677d0>]}
[0m16:45:36.422945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16079af30>]}
[0m16:45:36.423253 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:45:36.603156 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:45:36.603684 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:45:36.603910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160f06f30>]}
[0m16:45:37.506502 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.persist_docs
- models.my_project.ext
[0m16:45:37.511011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10558f830>]}
[0m16:45:37.556388 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:45:37.557490 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:45:37.568722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161420680>]}
[0m16:45:37.569019 [info ] [MainThread]: Found 10 models, 18 data tests, 1 source, 773 macros
[0m16:45:37.569256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161454920>]}
[0m16:45:37.570368 [info ] [MainThread]: 
[0m16:45:37.570580 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m16:45:37.570728 [info ] [MainThread]: 
[0m16:45:37.570978 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:45:37.573077 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m16:45:37.573292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:38.628305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m16:45:38.629692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:39.420868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16151bfe0>]}
[0m16:45:39.422299 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:39.485860 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m16:45:39.486307 [info ] [Thread-1 (]: 1 of 10 START sql table model single_view_policy_assignment.raw_policy_events .. [RUN]
[0m16:45:39.486607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m16:45:39.486824 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m16:45:39.491401 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m16:45:39.491938 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m16:45:39.499696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:40.338346 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m16:45:40.340294 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    );
  
[0m16:45:41.253212 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:3c71ee83-1f76-462d-8b1b-028a85516b42&page=queryresults
[0m16:45:43.555282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105258f50>]}
[0m16:45:43.556132 [info ] [Thread-1 (]: 1 of 10 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 4.07s]
[0m16:45:43.556709 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m16:45:43.557335 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m16:45:43.557856 [info ] [Thread-1 (]: 2 of 10 START sql table model single_view_policy_assignment.stg_policy_events .. [RUN]
[0m16:45:43.558360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m16:45:43.558685 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m16:45:43.561465 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m16:45:43.562058 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m16:45:43.564338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:44.377364 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m16:45:44.380108 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m16:45:45.122167 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:5c16544e-9b5c-4e89-a5b2-88fc66593f4e&page=queryresults
[0m16:45:47.057471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161ad7e00>]}
[0m16:45:47.060065 [info ] [Thread-1 (]: 2 of 10 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.50s]
[0m16:45:47.061221 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m16:45:47.062478 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m16:45:47.063191 [info ] [Thread-1 (]: 3 of 10 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m16:45:47.063883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m16:45:47.064360 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m16:45:47.071829 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m16:45:47.073231 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m16:45:47.107651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:47.851821 [debug] [Thread-1 (]: Hard refreshing `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched` because it is not replaceable
[0m16:45:48.014669 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m16:45:48.016700 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    -- Find first per event_type
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

policy_event_order as (
    select 'quote' as event_type, 1 as event_order union all
    select 'bind' as event_type, 2 as event_order union all
    select 'cancel' as event_type, 3 as event_order
)
, curated_data as (
    select
        spe.*
        ,peo.event_order
        ,row_number() over (partition by spe.policy_id order by spe.event_timestamp nulls last) as policy_order
    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events` spe
    join policy_event_order peo
        on spe.event_type = peo.event_type
),

filtered_curated AS(
  -- Exclude non-logical event sequences
  select *
  from curated_data
  where not (
    (policy_order = 1 and event_order != 1)
      or (policy_order = 2 and event_order = 3)
  )
),

---Assumptions are the order of events is only quote -> bind -> cancel. 
---A quote can't be cancelled
---A requote comes with a new policy_id

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type,
    event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      *,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, HOUR)
      ELSE NULL
    END AS quote_to_bind_hr,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, HOUR)
      ELSE NULL
    END AS bind_to_cancel_hr,
    l.event_month,
    l.source_channel,
    l.state,
    l.product_type,
    l.premium_amount
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
)


SELECT * FROM final
    );
  
[0m16:45:48.786304 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:d948a45e-08d3-414c-ab22-ededdeca5bff&page=queryresults
[0m16:45:51.097426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161622570>]}
[0m16:45:51.098692 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE TABLE (351.0 rows, 38.8 KiB processed)[0m in 4.03s]
[0m16:45:51.099577 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m16:45:51.100695 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m16:45:51.101336 [info ] [Thread-1 (]: 4 of 10 START sql view model single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [RUN]
[0m16:45:51.101900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_lifecycle_enriched, now model.my_project.avg_quote_to_bind_by_month_analysis)
[0m16:45:51.102365 [debug] [Thread-1 (]: Began compiling node model.my_project.avg_quote_to_bind_by_month_analysis
[0m16:45:51.106473 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.avg_quote_to_bind_by_month_analysis"
[0m16:45:51.108245 [debug] [Thread-1 (]: Began executing node model.my_project.avg_quote_to_bind_by_month_analysis
[0m16:45:51.124718 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.avg_quote_to_bind_by_month_analysis"
[0m16:45:51.125606 [debug] [Thread-1 (]: On model.my_project.avg_quote_to_bind_by_month_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.avg_quote_to_bind_by_month_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`avg_quote_to_bind_by_month_analysis`
  OPTIONS()
  as 


SELECT event_month, 
AVG(quote_to_bind_hr) AS avg_quote_to_bind_hr
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_hr IS NOT NULL
GROUP BY event_month
ORDER BY event_month;


[0m16:45:51.125939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:52.543518 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:4d937144-8a97-4dd1-81f4-25ef8c2f64f3&page=queryresults
[0m16:45:52.743289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161ac8e90>]}
[0m16:45:52.744380 [info ] [Thread-1 (]: 4 of 10 OK created sql view model single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[32mCREATE VIEW (0 processed)[0m in 1.64s]
[0m16:45:52.745074 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m16:45:52.745577 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m16:45:52.746231 [info ] [Thread-1 (]: 5 of 10 START sql view model single_view_policy_assignment.cancelled_within_30_days_analysis  [RUN]
[0m16:45:52.746823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.avg_quote_to_bind_by_month_analysis, now model.my_project.cancelled_within_30_days_analysis)
[0m16:45:52.747254 [debug] [Thread-1 (]: Began compiling node model.my_project.cancelled_within_30_days_analysis
[0m16:45:52.751307 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.cancelled_within_30_days_analysis"
[0m16:45:52.752096 [debug] [Thread-1 (]: Began executing node model.my_project.cancelled_within_30_days_analysis
[0m16:45:52.754949 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.cancelled_within_30_days_analysis"
[0m16:45:52.755724 [debug] [Thread-1 (]: On model.my_project.cancelled_within_30_days_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.cancelled_within_30_days_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`cancelled_within_30_days_analysis`
  OPTIONS()
  as 

SELECT COUNT(*) AS num_cancelled_within_30_days
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_hr IS NOT NULL
  AND bind_to_cancel_hr IS NOT NULL
  AND bind_to_cancel_hr <= 30*24;


[0m16:45:52.756144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:53.749512 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:8e4a5195-728e-42a2-94c7-75ca2ff884bb&page=queryresults
[0m16:45:54.711922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161b68440>]}
[0m16:45:54.713686 [info ] [Thread-1 (]: 5 of 10 OK created sql view model single_view_policy_assignment.cancelled_within_30_days_analysis  [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m16:45:54.714792 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m16:45:54.715493 [debug] [Thread-1 (]: Began running node model.my_project.dim_event_type
[0m16:45:54.716256 [info ] [Thread-1 (]: 6 of 10 START sql table model single_view_policy_assignment.dim_event_type ..... [RUN]
[0m16:45:54.716926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.cancelled_within_30_days_analysis, now model.my_project.dim_event_type)
[0m16:45:54.717437 [debug] [Thread-1 (]: Began compiling node model.my_project.dim_event_type
[0m16:45:54.722807 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.dim_event_type"
[0m16:45:54.723935 [debug] [Thread-1 (]: Began executing node model.my_project.dim_event_type
[0m16:45:54.730463 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.dim_event_type"
[0m16:45:54.731695 [debug] [Thread-1 (]: On model.my_project.dim_event_type: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.dim_event_type"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`dim_event_type`
      
    
    

    
    OPTIONS()
    as (
      

SELECT DISTINCT
    event_type
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    );
  
[0m16:45:54.732233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:55.642683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:46250014-1ab7-49cd-91a6-09326a205525&page=queryresults
[0m16:45:55.736755 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:46250014-1ab7-49cd-91a6-09326a205525&page=queryresults
[0m16:45:55.749653 [debug] [Thread-1 (]: Database Error in model dim_event_type (models/final/dim_event_type.sql)
  Unrecognized name: event_type at [17:5]
  compiled code at target/run/my_project/models/final/dim_event_type.sql
[0m16:45:55.750415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16151ab70>]}
[0m16:45:55.751635 [error] [Thread-1 (]: 6 of 10 ERROR creating sql table model single_view_policy_assignment.dim_event_type  [[31mERROR[0m in 1.03s]
[0m16:45:55.752562 [debug] [Thread-1 (]: Finished running node model.my_project.dim_event_type
[0m16:45:55.753150 [debug] [Thread-1 (]: Began running node model.my_project.dim_product_type
[0m16:45:55.753790 [debug] [Thread-4 (]: Marking all children of 'model.my_project.dim_event_type' to be skipped because of status 'error'.  Reason: Database Error in model dim_event_type (models/final/dim_event_type.sql)
  Unrecognized name: event_type at [17:5]
  compiled code at target/run/my_project/models/final/dim_event_type.sql.
[0m16:45:55.754479 [info ] [Thread-1 (]: 7 of 10 START sql table model single_view_policy_assignment.dim_product_type ... [RUN]
[0m16:45:55.755306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.dim_event_type, now model.my_project.dim_product_type)
[0m16:45:55.755785 [debug] [Thread-1 (]: Began compiling node model.my_project.dim_product_type
[0m16:45:55.759412 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.dim_product_type"
[0m16:45:55.760440 [debug] [Thread-1 (]: Began executing node model.my_project.dim_product_type
[0m16:45:55.763247 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.dim_product_type"
[0m16:45:55.763915 [debug] [Thread-1 (]: On model.my_project.dim_product_type: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.dim_product_type"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`dim_product_type`
      
    
    

    
    OPTIONS()
    as (
      

SELECT DISTINCT
    product_type
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE product_type IS NOT NULL
    );
  
[0m16:45:55.764383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:56.705695 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:9e210de5-b70b-4145-8089-70a0de182a0e&page=queryresults
[0m16:45:58.931724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161bb3ce0>]}
[0m16:45:58.933517 [info ] [Thread-1 (]: 7 of 10 OK created sql table model single_view_policy_assignment.dim_product_type  [[32mCREATE TABLE (4.0 rows, 2.6 KiB processed)[0m in 3.18s]
[0m16:45:58.934517 [debug] [Thread-1 (]: Finished running node model.my_project.dim_product_type
[0m16:45:58.935183 [debug] [Thread-1 (]: Began running node model.my_project.dim_source_channel
[0m16:45:58.935929 [info ] [Thread-1 (]: 8 of 10 START sql table model single_view_policy_assignment.dim_source_channel . [RUN]
[0m16:45:58.936513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.dim_product_type, now model.my_project.dim_source_channel)
[0m16:45:58.936957 [debug] [Thread-1 (]: Began compiling node model.my_project.dim_source_channel
[0m16:45:58.941990 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.dim_source_channel"
[0m16:45:58.943334 [debug] [Thread-1 (]: Began executing node model.my_project.dim_source_channel
[0m16:45:58.946452 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.dim_source_channel"
[0m16:45:58.947389 [debug] [Thread-1 (]: On model.my_project.dim_source_channel: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.dim_source_channel"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`dim_source_channel`
      
    
    

    
    OPTIONS()
    as (
      

SELECT DISTINCT
    source_channel
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    );
  
[0m16:45:58.947853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:59.976102 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:0f51e8ba-f084-4751-9870-1ff6b15bf2d9&page=queryresults
[0m16:46:01.991125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161c541a0>]}
[0m16:46:01.992808 [info ] [Thread-1 (]: 8 of 10 OK created sql table model single_view_policy_assignment.dim_source_channel  [[32mCREATE TABLE (4.0 rows, 3.1 KiB processed)[0m in 3.05s]
[0m16:46:01.993904 [debug] [Thread-1 (]: Finished running node model.my_project.dim_source_channel
[0m16:46:01.994587 [debug] [Thread-1 (]: Began running node model.my_project.dim_state
[0m16:46:01.995378 [info ] [Thread-1 (]: 9 of 10 START sql table model single_view_policy_assignment.dim_state .......... [RUN]
[0m16:46:01.996051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.dim_source_channel, now model.my_project.dim_state)
[0m16:46:01.996530 [debug] [Thread-1 (]: Began compiling node model.my_project.dim_state
[0m16:46:02.002195 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.dim_state"
[0m16:46:02.003286 [debug] [Thread-1 (]: Began executing node model.my_project.dim_state
[0m16:46:02.007143 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.dim_state"
[0m16:46:02.007980 [debug] [Thread-1 (]: On model.my_project.dim_state: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.dim_state"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`dim_state`
      
    
    

    
    OPTIONS()
    as (
      

SELECT DISTINCT
    state
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE state IS NOT NULL
    );
  
[0m16:46:02.008451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:02.962129 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:dfa1a06a-2bad-4f34-86f3-7ee5fa1ec21b&page=queryresults
[0m16:46:05.610250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161ca1c40>]}
[0m16:46:05.611492 [info ] [Thread-1 (]: 9 of 10 OK created sql table model single_view_policy_assignment.dim_state ..... [[32mCREATE TABLE (6.0 rows, 1.6 KiB processed)[0m in 3.61s]
[0m16:46:05.612360 [debug] [Thread-1 (]: Finished running node model.my_project.dim_state
[0m16:46:05.612946 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m16:46:05.613713 [info ] [Thread-1 (]: 10 of 10 START sql view model single_view_policy_assignment.quoted_never_bound_analysis  [RUN]
[0m16:46:05.614408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.dim_state, now model.my_project.quoted_never_bound_analysis)
[0m16:46:05.614924 [debug] [Thread-1 (]: Began compiling node model.my_project.quoted_never_bound_analysis
[0m16:46:05.621266 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.quoted_never_bound_analysis"
[0m16:46:05.622042 [debug] [Thread-1 (]: Began executing node model.my_project.quoted_never_bound_analysis
[0m16:46:05.624476 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.quoted_never_bound_analysis"
[0m16:46:05.625204 [debug] [Thread-1 (]: On model.my_project.quoted_never_bound_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.quoted_never_bound_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`quoted_never_bound_analysis`
  OPTIONS()
  as 

SELECT COUNT(*) AS num_quoted_never_bound
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE first_quote_ts IS NOT NULL 
    AND first_bind_ts IS NULL;


[0m16:46:05.625606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:06.528573 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:c7fe37a1-1b59-45d8-86b3-085285a35557&page=queryresults
[0m16:46:08.024910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc58cfe-e967-4331-8785-2769497c71f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161b75400>]}
[0m16:46:08.026508 [info ] [Thread-1 (]: 10 of 10 OK created sql view model single_view_policy_assignment.quoted_never_bound_analysis  [[32mCREATE VIEW (0 processed)[0m in 2.41s]
[0m16:46:08.027397 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m16:46:08.029165 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:46:08.085630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:08.085883 [debug] [MainThread]: Connection 'model.my_project.quoted_never_bound_analysis' was properly closed.
[0m16:46:08.086126 [info ] [MainThread]: 
[0m16:46:08.086329 [info ] [MainThread]: Finished running 1 incremental model, 6 table models, 3 view models in 0 hours 0 minutes and 30.52 seconds (30.52s).
[0m16:46:08.087354 [debug] [MainThread]: Command end result
[0m16:46:08.108696 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:46:08.109804 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:46:08.112889 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m16:46:08.113103 [info ] [MainThread]: 
[0m16:46:08.113317 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:46:08.113476 [info ] [MainThread]: 
[0m16:46:08.113661 [error] [MainThread]: [31mFailure in model dim_event_type (models/final/dim_event_type.sql)[0m
[0m16:46:08.113838 [error] [MainThread]:   Database Error in model dim_event_type (models/final/dim_event_type.sql)
  Unrecognized name: event_type at [17:5]
  compiled code at target/run/my_project/models/final/dim_event_type.sql
[0m16:46:08.113971 [info ] [MainThread]: 
[0m16:46:08.114124 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/final/dim_event_type.sql
[0m16:46:08.114271 [info ] [MainThread]: 
[0m16:46:08.114427 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=10
[0m16:46:08.114663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 33.689404, "process_in_blocks": "0", "process_kernel_time": 1.021019, "process_mem_max_rss": "399949824", "process_out_blocks": "0", "process_user_time": 5.630114}
[0m16:46:08.114919 [debug] [MainThread]: Command `dbt run` failed at 16:46:08.114881 after 33.69 seconds
[0m16:46:08.115094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106833fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685c320>]}
[0m16:46:08.115256 [debug] [MainThread]: Flushing usage events
[0m16:46:09.722796 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:24.145429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d856a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fdc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fdc170>]}


============================== 16:47:24.146973 | 0235df48-0181-477a-9712-a6991bb15024 ==============================
[0m16:47:24.146973 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:47:24.147351 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'write_json': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run --full-refresh', 'quiet': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'log_cache_events': 'False', 'version_check': 'True', 'introspect': 'True', 'indirect_selection': 'eager', 'empty': 'False', 'target_path': 'None', 'cache_selected_only': 'False'}
[0m16:47:25.909635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0235df48-0181-477a-9712-a6991bb15024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8b200>]}
[0m16:47:25.934552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0235df48-0181-477a-9712-a6991bb15024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10847f860>]}
[0m16:47:25.934863 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:47:26.056113 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:47:26.167921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:47:26.168278 [debug] [MainThread]: Partial parsing: updated file: my_project://models/final/dim_event_type.sql
[0m16:47:26.285075 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.persist_docs
- models.my_project.ext
[0m16:47:26.291069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0235df48-0181-477a-9712-a6991bb15024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1654e8e00>]}
[0m16:47:26.334715 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:47:26.337235 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:47:26.348477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0235df48-0181-477a-9712-a6991bb15024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1650efc50>]}
[0m16:47:26.348726 [info ] [MainThread]: Found 10 models, 18 data tests, 1 source, 773 macros
[0m16:47:26.348912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0235df48-0181-477a-9712-a6991bb15024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164d667b0>]}
[0m16:47:26.349831 [info ] [MainThread]: 
[0m16:47:26.350039 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m16:47:26.350178 [info ] [MainThread]: 
[0m16:47:26.350428 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:47:26.352300 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m16:47:26.352514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:27.364256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m16:47:27.365578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:28.129301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0235df48-0181-477a-9712-a6991bb15024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1653a5fd0>]}
[0m16:47:28.129749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:47:28.174631 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m16:47:28.174929 [info ] [Thread-1 (]: 1 of 10 START sql table model single_view_policy_assignment.raw_policy_events .. [RUN]
[0m16:47:28.175158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m16:47:28.175459 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m16:47:28.179318 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m16:47:28.180130 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m16:47:28.187605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:28.912971 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m16:47:28.914783 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    );
  
[0m16:47:29.472136 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:7dbd638e-6033-49bf-b5f1-7c192f55dd4c&page=queryresults
[0m16:47:31.538733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0235df48-0181-477a-9712-a6991bb15024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1698d9910>]}
[0m16:47:31.539712 [info ] [Thread-1 (]: 1 of 10 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 3.36s]
[0m16:47:31.540387 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m16:47:31.541179 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m16:47:31.541715 [info ] [Thread-1 (]: 2 of 10 START sql table model single_view_policy_assignment.stg_policy_events .. [RUN]
[0m16:47:31.542194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m16:47:31.542582 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m16:47:31.647747 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m16:47:31.648314 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m16:47:31.649459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:32.405236 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m16:47:32.407295 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m16:47:33.106012 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a2fa6059-c385-4778-ba30-1ac3fb803b20&page=queryresults
[0m16:47:34.897868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0235df48-0181-477a-9712-a6991bb15024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16535f8f0>]}
[0m16:47:34.899296 [info ] [Thread-1 (]: 2 of 10 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.36s]
[0m16:47:34.900287 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m16:47:34.901313 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m16:47:34.901954 [info ] [Thread-1 (]: 3 of 10 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m16:47:34.902546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m16:47:34.903012 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m16:47:34.908984 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m16:47:34.909862 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m16:47:34.942265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:35.642005 [debug] [Thread-1 (]: Hard refreshing `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched` because it is not replaceable
[0m16:47:35.768712 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m16:47:35.770627 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

WITH firsts AS (
  SELECT
    policy_id,
    -- Find first per event_type
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  GROUP BY policy_id
),

policy_event_order as (
    select 'quote' as event_type, 1 as event_order union all
    select 'bind' as event_type, 2 as event_order union all
    select 'cancel' as event_type, 3 as event_order
)
, curated_data as (
    select
        spe.*
        ,peo.event_order
        ,row_number() over (partition by spe.policy_id order by spe.event_timestamp nulls last) as policy_order
    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events` spe
    join policy_event_order peo
        on spe.event_type = peo.event_type
),

filtered_curated AS(
  -- Exclude non-logical event sequences
  select *
  from curated_data
  where not (
    (policy_order = 1 and event_order != 1)
      or (policy_order = 2 and event_order = 3)
  )
),

---Assumptions are the order of events is only quote -> bind -> cancel. 
---A quote can't be cancelled
---A requote comes with a new policy_id

last_evt AS (
  SELECT
    t.policy_id,
    event_type AS last_event_type,
    event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      *,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, HOUR)
      ELSE NULL
    END AS quote_to_bind_hr,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, HOUR)
      ELSE NULL
    END AS bind_to_cancel_hr,
    l.event_month,
    l.source_channel,
    l.state,
    l.product_type,
    l.premium_amount
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
)


SELECT * FROM final
    );
  
[0m16:47:36.196495 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a918110f-420b-4e94-b89f-da98e682404d&page=queryresults
[0m16:47:38.169712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0235df48-0181-477a-9712-a6991bb15024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164cb3e90>]}
[0m16:47:38.170544 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE TABLE (351.0 rows, 38.8 KiB processed)[0m in 3.27s]
[0m16:47:38.171213 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m16:47:38.171939 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m16:47:38.172452 [info ] [Thread-1 (]: 4 of 10 START sql view model single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [RUN]
[0m16:47:38.172946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_lifecycle_enriched, now model.my_project.avg_quote_to_bind_by_month_analysis)
[0m16:47:38.173314 [debug] [Thread-1 (]: Began compiling node model.my_project.avg_quote_to_bind_by_month_analysis
[0m16:47:38.176310 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.avg_quote_to_bind_by_month_analysis"
[0m16:47:38.178256 [debug] [Thread-1 (]: Began executing node model.my_project.avg_quote_to_bind_by_month_analysis
[0m16:47:38.194299 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.avg_quote_to_bind_by_month_analysis"
[0m16:47:38.194872 [debug] [Thread-1 (]: On model.my_project.avg_quote_to_bind_by_month_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.avg_quote_to_bind_by_month_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`avg_quote_to_bind_by_month_analysis`
  OPTIONS()
  as 


SELECT event_month, 
AVG(quote_to_bind_hr) AS avg_quote_to_bind_hr
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_hr IS NOT NULL
GROUP BY event_month
ORDER BY event_month;


[0m16:47:38.195160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:39.179587 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:e2f58bb9-1c5e-4dd6-8cae-b4cd0b2999af&page=queryresults
[0m16:47:39.682303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0235df48-0181-477a-9712-a6991bb15024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164d55a30>]}
[0m16:47:39.683245 [info ] [Thread-1 (]: 4 of 10 OK created sql view model single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[32mCREATE VIEW (0 processed)[0m in 1.51s]
[0m16:47:39.683931 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m16:47:39.684399 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m16:47:39.684982 [info ] [Thread-1 (]: 5 of 10 START sql view model single_view_policy_assignment.cancelled_within_30_days_analysis  [RUN]
[0m16:47:39.685547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.avg_quote_to_bind_by_month_analysis, now model.my_project.cancelled_within_30_days_analysis)
[0m16:47:39.685973 [debug] [Thread-1 (]: Began compiling node model.my_project.cancelled_within_30_days_analysis
[0m16:47:39.689622 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.cancelled_within_30_days_analysis"
[0m16:47:39.691334 [debug] [Thread-1 (]: Began executing node model.my_project.cancelled_within_30_days_analysis
[0m16:47:39.693859 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.cancelled_within_30_days_analysis"
[0m16:47:39.694495 [debug] [Thread-1 (]: On model.my_project.cancelled_within_30_days_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.cancelled_within_30_days_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`cancelled_within_30_days_analysis`
  OPTIONS()
  as 

SELECT COUNT(*) AS num_cancelled_within_30_days
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_hr IS NOT NULL
  AND bind_to_cancel_hr IS NOT NULL
  AND bind_to_cancel_hr <= 30*24;


[0m16:47:39.695048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:40.670450 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:747ffc78-d2bf-43b0-af18-20d60acd0b01&page=queryresults
[0m16:47:41.283295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0235df48-0181-477a-9712-a6991bb15024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164d04b60>]}
[0m16:47:41.284397 [info ] [Thread-1 (]: 5 of 10 OK created sql view model single_view_policy_assignment.cancelled_within_30_days_analysis  [[32mCREATE VIEW (0 processed)[0m in 1.60s]
[0m16:47:41.285253 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m16:47:41.285735 [debug] [Thread-1 (]: Began running node model.my_project.dim_event_type
[0m16:47:41.286358 [info ] [Thread-1 (]: 6 of 10 START sql table model single_view_policy_assignment.dim_event_type ..... [RUN]
[0m16:47:41.286918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.cancelled_within_30_days_analysis, now model.my_project.dim_event_type)
[0m16:47:41.287323 [debug] [Thread-1 (]: Began compiling node model.my_project.dim_event_type
[0m16:47:41.291159 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.dim_event_type"
[0m16:47:41.291954 [debug] [Thread-1 (]: Began executing node model.my_project.dim_event_type
[0m16:47:41.294716 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.dim_event_type"
[0m16:47:41.295470 [debug] [Thread-1 (]: On model.my_project.dim_event_type: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.dim_event_type"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`dim_event_type`
      
    
    

    
    OPTIONS()
    as (
      

SELECT DISTINCT
    last_event_type
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    );
  
[0m16:47:41.295871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:42.254834 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:baa9614a-1721-4286-8fef-7cbe119b8d3c&page=queryresults
[0m16:47:43.963160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0235df48-0181-477a-9712-a6991bb15024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165355dc0>]}
[0m16:47:43.964265 [info ] [Thread-1 (]: 6 of 10 OK created sql table model single_view_policy_assignment.dim_event_type  [[32mCREATE TABLE (3.0 rows, 2.3 KiB processed)[0m in 2.68s]
[0m16:47:43.965005 [debug] [Thread-1 (]: Finished running node model.my_project.dim_event_type
[0m16:47:43.965486 [debug] [Thread-1 (]: Began running node model.my_project.dim_product_type
[0m16:47:43.966126 [info ] [Thread-1 (]: 7 of 10 START sql table model single_view_policy_assignment.dim_product_type ... [RUN]
[0m16:47:43.966697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.dim_event_type, now model.my_project.dim_product_type)
[0m16:47:43.967128 [debug] [Thread-1 (]: Began compiling node model.my_project.dim_product_type
[0m16:47:43.970805 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.dim_product_type"
[0m16:47:43.971611 [debug] [Thread-1 (]: Began executing node model.my_project.dim_product_type
[0m16:47:43.975857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:44.703241 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.dim_product_type"
[0m16:47:44.706009 [debug] [Thread-1 (]: On model.my_project.dim_product_type: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.dim_product_type"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`dim_product_type`
      
    
    

    
    OPTIONS()
    as (
      

SELECT DISTINCT
    product_type
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE product_type IS NOT NULL
    );
  
[0m16:47:45.248439 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:cd82d09e-7b54-45df-9c12-9e0f41d1a2f4&page=queryresults
[0m16:47:47.290951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0235df48-0181-477a-9712-a6991bb15024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16993d4c0>]}
[0m16:47:47.292875 [info ] [Thread-1 (]: 7 of 10 OK created sql table model single_view_policy_assignment.dim_product_type  [[32mCREATE TABLE (4.0 rows, 2.6 KiB processed)[0m in 3.32s]
[0m16:47:47.294017 [debug] [Thread-1 (]: Finished running node model.my_project.dim_product_type
[0m16:47:47.294761 [debug] [Thread-1 (]: Began running node model.my_project.dim_source_channel
[0m16:47:47.295653 [info ] [Thread-1 (]: 8 of 10 START sql table model single_view_policy_assignment.dim_source_channel . [RUN]
[0m16:47:47.296344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.dim_product_type, now model.my_project.dim_source_channel)
[0m16:47:47.296889 [debug] [Thread-1 (]: Began compiling node model.my_project.dim_source_channel
[0m16:47:47.302422 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.dim_source_channel"
[0m16:47:47.303866 [debug] [Thread-1 (]: Began executing node model.my_project.dim_source_channel
[0m16:47:47.307103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:48.129117 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.dim_source_channel"
[0m16:47:48.129766 [debug] [Thread-1 (]: On model.my_project.dim_source_channel: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.dim_source_channel"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`dim_source_channel`
      
    
    

    
    OPTIONS()
    as (
      

SELECT DISTINCT
    source_channel
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    );
  
[0m16:47:48.484172 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:e3f2b455-d8f1-4aad-a931-43fcd77a7713&page=queryresults
[0m16:47:50.185766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0235df48-0181-477a-9712-a6991bb15024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165168050>]}
[0m16:47:50.187186 [info ] [Thread-1 (]: 8 of 10 OK created sql table model single_view_policy_assignment.dim_source_channel  [[32mCREATE TABLE (4.0 rows, 3.1 KiB processed)[0m in 2.89s]
[0m16:47:50.188028 [debug] [Thread-1 (]: Finished running node model.my_project.dim_source_channel
[0m16:47:50.188571 [debug] [Thread-1 (]: Began running node model.my_project.dim_state
[0m16:47:50.189488 [info ] [Thread-1 (]: 9 of 10 START sql table model single_view_policy_assignment.dim_state .......... [RUN]
[0m16:47:50.190216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.dim_source_channel, now model.my_project.dim_state)
[0m16:47:50.190725 [debug] [Thread-1 (]: Began compiling node model.my_project.dim_state
[0m16:47:50.195209 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.dim_state"
[0m16:47:50.196057 [debug] [Thread-1 (]: Began executing node model.my_project.dim_state
[0m16:47:50.198874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:50.885187 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.dim_state"
[0m16:47:50.886862 [debug] [Thread-1 (]: On model.my_project.dim_state: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.dim_state"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`dim_state`
      
    
    

    
    OPTIONS()
    as (
      

SELECT DISTINCT
    state
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE state IS NOT NULL
    );
  
[0m16:47:51.214562 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:c80ff042-2610-41af-b68b-e630339cab4b&page=queryresults
[0m16:47:53.194087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0235df48-0181-477a-9712-a6991bb15024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16531a330>]}
[0m16:47:53.195314 [info ] [Thread-1 (]: 9 of 10 OK created sql table model single_view_policy_assignment.dim_state ..... [[32mCREATE TABLE (6.0 rows, 1.6 KiB processed)[0m in 3.00s]
[0m16:47:53.196366 [debug] [Thread-1 (]: Finished running node model.my_project.dim_state
[0m16:47:53.196951 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m16:47:53.197735 [info ] [Thread-1 (]: 10 of 10 START sql view model single_view_policy_assignment.quoted_never_bound_analysis  [RUN]
[0m16:47:53.198457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.dim_state, now model.my_project.quoted_never_bound_analysis)
[0m16:47:53.198989 [debug] [Thread-1 (]: Began compiling node model.my_project.quoted_never_bound_analysis
[0m16:47:53.202915 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.quoted_never_bound_analysis"
[0m16:47:53.204474 [debug] [Thread-1 (]: Began executing node model.my_project.quoted_never_bound_analysis
[0m16:47:53.207557 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.quoted_never_bound_analysis"
[0m16:47:53.208349 [debug] [Thread-1 (]: On model.my_project.quoted_never_bound_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.quoted_never_bound_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`quoted_never_bound_analysis`
  OPTIONS()
  as 

SELECT COUNT(*) AS num_quoted_never_bound
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE first_quote_ts IS NOT NULL 
    AND first_bind_ts IS NULL;


[0m16:47:53.208745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:54.195539 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:c1f73c90-d76c-4c23-a2a3-2f07c73fffbd&page=queryresults
[0m16:47:54.801696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0235df48-0181-477a-9712-a6991bb15024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x169961e50>]}
[0m16:47:54.802644 [info ] [Thread-1 (]: 10 of 10 OK created sql view model single_view_policy_assignment.quoted_never_bound_analysis  [[32mCREATE VIEW (0 processed)[0m in 1.60s]
[0m16:47:54.803315 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m16:47:54.804464 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:47:54.856345 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:54.856567 [debug] [MainThread]: Connection 'model.my_project.quoted_never_bound_analysis' was properly closed.
[0m16:47:54.856794 [info ] [MainThread]: 
[0m16:47:54.856984 [info ] [MainThread]: Finished running 1 incremental model, 6 table models, 3 view models in 0 hours 0 minutes and 28.51 seconds (28.51s).
[0m16:47:54.857923 [debug] [MainThread]: Command end result
[0m16:47:54.878583 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:47:54.879839 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:47:54.882773 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m16:47:54.882936 [info ] [MainThread]: 
[0m16:47:54.883114 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:54.883255 [info ] [MainThread]: 
[0m16:47:54.883415 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m16:47:54.883656 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 30.772831, "process_in_blocks": "0", "process_kernel_time": 1.154241, "process_mem_max_rss": "411205632", "process_out_blocks": "0", "process_user_time": 4.725022}
[0m16:47:54.883907 [debug] [MainThread]: Command `dbt run` succeeded at 16:47:54.883867 after 30.77 seconds
[0m16:47:54.884083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1698ae720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fafec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1653a5880>]}
[0m16:47:54.884237 [debug] [MainThread]: Flushing usage events
[0m16:47:56.508575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:50.185472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510b260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b52780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b50740>]}


============================== 16:58:50.187441 | 13b5cb23-e8d0-4385-8918-19576482e228 ==============================
[0m16:58:50.187441 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:58:50.187803 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'target_path': 'None', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'printer_width': '80', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'write_json': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'invocation_command': 'dbt clean', 'quiet': 'False', 'fail_fast': 'False', 'introspect': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error': 'None'}
[0m16:58:50.313117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13b5cb23-e8d0-4385-8918-19576482e228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b0a70>]}
[0m16:58:50.350499 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.19782788, "process_in_blocks": "0", "process_kernel_time": 0.165951, "process_mem_max_rss": "107102208", "process_out_blocks": "0", "process_user_time": 0.683897}
[0m16:58:50.350842 [debug] [MainThread]: Command `dbt clean` succeeded at 16:58:50.350788 after 0.20 seconds
[0m16:58:50.351041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b0a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e77e00>]}
[0m16:58:50.351223 [debug] [MainThread]: Flushing usage events
[0m16:58:51.612214 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:57.080099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a7cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104426630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104427bc0>]}


============================== 16:58:57.081344 | 3d37452d-fcef-44aa-a605-034b4d912d01 ==============================
[0m16:58:57.081344 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:58:57.081699 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'printer_width': '80', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'partial_parse': 'True', 'quiet': 'False', 'write_json': 'True'}
[0m16:58:57.150451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d37452d-fcef-44aa-a605-034b4d912d01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a07e00>]}
[0m16:58:57.160882 [debug] [MainThread]: Set downloads directory='/var/folders/lc/51mm4fps53s5k9k2smvwx0j80000gn/T/dbt-downloads-titq4a8y'
[0m16:58:57.161115 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:58:58.128296 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:58:58.130697 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m16:58:58.247544 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m16:58:58.253356 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json
[0m16:58:58.359290 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/godatadriven/dbt_date.json 200
[0m16:58:58.363422 [info ] [MainThread]: Installing metaplane/dbt_expectations
[0m16:58:59.995766 [info ] [MainThread]: Installed from version 0.10.9
[0m16:58:59.996261 [info ] [MainThread]: Up to date!
[0m16:58:59.996477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3d37452d-fcef-44aa-a605-034b4d912d01', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105672e10>]}
[0m16:58:59.996688 [info ] [MainThread]: Installing godatadriven/dbt_date
[0m16:59:00.482050 [info ] [MainThread]: Installed from version 0.16.0
[0m16:59:00.482567 [info ] [MainThread]: Up to date!
[0m16:59:00.482932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3d37452d-fcef-44aa-a605-034b4d912d01', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a07d0>]}
[0m16:59:00.485177 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.4332583, "process_in_blocks": "0", "process_kernel_time": 0.177029, "process_mem_max_rss": "120029184", "process_out_blocks": "0", "process_user_time": 0.850368}
[0m16:59:00.485750 [debug] [MainThread]: Command `dbt deps` succeeded at 16:59:00.485657 after 3.43 seconds
[0m16:59:00.486083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105561220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104427c50>]}
[0m16:59:00.486363 [debug] [MainThread]: Flushing usage events
[0m16:59:01.742481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:06.793740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11023f860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aba8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d87c80>]}


============================== 16:59:06.795272 | 99b1d3d0-8b0d-448c-a60d-eb94dba619cb ==============================
[0m16:59:06.795272 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:59:06.795639 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'introspect': 'True', 'printer_width': '80', 'target_path': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'static_parser': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'warn_error': 'None', 'debug': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt'}
[0m16:59:08.964434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99b1d3d0-8b0d-448c-a60d-eb94dba619cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d4d3c20>]}
[0m16:59:08.990136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99b1d3d0-8b0d-448c-a60d-eb94dba619cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d066d20>]}
[0m16:59:08.990460 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:59:09.115247 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:59:09.115777 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:59:09.115994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '99b1d3d0-8b0d-448c-a60d-eb94dba619cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d665640>]}
[0m16:59:10.029035 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.ext
- models.my_project.persist_docs
[0m16:59:10.033800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99b1d3d0-8b0d-448c-a60d-eb94dba619cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dccf2f0>]}
[0m16:59:10.079611 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:59:10.081002 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:59:10.092070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99b1d3d0-8b0d-448c-a60d-eb94dba619cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15daee720>]}
[0m16:59:10.092341 [info ] [MainThread]: Found 10 models, 18 data tests, 1 source, 773 macros
[0m16:59:10.092513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99b1d3d0-8b0d-448c-a60d-eb94dba619cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dc1a870>]}
[0m16:59:10.093426 [info ] [MainThread]: 
[0m16:59:10.093621 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m16:59:10.093757 [info ] [MainThread]: 
[0m16:59:10.093999 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:59:10.095898 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m16:59:10.096112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:11.226675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m16:59:11.228052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:11.979171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99b1d3d0-8b0d-448c-a60d-eb94dba619cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15da39250>]}
[0m16:59:11.979787 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:59:12.032608 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m16:59:12.032950 [info ] [Thread-1 (]: 1 of 10 START sql table model single_view_policy_assignment.raw_policy_events .. [RUN]
[0m16:59:12.033209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m16:59:12.033405 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m16:59:12.037590 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m16:59:12.038151 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m16:59:12.046028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:12.741427 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m16:59:12.742528 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    );
  
[0m16:59:13.272128 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:5c2bb9ab-ed91-43ec-b98f-2b77c126e52e&page=queryresults
[0m16:59:15.386317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b1d3d0-8b0d-448c-a60d-eb94dba619cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d58890>]}
[0m16:59:15.386828 [info ] [Thread-1 (]: 1 of 10 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 3.35s]
[0m16:59:15.387185 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m16:59:15.387639 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m16:59:15.387955 [info ] [Thread-1 (]: 2 of 10 START sql table model single_view_policy_assignment.stg_policy_events .. [RUN]
[0m16:59:15.388219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m16:59:15.388410 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m16:59:15.390014 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m16:59:15.390384 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m16:59:15.391529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:16.103345 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m16:59:16.105802 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m16:59:16.652897 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:b3c2bee8-7cad-4079-8121-7f1e57053d6d&page=queryresults
[0m16:59:18.659181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b1d3d0-8b0d-448c-a60d-eb94dba619cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e263470>]}
[0m16:59:18.660639 [info ] [Thread-1 (]: 2 of 10 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.27s]
[0m16:59:18.661691 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m16:59:18.662904 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m16:59:18.663843 [info ] [Thread-1 (]: 3 of 10 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m16:59:18.664578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m16:59:18.665154 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m16:59:18.672416 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m16:59:18.673715 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m16:59:18.710298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:19.414574 [debug] [Thread-1 (]: Hard refreshing `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched` because it is not replaceable
[0m16:59:19.569950 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m16:59:19.572506 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

-- Event order mapping
WITH policy_event_order as (
    select 'quote' as event_type, 1 as event_order union all
    select 'bind' as event_type, 2 as event_order union all
    select 'cancel' as event_type, 3 as event_order
),

-- Attach event order and event position within each policy
, curated_data as (
    select
        spe.*
        ,peo.event_order
        ,row_number() over (partition by spe.policy_id order by spe.event_timestamp nulls last) as policy_order
    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events` spe
    join policy_event_order peo
        on spe.event_type = peo.event_type
),

-- Exclude non-logical event sequences
filtered_curated AS(
  select *
  from curated_data
  where not (
    (policy_order = 1 and event_order != 1) -- First event is not 'quote'
      or (policy_order = 2 and event_order = 3) -- Second event is 'cancel'
  )
),

---Assumptions are the order of events is only quote -> bind -> cancel. 
---A quote can't be cancelled
---A requote comes with a new policy_id

-- Find first per event_type
firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM filtered_curated
  GROUP BY policy_id
),


last_evt AS (
  SELECT
    t.policy_id,
    t.event_type AS last_event_type,
    t.event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      *,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM filtered_curated
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    l.event_ts,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, HOUR)
      ELSE NULL
    END AS quote_to_bind_hr,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, HOUR)
      ELSE NULL
    END AS bind_to_cancel_hr,
    l.event_month,
    l.source_channel,
    l.state,
    l.product_type,
    l.premium_amount
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
)


SELECT * FROM final
    );
  
[0m16:59:20.594278 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:e6a93c78-41c1-4f26-9e51-88988674dd95&page=queryresults
[0m16:59:20.596135 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:e6a93c78-41c1-4f26-9e51-88988674dd95&page=queryresults
[0m16:59:20.610405 [debug] [Thread-1 (]: Database Error in model policy_lifecycle_enriched (models/final/policy_lifecycle_enriched.sql)
  Syntax error: Expected keyword SELECT but got "," at [24:1]
  compiled code at target/run/my_project/models/final/policy_lifecycle_enriched.sql
[0m16:59:20.611441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99b1d3d0-8b0d-448c-a60d-eb94dba619cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15de680b0>]}
[0m16:59:20.612693 [error] [Thread-1 (]: 3 of 10 ERROR creating sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[31mERROR[0m in 1.95s]
[0m16:59:20.613804 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m16:59:20.614423 [debug] [Thread-4 (]: Marking all children of 'model.my_project.policy_lifecycle_enriched' to be skipped because of status 'error'.  Reason: Database Error in model policy_lifecycle_enriched (models/final/policy_lifecycle_enriched.sql)
  Syntax error: Expected keyword SELECT but got "," at [24:1]
  compiled code at target/run/my_project/models/final/policy_lifecycle_enriched.sql.
[0m16:59:20.615282 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m16:59:20.615868 [info ] [Thread-1 (]: 4 of 10 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m16:59:20.616333 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m16:59:20.616748 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m16:59:20.617186 [info ] [Thread-1 (]: 5 of 10 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m16:59:20.617658 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m16:59:20.618098 [debug] [Thread-1 (]: Began running node model.my_project.dim_event_type
[0m16:59:20.618527 [info ] [Thread-1 (]: 6 of 10 SKIP relation single_view_policy_assignment.dim_event_type ............. [[33mSKIP[0m]
[0m16:59:20.618958 [debug] [Thread-1 (]: Finished running node model.my_project.dim_event_type
[0m16:59:20.619321 [debug] [Thread-1 (]: Began running node model.my_project.dim_product_type
[0m16:59:20.619674 [info ] [Thread-1 (]: 7 of 10 SKIP relation single_view_policy_assignment.dim_product_type ........... [[33mSKIP[0m]
[0m16:59:20.620009 [debug] [Thread-1 (]: Finished running node model.my_project.dim_product_type
[0m16:59:20.620315 [debug] [Thread-1 (]: Began running node model.my_project.dim_source_channel
[0m16:59:20.620719 [info ] [Thread-1 (]: 8 of 10 SKIP relation single_view_policy_assignment.dim_source_channel ......... [[33mSKIP[0m]
[0m16:59:20.621203 [debug] [Thread-1 (]: Finished running node model.my_project.dim_source_channel
[0m16:59:20.621575 [debug] [Thread-1 (]: Began running node model.my_project.dim_state
[0m16:59:20.621924 [info ] [Thread-1 (]: 9 of 10 SKIP relation single_view_policy_assignment.dim_state .................. [[33mSKIP[0m]
[0m16:59:20.622262 [debug] [Thread-1 (]: Finished running node model.my_project.dim_state
[0m16:59:20.622566 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m16:59:20.622917 [info ] [Thread-1 (]: 10 of 10 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis  [[33mSKIP[0m]
[0m16:59:20.623553 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m16:59:20.624541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:59:20.671691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:20.671915 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m16:59:20.672138 [info ] [MainThread]: 
[0m16:59:20.672317 [info ] [MainThread]: Finished running 1 incremental model, 6 table models, 3 view models in 0 hours 0 minutes and 10.58 seconds (10.58s).
[0m16:59:20.672878 [debug] [MainThread]: Command end result
[0m16:59:20.692652 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m16:59:20.693878 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m16:59:20.696681 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m16:59:20.696858 [info ] [MainThread]: 
[0m16:59:20.697040 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:59:20.697186 [info ] [MainThread]: 
[0m16:59:20.697374 [error] [MainThread]: [31mFailure in model policy_lifecycle_enriched (models/final/policy_lifecycle_enriched.sql)[0m
[0m16:59:20.697551 [error] [MainThread]:   Database Error in model policy_lifecycle_enriched (models/final/policy_lifecycle_enriched.sql)
  Syntax error: Expected keyword SELECT but got "," at [24:1]
  compiled code at target/run/my_project/models/final/policy_lifecycle_enriched.sql
[0m16:59:20.697685 [info ] [MainThread]: 
[0m16:59:20.697837 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/final/policy_lifecycle_enriched.sql
[0m16:59:20.697966 [info ] [MainThread]: 
[0m16:59:20.698115 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=7 NO-OP=0 TOTAL=10
[0m16:59:20.698350 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.936267, "process_in_blocks": "0", "process_kernel_time": 0.907202, "process_mem_max_rss": "407142400", "process_out_blocks": "0", "process_user_time": 5.007731}
[0m16:59:20.698595 [debug] [MainThread]: Command `dbt run` failed at 16:59:20.698557 after 13.94 seconds
[0m16:59:20.698768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aba8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e1d9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e1704d0>]}
[0m16:59:20.698924 [debug] [MainThread]: Flushing usage events
[0m16:59:21.941867 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:01:24.741002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ceac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107233c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725c0e0>]}


============================== 17:01:24.742920 | d2a1b726-467b-4410-a4a7-81c12f666d4b ==============================
[0m17:01:24.742920 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:01:24.743267 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'target_path': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'write_json': 'True', 'version_check': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'quiet': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'log_format': 'default'}
[0m17:01:26.746273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2a1b726-467b-4410-a4a7-81c12f666d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172bb3080>]}
[0m17:01:26.771820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2a1b726-467b-4410-a4a7-81c12f666d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab8fe0>]}
[0m17:01:26.772142 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:01:26.891957 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:01:27.003368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:01:27.003741 [debug] [MainThread]: Partial parsing: updated file: my_project://models/final/policy_lifecycle_enriched.sql
[0m17:01:27.198899 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.ext
- models.my_project.persist_docs
[0m17:01:27.205199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2a1b726-467b-4410-a4a7-81c12f666d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1731e2b70>]}
[0m17:01:27.344208 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:01:27.345563 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:01:27.357435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2a1b726-467b-4410-a4a7-81c12f666d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17287b8f0>]}
[0m17:01:27.357710 [info ] [MainThread]: Found 10 models, 18 data tests, 1 source, 773 macros
[0m17:01:27.357892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2a1b726-467b-4410-a4a7-81c12f666d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1742f66c0>]}
[0m17:01:27.358839 [info ] [MainThread]: 
[0m17:01:27.359026 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m17:01:27.359161 [info ] [MainThread]: 
[0m17:01:27.359390 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:01:27.361297 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m17:01:27.361502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:28.393852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m17:01:28.395104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:29.135518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2a1b726-467b-4410-a4a7-81c12f666d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10533ba40>]}
[0m17:01:29.136760 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:01:29.195338 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m17:01:29.195712 [info ] [Thread-1 (]: 1 of 10 START sql table model single_view_policy_assignment.raw_policy_events .. [RUN]
[0m17:01:29.195979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m17:01:29.196334 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m17:01:29.200543 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m17:01:29.201184 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m17:01:29.208777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:29.947671 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m17:01:29.948579 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    );
  
[0m17:01:30.325891 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:035a8c2d-a5e0-4528-8d0d-101838bfb20d&page=queryresults
[0m17:01:32.634580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2a1b726-467b-4410-a4a7-81c12f666d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16bed3a40>]}
[0m17:01:32.635389 [info ] [Thread-1 (]: 1 of 10 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 3.44s]
[0m17:01:32.635969 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m17:01:32.636567 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m17:01:32.637060 [info ] [Thread-1 (]: 2 of 10 START sql table model single_view_policy_assignment.stg_policy_events .. [RUN]
[0m17:01:32.637508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m17:01:32.637800 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m17:01:32.640290 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m17:01:32.640904 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m17:01:32.642670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:33.370904 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m17:01:33.373048 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m17:01:33.838606 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:c4881f5f-b8bf-46c0-bad6-000053c90886&page=queryresults
[0m17:01:35.810843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2a1b726-467b-4410-a4a7-81c12f666d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1742c9b50>]}
[0m17:01:35.812554 [info ] [Thread-1 (]: 2 of 10 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.17s]
[0m17:01:35.813609 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m17:01:35.814831 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m17:01:35.815750 [info ] [Thread-1 (]: 3 of 10 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m17:01:35.816448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m17:01:35.817021 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m17:01:35.823757 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m17:01:35.824716 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m17:01:35.864138 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m17:01:35.864767 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

-- Event order mapping
WITH policy_event_order as (
    select 'quote' as event_type, 1 as event_order union all
    select 'bind' as event_type, 2 as event_order union all
    select 'cancel' as event_type, 3 as event_order
),

-- Attach event order and event position within each policy
curated_data as (
    select
        spe.*
        ,peo.event_order
        ,row_number() over (partition by spe.policy_id order by spe.event_timestamp nulls last) as policy_order
    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events` spe
    join policy_event_order peo
        on spe.event_type = peo.event_type
),

-- Exclude non-logical event sequences
filtered_curated AS (
  select *
  from curated_data
  where not (
    (policy_order = 1 and event_order != 1) -- First event is not 'quote'
      or (policy_order = 2 and event_order = 3) -- Second event is 'cancel'
  )
),

---Assumptions are the order of events is only quote -> bind -> cancel. 
---A quote can't be cancelled
---A requote comes with a new policy_id

-- Find first per event_type
firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM filtered_curated
  GROUP BY policy_id
),


last_evt AS (
  SELECT
    t.policy_id,
    t.event_type AS last_event_type,
    t.event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      *,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM filtered_curated
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    l.event_ts,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, HOUR)
      ELSE NULL
    END AS quote_to_bind_hr,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, HOUR)
      ELSE NULL
    END AS bind_to_cancel_hr,
    l.event_month,
    l.source_channel,
    l.state,
    l.product_type,
    l.premium_amount
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
)


SELECT * FROM final
    );
  
[0m17:01:35.865115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:36.803354 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:3272a862-1dde-4771-b4b4-83f13ac6d8ab&page=queryresults
[0m17:01:39.301219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2a1b726-467b-4410-a4a7-81c12f666d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172f594f0>]}
[0m17:01:39.303326 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE TABLE (351.0 rows, 44.4 KiB processed)[0m in 3.48s]
[0m17:01:39.304205 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m17:01:39.305194 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m17:01:39.305785 [info ] [Thread-1 (]: 4 of 10 START sql view model single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [RUN]
[0m17:01:39.306292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_lifecycle_enriched, now model.my_project.avg_quote_to_bind_by_month_analysis)
[0m17:01:39.306690 [debug] [Thread-1 (]: Began compiling node model.my_project.avg_quote_to_bind_by_month_analysis
[0m17:01:39.312645 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.avg_quote_to_bind_by_month_analysis"
[0m17:01:39.313511 [debug] [Thread-1 (]: Began executing node model.my_project.avg_quote_to_bind_by_month_analysis
[0m17:01:39.328917 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.avg_quote_to_bind_by_month_analysis"
[0m17:01:39.329575 [debug] [Thread-1 (]: On model.my_project.avg_quote_to_bind_by_month_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.avg_quote_to_bind_by_month_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`avg_quote_to_bind_by_month_analysis`
  OPTIONS()
  as 


SELECT event_month, 
AVG(quote_to_bind_hr) AS avg_quote_to_bind_hr
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_hr IS NOT NULL
GROUP BY event_month
ORDER BY event_month;


[0m17:01:39.329888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:40.319949 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:4b3368f0-d907-4933-bb7f-79f375514d88&page=queryresults
[0m17:01:40.927860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2a1b726-467b-4410-a4a7-81c12f666d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17313f530>]}
[0m17:01:40.929383 [info ] [Thread-1 (]: 4 of 10 OK created sql view model single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m17:01:40.930626 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m17:01:40.931314 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m17:01:40.932146 [info ] [Thread-1 (]: 5 of 10 START sql view model single_view_policy_assignment.cancelled_within_30_days_analysis  [RUN]
[0m17:01:40.932859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.avg_quote_to_bind_by_month_analysis, now model.my_project.cancelled_within_30_days_analysis)
[0m17:01:40.933384 [debug] [Thread-1 (]: Began compiling node model.my_project.cancelled_within_30_days_analysis
[0m17:01:40.937851 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.cancelled_within_30_days_analysis"
[0m17:01:40.938761 [debug] [Thread-1 (]: Began executing node model.my_project.cancelled_within_30_days_analysis
[0m17:01:40.941789 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.cancelled_within_30_days_analysis"
[0m17:01:40.942622 [debug] [Thread-1 (]: On model.my_project.cancelled_within_30_days_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.cancelled_within_30_days_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`cancelled_within_30_days_analysis`
  OPTIONS()
  as 

SELECT COUNT(*) AS num_cancelled_within_30_days
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_hr IS NOT NULL
  AND bind_to_cancel_hr IS NOT NULL
  AND bind_to_cancel_hr <= 30*24;


[0m17:01:40.943100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:42.052598 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:dd20e2f4-edeb-4b22-a8c5-a15859945b7d&page=queryresults
[0m17:01:42.618326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2a1b726-467b-4410-a4a7-81c12f666d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1755057f0>]}
[0m17:01:42.619910 [info ] [Thread-1 (]: 5 of 10 OK created sql view model single_view_policy_assignment.cancelled_within_30_days_analysis  [[32mCREATE VIEW (0 processed)[0m in 1.69s]
[0m17:01:42.620957 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m17:01:42.621664 [debug] [Thread-1 (]: Began running node model.my_project.dim_event_type
[0m17:01:42.622466 [info ] [Thread-1 (]: 6 of 10 START sql table model single_view_policy_assignment.dim_event_type ..... [RUN]
[0m17:01:42.623130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.cancelled_within_30_days_analysis, now model.my_project.dim_event_type)
[0m17:01:42.623662 [debug] [Thread-1 (]: Began compiling node model.my_project.dim_event_type
[0m17:01:42.629337 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.dim_event_type"
[0m17:01:42.630504 [debug] [Thread-1 (]: Began executing node model.my_project.dim_event_type
[0m17:01:42.633824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:43.361718 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.dim_event_type"
[0m17:01:43.363651 [debug] [Thread-1 (]: On model.my_project.dim_event_type: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.dim_event_type"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`dim_event_type`
      
    
    

    
    OPTIONS()
    as (
      

SELECT DISTINCT
    last_event_type
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    );
  
[0m17:01:43.686684 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:8ffe69f6-fce6-441f-988d-3f99449c5483&page=queryresults
[0m17:01:45.967995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2a1b726-467b-4410-a4a7-81c12f666d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17546f740>]}
[0m17:01:45.969318 [info ] [Thread-1 (]: 6 of 10 OK created sql table model single_view_policy_assignment.dim_event_type  [[32mCREATE TABLE (3.0 rows, 2.3 KiB processed)[0m in 3.34s]
[0m17:01:45.970479 [debug] [Thread-1 (]: Finished running node model.my_project.dim_event_type
[0m17:01:45.971205 [debug] [Thread-1 (]: Began running node model.my_project.dim_product_type
[0m17:01:45.971886 [info ] [Thread-1 (]: 7 of 10 START sql table model single_view_policy_assignment.dim_product_type ... [RUN]
[0m17:01:45.972502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.dim_event_type, now model.my_project.dim_product_type)
[0m17:01:45.972983 [debug] [Thread-1 (]: Began compiling node model.my_project.dim_product_type
[0m17:01:45.980387 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.dim_product_type"
[0m17:01:45.981322 [debug] [Thread-1 (]: Began executing node model.my_project.dim_product_type
[0m17:01:45.983674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:46.708646 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.dim_product_type"
[0m17:01:46.711084 [debug] [Thread-1 (]: On model.my_project.dim_product_type: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.dim_product_type"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`dim_product_type`
      
    
    

    
    OPTIONS()
    as (
      

SELECT DISTINCT
    product_type
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE product_type IS NOT NULL
    );
  
[0m17:01:47.026795 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:77974452-b53b-4dc1-8e0a-f202fcd1d093&page=queryresults
[0m17:01:49.023218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2a1b726-467b-4410-a4a7-81c12f666d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x175504f80>]}
[0m17:01:49.024640 [info ] [Thread-1 (]: 7 of 10 OK created sql table model single_view_policy_assignment.dim_product_type  [[32mCREATE TABLE (4.0 rows, 2.6 KiB processed)[0m in 3.05s]
[0m17:01:49.025487 [debug] [Thread-1 (]: Finished running node model.my_project.dim_product_type
[0m17:01:49.025989 [debug] [Thread-1 (]: Began running node model.my_project.dim_source_channel
[0m17:01:49.026563 [info ] [Thread-1 (]: 8 of 10 START sql table model single_view_policy_assignment.dim_source_channel . [RUN]
[0m17:01:49.027032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.dim_product_type, now model.my_project.dim_source_channel)
[0m17:01:49.027421 [debug] [Thread-1 (]: Began compiling node model.my_project.dim_source_channel
[0m17:01:49.031575 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.dim_source_channel"
[0m17:01:49.032556 [debug] [Thread-1 (]: Began executing node model.my_project.dim_source_channel
[0m17:01:49.035543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:49.734311 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.dim_source_channel"
[0m17:01:49.736812 [debug] [Thread-1 (]: On model.my_project.dim_source_channel: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.dim_source_channel"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`dim_source_channel`
      
    
    

    
    OPTIONS()
    as (
      

SELECT DISTINCT
    source_channel
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    );
  
[0m17:01:50.080732 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:ed1370eb-55d3-4863-9ee6-1fb4f49bbd26&page=queryresults
[0m17:01:52.171593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2a1b726-467b-4410-a4a7-81c12f666d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17313ef30>]}
[0m17:01:52.172590 [info ] [Thread-1 (]: 8 of 10 OK created sql table model single_view_policy_assignment.dim_source_channel  [[32mCREATE TABLE (4.0 rows, 3.1 KiB processed)[0m in 3.14s]
[0m17:01:52.173397 [debug] [Thread-1 (]: Finished running node model.my_project.dim_source_channel
[0m17:01:52.173912 [debug] [Thread-1 (]: Began running node model.my_project.dim_state
[0m17:01:52.174489 [info ] [Thread-1 (]: 9 of 10 START sql table model single_view_policy_assignment.dim_state .......... [RUN]
[0m17:01:52.175057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.dim_source_channel, now model.my_project.dim_state)
[0m17:01:52.175404 [debug] [Thread-1 (]: Began compiling node model.my_project.dim_state
[0m17:01:52.177254 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.dim_state"
[0m17:01:52.177758 [debug] [Thread-1 (]: Began executing node model.my_project.dim_state
[0m17:01:52.180938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:52.930704 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.dim_state"
[0m17:01:52.933560 [debug] [Thread-1 (]: On model.my_project.dim_state: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.dim_state"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`dim_state`
      
    
    

    
    OPTIONS()
    as (
      

SELECT DISTINCT
    state
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE state IS NOT NULL
    );
  
[0m17:01:53.259812 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:d07200a1-8c43-4a54-aada-08654151a123&page=queryresults
[0m17:01:55.248458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2a1b726-467b-4410-a4a7-81c12f666d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17552c650>]}
[0m17:01:55.250121 [info ] [Thread-1 (]: 9 of 10 OK created sql table model single_view_policy_assignment.dim_state ..... [[32mCREATE TABLE (6.0 rows, 1.6 KiB processed)[0m in 3.07s]
[0m17:01:55.251189 [debug] [Thread-1 (]: Finished running node model.my_project.dim_state
[0m17:01:55.251916 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m17:01:55.252768 [info ] [Thread-1 (]: 10 of 10 START sql view model single_view_policy_assignment.quoted_never_bound_analysis  [RUN]
[0m17:01:55.253507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.dim_state, now model.my_project.quoted_never_bound_analysis)
[0m17:01:55.254087 [debug] [Thread-1 (]: Began compiling node model.my_project.quoted_never_bound_analysis
[0m17:01:55.260004 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.quoted_never_bound_analysis"
[0m17:01:55.261240 [debug] [Thread-1 (]: Began executing node model.my_project.quoted_never_bound_analysis
[0m17:01:55.268368 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.quoted_never_bound_analysis"
[0m17:01:55.269412 [debug] [Thread-1 (]: On model.my_project.quoted_never_bound_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.quoted_never_bound_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`quoted_never_bound_analysis`
  OPTIONS()
  as 

SELECT COUNT(*) AS num_quoted_never_bound
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE first_quote_ts IS NOT NULL 
    AND first_bind_ts IS NULL;


[0m17:01:55.269948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:56.170014 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a4c2f99b-1e40-4381-9a94-e8f557135787&page=queryresults
[0m17:01:56.688247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2a1b726-467b-4410-a4a7-81c12f666d4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1755ad790>]}
[0m17:01:56.689576 [info ] [Thread-1 (]: 10 of 10 OK created sql view model single_view_policy_assignment.quoted_never_bound_analysis  [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m17:01:56.690666 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m17:01:56.692120 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:01:56.746725 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:56.746953 [debug] [MainThread]: Connection 'model.my_project.quoted_never_bound_analysis' was properly closed.
[0m17:01:56.747181 [info ] [MainThread]: 
[0m17:01:56.747375 [info ] [MainThread]: Finished running 1 incremental model, 6 table models, 3 view models in 0 hours 0 minutes and 29.39 seconds (29.39s).
[0m17:01:56.748329 [debug] [MainThread]: Command end result
[0m17:01:56.768148 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:01:56.769514 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:01:56.772418 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m17:01:56.772585 [info ] [MainThread]: 
[0m17:01:56.772773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:01:56.772919 [info ] [MainThread]: 
[0m17:01:56.773084 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m17:01:56.773327 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 32.065826, "process_in_blocks": "0", "process_kernel_time": 0.852552, "process_mem_max_rss": "407715840", "process_out_blocks": "0", "process_user_time": 5.255691}
[0m17:01:56.773582 [debug] [MainThread]: Command `dbt run` succeeded at 17:01:56.773540 after 32.07 seconds
[0m17:01:56.773758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x172839a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1742c9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725c230>]}
[0m17:01:56.773922 [debug] [MainThread]: Flushing usage events
[0m17:01:58.315070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:31.432264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10755e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c484a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c48200>]}


============================== 17:06:31.434293 | f85b62e4-570e-4e7f-94a8-72eb4833b134 ==============================
[0m17:06:31.434293 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:06:31.434672 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'static_parser': 'True', 'introspect': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'invocation_command': 'dbt test', 'version_check': 'True', 'write_json': 'True', 'fail_fast': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'use_colors': 'True', 'quiet': 'False', 'debug': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'no_print': 'None', 'warn_error': 'None'}
[0m17:06:33.594495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f85b62e4-570e-4e7f-94a8-72eb4833b134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1639b31a0>]}
[0m17:06:33.619656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f85b62e4-570e-4e7f-94a8-72eb4833b134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161c36d20>]}
[0m17:06:33.619963 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:06:33.741322 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:06:33.859301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:06:33.859558 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:06:33.862203 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.persist_docs
- models.my_project.ext
[0m17:06:33.880992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f85b62e4-570e-4e7f-94a8-72eb4833b134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163d19340>]}
[0m17:06:33.925569 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:06:33.927088 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:06:33.944533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f85b62e4-570e-4e7f-94a8-72eb4833b134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1640a0a10>]}
[0m17:06:33.944779 [info ] [MainThread]: Found 10 models, 18 data tests, 1 source, 773 macros
[0m17:06:33.944955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f85b62e4-570e-4e7f-94a8-72eb4833b134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163b653a0>]}
[0m17:06:33.946038 [info ] [MainThread]: 
[0m17:06:33.946254 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m17:06:33.946389 [info ] [MainThread]: 
[0m17:06:33.946635 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:06:33.948525 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9_single_view_policy_assignment'
[0m17:06:33.948725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:34.795280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f85b62e4-570e-4e7f-94a8-72eb4833b134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163980b60>]}
[0m17:06:34.796564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:34.854834 [debug] [Thread-1 (]: Began running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m17:06:34.855154 [info ] [Thread-1 (]: 1 of 18 START test accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled  [RUN]
[0m17:06:34.855416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715)
[0m17:06:34.855627 [debug] [Thread-1 (]: Began compiling node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m17:06:34.866244 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"
[0m17:06:34.866951 [debug] [Thread-1 (]: Began executing node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m17:06:34.879952 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"
[0m17:06:34.880481 [debug] [Thread-1 (]: On test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        current_status as value_field,
        count(*) as n_records

    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    group by current_status

)

select *
from all_values
where value_field not in (
    'quoted','bound','cancelled'
)



  
  
      
    ) dbt_internal_test
[0m17:06:34.880734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:36.178567 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:16cd703a-b784-4bf0-9d82-8b7c999b6b3b&page=queryresults
[0m17:06:36.906397 [info ] [Thread-1 (]: 1 of 18 PASS accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled  [[32mPASS[0m in 2.05s]
[0m17:06:36.907955 [debug] [Thread-1 (]: Finished running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m17:06:36.908639 [debug] [Thread-1 (]: Began running node test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840
[0m17:06:36.909301 [info ] [Thread-1 (]: 2 of 18 START test accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel  [RUN]
[0m17:06:36.909932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715, now test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840)
[0m17:06:36.910753 [debug] [Thread-1 (]: Began compiling node test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840
[0m17:06:36.919014 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840"
[0m17:06:36.920062 [debug] [Thread-1 (]: Began executing node test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840
[0m17:06:36.922677 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840"
[0m17:06:36.924008 [debug] [Thread-1 (]: On test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    group by event_type

)

select *
from all_values
where value_field not in (
    'quote','bind','cancel'
)



  
  
      
    ) dbt_internal_test
[0m17:06:36.924532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:37.960141 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:8b4c8690-486d-4053-8ba2-682207727288&page=queryresults
[0m17:06:37.962299 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:8b4c8690-486d-4053-8ba2-682207727288&page=queryresults
[0m17:06:37.975373 [debug] [Thread-1 (]: Database Error in test accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel (models/final/schema.yml)
  Unrecognized name: event_type; Did you mean event_ts? at [17:9]
  compiled code at target/run/my_project/models/final/schema.yml/accepted_values_policy_lifecyc_2f8e81ac6727de9c6546d0c3d8da9e91.sql
[0m17:06:37.976352 [error] [Thread-1 (]: 2 of 18 ERROR accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel  [[31mERROR[0m in 1.07s]
[0m17:06:37.977147 [debug] [Thread-1 (]: Finished running node test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840
[0m17:06:37.977678 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af
[0m17:06:37.978445 [debug] [Thread-4 (]: Marking all children of 'test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel (models/final/schema.yml)
  Unrecognized name: event_type; Did you mean event_ts? at [17:9]
  compiled code at target/run/my_project/models/final/schema.yml/accepted_values_policy_lifecyc_2f8e81ac6727de9c6546d0c3d8da9e91.sql.
[0m17:06:37.978992 [info ] [Thread-1 (]: 3 of 18 START test dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel  [RUN]
[0m17:06:37.979702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel.636c7c6840, now test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af)
[0m17:06:37.980122 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af
[0m17:06:37.989717 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af"
[0m17:06:37.990578 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af
[0m17:06:37.994445 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af"
[0m17:06:37.995224 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with all_values as (

    select
        event_type as value_field

    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
set_values as (

    select
        cast('quote' as string) as value_field
    union all
    select
        cast('bind' as string) as value_field
    union all
    select
        cast('cancel' as string) as value_field
    
    
),
validation_errors as (
    -- values from the model that are not in the set
    select
        v.value_field
    from
        all_values v
        left join
        set_values s on v.value_field = s.value_field
    where
        s.value_field is null

)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m17:06:37.995616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:39.363411 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:7f166701-ec1c-4695-819f-e3e9c9588489&page=queryresults
[0m17:06:39.836619 [info ] [Thread-1 (]: 3 of 18 PASS dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel  [[32mPASS[0m in 1.86s]
[0m17:06:39.838142 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af
[0m17:06:39.838906 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb
[0m17:06:39.839665 [info ] [Thread-1 (]: 4 of 18 START test dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id  [RUN]
[0m17:06:39.840452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af, now test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb)
[0m17:06:39.841105 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb
[0m17:06:39.862747 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb"
[0m17:06:39.863741 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb
[0m17:06:39.866187 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb"
[0m17:06:39.866881 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




with validation_errors as (

    select
        policy_id,
        count(*) as `n_records`
    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    where
        1=1
        and 
    not (
        policy_id is null
        
    )


    
    group by
        policy_id
    having count(*) > 1

)
select * from validation_errors


  
  
      
    ) dbt_internal_test
[0m17:06:39.867253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:41.255010 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:06f16e89-a85f-41d6-a282-8bf255975b8f&page=queryresults
[0m17:06:41.713399 [error] [Thread-1 (]: 4 of 18 FAIL 278 dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id  [[31mFAIL 278[0m in 1.87s]
[0m17:06:41.714979 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb
[0m17:06:41.715774 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.357564f369
[0m17:06:41.716561 [info ] [Thread-1 (]: 5 of 18 START test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_  [RUN]
[0m17:06:41.717373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb, now test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.357564f369)
[0m17:06:41.718015 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.357564f369
[0m17:06:41.738485 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.357564f369"
[0m17:06:41.739310 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.357564f369
[0m17:06:41.741612 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.357564f369"
[0m17:06:41.742182 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.357564f369: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.357564f369"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  


    
regexp_instr(event_timestamp, '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}', 1, 1)


 > 0
 as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
      
    ) dbt_internal_test
[0m17:06:41.742518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:42.691210 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:255ff7d9-5e58-4b61-8692-ec2f3cbd98b6&page=queryresults
[0m17:06:42.692820 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:255ff7d9-5e58-4b61-8692-ec2f3cbd98b6&page=queryresults
[0m17:06:42.698438 [debug] [Thread-1 (]: Database Error in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_ (models/build/source.yml)
  Syntax error: Illegal escape sequence: \d at [24:33]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_6f3d197a461c9e251aedf876b21888fd.sql
[0m17:06:42.699334 [error] [Thread-1 (]: 5 of 18 ERROR dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_  [[31mERROR[0m in 0.98s]
[0m17:06:42.700392 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.357564f369
[0m17:06:42.701156 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_.b28642d4dc
[0m17:06:42.701949 [debug] [Thread-4 (]: Marking all children of 'test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.357564f369' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_ (models/build/source.yml)
  Syntax error: Illegal escape sequence: \d at [24:33]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_6f3d197a461c9e251aedf876b21888fd.sql.
[0m17:06:42.702543 [info ] [Thread-1 (]: 6 of 18 START test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_  [RUN]
[0m17:06:42.703511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.357564f369, now test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_.b28642d4dc)
[0m17:06:42.704349 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_.b28642d4dc
[0m17:06:42.710685 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_.b28642d4dc"
[0m17:06:42.711591 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_.b28642d4dc
[0m17:06:42.716075 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_.b28642d4dc"
[0m17:06:42.716872 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_.b28642d4dc: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_.b28642d4dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  


    
regexp_instr(premium_amount, '^\d+(\.\d+)?$', 1, 1)


 > 0
 as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
      
    ) dbt_internal_test
[0m17:06:42.717311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:43.643026 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:3d3969f4-32a0-4800-8431-aac7eadf4915&page=queryresults
[0m17:06:43.644989 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:3d3969f4-32a0-4800-8431-aac7eadf4915&page=queryresults
[0m17:06:43.649934 [debug] [Thread-1 (]: Database Error in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_ (models/build/source.yml)
  Syntax error: Illegal escape sequence: \d at [24:32]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_9bc447058378ec776d3673bb3ed1c3d7.sql
[0m17:06:43.650725 [error] [Thread-1 (]: 6 of 18 ERROR dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_  [[31mERROR[0m in 0.95s]
[0m17:06:43.651587 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_.b28642d4dc
[0m17:06:43.652106 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277
[0m17:06:43.652739 [debug] [Thread-4 (]: Marking all children of 'test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_.b28642d4dc' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_ (models/build/source.yml)
  Syntax error: Illegal escape sequence: \d at [24:32]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_9bc447058378ec776d3673bb3ed1c3d7.sql.
[0m17:06:43.653184 [info ] [Thread-1 (]: 7 of 18 START test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp  [RUN]
[0m17:06:43.653837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_.b28642d4dc, now test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277)
[0m17:06:43.654285 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277
[0m17:06:43.661217 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277"
[0m17:06:43.661961 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277
[0m17:06:43.664279 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277"
[0m17:06:43.665040 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  event_timestamp is not null as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




  
  
      
    ) dbt_internal_test
[0m17:06:43.665456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:45.052692 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:25a6556b-29d2-4467-8e51-eb24079d22b5&page=queryresults
[0m17:06:45.372024 [info ] [Thread-1 (]: 7 of 18 PASS dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp  [[32mPASS[0m in 1.72s]
[0m17:06:45.373679 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277
[0m17:06:45.374400 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941
[0m17:06:45.375125 [info ] [Thread-1 (]: 8 of 18 START test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type  [RUN]
[0m17:06:45.375838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277, now test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941)
[0m17:06:45.376435 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941
[0m17:06:45.383874 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941"
[0m17:06:45.385541 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941
[0m17:06:45.388500 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941"
[0m17:06:45.389366 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  event_type is not null as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




  
  
      
    ) dbt_internal_test
[0m17:06:45.389860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:46.814301 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:8688aad9-0fed-4d98-940d-6de39678a5c0&page=queryresults
[0m17:06:47.126107 [info ] [Thread-1 (]: 8 of 18 PASS dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type  [[32mPASS[0m in 1.75s]
[0m17:06:47.127367 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941
[0m17:06:47.127951 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682
[0m17:06:47.128540 [info ] [Thread-1 (]: 9 of 18 START test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id  [RUN]
[0m17:06:47.129215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941, now test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682)
[0m17:06:47.129847 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682
[0m17:06:47.135946 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682"
[0m17:06:47.136768 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682
[0m17:06:47.139345 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682"
[0m17:06:47.140193 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  policy_id is not null as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




  
  
      
    ) dbt_internal_test
[0m17:06:47.140686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:48.453536 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:61264b8e-d1c1-466c-90be-5eaea33c95d2&page=queryresults
[0m17:06:48.982994 [error] [Thread-1 (]: 9 of 18 FAIL 1 dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id  [[31mFAIL 1[0m in 1.85s]
[0m17:06:48.984656 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682
[0m17:06:48.985440 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_premium_amount.55190d23fd
[0m17:06:48.986227 [info ] [Thread-1 (]: 10 of 18 START test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_premium_amount  [RUN]
[0m17:06:48.987016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682, now test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_premium_amount.55190d23fd)
[0m17:06:48.987695 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_premium_amount.55190d23fd
[0m17:06:48.998619 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_premium_amount.55190d23fd"
[0m17:06:49.000556 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_premium_amount.55190d23fd
[0m17:06:49.003293 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_premium_amount.55190d23fd"
[0m17:06:49.004081 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_premium_amount.55190d23fd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_premium_amount.55190d23fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  premium_amount is not null as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




  
  
      
    ) dbt_internal_test
[0m17:06:49.004560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:50.291541 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a92249f6-fb69-4c6a-a95e-814cbcaa0b7a&page=queryresults
[0m17:06:50.604478 [error] [Thread-1 (]: 10 of 18 FAIL 439 dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_premium_amount  [[31mFAIL 439[0m in 1.62s]
[0m17:06:50.606185 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_premium_amount.55190d23fd
[0m17:06:50.606958 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m17:06:50.607731 [info ] [Thread-1 (]: 11 of 18 START test not_null_policy_lifecycle_enriched_current_status .......... [RUN]
[0m17:06:50.608501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_premium_amount.55190d23fd, now test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a)
[0m17:06:50.609163 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m17:06:50.620396 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"
[0m17:06:50.621707 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m17:06:50.624903 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"
[0m17:06:50.625863 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select current_status
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where current_status is null



  
  
      
    ) dbt_internal_test
[0m17:06:50.626363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:51.927995 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:8a214ee8-6025-4658-974a-fcaf41f6a6d2&page=queryresults
[0m17:06:52.263508 [info ] [Thread-1 (]: 11 of 18 PASS not_null_policy_lifecycle_enriched_current_status ................ [[32mPASS[0m in 1.65s]
[0m17:06:52.265050 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m17:06:52.265774 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m17:06:52.266481 [info ] [Thread-1 (]: 12 of 18 START test not_null_policy_lifecycle_enriched_event_month ............. [RUN]
[0m17:06:52.267219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a, now test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87)
[0m17:06:52.267811 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m17:06:52.275111 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"
[0m17:06:52.276497 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m17:06:52.279475 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"
[0m17:06:52.280585 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_month
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where event_month is null



  
  
      
    ) dbt_internal_test
[0m17:06:52.281172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:53.628137 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:7451cb78-ecc5-4f0a-98df-bb3277754ee6&page=queryresults
[0m17:06:54.121924 [info ] [Thread-1 (]: 12 of 18 PASS not_null_policy_lifecycle_enriched_event_month ................... [[32mPASS[0m in 1.85s]
[0m17:06:54.123269 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m17:06:54.123873 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8
[0m17:06:54.124445 [info ] [Thread-1 (]: 13 of 18 START test not_null_policy_lifecycle_enriched_event_timestamp ......... [RUN]
[0m17:06:54.125229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87, now test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8)
[0m17:06:54.125853 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8
[0m17:06:54.131698 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8"
[0m17:06:54.132718 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8
[0m17:06:54.137854 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8"
[0m17:06:54.138889 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_timestamp
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where event_timestamp is null



  
  
      
    ) dbt_internal_test
[0m17:06:54.139286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:55.098222 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a5c7eca7-c97c-41d3-a9e6-e7065a460a44&page=queryresults
[0m17:06:55.100550 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a5c7eca7-c97c-41d3-a9e6-e7065a460a44&page=queryresults
[0m17:06:55.107437 [debug] [Thread-1 (]: Database Error in test not_null_policy_lifecycle_enriched_event_timestamp (models/final/schema.yml)
  Unrecognized name: event_timestamp at [18:7]
  compiled code at target/run/my_project/models/final/schema.yml/not_null_policy_lifecycle_enriched_event_timestamp.sql
[0m17:06:55.108344 [error] [Thread-1 (]: 13 of 18 ERROR not_null_policy_lifecycle_enriched_event_timestamp .............. [[31mERROR[0m in 0.98s]
[0m17:06:55.109300 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8
[0m17:06:55.109874 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c
[0m17:06:55.110463 [debug] [Thread-4 (]: Marking all children of 'test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8' to be skipped because of status 'error'.  Reason: Database Error in test not_null_policy_lifecycle_enriched_event_timestamp (models/final/schema.yml)
  Unrecognized name: event_timestamp at [18:7]
  compiled code at target/run/my_project/models/final/schema.yml/not_null_policy_lifecycle_enriched_event_timestamp.sql.
[0m17:06:55.110944 [info ] [Thread-1 (]: 14 of 18 START test not_null_policy_lifecycle_enriched_event_type .............. [RUN]
[0m17:06:55.111853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_event_timestamp.e2131ac6b8, now test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c)
[0m17:06:55.112796 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c
[0m17:06:55.119149 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c"
[0m17:06:55.120120 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c
[0m17:06:55.122873 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c"
[0m17:06:55.123624 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_type
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where event_type is null



  
  
      
    ) dbt_internal_test
[0m17:06:55.124077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:56.105569 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:d73aab52-3d40-42e5-b4a9-2c67d7084a4c&page=queryresults
[0m17:06:56.107538 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:d73aab52-3d40-42e5-b4a9-2c67d7084a4c&page=queryresults
[0m17:06:56.115414 [debug] [Thread-1 (]: Database Error in test not_null_policy_lifecycle_enriched_event_type (models/final/schema.yml)
  Unrecognized name: event_type; Did you mean event_ts? at [18:7]
  compiled code at target/run/my_project/models/final/schema.yml/not_null_policy_lifecycle_enriched_event_type.sql
[0m17:06:56.116513 [error] [Thread-1 (]: 14 of 18 ERROR not_null_policy_lifecycle_enriched_event_type ................... [[31mERROR[0m in 1.00s]
[0m17:06:56.117437 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c
[0m17:06:56.118047 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m17:06:56.118689 [debug] [Thread-4 (]: Marking all children of 'test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c' to be skipped because of status 'error'.  Reason: Database Error in test not_null_policy_lifecycle_enriched_event_type (models/final/schema.yml)
  Unrecognized name: event_type; Did you mean event_ts? at [18:7]
  compiled code at target/run/my_project/models/final/schema.yml/not_null_policy_lifecycle_enriched_event_type.sql.
[0m17:06:56.119275 [info ] [Thread-1 (]: 15 of 18 START test not_null_policy_lifecycle_enriched_first_bind_ts ........... [RUN]
[0m17:06:56.120081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_event_type.d0e599500c, now test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8)
[0m17:06:56.120810 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m17:06:56.127277 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8"
[0m17:06:56.128277 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m17:06:56.130713 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8"
[0m17:06:56.131537 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_bind_ts
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where first_bind_ts is null



  
  
      
    ) dbt_internal_test
[0m17:06:56.132294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:57.364245 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:85747f52-7a10-4ac7-b63b-ec50bebd3bb7&page=queryresults
[0m17:06:57.693839 [error] [Thread-1 (]: 15 of 18 FAIL 74 not_null_policy_lifecycle_enriched_first_bind_ts .............. [[31mFAIL 74[0m in 1.57s]
[0m17:06:57.695631 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8
[0m17:06:57.696512 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m17:06:57.697263 [info ] [Thread-1 (]: 16 of 18 START test not_null_policy_lifecycle_enriched_first_quote_ts .......... [RUN]
[0m17:06:57.698012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_first_bind_ts.651a22dce8, now test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0)
[0m17:06:57.698623 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m17:06:57.706135 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"
[0m17:06:57.707042 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m17:06:57.710597 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"
[0m17:06:57.711598 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_quote_ts
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where first_quote_ts is null



  
  
      
    ) dbt_internal_test
[0m17:06:57.712120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:59.168391 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:09bf951b-a852-4c37-b609-8b649878b3d1&page=queryresults
[0m17:06:59.572794 [info ] [Thread-1 (]: 16 of 18 PASS not_null_policy_lifecycle_enriched_first_quote_ts ................ [[32mPASS[0m in 1.87s]
[0m17:06:59.574469 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m17:06:59.575247 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m17:06:59.576015 [info ] [Thread-1 (]: 17 of 18 START test not_null_policy_lifecycle_enriched_policy_id ............... [RUN]
[0m17:06:59.576815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0, now test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b)
[0m17:06:59.577451 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m17:06:59.585554 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"
[0m17:06:59.586803 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m17:06:59.592649 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"
[0m17:06:59.593806 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select policy_id
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where policy_id is null



  
  
      
    ) dbt_internal_test
[0m17:06:59.594364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:00.841966 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:d4d557be-2472-4168-8603-3ea614ff44e4&page=queryresults
[0m17:07:01.127814 [info ] [Thread-1 (]: 17 of 18 PASS not_null_policy_lifecycle_enriched_policy_id ..................... [[32mPASS[0m in 1.55s]
[0m17:07:01.129298 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m17:07:01.130080 [debug] [Thread-1 (]: Began running node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m17:07:01.130853 [info ] [Thread-1 (]: 18 of 18 START test unique_policy_lifecycle_enriched_policy_id ................. [RUN]
[0m17:07:01.131633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b, now test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745)
[0m17:07:01.132207 [debug] [Thread-1 (]: Began compiling node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m17:07:01.143477 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745"
[0m17:07:01.144472 [debug] [Thread-1 (]: Began executing node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m17:07:01.147642 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745"
[0m17:07:01.148373 [debug] [Thread-1 (]: On test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select policy_id as unique_field
  from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
  where policy_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:07:01.148841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:02.483457 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a5e2ec6b-43e1-427e-8e61-5850241570cb&page=queryresults
[0m17:07:02.792908 [info ] [Thread-1 (]: 18 of 18 PASS unique_policy_lifecycle_enriched_policy_id ....................... [[32mPASS[0m in 1.66s]
[0m17:07:02.794277 [debug] [Thread-1 (]: Finished running node test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745
[0m17:07:02.796366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:07:02.854042 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:02.854298 [debug] [MainThread]: Connection 'test.my_project.unique_policy_lifecycle_enriched_policy_id.a79a98d745' was properly closed.
[0m17:07:02.854503 [info ] [MainThread]: 
[0m17:07:02.854707 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 28.91 seconds (28.91s).
[0m17:07:02.856177 [debug] [MainThread]: Command end result
[0m17:07:02.968058 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:07:02.969131 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:07:02.972991 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m17:07:02.973185 [info ] [MainThread]: 
[0m17:07:02.973380 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successes, and 0 warnings:[0m
[0m17:07:02.973537 [info ] [MainThread]: 
[0m17:07:02.973730 [error] [MainThread]: [31mFailure in test accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel (models/final/schema.yml)[0m
[0m17:07:02.973911 [error] [MainThread]:   Database Error in test accepted_values_policy_lifecycle_enriched_event_type__quote__bind__cancel (models/final/schema.yml)
  Unrecognized name: event_type; Did you mean event_ts? at [17:9]
  compiled code at target/run/my_project/models/final/schema.yml/accepted_values_policy_lifecyc_2f8e81ac6727de9c6546d0c3d8da9e91.sql
[0m17:07:02.974041 [info ] [MainThread]: 
[0m17:07:02.974193 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/final/schema.yml/accepted_values_policy_lifecyc_2f8e81ac6727de9c6546d0c3d8da9e91.sql
[0m17:07:02.974329 [info ] [MainThread]: 
[0m17:07:02.974489 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id (models/build/source.yml)[0m
[0m17:07:02.974651 [error] [MainThread]:   Got 278 results, configured to fail if != 0
[0m17:07:02.974767 [info ] [MainThread]: 
[0m17:07:02.974914 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/build/source.yml/dbt_expectations_source_expect_b57649855eb6ca423447fe635531c9c2.sql
[0m17:07:02.975038 [info ] [MainThread]: 
[0m17:07:02.975193 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_ (models/build/source.yml)[0m
[0m17:07:02.975361 [error] [MainThread]:   Database Error in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timestamp___d_4_d_2_d_2_T_d_2_d_2_d_2_ (models/build/source.yml)
  Syntax error: Illegal escape sequence: \d at [24:33]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_6f3d197a461c9e251aedf876b21888fd.sql
[0m17:07:02.975489 [info ] [MainThread]: 
[0m17:07:02.975644 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/build/source.yml/dbt_expectations_source_expect_6f3d197a461c9e251aedf876b21888fd.sql
[0m17:07:02.975764 [info ] [MainThread]: 
[0m17:07:02.975917 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_ (models/build/source.yml)[0m
[0m17:07:02.976082 [error] [MainThread]:   Database Error in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___d_d_ (models/build/source.yml)
  Syntax error: Illegal escape sequence: \d at [24:32]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_9bc447058378ec776d3673bb3ed1c3d7.sql
[0m17:07:02.976206 [info ] [MainThread]: 
[0m17:07:02.976347 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/build/source.yml/dbt_expectations_source_expect_9bc447058378ec776d3673bb3ed1c3d7.sql
[0m17:07:02.976470 [info ] [MainThread]: 
[0m17:07:02.976624 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id (models/build/source.yml)[0m
[0m17:07:02.976776 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:07:02.976891 [info ] [MainThread]: 
[0m17:07:02.977039 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/build/source.yml/dbt_expectations_source_expect_220988c18ae28ad56365e52f07aad26c.sql
[0m17:07:02.977159 [info ] [MainThread]: 
[0m17:07:02.977308 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_premium_amount (models/build/source.yml)[0m
[0m17:07:02.977461 [error] [MainThread]:   Got 439 results, configured to fail if != 0
[0m17:07:02.977573 [info ] [MainThread]: 
[0m17:07:02.977715 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/build/source.yml/dbt_expectations_source_expect_277d30f9ea8916fa98ad60c22342c63f.sql
[0m17:07:02.977836 [info ] [MainThread]: 
[0m17:07:02.977979 [error] [MainThread]: [31mFailure in test not_null_policy_lifecycle_enriched_event_timestamp (models/final/schema.yml)[0m
[0m17:07:02.978133 [error] [MainThread]:   Database Error in test not_null_policy_lifecycle_enriched_event_timestamp (models/final/schema.yml)
  Unrecognized name: event_timestamp at [18:7]
  compiled code at target/run/my_project/models/final/schema.yml/not_null_policy_lifecycle_enriched_event_timestamp.sql
[0m17:07:02.978251 [info ] [MainThread]: 
[0m17:07:02.978422 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/final/schema.yml/not_null_policy_lifecycle_enriched_event_timestamp.sql
[0m17:07:02.978548 [info ] [MainThread]: 
[0m17:07:02.978692 [error] [MainThread]: [31mFailure in test not_null_policy_lifecycle_enriched_event_type (models/final/schema.yml)[0m
[0m17:07:02.978849 [error] [MainThread]:   Database Error in test not_null_policy_lifecycle_enriched_event_type (models/final/schema.yml)
  Unrecognized name: event_type; Did you mean event_ts? at [18:7]
  compiled code at target/run/my_project/models/final/schema.yml/not_null_policy_lifecycle_enriched_event_type.sql
[0m17:07:02.978968 [info ] [MainThread]: 
[0m17:07:02.979173 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/final/schema.yml/not_null_policy_lifecycle_enriched_event_type.sql
[0m17:07:02.979358 [info ] [MainThread]: 
[0m17:07:02.979537 [error] [MainThread]: [31mFailure in test not_null_policy_lifecycle_enriched_first_bind_ts (models/final/schema.yml)[0m
[0m17:07:02.979711 [error] [MainThread]:   Got 74 results, configured to fail if != 0
[0m17:07:02.979839 [info ] [MainThread]: 
[0m17:07:02.979989 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/final/schema.yml/not_null_policy_lifecycle_enriched_first_bind_ts.sql
[0m17:07:02.980127 [info ] [MainThread]: 
[0m17:07:02.980285 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=9 SKIP=0 NO-OP=0 TOTAL=18
[0m17:07:02.980535 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 31.581556, "process_in_blocks": "0", "process_kernel_time": 0.98418, "process_mem_max_rss": "401457152", "process_out_blocks": "0", "process_user_time": 5.624025}
[0m17:07:02.980789 [debug] [MainThread]: Command `dbt test` failed at 17:07:02.980748 after 31.58 seconds
[0m17:07:02.980972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163667f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10368b7d0>]}
[0m17:07:02.981137 [debug] [MainThread]: Flushing usage events
[0m17:07:04.123425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:20:21.171936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd6f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a7da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a7f20>]}


============================== 17:20:21.173957 | 52d37b71-0372-4f47-87fa-7a44fd3426ad ==============================
[0m17:20:21.173957 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:20:21.174360 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'invocation_command': 'dbt test', 'debug': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'version_check': 'True', 'target_path': 'None', 'log_format': 'default', 'quiet': 'False', 'warn_error': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'empty': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'printer_width': '80'}
[0m17:20:23.351293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52d37b71-0372-4f47-87fa-7a44fd3426ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b2d0cb0>]}
[0m17:20:23.376719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52d37b71-0372-4f47-87fa-7a44fd3426ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109881130>]}
[0m17:20:23.377047 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:20:23.497359 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:20:23.614848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:20:23.615499 [debug] [MainThread]: Partial parsing: updated file: my_project://models/build/source.yml
[0m17:20:23.615732 [debug] [MainThread]: Partial parsing: updated file: my_project://models/final/schema.yml
[0m17:20:23.989483 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.persist_docs
- models.my_project.ext
[0m17:20:23.994062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52d37b71-0372-4f47-87fa-7a44fd3426ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157c0d3d0>]}
[0m17:20:24.037183 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:20:24.041233 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:20:24.058540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52d37b71-0372-4f47-87fa-7a44fd3426ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dc14920>]}
[0m17:20:24.058799 [info ] [MainThread]: Found 10 models, 15 data tests, 1 source, 773 macros
[0m17:20:24.058972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52d37b71-0372-4f47-87fa-7a44fd3426ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15decf590>]}
[0m17:20:24.059970 [info ] [MainThread]: 
[0m17:20:24.060164 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m17:20:24.060303 [info ] [MainThread]: 
[0m17:20:24.060531 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:20:24.062417 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9_single_view_policy_assignment'
[0m17:20:24.062611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:24.996374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52d37b71-0372-4f47-87fa-7a44fd3426ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15dc166f0>]}
[0m17:20:24.997221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:20:25.055101 [debug] [Thread-1 (]: Began running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m17:20:25.055436 [info ] [Thread-1 (]: 1 of 15 START test accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled  [RUN]
[0m17:20:25.055711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715)
[0m17:20:25.055921 [debug] [Thread-1 (]: Began compiling node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m17:20:25.060724 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"
[0m17:20:25.061765 [debug] [Thread-1 (]: Began executing node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m17:20:25.074207 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"
[0m17:20:25.074942 [debug] [Thread-1 (]: On test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        current_status as value_field,
        count(*) as n_records

    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    group by current_status

)

select *
from all_values
where value_field not in (
    'quoted','bound','cancelled'
)



  
  
      
    ) dbt_internal_test
[0m17:20:25.075183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:26.141613 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:a2dace52-23d0-43fb-8b47-5c55605f74b7&page=queryresults
[0m17:20:26.873070 [info ] [Thread-1 (]: 1 of 15 PASS accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled  [[32mPASS[0m in 1.82s]
[0m17:20:26.874194 [debug] [Thread-1 (]: Finished running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m17:20:26.874823 [debug] [Thread-1 (]: Began running node test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9
[0m17:20:26.875501 [info ] [Thread-1 (]: 2 of 15 START test accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel  [RUN]
[0m17:20:26.876197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715, now test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9)
[0m17:20:26.876734 [debug] [Thread-1 (]: Began compiling node test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9
[0m17:20:26.882460 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9"
[0m17:20:26.883391 [debug] [Thread-1 (]: Began executing node test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9
[0m17:20:26.886046 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9"
[0m17:20:26.886795 [debug] [Thread-1 (]: On test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        last_event_type as value_field,
        count(*) as n_records

    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    group by last_event_type

)

select *
from all_values
where value_field not in (
    'quote','bind','cancel'
)



  
  
      
    ) dbt_internal_test
[0m17:20:26.887241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:28.334329 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:defff0a4-44ab-4ce4-9652-aa26ec0cf7a7&page=queryresults
[0m17:20:28.973630 [info ] [Thread-1 (]: 2 of 15 PASS accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel  [[32mPASS[0m in 2.10s]
[0m17:20:28.975825 [debug] [Thread-1 (]: Finished running node test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9
[0m17:20:28.976679 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af
[0m17:20:28.977530 [info ] [Thread-1 (]: 3 of 15 START test dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel  [RUN]
[0m17:20:28.978343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9, now test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af)
[0m17:20:28.979017 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af
[0m17:20:28.988070 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af"
[0m17:20:28.989388 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af
[0m17:20:28.993217 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af"
[0m17:20:28.994217 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with all_values as (

    select
        event_type as value_field

    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
set_values as (

    select
        cast('quote' as string) as value_field
    union all
    select
        cast('bind' as string) as value_field
    union all
    select
        cast('cancel' as string) as value_field
    
    
),
validation_errors as (
    -- values from the model that are not in the set
    select
        v.value_field
    from
        all_values v
        left join
        set_values s on v.value_field = s.value_field
    where
        s.value_field is null

)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m17:20:28.994764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:30.070690 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:45297a34-5612-4eac-a2b4-d0bf2fd1eb07&page=queryresults
[0m17:20:30.686086 [info ] [Thread-1 (]: 3 of 15 PASS dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel  [[32mPASS[0m in 1.71s]
[0m17:20:30.687995 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af
[0m17:20:30.688696 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb
[0m17:20:30.689340 [info ] [Thread-1 (]: 4 of 15 START test dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id  [RUN]
[0m17:20:30.689991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af, now test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb)
[0m17:20:30.690519 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb
[0m17:20:30.698012 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb"
[0m17:20:30.700734 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb
[0m17:20:30.703933 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb"
[0m17:20:30.705293 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




with validation_errors as (

    select
        policy_id,
        count(*) as `n_records`
    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    where
        1=1
        and 
    not (
        policy_id is null
        
    )


    
    group by
        policy_id
    having count(*) > 1

)
select * from validation_errors


  
  
      
    ) dbt_internal_test
[0m17:20:30.705812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:31.844143 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:943e65da-21d0-4f0a-8581-77db56343327&page=queryresults
[0m17:20:32.215329 [error] [Thread-1 (]: 4 of 15 FAIL 278 dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id  [[31mFAIL 278[0m in 1.52s]
[0m17:20:32.216412 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb
[0m17:20:32.217031 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_.56270498b1
[0m17:20:32.217675 [info ] [Thread-1 (]: 5 of 15 START test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_  [RUN]
[0m17:20:32.218382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id.b90cd111cb, now test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_.56270498b1)
[0m17:20:32.218928 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_.56270498b1
[0m17:20:32.227047 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_.56270498b1"
[0m17:20:32.227868 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_.56270498b1
[0m17:20:32.229985 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_.56270498b1"
[0m17:20:32.230938 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_.56270498b1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_.56270498b1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  


    
regexp_instr(event_ts, '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}', 1, 1)


 > 0
 as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
      
    ) dbt_internal_test
[0m17:20:32.231377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:33.200243 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:dfce3cee-fa35-48c8-984e-87a29cc7c9c5&page=queryresults
[0m17:20:33.201658 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:dfce3cee-fa35-48c8-984e-87a29cc7c9c5&page=queryresults
[0m17:20:33.213932 [debug] [Thread-1 (]: Database Error in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_ (models/build/source.yml)
  Syntax error: Illegal escape sequence: \d at [24:26]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_6fbe3145dba6e18dc31acc1a52aec310.sql
[0m17:20:33.214767 [error] [Thread-1 (]: 5 of 15 ERROR dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_  [[31mERROR[0m in 1.00s]
[0m17:20:33.215417 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_.56270498b1
[0m17:20:33.215866 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___0_9_4_0_9_2_0_9_2_T_0_9_2_0_9_2_0_9_2_.e88fa370df
[0m17:20:33.216413 [debug] [Thread-4 (]: Marking all children of 'test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_.56270498b1' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_ (models/build/source.yml)
  Syntax error: Illegal escape sequence: \d at [24:26]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_6fbe3145dba6e18dc31acc1a52aec310.sql.
[0m17:20:33.216979 [info ] [Thread-1 (]: 6 of 15 START test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___0_9_4_0_9_2_0_9_2_T_0_9_2_0_9_2_0_9_2_  [RUN]
[0m17:20:33.217645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_.56270498b1, now test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___0_9_4_0_9_2_0_9_2_T_0_9_2_0_9_2_0_9_2_.e88fa370df)
[0m17:20:33.218053 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___0_9_4_0_9_2_0_9_2_T_0_9_2_0_9_2_0_9_2_.e88fa370df
[0m17:20:33.222833 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___0_9_4_0_9_2_0_9_2_T_0_9_2_0_9_2_0_9_2_.e88fa370df"
[0m17:20:33.223559 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___0_9_4_0_9_2_0_9_2_T_0_9_2_0_9_2_0_9_2_.e88fa370df
[0m17:20:33.225788 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___0_9_4_0_9_2_0_9_2_T_0_9_2_0_9_2_0_9_2_.e88fa370df"
[0m17:20:33.226436 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___0_9_4_0_9_2_0_9_2_T_0_9_2_0_9_2_0_9_2_.e88fa370df: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___0_9_4_0_9_2_0_9_2_T_0_9_2_0_9_2_0_9_2_.e88fa370df"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  


    
regexp_instr(premium_amount, '^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}', 1, 1)


 > 0
 as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
      
    ) dbt_internal_test
[0m17:20:33.226848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:34.662840 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:79b4dc51-b1c3-4ea4-882e-f0b362929a36&page=queryresults
[0m17:20:35.020244 [error] [Thread-1 (]: 6 of 15 FAIL 279 dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___0_9_4_0_9_2_0_9_2_T_0_9_2_0_9_2_0_9_2_  [[31mFAIL 279[0m in 1.80s]
[0m17:20:35.021735 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___0_9_4_0_9_2_0_9_2_T_0_9_2_0_9_2_0_9_2_.e88fa370df
[0m17:20:35.022378 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts.43a97236fd
[0m17:20:35.023155 [info ] [Thread-1 (]: 7 of 15 START test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts  [RUN]
[0m17:20:35.024049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___0_9_4_0_9_2_0_9_2_T_0_9_2_0_9_2_0_9_2_.e88fa370df, now test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts.43a97236fd)
[0m17:20:35.024637 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts.43a97236fd
[0m17:20:35.031645 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts.43a97236fd"
[0m17:20:35.032555 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts.43a97236fd
[0m17:20:35.035471 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts.43a97236fd"
[0m17:20:35.036377 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts.43a97236fd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts.43a97236fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  event_ts is not null as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




  
  
      
    ) dbt_internal_test
[0m17:20:35.036874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:36.023093 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:da2195fb-bbb7-4db5-9cf5-00abac5de671&page=queryresults
[0m17:20:36.024737 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:da2195fb-bbb7-4db5-9cf5-00abac5de671&page=queryresults
[0m17:20:36.031033 [debug] [Thread-1 (]: Database Error in test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts (models/build/source.yml)
  Unrecognized name: event_ts; Did you mean event_type? at [20:3]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_79945edee93ea6353b67f038e408e967.sql
[0m17:20:36.032174 [error] [Thread-1 (]: 7 of 15 ERROR dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts  [[31mERROR[0m in 1.01s]
[0m17:20:36.033142 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts.43a97236fd
[0m17:20:36.033750 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941
[0m17:20:36.034397 [debug] [Thread-4 (]: Marking all children of 'test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts.43a97236fd' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts (models/build/source.yml)
  Unrecognized name: event_ts; Did you mean event_type? at [20:3]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_79945edee93ea6353b67f038e408e967.sql.
[0m17:20:36.035035 [info ] [Thread-1 (]: 8 of 15 START test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type  [RUN]
[0m17:20:36.035852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts.43a97236fd, now test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941)
[0m17:20:36.036366 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941
[0m17:20:36.042507 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941"
[0m17:20:36.044061 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941
[0m17:20:36.048043 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941"
[0m17:20:36.048695 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  event_type is not null as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




  
  
      
    ) dbt_internal_test
[0m17:20:36.049093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:36.976968 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:93cb706e-498b-46ff-8294-6547826a1c16&page=queryresults
[0m17:20:37.397135 [info ] [Thread-1 (]: 8 of 15 PASS dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type  [[32mPASS[0m in 1.36s]
[0m17:20:37.399170 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941
[0m17:20:37.399912 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682
[0m17:20:37.400603 [info ] [Thread-1 (]: 9 of 15 START test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id  [RUN]
[0m17:20:37.401316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941, now test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682)
[0m17:20:37.401900 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682
[0m17:20:37.409056 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682"
[0m17:20:37.410606 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682
[0m17:20:37.413361 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682"
[0m17:20:37.414150 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  policy_id is not null as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




  
  
      
    ) dbt_internal_test
[0m17:20:37.414635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:38.400463 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:806f83ae-d9fd-4fcf-a4db-7a4f8d9f01c5&page=queryresults
[0m17:20:38.732519 [error] [Thread-1 (]: 9 of 15 FAIL 1 dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id  [[31mFAIL 1[0m in 1.33s]
[0m17:20:38.734363 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682
[0m17:20:38.735117 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m17:20:38.735825 [info ] [Thread-1 (]: 10 of 15 START test not_null_policy_lifecycle_enriched_current_status .......... [RUN]
[0m17:20:38.736530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682, now test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a)
[0m17:20:38.737088 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m17:20:38.747775 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"
[0m17:20:38.749790 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m17:20:38.752297 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"
[0m17:20:38.753031 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select current_status
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where current_status is null



  
  
      
    ) dbt_internal_test
[0m17:20:38.753457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:39.659458 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:49022865-1d8e-449b-950c-1b5ff455179a&page=queryresults
[0m17:20:40.045349 [info ] [Thread-1 (]: 10 of 15 PASS not_null_policy_lifecycle_enriched_current_status ................ [[32mPASS[0m in 1.31s]
[0m17:20:40.046477 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m17:20:40.046978 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m17:20:40.047504 [info ] [Thread-1 (]: 11 of 15 START test not_null_policy_lifecycle_enriched_event_month ............. [RUN]
[0m17:20:40.048091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a, now test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87)
[0m17:20:40.048530 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m17:20:40.053556 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"
[0m17:20:40.054284 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m17:20:40.056693 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"
[0m17:20:40.057310 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_month
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where event_month is null



  
  
      
    ) dbt_internal_test
[0m17:20:40.057681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:41.023449 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:96595305-f6ac-4460-bb1f-f2bf6b1ed4b9&page=queryresults
[0m17:20:41.373205 [info ] [Thread-1 (]: 11 of 15 PASS not_null_policy_lifecycle_enriched_event_month ................... [[32mPASS[0m in 1.32s]
[0m17:20:41.374669 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m17:20:41.375561 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a
[0m17:20:41.376537 [info ] [Thread-1 (]: 12 of 15 START test not_null_policy_lifecycle_enriched_event_ts ................ [RUN]
[0m17:20:41.377358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87, now test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a)
[0m17:20:41.378020 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a
[0m17:20:41.387820 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a"
[0m17:20:41.388948 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a
[0m17:20:41.391838 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a"
[0m17:20:41.392682 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_ts
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where event_ts is null



  
  
      
    ) dbt_internal_test
[0m17:20:41.393156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:42.658179 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:1fbe11f2-6360-4422-bd91-b3062ca9be58&page=queryresults
[0m17:20:42.972060 [info ] [Thread-1 (]: 12 of 15 PASS not_null_policy_lifecycle_enriched_event_ts ...................... [[32mPASS[0m in 1.59s]
[0m17:20:42.973817 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a
[0m17:20:42.974590 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m17:20:42.975356 [info ] [Thread-1 (]: 13 of 15 START test not_null_policy_lifecycle_enriched_first_quote_ts .......... [RUN]
[0m17:20:42.976149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a, now test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0)
[0m17:20:42.976780 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m17:20:42.984044 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"
[0m17:20:42.986634 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m17:20:42.989800 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"
[0m17:20:42.990618 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_quote_ts
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where first_quote_ts is null



  
  
      
    ) dbt_internal_test
[0m17:20:42.991082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:43.920923 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:742c9ada-4e1e-4d00-83d2-51c15c49524d&page=queryresults
[0m17:20:44.357131 [info ] [Thread-1 (]: 13 of 15 PASS not_null_policy_lifecycle_enriched_first_quote_ts ................ [[32mPASS[0m in 1.38s]
[0m17:20:44.359225 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m17:20:44.360037 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9
[0m17:20:44.360799 [info ] [Thread-1 (]: 14 of 15 START test not_null_policy_lifecycle_enriched_last_event_type ......... [RUN]
[0m17:20:44.361580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0, now test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9)
[0m17:20:44.362175 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9
[0m17:20:44.369045 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9"
[0m17:20:44.370597 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9
[0m17:20:44.373743 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9"
[0m17:20:44.374600 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_event_type
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where last_event_type is null



  
  
      
    ) dbt_internal_test
[0m17:20:44.375093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:45.587979 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:0622313f-d1be-453d-9066-50004339e3a6&page=queryresults
[0m17:20:45.909326 [info ] [Thread-1 (]: 14 of 15 PASS not_null_policy_lifecycle_enriched_last_event_type ............... [[32mPASS[0m in 1.55s]
[0m17:20:45.911050 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9
[0m17:20:45.911845 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m17:20:45.912533 [info ] [Thread-1 (]: 15 of 15 START test not_null_policy_lifecycle_enriched_policy_id ............... [RUN]
[0m17:20:45.913239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9, now test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b)
[0m17:20:45.913822 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m17:20:45.920979 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"
[0m17:20:45.922232 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m17:20:45.928293 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"
[0m17:20:45.929641 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select policy_id
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where policy_id is null



  
  
      
    ) dbt_internal_test
[0m17:20:45.930146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:20:46.863642 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:ff909e0c-8865-4e51-a4e2-4aa35f83589d&page=queryresults
[0m17:20:47.178494 [info ] [Thread-1 (]: 15 of 15 PASS not_null_policy_lifecycle_enriched_policy_id ..................... [[32mPASS[0m in 1.26s]
[0m17:20:47.180122 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m17:20:47.182393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:20:47.242537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:47.242827 [debug] [MainThread]: Connection 'test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b' was properly closed.
[0m17:20:47.243043 [info ] [MainThread]: 
[0m17:20:47.243270 [info ] [MainThread]: Finished running 15 data tests in 0 hours 0 minutes and 23.18 seconds (23.18s).
[0m17:20:47.244713 [debug] [MainThread]: Command end result
[0m17:20:47.264613 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:20:47.265802 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:20:47.269965 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m17:20:47.270125 [info ] [MainThread]: 
[0m17:20:47.270364 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m17:20:47.270536 [info ] [MainThread]: 
[0m17:20:47.270743 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_be_unique_policy_events_policy_events_external_table_policy_id (models/build/source.yml)[0m
[0m17:20:47.270923 [error] [MainThread]:   Got 278 results, configured to fail if != 0
[0m17:20:47.271054 [info ] [MainThread]: 
[0m17:20:47.271214 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/build/source.yml/dbt_expectations_source_expect_b57649855eb6ca423447fe635531c9c2.sql
[0m17:20:47.271347 [info ] [MainThread]: 
[0m17:20:47.271508 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_ (models/build/source.yml)[0m
[0m17:20:47.271682 [error] [MainThread]:   Database Error in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_ts___d_4_d_2_d_2_T_d_2_d_2_d_2_ (models/build/source.yml)
  Syntax error: Illegal escape sequence: \d at [24:26]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_6fbe3145dba6e18dc31acc1a52aec310.sql
[0m17:20:47.271809 [info ] [MainThread]: 
[0m17:20:47.271958 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/build/source.yml/dbt_expectations_source_expect_6fbe3145dba6e18dc31acc1a52aec310.sql
[0m17:20:47.272084 [info ] [MainThread]: 
[0m17:20:47.272241 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_premium_amount___0_9_4_0_9_2_0_9_2_T_0_9_2_0_9_2_0_9_2_ (models/build/source.yml)[0m
[0m17:20:47.272399 [error] [MainThread]:   Got 279 results, configured to fail if != 0
[0m17:20:47.272513 [info ] [MainThread]: 
[0m17:20:47.272662 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/build/source.yml/dbt_expectations_source_expect_4650181a7c6675b6c14555140fc75351.sql
[0m17:20:47.272781 [info ] [MainThread]: 
[0m17:20:47.272930 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts (models/build/source.yml)[0m
[0m17:20:47.273092 [error] [MainThread]:   Database Error in test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_ts (models/build/source.yml)
  Unrecognized name: event_ts; Did you mean event_type? at [20:3]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_79945edee93ea6353b67f038e408e967.sql
[0m17:20:47.273215 [info ] [MainThread]: 
[0m17:20:47.273359 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/build/source.yml/dbt_expectations_source_expect_79945edee93ea6353b67f038e408e967.sql
[0m17:20:47.273477 [info ] [MainThread]: 
[0m17:20:47.273631 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id (models/build/source.yml)[0m
[0m17:20:47.273788 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:20:47.273906 [info ] [MainThread]: 
[0m17:20:47.274049 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/build/source.yml/dbt_expectations_source_expect_220988c18ae28ad56365e52f07aad26c.sql
[0m17:20:47.274173 [info ] [MainThread]: 
[0m17:20:47.274323 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=15
[0m17:20:47.274565 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 26.136826, "process_in_blocks": "0", "process_kernel_time": 0.939941, "process_mem_max_rss": "408403968", "process_out_blocks": "0", "process_user_time": 5.569752}
[0m17:20:47.274819 [debug] [MainThread]: Command `dbt test` failed at 17:20:47.274779 after 26.14 seconds
[0m17:20:47.275011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d39d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e449f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e448a40>]}
[0m17:20:47.275177 [debug] [MainThread]: Flushing usage events
[0m17:20:49.373242 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:53.263675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb2a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091785f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091780e0>]}


============================== 17:25:53.265996 | 2aa2ff5f-14cc-4872-9108-df9d16059199 ==============================
[0m17:25:53.265996 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:25:53.266403 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'printer_width': '80', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'empty': 'False', 'fail_fast': 'False', 'introspect': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'log_format': 'default', 'version_check': 'True', 'warn_error': 'None'}
[0m17:25:55.490556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2aa2ff5f-14cc-4872-9108-df9d16059199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15cad86b0>]}
[0m17:25:55.517131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2aa2ff5f-14cc-4872-9108-df9d16059199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e4ce0>]}
[0m17:25:55.517512 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:25:55.639752 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:25:55.757950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:25:55.758620 [debug] [MainThread]: Partial parsing: updated file: my_project://models/build/source.yml
[0m17:25:56.128558 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.persist_docs
- models.my_project.ext
[0m17:25:56.133299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2aa2ff5f-14cc-4872-9108-df9d16059199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10857b110>]}
[0m17:25:56.176320 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:25:56.177833 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:25:56.190167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2aa2ff5f-14cc-4872-9108-df9d16059199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d68b1d0>]}
[0m17:25:56.190411 [info ] [MainThread]: Found 10 models, 13 data tests, 1 source, 773 macros
[0m17:25:56.190580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aa2ff5f-14cc-4872-9108-df9d16059199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d56f470>]}
[0m17:25:56.191465 [info ] [MainThread]: 
[0m17:25:56.191657 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m17:25:56.191795 [info ] [MainThread]: 
[0m17:25:56.192033 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:25:56.193934 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m17:25:56.194164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:57.350693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m17:25:57.351959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:58.140830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2aa2ff5f-14cc-4872-9108-df9d16059199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc9820>]}
[0m17:25:58.142179 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:58.205154 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m17:25:58.205723 [info ] [Thread-1 (]: 1 of 10 START sql table model single_view_policy_assignment.raw_policy_events .. [RUN]
[0m17:25:58.206048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m17:25:58.206285 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m17:25:58.211136 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m17:25:58.212236 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m17:25:58.221086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:58.977956 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m17:25:58.978869 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    );
  
[0m17:25:59.496733 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:76ec951b-158a-4cd8-8ee2-2215129a086d&page=queryresults
[0m17:26:01.976794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa2ff5f-14cc-4872-9108-df9d16059199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d689e50>]}
[0m17:26:01.977767 [info ] [Thread-1 (]: 1 of 10 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 3.77s]
[0m17:26:01.978408 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m17:26:01.979131 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m17:26:01.979607 [info ] [Thread-1 (]: 2 of 10 START sql table model single_view_policy_assignment.stg_policy_events .. [RUN]
[0m17:26:01.979962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m17:26:01.980243 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m17:26:01.982950 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m17:26:01.983739 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m17:26:01.985925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:02.740211 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m17:26:02.743250 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m17:26:03.344435 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:9c7a3e95-7bc0-4487-b25e-6d9030a48466&page=queryresults
[0m17:26:05.494693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa2ff5f-14cc-4872-9108-df9d16059199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d9e4500>]}
[0m17:26:05.495708 [info ] [Thread-1 (]: 2 of 10 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.51s]
[0m17:26:05.496448 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m17:26:05.497310 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m17:26:05.497803 [info ] [Thread-1 (]: 3 of 10 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m17:26:05.498260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m17:26:05.498651 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m17:26:05.505283 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m17:26:05.506120 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m17:26:05.534870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:06.294795 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m17:26:06.297214 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched` as DBT_INTERNAL_DEST
        using (

-- Event order mapping
WITH policy_event_order as (
    select 'quote' as event_type, 1 as event_order union all
    select 'bind' as event_type, 2 as event_order union all
    select 'cancel' as event_type, 3 as event_order
),

-- Attach event order and event position within each policy
curated_data as (
    select
        spe.*
        ,peo.event_order
        ,row_number() over (partition by spe.policy_id order by spe.event_timestamp nulls last) as policy_order
    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events` spe
    join policy_event_order peo
        on spe.event_type = peo.event_type
),

-- Exclude non-logical event sequences
filtered_curated AS (
  select *
  from curated_data
  where not (
    (policy_order = 1 and event_order != 1) -- First event is not 'quote'
      or (policy_order = 2 and event_order = 3) -- Second event is 'cancel'
  )
),

---Assumptions are the order of events is only quote -> bind -> cancel. 
---A quote can't be cancelled
---A requote comes with a new policy_id

-- Find first per event_type
firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM filtered_curated
  GROUP BY policy_id
),


last_evt AS (
  SELECT
    t.policy_id,
    t.event_type AS last_event_type,
    t.event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      *,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM filtered_curated
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    l.event_ts,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, HOUR)
      ELSE NULL
    END AS quote_to_bind_hr,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, HOUR)
      ELSE NULL
    END AS bind_to_cancel_hr,
    l.event_month,
    l.source_channel,
    l.state,
    l.product_type,
    l.premium_amount
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
)


SELECT * FROM final
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.policy_id = DBT_INTERNAL_DEST.policy_id
                ) and (
                    DBT_INTERNAL_SOURCE.event_type = DBT_INTERNAL_DEST.event_type
                ) and (
                    DBT_INTERNAL_SOURCE.product_type = DBT_INTERNAL_DEST.product_type
                )

    
    when matched then update set
        `policy_id` = DBT_INTERNAL_SOURCE.`policy_id`,`first_quote_ts` = DBT_INTERNAL_SOURCE.`first_quote_ts`,`first_bind_ts` = DBT_INTERNAL_SOURCE.`first_bind_ts`,`first_cancel_ts` = DBT_INTERNAL_SOURCE.`first_cancel_ts`,`last_event_type` = DBT_INTERNAL_SOURCE.`last_event_type`,`event_ts` = DBT_INTERNAL_SOURCE.`event_ts`,`current_status` = DBT_INTERNAL_SOURCE.`current_status`,`quote_to_bind_hr` = DBT_INTERNAL_SOURCE.`quote_to_bind_hr`,`bind_to_cancel_hr` = DBT_INTERNAL_SOURCE.`bind_to_cancel_hr`,`event_month` = DBT_INTERNAL_SOURCE.`event_month`,`source_channel` = DBT_INTERNAL_SOURCE.`source_channel`,`state` = DBT_INTERNAL_SOURCE.`state`,`product_type` = DBT_INTERNAL_SOURCE.`product_type`,`premium_amount` = DBT_INTERNAL_SOURCE.`premium_amount`
    

    when not matched then insert
        (`policy_id`, `first_quote_ts`, `first_bind_ts`, `first_cancel_ts`, `last_event_type`, `event_ts`, `current_status`, `quote_to_bind_hr`, `bind_to_cancel_hr`, `event_month`, `source_channel`, `state`, `product_type`, `premium_amount`)
    values
        (`policy_id`, `first_quote_ts`, `first_bind_ts`, `first_cancel_ts`, `last_event_type`, `event_ts`, `current_status`, `quote_to_bind_hr`, `bind_to_cancel_hr`, `event_month`, `source_channel`, `state`, `product_type`, `premium_amount`)


    
[0m17:26:06.819336 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:738d8c89-c823-4daa-a364-0e6d10cb898e&page=queryresults
[0m17:26:07.035760 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:738d8c89-c823-4daa-a364-0e6d10cb898e&page=queryresults
[0m17:26:07.047657 [debug] [Thread-1 (]: Database Error in model policy_lifecycle_enriched (models/final/policy_lifecycle_enriched.sql)
  Name event_type not found inside DBT_INTERNAL_SOURCE at [129:41]
  compiled code at target/run/my_project/models/final/policy_lifecycle_enriched.sql
[0m17:26:07.048345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2aa2ff5f-14cc-4872-9108-df9d16059199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d821e80>]}
[0m17:26:07.049008 [error] [Thread-1 (]: 3 of 10 ERROR creating sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[31mERROR[0m in 1.55s]
[0m17:26:07.050192 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m17:26:07.050704 [debug] [Thread-4 (]: Marking all children of 'model.my_project.policy_lifecycle_enriched' to be skipped because of status 'error'.  Reason: Database Error in model policy_lifecycle_enriched (models/final/policy_lifecycle_enriched.sql)
  Name event_type not found inside DBT_INTERNAL_SOURCE at [129:41]
  compiled code at target/run/my_project/models/final/policy_lifecycle_enriched.sql.
[0m17:26:07.051438 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m17:26:07.052230 [info ] [Thread-1 (]: 4 of 10 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m17:26:07.052627 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m17:26:07.052965 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m17:26:07.053319 [info ] [Thread-1 (]: 5 of 10 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m17:26:07.053661 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m17:26:07.053974 [debug] [Thread-1 (]: Began running node model.my_project.dim_event_type
[0m17:26:07.054297 [info ] [Thread-1 (]: 6 of 10 SKIP relation single_view_policy_assignment.dim_event_type ............. [[33mSKIP[0m]
[0m17:26:07.054699 [debug] [Thread-1 (]: Finished running node model.my_project.dim_event_type
[0m17:26:07.055123 [debug] [Thread-1 (]: Began running node model.my_project.dim_product_type
[0m17:26:07.055489 [info ] [Thread-1 (]: 7 of 10 SKIP relation single_view_policy_assignment.dim_product_type ........... [[33mSKIP[0m]
[0m17:26:07.055828 [debug] [Thread-1 (]: Finished running node model.my_project.dim_product_type
[0m17:26:07.056136 [debug] [Thread-1 (]: Began running node model.my_project.dim_source_channel
[0m17:26:07.056459 [info ] [Thread-1 (]: 8 of 10 SKIP relation single_view_policy_assignment.dim_source_channel ......... [[33mSKIP[0m]
[0m17:26:07.056752 [debug] [Thread-1 (]: Finished running node model.my_project.dim_source_channel
[0m17:26:07.057015 [debug] [Thread-1 (]: Began running node model.my_project.dim_state
[0m17:26:07.057334 [info ] [Thread-1 (]: 9 of 10 SKIP relation single_view_policy_assignment.dim_state .................. [[33mSKIP[0m]
[0m17:26:07.057728 [debug] [Thread-1 (]: Finished running node model.my_project.dim_state
[0m17:26:07.058043 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m17:26:07.058353 [info ] [Thread-1 (]: 10 of 10 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis  [[33mSKIP[0m]
[0m17:26:07.058644 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m17:26:07.059314 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:26:07.103754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:07.103948 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m17:26:07.104159 [info ] [MainThread]: 
[0m17:26:07.104330 [info ] [MainThread]: Finished running 1 incremental model, 6 table models, 3 view models in 0 hours 0 minutes and 10.91 seconds (10.91s).
[0m17:26:07.104879 [debug] [MainThread]: Command end result
[0m17:26:07.123414 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:26:07.124250 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:26:07.127432 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m17:26:07.127595 [info ] [MainThread]: 
[0m17:26:07.127772 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:26:07.127914 [info ] [MainThread]: 
[0m17:26:07.128093 [error] [MainThread]: [31mFailure in model policy_lifecycle_enriched (models/final/policy_lifecycle_enriched.sql)[0m
[0m17:26:07.128268 [error] [MainThread]:   Database Error in model policy_lifecycle_enriched (models/final/policy_lifecycle_enriched.sql)
  Name event_type not found inside DBT_INTERNAL_SOURCE at [129:41]
  compiled code at target/run/my_project/models/final/policy_lifecycle_enriched.sql
[0m17:26:07.128398 [info ] [MainThread]: 
[0m17:26:07.128547 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/final/policy_lifecycle_enriched.sql
[0m17:26:07.128678 [info ] [MainThread]: 
[0m17:26:07.128831 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=7 NO-OP=0 TOTAL=10
[0m17:26:07.129063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.899791, "process_in_blocks": "0", "process_kernel_time": 0.764304, "process_mem_max_rss": "407044096", "process_out_blocks": "0", "process_user_time": 4.696155}
[0m17:26:07.129319 [debug] [MainThread]: Command `dbt run` failed at 17:26:07.129277 after 13.90 seconds
[0m17:26:07.129493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d643200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d54a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f955b0>]}
[0m17:26:07.129652 [debug] [MainThread]: Flushing usage events
[0m17:26:09.041092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:28:27.788097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108993440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10910c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098f4230>]}


============================== 17:28:27.790016 | 835f4f17-b478-47bf-b177-9e6dc1f6e89b ==============================
[0m17:28:27.790016 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:28:27.790401 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'printer_width': '80', 'version_check': 'True', 'fail_fast': 'False', 'introspect': 'True', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'empty': 'False', 'debug': 'False', 'quiet': 'False', 'warn_error': 'None', 'no_print': 'None', 'target_path': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --full-refresh', 'indirect_selection': 'eager', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'partial_parse': 'True'}
[0m17:28:29.949858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '835f4f17-b478-47bf-b177-9e6dc1f6e89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142a27b60>]}
[0m17:28:29.975662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '835f4f17-b478-47bf-b177-9e6dc1f6e89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136ebed20>]}
[0m17:28:29.975984 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:28:30.096907 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:28:30.218099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:28:30.218493 [debug] [MainThread]: Partial parsing: updated file: my_project://models/final/policy_lifecycle_enriched.sql
[0m17:28:30.436193 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.ext
- models.my_project.persist_docs
[0m17:28:30.442346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '835f4f17-b478-47bf-b177-9e6dc1f6e89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a06750>]}
[0m17:28:30.584840 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:28:30.586513 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:28:30.598144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '835f4f17-b478-47bf-b177-9e6dc1f6e89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1436fb2f0>]}
[0m17:28:30.598412 [info ] [MainThread]: Found 10 models, 13 data tests, 1 source, 773 macros
[0m17:28:30.598587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '835f4f17-b478-47bf-b177-9e6dc1f6e89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a06810>]}
[0m17:28:30.599530 [info ] [MainThread]: 
[0m17:28:30.599722 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m17:28:30.599860 [info ] [MainThread]: 
[0m17:28:30.600090 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:28:30.602027 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m17:28:30.602231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:31.577062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m17:28:31.578107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:28:32.305353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '835f4f17-b478-47bf-b177-9e6dc1f6e89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143af2c90>]}
[0m17:28:32.306625 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:28:32.370692 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m17:28:32.371269 [info ] [Thread-1 (]: 1 of 10 START sql table model single_view_policy_assignment.raw_policy_events .. [RUN]
[0m17:28:32.371612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m17:28:32.372348 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m17:28:32.376738 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m17:28:32.377325 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m17:28:32.385333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:33.146155 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m17:28:33.148046 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    );
  
[0m17:28:33.614808 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:d3be2336-7128-447c-8231-1796721d6c7a&page=queryresults
[0m17:28:35.719490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '835f4f17-b478-47bf-b177-9e6dc1f6e89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108710b00>]}
[0m17:28:35.720333 [info ] [Thread-1 (]: 1 of 10 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 3.35s]
[0m17:28:35.720882 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m17:28:35.721614 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m17:28:35.722087 [info ] [Thread-1 (]: 2 of 10 START sql table model single_view_policy_assignment.stg_policy_events .. [RUN]
[0m17:28:35.722467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m17:28:35.722767 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m17:28:35.725364 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m17:28:35.725970 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m17:28:35.728070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:36.464493 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m17:28:36.467606 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m17:28:36.910993 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:6853a52a-1102-4729-8e2c-660a0271cc5f&page=queryresults
[0m17:28:38.740406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '835f4f17-b478-47bf-b177-9e6dc1f6e89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1436cdbb0>]}
[0m17:28:38.742281 [info ] [Thread-1 (]: 2 of 10 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.02s]
[0m17:28:38.743394 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m17:28:38.744648 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m17:28:38.745408 [info ] [Thread-1 (]: 3 of 10 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m17:28:38.746097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m17:28:38.746596 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m17:28:38.753541 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m17:28:38.754873 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m17:28:38.789271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:39.481705 [debug] [Thread-1 (]: Hard refreshing `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched` because it is not replaceable
[0m17:28:39.619718 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m17:28:39.622928 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

-- Event order mapping
WITH policy_event_order as (
    select 'quote' as event_type, 1 as event_order union all
    select 'bind' as event_type, 2 as event_order union all
    select 'cancel' as event_type, 3 as event_order
),

-- Attach event order and event position within each policy
curated_data as (
    select
        spe.*
        ,peo.event_order
        ,row_number() over (partition by spe.policy_id order by spe.event_timestamp nulls last) as policy_order
    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events` spe
    join policy_event_order peo
        on spe.event_type = peo.event_type
),

-- Exclude non-logical event sequences
filtered_curated AS (
  select *
  from curated_data
  where not (
    (policy_order = 1 and event_order != 1) -- First event is not 'quote'
      or (policy_order = 2 and event_order = 3) -- Second event is 'cancel'
  )
),

---Assumptions are the order of events is only quote -> bind -> cancel. 
---A quote can't be cancelled
---A requote comes with a new policy_id

-- Find first per event_type
firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM filtered_curated
  GROUP BY policy_id
),


last_evt AS (
  SELECT
    t.policy_id,
    t.event_type AS last_event_type,
    t.event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      *,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM filtered_curated
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    l.event_ts,
    l.event_type
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, HOUR)
      ELSE NULL
    END AS quote_to_bind_hr,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, HOUR)
      ELSE NULL
    END AS bind_to_cancel_hr,
    l.event_month,
    l.source_channel,
    l.state,
    l.product_type,
    l.premium_amount
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
)


SELECT * FROM final
    );
  
[0m17:28:40.013820 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:1f644407-dd0c-47c2-9286-e2674f957ea6&page=queryresults
[0m17:28:40.015649 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:1f644407-dd0c-47c2-9286-e2674f957ea6&page=queryresults
[0m17:28:40.030880 [debug] [Thread-1 (]: Database Error in model policy_lifecycle_enriched (models/final/policy_lifecycle_enriched.sql)
  Syntax error: Expected ")" but got keyword CASE at [89:5]
  compiled code at target/run/my_project/models/final/policy_lifecycle_enriched.sql
[0m17:28:40.032160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '835f4f17-b478-47bf-b177-9e6dc1f6e89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143b28c20>]}
[0m17:28:40.033197 [error] [Thread-1 (]: 3 of 10 ERROR creating sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[31mERROR[0m in 1.29s]
[0m17:28:40.033914 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m17:28:40.034441 [debug] [Thread-4 (]: Marking all children of 'model.my_project.policy_lifecycle_enriched' to be skipped because of status 'error'.  Reason: Database Error in model policy_lifecycle_enriched (models/final/policy_lifecycle_enriched.sql)
  Syntax error: Expected ")" but got keyword CASE at [89:5]
  compiled code at target/run/my_project/models/final/policy_lifecycle_enriched.sql.
[0m17:28:40.035300 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m17:28:40.035932 [info ] [Thread-1 (]: 4 of 10 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m17:28:40.036425 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m17:28:40.036842 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m17:28:40.037268 [info ] [Thread-1 (]: 5 of 10 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m17:28:40.037687 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m17:28:40.038082 [debug] [Thread-1 (]: Began running node model.my_project.dim_event_type
[0m17:28:40.038481 [info ] [Thread-1 (]: 6 of 10 SKIP relation single_view_policy_assignment.dim_event_type ............. [[33mSKIP[0m]
[0m17:28:40.038877 [debug] [Thread-1 (]: Finished running node model.my_project.dim_event_type
[0m17:28:40.039524 [debug] [Thread-1 (]: Began running node model.my_project.dim_product_type
[0m17:28:40.040011 [info ] [Thread-1 (]: 7 of 10 SKIP relation single_view_policy_assignment.dim_product_type ........... [[33mSKIP[0m]
[0m17:28:40.040409 [debug] [Thread-1 (]: Finished running node model.my_project.dim_product_type
[0m17:28:40.040754 [debug] [Thread-1 (]: Began running node model.my_project.dim_source_channel
[0m17:28:40.041149 [info ] [Thread-1 (]: 8 of 10 SKIP relation single_view_policy_assignment.dim_source_channel ......... [[33mSKIP[0m]
[0m17:28:40.041496 [debug] [Thread-1 (]: Finished running node model.my_project.dim_source_channel
[0m17:28:40.041811 [debug] [Thread-1 (]: Began running node model.my_project.dim_state
[0m17:28:40.042173 [info ] [Thread-1 (]: 9 of 10 SKIP relation single_view_policy_assignment.dim_state .................. [[33mSKIP[0m]
[0m17:28:40.042573 [debug] [Thread-1 (]: Finished running node model.my_project.dim_state
[0m17:28:40.042918 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m17:28:40.043262 [info ] [Thread-1 (]: 10 of 10 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis  [[33mSKIP[0m]
[0m17:28:40.043622 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m17:28:40.044532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:28:40.091934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:40.092166 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m17:28:40.092391 [info ] [MainThread]: 
[0m17:28:40.092577 [info ] [MainThread]: Finished running 1 incremental model, 6 table models, 3 view models in 0 hours 0 minutes and 9.49 seconds (9.49s).
[0m17:28:40.093130 [debug] [MainThread]: Command end result
[0m17:28:40.113177 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:28:40.114041 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:28:40.116711 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m17:28:40.116873 [info ] [MainThread]: 
[0m17:28:40.117052 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:28:40.117198 [info ] [MainThread]: 
[0m17:28:40.117382 [error] [MainThread]: [31mFailure in model policy_lifecycle_enriched (models/final/policy_lifecycle_enriched.sql)[0m
[0m17:28:40.117560 [error] [MainThread]:   Database Error in model policy_lifecycle_enriched (models/final/policy_lifecycle_enriched.sql)
  Syntax error: Expected ")" but got keyword CASE at [89:5]
  compiled code at target/run/my_project/models/final/policy_lifecycle_enriched.sql
[0m17:28:40.117693 [info ] [MainThread]: 
[0m17:28:40.117845 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/final/policy_lifecycle_enriched.sql
[0m17:28:40.117974 [info ] [MainThread]: 
[0m17:28:40.118129 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=7 NO-OP=0 TOTAL=10
[0m17:28:40.118370 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.363267, "process_in_blocks": "0", "process_kernel_time": 0.827331, "process_mem_max_rss": "398721024", "process_out_blocks": "0", "process_user_time": 4.557864}
[0m17:28:40.118624 [debug] [MainThread]: Command `dbt run` failed at 17:28:40.118584 after 12.36 seconds
[0m17:28:40.118794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142f5dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a1ac0>]}
[0m17:28:40.118952 [debug] [MainThread]: Flushing usage events
[0m17:28:41.241873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:56.747677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df4e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109098230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109848110>]}


============================== 17:29:56.749700 | e0d15b8e-2c13-46bd-aa0c-1df4f46fd2be ==============================
[0m17:29:56.749700 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:29:56.750104 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'partial_parse': 'True', 'static_parser': 'True', 'version_check': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'invocation_command': 'dbt run --full-refresh', 'printer_width': '80', 'use_experimental_parser': 'False', 'target_path': 'None', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'warn_error': 'None', 'quiet': 'False', 'write_json': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'empty': 'False'}
[0m17:29:58.814514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0d15b8e-2c13-46bd-aa0c-1df4f46fd2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1654837d0>]}
[0m17:29:58.840208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0d15b8e-2c13-46bd-aa0c-1df4f46fd2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165408d40>]}
[0m17:29:58.840568 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:29:58.963564 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:29:59.074596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:29:59.074972 [debug] [MainThread]: Partial parsing: updated file: my_project://models/final/policy_lifecycle_enriched.sql
[0m17:29:59.271616 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.ext
- models.my_project.persist_docs
[0m17:29:59.277701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0d15b8e-2c13-46bd-aa0c-1df4f46fd2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165f05eb0>]}
[0m17:29:59.417768 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:29:59.419574 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:29:59.429989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0d15b8e-2c13-46bd-aa0c-1df4f46fd2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165e1bef0>]}
[0m17:29:59.430271 [info ] [MainThread]: Found 10 models, 13 data tests, 1 source, 773 macros
[0m17:29:59.430449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0d15b8e-2c13-46bd-aa0c-1df4f46fd2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165e705c0>]}
[0m17:29:59.431342 [info ] [MainThread]: 
[0m17:29:59.431546 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m17:29:59.431688 [info ] [MainThread]: 
[0m17:29:59.431923 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:29:59.433825 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m17:29:59.434022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:00.385741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m17:30:00.386615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:01.167897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0d15b8e-2c13-46bd-aa0c-1df4f46fd2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165fe57c0>]}
[0m17:30:01.169138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:01.232041 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m17:30:01.232452 [info ] [Thread-1 (]: 1 of 10 START sql table model single_view_policy_assignment.raw_policy_events .. [RUN]
[0m17:30:01.232736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m17:30:01.233366 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m17:30:01.237598 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m17:30:01.238011 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m17:30:01.245895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:02.150185 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m17:30:02.151338 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    );
  
[0m17:30:02.538248 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:07370960-e838-4d01-9d01-e75c5eda043a&page=queryresults
[0m17:30:06.205387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0d15b8e-2c13-46bd-aa0c-1df4f46fd2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1601bba10>]}
[0m17:30:06.206498 [info ] [Thread-1 (]: 1 of 10 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 4.97s]
[0m17:30:06.207163 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m17:30:06.207951 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m17:30:06.208481 [info ] [Thread-1 (]: 2 of 10 START sql table model single_view_policy_assignment.stg_policy_events .. [RUN]
[0m17:30:06.208988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m17:30:06.209354 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m17:30:06.212132 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m17:30:06.213033 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m17:30:06.215066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:06.951592 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m17:30:06.954200 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m17:30:07.367425 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:38cb92be-b68b-4782-ac5d-cd5d4b8d82e8&page=queryresults
[0m17:30:09.430219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0d15b8e-2c13-46bd-aa0c-1df4f46fd2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16602de50>]}
[0m17:30:09.432002 [info ] [Thread-1 (]: 2 of 10 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.22s]
[0m17:30:09.433104 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m17:30:09.434477 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m17:30:09.435318 [info ] [Thread-1 (]: 3 of 10 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m17:30:09.436010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m17:30:09.436571 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m17:30:09.444612 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m17:30:09.445997 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m17:30:09.484571 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m17:30:09.485687 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

-- Event order mapping
WITH policy_event_order as (
    select 'quote' as event_type, 1 as event_order union all
    select 'bind' as event_type, 2 as event_order union all
    select 'cancel' as event_type, 3 as event_order
),

-- Attach event order and event position within each policy
curated_data as (
    select
        spe.*
        ,peo.event_order
        ,row_number() over (partition by spe.policy_id order by spe.event_timestamp nulls last) as policy_order
    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events` spe
    join policy_event_order peo
        on spe.event_type = peo.event_type
),

-- Exclude non-logical event sequences
filtered_curated AS (
  select *
  from curated_data
  where not (
    (policy_order = 1 and event_order != 1) -- First event is not 'quote'
      or (policy_order = 2 and event_order = 3) -- Second event is 'cancel'
  )
),

---Assumptions are the order of events is only quote -> bind -> cancel. 
---A quote can't be cancelled
---A requote comes with a new policy_id

-- Find first per event_type
firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM filtered_curated
  GROUP BY policy_id
),


last_evt AS (
  SELECT
    t.policy_id,
    t.event_type AS last_event_type,
    t.event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      *,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM filtered_curated
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    l.event_ts,
    l.event_type,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, HOUR)
      ELSE NULL
    END AS quote_to_bind_hr,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, HOUR)
      ELSE NULL
    END AS bind_to_cancel_hr,
    l.event_month,
    l.source_channel,
    l.state,
    l.product_type,
    l.premium_amount
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
)


SELECT * FROM final
    );
  
[0m17:30:09.486067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:10.490918 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:2d667e0d-b4fc-41c9-be01-ae793a434caa&page=queryresults
[0m17:30:10.579118 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:2d667e0d-b4fc-41c9-be01-ae793a434caa&page=queryresults
[0m17:30:10.593186 [debug] [Thread-1 (]: Database Error in model policy_lifecycle_enriched (models/final/policy_lifecycle_enriched.sql)
  Name event_type not found inside l at [87:7]
  compiled code at target/run/my_project/models/final/policy_lifecycle_enriched.sql
[0m17:30:10.594254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0d15b8e-2c13-46bd-aa0c-1df4f46fd2be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165f070b0>]}
[0m17:30:10.595255 [error] [Thread-1 (]: 3 of 10 ERROR creating sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[31mERROR[0m in 1.16s]
[0m17:30:10.596066 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m17:30:10.596834 [debug] [Thread-4 (]: Marking all children of 'model.my_project.policy_lifecycle_enriched' to be skipped because of status 'error'.  Reason: Database Error in model policy_lifecycle_enriched (models/final/policy_lifecycle_enriched.sql)
  Name event_type not found inside l at [87:7]
  compiled code at target/run/my_project/models/final/policy_lifecycle_enriched.sql.
[0m17:30:10.598622 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m17:30:10.599144 [info ] [Thread-1 (]: 4 of 10 SKIP relation single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[33mSKIP[0m]
[0m17:30:10.599593 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m17:30:10.599995 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m17:30:10.600500 [info ] [Thread-1 (]: 5 of 10 SKIP relation single_view_policy_assignment.cancelled_within_30_days_analysis  [[33mSKIP[0m]
[0m17:30:10.601179 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m17:30:10.601733 [debug] [Thread-1 (]: Began running node model.my_project.dim_event_type
[0m17:30:10.602205 [info ] [Thread-1 (]: 6 of 10 SKIP relation single_view_policy_assignment.dim_event_type ............. [[33mSKIP[0m]
[0m17:30:10.602619 [debug] [Thread-1 (]: Finished running node model.my_project.dim_event_type
[0m17:30:10.602990 [debug] [Thread-1 (]: Began running node model.my_project.dim_product_type
[0m17:30:10.603435 [info ] [Thread-1 (]: 7 of 10 SKIP relation single_view_policy_assignment.dim_product_type ........... [[33mSKIP[0m]
[0m17:30:10.603939 [debug] [Thread-1 (]: Finished running node model.my_project.dim_product_type
[0m17:30:10.604311 [debug] [Thread-1 (]: Began running node model.my_project.dim_source_channel
[0m17:30:10.604678 [info ] [Thread-1 (]: 8 of 10 SKIP relation single_view_policy_assignment.dim_source_channel ......... [[33mSKIP[0m]
[0m17:30:10.605028 [debug] [Thread-1 (]: Finished running node model.my_project.dim_source_channel
[0m17:30:10.605336 [debug] [Thread-1 (]: Began running node model.my_project.dim_state
[0m17:30:10.605680 [info ] [Thread-1 (]: 9 of 10 SKIP relation single_view_policy_assignment.dim_state .................. [[33mSKIP[0m]
[0m17:30:10.606439 [debug] [Thread-1 (]: Finished running node model.my_project.dim_state
[0m17:30:10.606827 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m17:30:10.607273 [info ] [Thread-1 (]: 10 of 10 SKIP relation single_view_policy_assignment.quoted_never_bound_analysis  [[33mSKIP[0m]
[0m17:30:10.607724 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m17:30:10.608622 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:30:10.655765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:10.655982 [debug] [MainThread]: Connection 'model.my_project.policy_lifecycle_enriched' was properly closed.
[0m17:30:10.656204 [info ] [MainThread]: 
[0m17:30:10.656451 [info ] [MainThread]: Finished running 1 incremental model, 6 table models, 3 view models in 0 hours 0 minutes and 11.22 seconds (11.22s).
[0m17:30:10.657033 [debug] [MainThread]: Command end result
[0m17:30:10.676341 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:30:10.677245 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:30:10.679956 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m17:30:10.680120 [info ] [MainThread]: 
[0m17:30:10.680307 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:30:10.680454 [info ] [MainThread]: 
[0m17:30:10.680639 [error] [MainThread]: [31mFailure in model policy_lifecycle_enriched (models/final/policy_lifecycle_enriched.sql)[0m
[0m17:30:10.680821 [error] [MainThread]:   Database Error in model policy_lifecycle_enriched (models/final/policy_lifecycle_enriched.sql)
  Name event_type not found inside l at [87:7]
  compiled code at target/run/my_project/models/final/policy_lifecycle_enriched.sql
[0m17:30:10.680951 [info ] [MainThread]: 
[0m17:30:10.681102 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/final/policy_lifecycle_enriched.sql
[0m17:30:10.681234 [info ] [MainThread]: 
[0m17:30:10.681388 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=7 NO-OP=0 TOTAL=10
[0m17:30:10.681629 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.96657, "process_in_blocks": "0", "process_kernel_time": 0.9344, "process_mem_max_rss": "401653760", "process_out_blocks": "0", "process_user_time": 4.433343}
[0m17:30:10.681880 [debug] [MainThread]: Command `dbt run` failed at 17:30:10.681841 after 13.97 seconds
[0m17:30:10.682051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10989d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109848260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109848440>]}
[0m17:30:10.682206 [debug] [MainThread]: Flushing usage events
[0m17:30:13.430231 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:47.918011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d730e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104901220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104986a80>]}


============================== 17:30:47.919793 | 776cda6d-a11b-45a8-9a7d-22cd215cee10 ==============================
[0m17:30:47.919793 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:30:47.920119 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'static_parser': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --full-refresh', 'printer_width': '80', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'target_path': 'None', 'partial_parse': 'True', 'quiet': 'False', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'introspect': 'True', 'warn_error': 'None', 'empty': 'False', 'no_print': 'None', 'indirect_selection': 'eager'}
[0m17:30:50.122852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '776cda6d-a11b-45a8-9a7d-22cd215cee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16036f7d0>]}
[0m17:30:50.148469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '776cda6d-a11b-45a8-9a7d-22cd215cee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f28b60>]}
[0m17:30:50.148784 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:30:50.272173 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:30:50.390483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:30:50.390849 [debug] [MainThread]: Partial parsing: updated file: my_project://models/final/policy_lifecycle_enriched.sql
[0m17:30:50.588545 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.persist_docs
- models.my_project.ext
[0m17:30:50.594549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '776cda6d-a11b-45a8-9a7d-22cd215cee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16222a510>]}
[0m17:30:50.733935 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:30:50.735341 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:30:50.747183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '776cda6d-a11b-45a8-9a7d-22cd215cee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1622d7ef0>]}
[0m17:30:50.747434 [info ] [MainThread]: Found 10 models, 13 data tests, 1 source, 773 macros
[0m17:30:50.747609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '776cda6d-a11b-45a8-9a7d-22cd215cee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1622fb740>]}
[0m17:30:50.748489 [info ] [MainThread]: 
[0m17:30:50.748671 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m17:30:50.748804 [info ] [MainThread]: 
[0m17:30:50.749035 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:30:50.750935 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9'
[0m17:30:50.751160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:51.843332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9, now list_horizontal-ray-467611-f9_single_view_policy_assignment)
[0m17:30:51.844201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:52.582685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '776cda6d-a11b-45a8-9a7d-22cd215cee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1620986b0>]}
[0m17:30:52.584004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:52.647742 [debug] [Thread-1 (]: Began running node model.my_project.raw_policy_events
[0m17:30:52.648550 [info ] [Thread-1 (]: 1 of 10 START sql table model single_view_policy_assignment.raw_policy_events .. [RUN]
[0m17:30:52.648871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now model.my_project.raw_policy_events)
[0m17:30:52.649599 [debug] [Thread-1 (]: Began compiling node model.my_project.raw_policy_events
[0m17:30:52.653917 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.raw_policy_events"
[0m17:30:52.654696 [debug] [Thread-1 (]: Began executing node model.my_project.raw_policy_events
[0m17:30:52.663167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:53.434437 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.raw_policy_events"
[0m17:30:53.435708 [debug] [Thread-1 (]: On model.my_project.raw_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.raw_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

SELECT
    policy_id,
    event_type,
    CAST(event_timestamp AS TIMESTAMP) AS event_timestamp,
    source_channel,
    state,
    product_type,
    CAST(premium_amount AS FLOAT64) AS premium_amount
FROM
    `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    );
  
[0m17:30:53.830924 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:4c3621f3-88e2-47b0-b66e-54f1005f39de&page=queryresults
[0m17:30:56.010578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '776cda6d-a11b-45a8-9a7d-22cd215cee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049587a0>]}
[0m17:30:56.011705 [info ] [Thread-1 (]: 1 of 10 OK created sql table model single_view_policy_assignment.raw_policy_events  [[32mCREATE TABLE (718.0 rows, 37.6 KiB processed)[0m in 3.36s]
[0m17:30:56.012303 [debug] [Thread-1 (]: Finished running node model.my_project.raw_policy_events
[0m17:30:56.012980 [debug] [Thread-1 (]: Began running node model.my_project.stg_policy_events
[0m17:30:56.013430 [info ] [Thread-1 (]: 2 of 10 START sql table model single_view_policy_assignment.stg_policy_events .. [RUN]
[0m17:30:56.013783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.raw_policy_events, now model.my_project.stg_policy_events)
[0m17:30:56.014084 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_policy_events
[0m17:30:56.016697 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_policy_events"
[0m17:30:56.017305 [debug] [Thread-1 (]: Began executing node model.my_project.stg_policy_events
[0m17:30:56.019086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:56.727955 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_policy_events"
[0m17:30:56.729684 [debug] [Thread-1 (]: On model.my_project.stg_policy_events: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.stg_policy_events"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events`
      
    
    

    
    OPTIONS()
    as (
      

WITH ranked_events AS (
  SELECT
    *,
    ROW_NUMBER() OVER (
      PARTITION BY policy_id, event_type, product_type
      ORDER BY event_timestamp DESC
    ) AS row_num
  FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`raw_policy_events`
)

SELECT
  *,
  event_timestamp AS event_ts,
  FORMAT_DATE('%Y-%m', DATE(event_timestamp)) AS event_month
FROM ranked_events
WHERE row_num = 1

-- Assumption made that (policy_id, event_type, product_type) combination is the business key 
-- however needs to confirmed by the business
    );
  
[0m17:30:57.091681 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:717a8b7b-68b8-4489-8881-f29ef4dee4e1&page=queryresults
[0m17:30:59.354401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '776cda6d-a11b-45a8-9a7d-22cd215cee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16232cc50>]}
[0m17:30:59.356268 [info ] [Thread-1 (]: 2 of 10 OK created sql table model single_view_policy_assignment.stg_policy_events  [[32mCREATE TABLE (718.0 rows, 32.5 KiB processed)[0m in 3.34s]
[0m17:30:59.357337 [debug] [Thread-1 (]: Finished running node model.my_project.stg_policy_events
[0m17:30:59.358635 [debug] [Thread-1 (]: Began running node model.my_project.policy_lifecycle_enriched
[0m17:30:59.359370 [info ] [Thread-1 (]: 3 of 10 START sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [RUN]
[0m17:30:59.359974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.stg_policy_events, now model.my_project.policy_lifecycle_enriched)
[0m17:30:59.360434 [debug] [Thread-1 (]: Began compiling node model.my_project.policy_lifecycle_enriched
[0m17:30:59.367984 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.policy_lifecycle_enriched"
[0m17:30:59.369266 [debug] [Thread-1 (]: Began executing node model.my_project.policy_lifecycle_enriched
[0m17:30:59.406582 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.policy_lifecycle_enriched"
[0m17:30:59.407251 [debug] [Thread-1 (]: On model.my_project.policy_lifecycle_enriched: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.policy_lifecycle_enriched"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
      
    
    cluster by policy_id, current_status

    
    OPTIONS()
    as (
      

-- Event order mapping
WITH policy_event_order as (
    select 'quote' as event_type, 1 as event_order union all
    select 'bind' as event_type, 2 as event_order union all
    select 'cancel' as event_type, 3 as event_order
),

-- Attach event order and event position within each policy
curated_data as (
    select
        spe.*
        ,peo.event_order
        ,row_number() over (partition by spe.policy_id order by spe.event_timestamp nulls last) as policy_order
    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`stg_policy_events` spe
    join policy_event_order peo
        on spe.event_type = peo.event_type
),

-- Exclude non-logical event sequences
filtered_curated AS (
  select *
  from curated_data
  where not (
    (policy_order = 1 and event_order != 1) -- First event is not 'quote'
      or (policy_order = 2 and event_order = 3) -- Second event is 'cancel'
  )
),

---Assumptions are the order of events is only quote -> bind -> cancel. 
---A quote can't be cancelled
---A requote comes with a new policy_id

-- Find first per event_type
firsts AS (
  SELECT
    policy_id,
    MIN(CASE WHEN event_type = 'quote' THEN event_ts END) AS first_quote_ts,
    MIN(CASE WHEN event_type = 'bind' THEN event_ts END) AS first_bind_ts,
    MIN(CASE WHEN event_type = 'cancel' THEN event_ts END) AS first_cancel_ts,
  FROM filtered_curated
  GROUP BY policy_id
),


last_evt AS (
  SELECT
    t.policy_id,
    t.event_type AS last_event_type,
    t.event_ts,
    source_channel,
    state,
    product_type,
    premium_amount,
    event_month
  FROM (
    SELECT 
      *,
      ROW_NUMBER() OVER (PARTITION BY policy_id ORDER BY event_ts DESC) AS rn
    FROM filtered_curated
  ) t
  WHERE t.rn = 1
),

final AS (
  SELECT
    f.policy_id,
    f.first_quote_ts,
    f.first_bind_ts,
    f.first_cancel_ts,
    l.last_event_type,
    l.event_ts,
    -- Status logic
    CASE
      WHEN l.last_event_type = 'cancel' THEN 'cancelled'
      WHEN l.last_event_type = 'bind' THEN 'bound'
      ELSE 'quoted'
    END AS current_status,

    -- Durations
    CASE
      WHEN f.first_quote_ts IS NOT NULL AND f.first_bind_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_bind_ts, f.first_quote_ts, HOUR)
      ELSE NULL
    END AS quote_to_bind_hr,

    CASE
      WHEN f.first_bind_ts IS NOT NULL AND f.first_cancel_ts IS NOT NULL
        THEN TIMESTAMP_DIFF(f.first_cancel_ts, f.first_bind_ts, HOUR)
      ELSE NULL
    END AS bind_to_cancel_hr,
    l.event_month,
    l.source_channel,
    l.state,
    l.product_type,
    l.premium_amount
  FROM firsts f
  JOIN last_evt l ON f.policy_id = l.policy_id
)


SELECT * FROM final
    );
  
[0m17:30:59.407626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:00.469196 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:99e28347-54a4-4d73-904b-6a72b9420913&page=queryresults
[0m17:31:02.904926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '776cda6d-a11b-45a8-9a7d-22cd215cee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1624239e0>]}
[0m17:31:02.906750 [info ] [Thread-1 (]: 3 of 10 OK created sql incremental model single_view_policy_assignment.policy_lifecycle_enriched  [[32mCREATE TABLE (351.0 rows, 44.4 KiB processed)[0m in 3.54s]
[0m17:31:02.907766 [debug] [Thread-1 (]: Finished running node model.my_project.policy_lifecycle_enriched
[0m17:31:02.909195 [debug] [Thread-1 (]: Began running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m17:31:02.909970 [info ] [Thread-1 (]: 4 of 10 START sql view model single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [RUN]
[0m17:31:02.910607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.policy_lifecycle_enriched, now model.my_project.avg_quote_to_bind_by_month_analysis)
[0m17:31:02.911126 [debug] [Thread-1 (]: Began compiling node model.my_project.avg_quote_to_bind_by_month_analysis
[0m17:31:02.916913 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.avg_quote_to_bind_by_month_analysis"
[0m17:31:02.920095 [debug] [Thread-1 (]: Began executing node model.my_project.avg_quote_to_bind_by_month_analysis
[0m17:31:02.940088 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.avg_quote_to_bind_by_month_analysis"
[0m17:31:02.940947 [debug] [Thread-1 (]: On model.my_project.avg_quote_to_bind_by_month_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.avg_quote_to_bind_by_month_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`avg_quote_to_bind_by_month_analysis`
  OPTIONS()
  as 


SELECT event_month, 
AVG(quote_to_bind_hr) AS avg_quote_to_bind_hr
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_hr IS NOT NULL
GROUP BY event_month
ORDER BY event_month;


[0m17:31:02.941312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:03.982572 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:70ca4f00-20ff-4943-9754-f27a2acfba88&page=queryresults
[0m17:31:04.699712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '776cda6d-a11b-45a8-9a7d-22cd215cee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162472930>]}
[0m17:31:04.702782 [info ] [Thread-1 (]: 4 of 10 OK created sql view model single_view_policy_assignment.avg_quote_to_bind_by_month_analysis  [[32mCREATE VIEW (0 processed)[0m in 1.79s]
[0m17:31:04.704434 [debug] [Thread-1 (]: Finished running node model.my_project.avg_quote_to_bind_by_month_analysis
[0m17:31:04.705665 [debug] [Thread-1 (]: Began running node model.my_project.cancelled_within_30_days_analysis
[0m17:31:04.706899 [info ] [Thread-1 (]: 5 of 10 START sql view model single_view_policy_assignment.cancelled_within_30_days_analysis  [RUN]
[0m17:31:04.707981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.avg_quote_to_bind_by_month_analysis, now model.my_project.cancelled_within_30_days_analysis)
[0m17:31:04.708563 [debug] [Thread-1 (]: Began compiling node model.my_project.cancelled_within_30_days_analysis
[0m17:31:04.713953 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.cancelled_within_30_days_analysis"
[0m17:31:04.716117 [debug] [Thread-1 (]: Began executing node model.my_project.cancelled_within_30_days_analysis
[0m17:31:04.720311 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.cancelled_within_30_days_analysis"
[0m17:31:04.721243 [debug] [Thread-1 (]: On model.my_project.cancelled_within_30_days_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.cancelled_within_30_days_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`cancelled_within_30_days_analysis`
  OPTIONS()
  as 

SELECT COUNT(*) AS num_cancelled_within_30_days
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE quote_to_bind_hr IS NOT NULL
  AND bind_to_cancel_hr IS NOT NULL
  AND bind_to_cancel_hr <= 30*24;


[0m17:31:04.721738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:05.714730 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:7c408d53-3054-4714-bd0d-cb85bac0ee14&page=queryresults
[0m17:31:06.324647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '776cda6d-a11b-45a8-9a7d-22cd215cee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16237b320>]}
[0m17:31:06.326247 [info ] [Thread-1 (]: 5 of 10 OK created sql view model single_view_policy_assignment.cancelled_within_30_days_analysis  [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m17:31:06.327147 [debug] [Thread-1 (]: Finished running node model.my_project.cancelled_within_30_days_analysis
[0m17:31:06.327743 [debug] [Thread-1 (]: Began running node model.my_project.dim_event_type
[0m17:31:06.328675 [info ] [Thread-1 (]: 6 of 10 START sql table model single_view_policy_assignment.dim_event_type ..... [RUN]
[0m17:31:06.329824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.cancelled_within_30_days_analysis, now model.my_project.dim_event_type)
[0m17:31:06.330497 [debug] [Thread-1 (]: Began compiling node model.my_project.dim_event_type
[0m17:31:06.335343 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.dim_event_type"
[0m17:31:06.337539 [debug] [Thread-1 (]: Began executing node model.my_project.dim_event_type
[0m17:31:06.340492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:07.096783 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.dim_event_type"
[0m17:31:07.100406 [debug] [Thread-1 (]: On model.my_project.dim_event_type: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.dim_event_type"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`dim_event_type`
      
    
    

    
    OPTIONS()
    as (
      

SELECT DISTINCT
    last_event_type
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    );
  
[0m17:31:07.603230 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:71654981-402e-47ca-a783-f5be61827248&page=queryresults
[0m17:31:09.469523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '776cda6d-a11b-45a8-9a7d-22cd215cee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16237b320>]}
[0m17:31:09.471249 [info ] [Thread-1 (]: 6 of 10 OK created sql table model single_view_policy_assignment.dim_event_type  [[32mCREATE TABLE (3.0 rows, 2.3 KiB processed)[0m in 3.14s]
[0m17:31:09.472319 [debug] [Thread-1 (]: Finished running node model.my_project.dim_event_type
[0m17:31:09.473052 [debug] [Thread-1 (]: Began running node model.my_project.dim_product_type
[0m17:31:09.473963 [info ] [Thread-1 (]: 7 of 10 START sql table model single_view_policy_assignment.dim_product_type ... [RUN]
[0m17:31:09.474711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.dim_event_type, now model.my_project.dim_product_type)
[0m17:31:09.475234 [debug] [Thread-1 (]: Began compiling node model.my_project.dim_product_type
[0m17:31:09.481277 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.dim_product_type"
[0m17:31:09.483427 [debug] [Thread-1 (]: Began executing node model.my_project.dim_product_type
[0m17:31:09.486723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:10.207999 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.dim_product_type"
[0m17:31:10.209620 [debug] [Thread-1 (]: On model.my_project.dim_product_type: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.dim_product_type"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`dim_product_type`
      
    
    

    
    OPTIONS()
    as (
      

SELECT DISTINCT
    product_type
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE product_type IS NOT NULL
    );
  
[0m17:31:10.655812 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:ff5c7505-e213-42ae-9a22-fe6b834fc982&page=queryresults
[0m17:31:12.513681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '776cda6d-a11b-45a8-9a7d-22cd215cee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16249ae10>]}
[0m17:31:12.515529 [info ] [Thread-1 (]: 7 of 10 OK created sql table model single_view_policy_assignment.dim_product_type  [[32mCREATE TABLE (4.0 rows, 2.6 KiB processed)[0m in 3.04s]
[0m17:31:12.516653 [debug] [Thread-1 (]: Finished running node model.my_project.dim_product_type
[0m17:31:12.517412 [debug] [Thread-1 (]: Began running node model.my_project.dim_source_channel
[0m17:31:12.518298 [info ] [Thread-1 (]: 8 of 10 START sql table model single_view_policy_assignment.dim_source_channel . [RUN]
[0m17:31:12.519063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.dim_product_type, now model.my_project.dim_source_channel)
[0m17:31:12.519650 [debug] [Thread-1 (]: Began compiling node model.my_project.dim_source_channel
[0m17:31:12.525761 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.dim_source_channel"
[0m17:31:12.527044 [debug] [Thread-1 (]: Began executing node model.my_project.dim_source_channel
[0m17:31:12.530626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:13.243264 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.dim_source_channel"
[0m17:31:13.246830 [debug] [Thread-1 (]: On model.my_project.dim_source_channel: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.dim_source_channel"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`dim_source_channel`
      
    
    

    
    OPTIONS()
    as (
      

SELECT DISTINCT
    source_channel
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    );
  
[0m17:31:13.672699 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:c8bd7703-c2a8-4afd-90d5-4588b4793e7b&page=queryresults
[0m17:31:15.768732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '776cda6d-a11b-45a8-9a7d-22cd215cee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1623a7d70>]}
[0m17:31:15.770718 [info ] [Thread-1 (]: 8 of 10 OK created sql table model single_view_policy_assignment.dim_source_channel  [[32mCREATE TABLE (4.0 rows, 3.1 KiB processed)[0m in 3.25s]
[0m17:31:15.771879 [debug] [Thread-1 (]: Finished running node model.my_project.dim_source_channel
[0m17:31:15.772673 [debug] [Thread-1 (]: Began running node model.my_project.dim_state
[0m17:31:15.773538 [info ] [Thread-1 (]: 9 of 10 START sql table model single_view_policy_assignment.dim_state .......... [RUN]
[0m17:31:15.774193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.dim_source_channel, now model.my_project.dim_state)
[0m17:31:15.774742 [debug] [Thread-1 (]: Began compiling node model.my_project.dim_state
[0m17:31:15.780873 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.dim_state"
[0m17:31:15.783791 [debug] [Thread-1 (]: Began executing node model.my_project.dim_state
[0m17:31:15.786668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:16.496036 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.dim_state"
[0m17:31:16.499336 [debug] [Thread-1 (]: On model.my_project.dim_state: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.dim_state"} */

  
    

    create or replace table `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`dim_state`
      
    
    

    
    OPTIONS()
    as (
      

SELECT DISTINCT
    state
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE state IS NOT NULL
    );
  
[0m17:31:16.807565 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:ecf06811-8fba-43d8-a063-637af9dac165&page=queryresults
[0m17:31:18.800031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '776cda6d-a11b-45a8-9a7d-22cd215cee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1623a42f0>]}
[0m17:31:18.801720 [info ] [Thread-1 (]: 9 of 10 OK created sql table model single_view_policy_assignment.dim_state ..... [[32mCREATE TABLE (6.0 rows, 1.6 KiB processed)[0m in 3.03s]
[0m17:31:18.803281 [debug] [Thread-1 (]: Finished running node model.my_project.dim_state
[0m17:31:18.804323 [debug] [Thread-1 (]: Began running node model.my_project.quoted_never_bound_analysis
[0m17:31:18.805244 [info ] [Thread-1 (]: 10 of 10 START sql view model single_view_policy_assignment.quoted_never_bound_analysis  [RUN]
[0m17:31:18.806487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_project.dim_state, now model.my_project.quoted_never_bound_analysis)
[0m17:31:18.807117 [debug] [Thread-1 (]: Began compiling node model.my_project.quoted_never_bound_analysis
[0m17:31:18.812428 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.quoted_never_bound_analysis"
[0m17:31:18.814652 [debug] [Thread-1 (]: Began executing node model.my_project.quoted_never_bound_analysis
[0m17:31:18.818507 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.quoted_never_bound_analysis"
[0m17:31:18.819894 [debug] [Thread-1 (]: On model.my_project.quoted_never_bound_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "model.my_project.quoted_never_bound_analysis"} */


  create or replace view `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`quoted_never_bound_analysis`
  OPTIONS()
  as 

SELECT COUNT(*) AS num_quoted_never_bound
FROM `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
WHERE first_quote_ts IS NOT NULL 
    AND first_bind_ts IS NULL;


[0m17:31:18.820486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:19.690886 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:33420748-32c9-4d08-be8e-58f1aae3fd67&page=queryresults
[0m17:31:20.200831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '776cda6d-a11b-45a8-9a7d-22cd215cee10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16223c5c0>]}
[0m17:31:20.203773 [info ] [Thread-1 (]: 10 of 10 OK created sql view model single_view_policy_assignment.quoted_never_bound_analysis  [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m17:31:20.205057 [debug] [Thread-1 (]: Finished running node model.my_project.quoted_never_bound_analysis
[0m17:31:20.207005 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:31:20.265051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:20.265403 [debug] [MainThread]: Connection 'model.my_project.quoted_never_bound_analysis' was properly closed.
[0m17:31:20.265697 [info ] [MainThread]: 
[0m17:31:20.265913 [info ] [MainThread]: Finished running 1 incremental model, 6 table models, 3 view models in 0 hours 0 minutes and 29.52 seconds (29.52s).
[0m17:31:20.266889 [debug] [MainThread]: Command end result
[0m17:31:20.288246 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:31:20.289178 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:31:20.292019 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m17:31:20.292190 [info ] [MainThread]: 
[0m17:31:20.292384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:31:20.292532 [info ] [MainThread]: 
[0m17:31:20.292699 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m17:31:20.292953 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 32.40826, "process_in_blocks": "0", "process_kernel_time": 0.949052, "process_mem_max_rss": "400834560", "process_out_blocks": "0", "process_user_time": 5.273642}
[0m17:31:20.293198 [debug] [MainThread]: Command `dbt run` succeeded at 17:31:20.293157 after 32.41 seconds
[0m17:31:20.293367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160893d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f3c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f3c2c0>]}
[0m17:31:20.293530 [debug] [MainThread]: Flushing usage events
[0m17:31:21.795383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:34:02.842677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bef3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a33e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a581a0>]}


============================== 17:34:02.844373 | 9d8c1f8d-b16f-4824-bc77-0056c2775f54 ==============================
[0m17:34:02.844373 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:34:02.844738 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'version_check': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'invocation_command': 'dbt test', 'no_print': 'None', 'log_format': 'default', 'empty': 'None', 'target_path': 'None', 'warn_error': 'None', 'introspect': 'True', 'partial_parse': 'True', 'debug': 'False', 'quiet': 'False', 'static_parser': 'True', 'write_json': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'printer_width': '80'}
[0m17:34:04.822845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d8c1f8d-b16f-4824-bc77-0056c2775f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f26b0e0>]}
[0m17:34:04.848812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d8c1f8d-b16f-4824-bc77-0056c2775f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16e7d6d20>]}
[0m17:34:04.849134 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:34:04.973207 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:34:05.085801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:34:05.086030 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:34:05.089034 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.persist_docs
- models.my_project.ext
[0m17:34:05.107384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d8c1f8d-b16f-4824-bc77-0056c2775f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f466c90>]}
[0m17:34:05.155953 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:34:05.157343 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:34:05.173655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d8c1f8d-b16f-4824-bc77-0056c2775f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x170081850>]}
[0m17:34:05.173917 [info ] [MainThread]: Found 10 models, 13 data tests, 1 source, 773 macros
[0m17:34:05.174095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d8c1f8d-b16f-4824-bc77-0056c2775f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f2d11f0>]}
[0m17:34:05.175084 [info ] [MainThread]: 
[0m17:34:05.175296 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m17:34:05.175436 [info ] [MainThread]: 
[0m17:34:05.175700 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:34:05.177644 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9_single_view_policy_assignment'
[0m17:34:05.177848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:05.963638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d8c1f8d-b16f-4824-bc77-0056c2775f54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16f687170>]}
[0m17:34:05.964281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:34:06.017569 [debug] [Thread-1 (]: Began running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m17:34:06.017863 [info ] [Thread-1 (]: 1 of 13 START test accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled  [RUN]
[0m17:34:06.018119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715)
[0m17:34:06.018318 [debug] [Thread-1 (]: Began compiling node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m17:34:06.028366 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"
[0m17:34:06.029467 [debug] [Thread-1 (]: Began executing node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m17:34:06.040449 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"
[0m17:34:06.041403 [debug] [Thread-1 (]: On test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        current_status as value_field,
        count(*) as n_records

    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    group by current_status

)

select *
from all_values
where value_field not in (
    'quoted','bound','cancelled'
)



  
  
      
    ) dbt_internal_test
[0m17:34:06.041652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:07.404898 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:55b38272-d576-486d-8312-c1c71582e7c2&page=queryresults
[0m17:34:07.804215 [info ] [Thread-1 (]: 1 of 13 PASS accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled  [[32mPASS[0m in 1.79s]
[0m17:34:07.805559 [debug] [Thread-1 (]: Finished running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m17:34:07.806626 [debug] [Thread-1 (]: Began running node test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9
[0m17:34:07.807311 [info ] [Thread-1 (]: 2 of 13 START test accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel  [RUN]
[0m17:34:07.807943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715, now test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9)
[0m17:34:07.808306 [debug] [Thread-1 (]: Began compiling node test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9
[0m17:34:07.815406 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9"
[0m17:34:07.816228 [debug] [Thread-1 (]: Began executing node test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9
[0m17:34:07.819279 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9"
[0m17:34:07.820328 [debug] [Thread-1 (]: On test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        last_event_type as value_field,
        count(*) as n_records

    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    group by last_event_type

)

select *
from all_values
where value_field not in (
    'quote','bind','cancel'
)



  
  
      
    ) dbt_internal_test
[0m17:34:07.820791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:09.133855 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:616e214e-056d-4b5c-8498-a38b9670498c&page=queryresults
[0m17:34:09.485186 [info ] [Thread-1 (]: 2 of 13 PASS accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel  [[32mPASS[0m in 1.68s]
[0m17:34:09.486231 [debug] [Thread-1 (]: Finished running node test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9
[0m17:34:09.486905 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af
[0m17:34:09.487478 [info ] [Thread-1 (]: 3 of 13 START test dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel  [RUN]
[0m17:34:09.488084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9, now test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af)
[0m17:34:09.488662 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af
[0m17:34:09.501696 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af"
[0m17:34:09.502425 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af
[0m17:34:09.505546 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af"
[0m17:34:09.506621 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with all_values as (

    select
        event_type as value_field

    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
set_values as (

    select
        cast('quote' as string) as value_field
    union all
    select
        cast('bind' as string) as value_field
    union all
    select
        cast('cancel' as string) as value_field
    
    
),
validation_errors as (
    -- values from the model that are not in the set
    select
        v.value_field
    from
        all_values v
        left join
        set_values s on v.value_field = s.value_field
    where
        s.value_field is null

)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m17:34:09.507214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:10.563201 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:143e1e52-33ea-4bf1-bbd4-cad4ae9e0b5f&page=queryresults
[0m17:34:11.095582 [info ] [Thread-1 (]: 3 of 13 PASS dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel  [[32mPASS[0m in 1.61s]
[0m17:34:11.097365 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af
[0m17:34:11.098225 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.a4863a07cd
[0m17:34:11.098964 [info ] [Thread-1 (]: 4 of 13 START test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_  [RUN]
[0m17:34:11.099700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af, now test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.a4863a07cd)
[0m17:34:11.100373 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.a4863a07cd
[0m17:34:11.122999 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.a4863a07cd"
[0m17:34:11.123943 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.a4863a07cd
[0m17:34:11.125956 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.a4863a07cd"
[0m17:34:11.126578 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.a4863a07cd: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.a4863a07cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  


    
regexp_instr(event_timstamp, '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}', 1, 1)


 > 0
 as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  
  
      
    ) dbt_internal_test
[0m17:34:11.126947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:12.162276 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:79de1bea-d415-4aaa-a03e-c56e6954a573&page=queryresults
[0m17:34:12.164436 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:US:79de1bea-d415-4aaa-a03e-c56e6954a573&page=queryresults
[0m17:34:12.175944 [debug] [Thread-1 (]: Database Error in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_ (models/build/source.yml)
  Syntax error: Illegal escape sequence: \d at [24:32]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_631b8cc3a6450cf0a5ca4765fd6e915a.sql
[0m17:34:12.176681 [error] [Thread-1 (]: 4 of 13 ERROR dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_  [[31mERROR[0m in 1.08s]
[0m17:34:12.177860 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.a4863a07cd
[0m17:34:12.178325 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp.3f8e1b8c58
[0m17:34:12.178824 [debug] [Thread-4 (]: Marking all children of 'test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.a4863a07cd' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_ (models/build/source.yml)
  Syntax error: Illegal escape sequence: \d at [24:32]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_631b8cc3a6450cf0a5ca4765fd6e915a.sql.
[0m17:34:12.179271 [info ] [Thread-1 (]: 5 of 13 START test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp  [RUN]
[0m17:34:12.179823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_.a4863a07cd, now test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp.3f8e1b8c58)
[0m17:34:12.180165 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp.3f8e1b8c58
[0m17:34:12.185669 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp.3f8e1b8c58"
[0m17:34:12.186223 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp.3f8e1b8c58
[0m17:34:12.187965 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp.3f8e1b8c58"
[0m17:34:12.188481 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp.3f8e1b8c58: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp.3f8e1b8c58"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  event_timstamp is not null as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




  
  
      
    ) dbt_internal_test
[0m17:34:12.188807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:13.163516 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:318741ce-4de3-4a46-bfa1-7586ce0e2cd1&page=queryresults
[0m17:34:13.164801 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:318741ce-4de3-4a46-bfa1-7586ce0e2cd1&page=queryresults
[0m17:34:13.169746 [debug] [Thread-1 (]: Database Error in test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp (models/build/source.yml)
  Unrecognized name: event_timstamp; Did you mean event_timestamp? at [20:3]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_caf695eeb097548d455e07cdfb79286f.sql
[0m17:34:13.170745 [error] [Thread-1 (]: 5 of 13 ERROR dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp  [[31mERROR[0m in 0.99s]
[0m17:34:13.171743 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp.3f8e1b8c58
[0m17:34:13.172609 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941
[0m17:34:13.173369 [debug] [Thread-4 (]: Marking all children of 'test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp.3f8e1b8c58' to be skipped because of status 'error'.  Reason: Database Error in test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp (models/build/source.yml)
  Unrecognized name: event_timstamp; Did you mean event_timestamp? at [20:3]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_caf695eeb097548d455e07cdfb79286f.sql.
[0m17:34:13.174014 [info ] [Thread-1 (]: 6 of 13 START test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type  [RUN]
[0m17:34:13.174962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp.3f8e1b8c58, now test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941)
[0m17:34:13.175948 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941
[0m17:34:13.183020 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941"
[0m17:34:13.185102 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941
[0m17:34:13.187594 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941"
[0m17:34:13.188446 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  event_type is not null as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




  
  
      
    ) dbt_internal_test
[0m17:34:13.188965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:14.159329 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:e8026ba2-d727-451e-b588-3f5458568bb8&page=queryresults
[0m17:34:14.466093 [info ] [Thread-1 (]: 6 of 13 PASS dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type  [[32mPASS[0m in 1.29s]
[0m17:34:14.467293 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941
[0m17:34:14.468150 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682
[0m17:34:14.468931 [info ] [Thread-1 (]: 7 of 13 START test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id  [RUN]
[0m17:34:14.469699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941, now test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682)
[0m17:34:14.470319 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682
[0m17:34:14.477326 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682"
[0m17:34:14.478539 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682
[0m17:34:14.481915 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682"
[0m17:34:14.482485 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  policy_id is not null as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




  
  
      
    ) dbt_internal_test
[0m17:34:14.482802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:15.431225 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:f4f99aeb-38a3-4f38-99ca-27da4a0762fb&page=queryresults
[0m17:34:15.746466 [error] [Thread-1 (]: 7 of 13 FAIL 1 dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id  [[31mFAIL 1[0m in 1.28s]
[0m17:34:15.747992 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682
[0m17:34:15.748955 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m17:34:15.749878 [info ] [Thread-1 (]: 8 of 13 START test not_null_policy_lifecycle_enriched_current_status ........... [RUN]
[0m17:34:15.750675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682, now test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a)
[0m17:34:15.751275 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m17:34:15.761610 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"
[0m17:34:15.762892 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m17:34:15.765143 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"
[0m17:34:15.765829 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select current_status
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where current_status is null



  
  
      
    ) dbt_internal_test
[0m17:34:15.766400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:16.971110 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:50acf815-3a86-47c2-81b8-e2a37c3a93e9&page=queryresults
[0m17:34:17.299230 [info ] [Thread-1 (]: 8 of 13 PASS not_null_policy_lifecycle_enriched_current_status ................. [[32mPASS[0m in 1.55s]
[0m17:34:17.300218 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m17:34:17.300783 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m17:34:17.301376 [info ] [Thread-1 (]: 9 of 13 START test not_null_policy_lifecycle_enriched_event_month .............. [RUN]
[0m17:34:17.302016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a, now test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87)
[0m17:34:17.302532 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m17:34:17.309743 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"
[0m17:34:17.311154 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m17:34:17.313570 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"
[0m17:34:17.314261 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_month
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where event_month is null



  
  
      
    ) dbt_internal_test
[0m17:34:17.314530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:18.550205 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:f041f412-0562-41e9-bd8f-1f9b4c90f7b4&page=queryresults
[0m17:34:18.864032 [info ] [Thread-1 (]: 9 of 13 PASS not_null_policy_lifecycle_enriched_event_month .................... [[32mPASS[0m in 1.56s]
[0m17:34:18.865569 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m17:34:18.866131 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a
[0m17:34:18.866715 [info ] [Thread-1 (]: 10 of 13 START test not_null_policy_lifecycle_enriched_event_ts ................ [RUN]
[0m17:34:18.867424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87, now test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a)
[0m17:34:18.868002 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a
[0m17:34:18.874436 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a"
[0m17:34:18.875496 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a
[0m17:34:18.877852 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a"
[0m17:34:18.878716 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_ts
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where event_ts is null



  
  
      
    ) dbt_internal_test
[0m17:34:18.879005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:20.082884 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:82bd57e0-3fa9-49f2-88e6-9479d7d5767a&page=queryresults
[0m17:34:20.390574 [info ] [Thread-1 (]: 10 of 13 PASS not_null_policy_lifecycle_enriched_event_ts ...................... [[32mPASS[0m in 1.52s]
[0m17:34:20.391514 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a
[0m17:34:20.392061 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m17:34:20.392736 [info ] [Thread-1 (]: 11 of 13 START test not_null_policy_lifecycle_enriched_first_quote_ts .......... [RUN]
[0m17:34:20.393475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a, now test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0)
[0m17:34:20.394046 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m17:34:20.402489 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"
[0m17:34:20.404437 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m17:34:20.407472 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"
[0m17:34:20.408770 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_quote_ts
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where first_quote_ts is null



  
  
      
    ) dbt_internal_test
[0m17:34:20.409117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:21.628779 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:68a31b19-abe1-4c7e-bb0d-92c04cc91162&page=queryresults
[0m17:34:21.958081 [info ] [Thread-1 (]: 11 of 13 PASS not_null_policy_lifecycle_enriched_first_quote_ts ................ [[32mPASS[0m in 1.56s]
[0m17:34:21.959838 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m17:34:21.960829 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9
[0m17:34:21.961698 [info ] [Thread-1 (]: 12 of 13 START test not_null_policy_lifecycle_enriched_last_event_type ......... [RUN]
[0m17:34:21.962506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0, now test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9)
[0m17:34:21.963133 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9
[0m17:34:21.971311 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9"
[0m17:34:21.972648 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9
[0m17:34:21.976525 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9"
[0m17:34:21.977917 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_event_type
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where last_event_type is null



  
  
      
    ) dbt_internal_test
[0m17:34:21.978803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:23.231789 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:0c5f62a6-424f-4d0e-b9c9-4e03ec73c7d8&page=queryresults
[0m17:34:23.549769 [info ] [Thread-1 (]: 12 of 13 PASS not_null_policy_lifecycle_enriched_last_event_type ............... [[32mPASS[0m in 1.59s]
[0m17:34:23.551211 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9
[0m17:34:23.551934 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m17:34:23.552629 [info ] [Thread-1 (]: 13 of 13 START test not_null_policy_lifecycle_enriched_policy_id ............... [RUN]
[0m17:34:23.553356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9, now test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b)
[0m17:34:23.553940 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m17:34:23.560071 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"
[0m17:34:23.561508 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m17:34:23.564088 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"
[0m17:34:23.564848 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select policy_id
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where policy_id is null



  
  
      
    ) dbt_internal_test
[0m17:34:23.565205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:24.751582 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:8e686f21-c5d8-4d57-a2f3-067bf5e0b055&page=queryresults
[0m17:34:25.075411 [info ] [Thread-1 (]: 13 of 13 PASS not_null_policy_lifecycle_enriched_policy_id ..................... [[32mPASS[0m in 1.52s]
[0m17:34:25.076514 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m17:34:25.078061 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:34:25.126639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:25.126949 [debug] [MainThread]: Connection 'test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b' was properly closed.
[0m17:34:25.127157 [info ] [MainThread]: 
[0m17:34:25.127350 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 19.95 seconds (19.95s).
[0m17:34:25.128616 [debug] [MainThread]: Command end result
[0m17:34:25.150649 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:34:25.152778 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:34:25.157012 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m17:34:25.157219 [info ] [MainThread]: 
[0m17:34:25.157414 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m17:34:25.157568 [info ] [MainThread]: 
[0m17:34:25.157770 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_ (models/build/source.yml)[0m
[0m17:34:25.157960 [error] [MainThread]:   Database Error in test dbt_expectations_source_expect_column_values_to_match_regex_policy_events_policy_events_external_table_event_timstamp___d_4_d_2_d_2_T_d_2_d_2_d_2_ (models/build/source.yml)
  Syntax error: Illegal escape sequence: \d at [24:32]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_631b8cc3a6450cf0a5ca4765fd6e915a.sql
[0m17:34:25.158098 [info ] [MainThread]: 
[0m17:34:25.158262 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/build/source.yml/dbt_expectations_source_expect_631b8cc3a6450cf0a5ca4765fd6e915a.sql
[0m17:34:25.158396 [info ] [MainThread]: 
[0m17:34:25.158556 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp (models/build/source.yml)[0m
[0m17:34:25.158726 [error] [MainThread]:   Database Error in test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timstamp (models/build/source.yml)
  Unrecognized name: event_timstamp; Did you mean event_timestamp? at [20:3]
  compiled code at target/run/my_project/models/build/source.yml/dbt_expectations_source_expect_caf695eeb097548d455e07cdfb79286f.sql
[0m17:34:25.158856 [info ] [MainThread]: 
[0m17:34:25.159009 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/build/source.yml/dbt_expectations_source_expect_caf695eeb097548d455e07cdfb79286f.sql
[0m17:34:25.159132 [info ] [MainThread]: 
[0m17:34:25.159287 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id (models/build/source.yml)[0m
[0m17:34:25.159443 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:34:25.159558 [info ] [MainThread]: 
[0m17:34:25.159705 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/build/source.yml/dbt_expectations_source_expect_220988c18ae28ad56365e52f07aad26c.sql
[0m17:34:25.159834 [info ] [MainThread]: 
[0m17:34:25.159989 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=13
[0m17:34:25.160263 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 22.348625, "process_in_blocks": "0", "process_kernel_time": 0.869087, "process_mem_max_rss": "402767872", "process_out_blocks": "0", "process_user_time": 4.924123}
[0m17:34:25.160553 [debug] [MainThread]: Command `dbt test` failed at 17:34:25.160513 after 22.35 seconds
[0m17:34:25.160760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x17157ca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077533b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a582f0>]}
[0m17:34:25.160929 [debug] [MainThread]: Flushing usage events
[0m17:34:26.303388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:37:12.411896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a07f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d85c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d8320>]}


============================== 17:37:12.413916 | 8bad68bc-7ae5-4a04-8ad9-0e8918270f5a ==============================
[0m17:37:12.413916 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:37:12.414292 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'partial_parse': 'True', 'introspect': 'True', 'printer_width': '80', 'static_parser': 'True', 'empty': 'None', 'version_check': 'True', 'fail_fast': 'False', 'write_json': 'True', 'profiles_dir': '/Users/pratibhagangavarapu/.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/pratibhagangavarapu/my_project/logs', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None'}
[0m17:37:14.655749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bad68bc-7ae5-4a04-8ad9-0e8918270f5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14aca1c70>]}
[0m17:37:14.680982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bad68bc-7ae5-4a04-8ad9-0e8918270f5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ab36d20>]}
[0m17:37:14.681299 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:37:14.803431 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:37:14.921000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:37:14.921604 [debug] [MainThread]: Partial parsing: updated file: my_project://models/build/source.yml
[0m17:37:15.318216 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.my_project.persist_docs
- models.my_project.ext
[0m17:37:15.322800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bad68bc-7ae5-4a04-8ad9-0e8918270f5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b68ef60>]}
[0m17:37:15.365031 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:37:15.366303 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:37:15.383286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bad68bc-7ae5-4a04-8ad9-0e8918270f5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b55d310>]}
[0m17:37:15.383536 [info ] [MainThread]: Found 10 models, 12 data tests, 1 source, 773 macros
[0m17:37:15.383714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bad68bc-7ae5-4a04-8ad9-0e8918270f5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b646960>]}
[0m17:37:15.384652 [info ] [MainThread]: 
[0m17:37:15.384848 [info ] [MainThread]: Concurrency: 1 threads (target='bq')
[0m17:37:15.384982 [info ] [MainThread]: 
[0m17:37:15.385215 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:37:15.387105 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_horizontal-ray-467611-f9_single_view_policy_assignment'
[0m17:37:15.387302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:16.237616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bad68bc-7ae5-4a04-8ad9-0e8918270f5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b6caae0>]}
[0m17:37:16.239138 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:16.303015 [debug] [Thread-1 (]: Began running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m17:37:16.303390 [info ] [Thread-1 (]: 1 of 12 START test accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled  [RUN]
[0m17:37:16.303688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_horizontal-ray-467611-f9_single_view_policy_assignment, now test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715)
[0m17:37:16.304020 [debug] [Thread-1 (]: Began compiling node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m17:37:16.308947 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"
[0m17:37:16.309603 [debug] [Thread-1 (]: Began executing node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m17:37:16.322681 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"
[0m17:37:16.323609 [debug] [Thread-1 (]: On test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        current_status as value_field,
        count(*) as n_records

    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    group by current_status

)

select *
from all_values
where value_field not in (
    'quoted','bound','cancelled'
)



  
  
      
    ) dbt_internal_test
[0m17:37:16.323902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:17.467874 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:8dbd3fca-81d4-4b2f-a0be-1e8d77b2b121&page=queryresults
[0m17:37:18.005457 [info ] [Thread-1 (]: 1 of 12 PASS accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled  [[32mPASS[0m in 1.70s]
[0m17:37:18.007068 [debug] [Thread-1 (]: Finished running node test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715
[0m17:37:18.007762 [debug] [Thread-1 (]: Began running node test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9
[0m17:37:18.008507 [info ] [Thread-1 (]: 2 of 12 START test accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel  [RUN]
[0m17:37:18.009326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.accepted_values_policy_lifecycle_enriched_current_status__quoted__bound__cancelled.f866212715, now test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9)
[0m17:37:18.010040 [debug] [Thread-1 (]: Began compiling node test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9
[0m17:37:18.016594 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9"
[0m17:37:18.018695 [debug] [Thread-1 (]: Began executing node test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9
[0m17:37:18.024340 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9"
[0m17:37:18.025604 [debug] [Thread-1 (]: On test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        last_event_type as value_field,
        count(*) as n_records

    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
    group by last_event_type

)

select *
from all_values
where value_field not in (
    'quote','bind','cancel'
)



  
  
      
    ) dbt_internal_test
[0m17:37:18.026087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:19.045314 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:1de9e1cd-0806-4887-8039-4ac4f982129e&page=queryresults
[0m17:37:19.510202 [info ] [Thread-1 (]: 2 of 12 PASS accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel  [[32mPASS[0m in 1.50s]
[0m17:37:19.512483 [debug] [Thread-1 (]: Finished running node test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9
[0m17:37:19.513224 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af
[0m17:37:19.513938 [info ] [Thread-1 (]: 3 of 12 START test dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel  [RUN]
[0m17:37:19.514669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.accepted_values_policy_lifecycle_enriched_last_event_type__quote__bind__cancel.69e68c75a9, now test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af)
[0m17:37:19.515231 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af
[0m17:37:19.521703 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af"
[0m17:37:19.523228 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af
[0m17:37:19.525927 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af"
[0m17:37:19.527437 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with all_values as (

    select
        event_type as value_field

    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
set_values as (

    select
        cast('quote' as string) as value_field
    union all
    select
        cast('bind' as string) as value_field
    union all
    select
        cast('cancel' as string) as value_field
    
    
),
validation_errors as (
    -- values from the model that are not in the set
    select
        v.value_field
    from
        all_values v
        left join
        set_values s on v.value_field = s.value_field
    where
        s.value_field is null

)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m17:37:19.527904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:20.619737 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:4eb47e1b-84d7-4580-8601-738947322fbb&page=queryresults
[0m17:37:21.223164 [info ] [Thread-1 (]: 3 of 12 PASS dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel  [[32mPASS[0m in 1.71s]
[0m17:37:21.224285 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af
[0m17:37:21.225414 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277
[0m17:37:21.226598 [info ] [Thread-1 (]: 4 of 12 START test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp  [RUN]
[0m17:37:21.227365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_be_in_set_policy_events_policy_events_external_table_event_type__quote__bind__cancel.a40bc764af, now test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277)
[0m17:37:21.227886 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277
[0m17:37:21.251271 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277"
[0m17:37:21.253342 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277
[0m17:37:21.257363 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277"
[0m17:37:21.258295 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  event_timestamp is not null as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




  
  
      
    ) dbt_internal_test
[0m17:37:21.258586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:22.307258 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:1510ee19-d186-48ed-9a95-08df1d32ecdd&page=queryresults
[0m17:37:22.630958 [info ] [Thread-1 (]: 4 of 12 PASS dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp  [[32mPASS[0m in 1.40s]
[0m17:37:22.632573 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277
[0m17:37:22.633397 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941
[0m17:37:22.634181 [info ] [Thread-1 (]: 5 of 12 START test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type  [RUN]
[0m17:37:22.634999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_timestamp.8f6bf8e277, now test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941)
[0m17:37:22.635664 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941
[0m17:37:22.644491 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941"
[0m17:37:22.647217 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941
[0m17:37:22.651265 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941"
[0m17:37:22.652242 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  event_type is not null as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




  
  
      
    ) dbt_internal_test
[0m17:37:22.652788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:23.739365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:48c816f6-e6a9-487e-b82f-94f0a600a025&page=queryresults
[0m17:37:24.029775 [info ] [Thread-1 (]: 5 of 12 PASS dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type  [[32mPASS[0m in 1.39s]
[0m17:37:24.031506 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941
[0m17:37:24.032304 [debug] [Thread-1 (]: Began running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682
[0m17:37:24.033066 [info ] [Thread-1 (]: 6 of 12 START test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id  [RUN]
[0m17:37:24.033863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_event_type.0d8aaa9941, now test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682)
[0m17:37:24.034520 [debug] [Thread-1 (]: Began compiling node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682
[0m17:37:24.042482 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682"
[0m17:37:24.043833 [debug] [Thread-1 (]: Began executing node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682
[0m17:37:24.047185 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682"
[0m17:37:24.048272 [debug] [Thread-1 (]: On test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  




    with grouped_expression as (
    select
        
        
    
  policy_id is not null as expression


    from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_events_external_table`
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




  
  
      
    ) dbt_internal_test
[0m17:37:24.048849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:25.109738 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:bd7b0811-f98a-4cc6-ad08-a300fca763df&page=queryresults
[0m17:37:25.428915 [error] [Thread-1 (]: 6 of 12 FAIL 1 dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id  [[31mFAIL 1[0m in 1.39s]
[0m17:37:25.430366 [debug] [Thread-1 (]: Finished running node test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682
[0m17:37:25.431054 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m17:37:25.431751 [info ] [Thread-1 (]: 7 of 12 START test not_null_policy_lifecycle_enriched_current_status ........... [RUN]
[0m17:37:25.432383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id.92768f7682, now test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a)
[0m17:37:25.432851 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m17:37:25.443342 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"
[0m17:37:25.445912 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m17:37:25.448884 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"
[0m17:37:25.449934 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select current_status
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where current_status is null



  
  
      
    ) dbt_internal_test
[0m17:37:25.450398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:26.379488 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:c866ffec-7022-4f3e-8c72-1c7c7a43904e&page=queryresults
[0m17:37:26.706717 [info ] [Thread-1 (]: 7 of 12 PASS not_null_policy_lifecycle_enriched_current_status ................. [[32mPASS[0m in 1.27s]
[0m17:37:26.708482 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a
[0m17:37:26.709260 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m17:37:26.710034 [info ] [Thread-1 (]: 8 of 12 START test not_null_policy_lifecycle_enriched_event_month .............. [RUN]
[0m17:37:26.710836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_current_status.8f8d355f9a, now test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87)
[0m17:37:26.711424 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m17:37:26.719435 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"
[0m17:37:26.721454 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m17:37:26.724350 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"
[0m17:37:26.725145 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_month
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where event_month is null



  
  
      
    ) dbt_internal_test
[0m17:37:26.725623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:27.794187 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:758655aa-e9c5-4d1e-b951-4b34a49817c6&page=queryresults
[0m17:37:28.279826 [info ] [Thread-1 (]: 8 of 12 PASS not_null_policy_lifecycle_enriched_event_month .................... [[32mPASS[0m in 1.57s]
[0m17:37:28.281432 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87
[0m17:37:28.282141 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a
[0m17:37:28.283137 [info ] [Thread-1 (]: 9 of 12 START test not_null_policy_lifecycle_enriched_event_ts ................. [RUN]
[0m17:37:28.283890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_event_month.c975182f87, now test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a)
[0m17:37:28.284421 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a
[0m17:37:28.290485 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a"
[0m17:37:28.292365 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a
[0m17:37:28.297383 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a"
[0m17:37:28.298214 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_ts
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where event_ts is null



  
  
      
    ) dbt_internal_test
[0m17:37:28.298643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:29.232171 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:739c7ed8-adb1-4625-8d33-9235d48511a4&page=queryresults
[0m17:37:29.629424 [info ] [Thread-1 (]: 9 of 12 PASS not_null_policy_lifecycle_enriched_event_ts ....................... [[32mPASS[0m in 1.35s]
[0m17:37:29.630944 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a
[0m17:37:29.631659 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m17:37:29.632356 [info ] [Thread-1 (]: 10 of 12 START test not_null_policy_lifecycle_enriched_first_quote_ts .......... [RUN]
[0m17:37:29.633077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_event_ts.25f5aa3a8a, now test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0)
[0m17:37:29.633524 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m17:37:29.642252 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"
[0m17:37:29.644914 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m17:37:29.648356 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"
[0m17:37:29.649348 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select first_quote_ts
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where first_quote_ts is null



  
  
      
    ) dbt_internal_test
[0m17:37:29.649855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:30.525310 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:6932e617-9a8d-460f-8e35-1caba7fa1a52&page=queryresults
[0m17:37:30.870435 [info ] [Thread-1 (]: 10 of 12 PASS not_null_policy_lifecycle_enriched_first_quote_ts ................ [[32mPASS[0m in 1.24s]
[0m17:37:30.872211 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0
[0m17:37:30.873006 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9
[0m17:37:30.873975 [info ] [Thread-1 (]: 11 of 12 START test not_null_policy_lifecycle_enriched_last_event_type ......... [RUN]
[0m17:37:30.874905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_first_quote_ts.f079c81fc0, now test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9)
[0m17:37:30.875815 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9
[0m17:37:30.884364 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9"
[0m17:37:30.886853 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9
[0m17:37:30.889558 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9"
[0m17:37:30.890373 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select last_event_type
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where last_event_type is null



  
  
      
    ) dbt_internal_test
[0m17:37:30.890865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:31.847600 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:79f4d982-5808-460c-a36d-94f639c6c14f&page=queryresults
[0m17:37:32.143819 [info ] [Thread-1 (]: 11 of 12 PASS not_null_policy_lifecycle_enriched_last_event_type ............... [[32mPASS[0m in 1.27s]
[0m17:37:32.145282 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9
[0m17:37:32.145903 [debug] [Thread-1 (]: Began running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m17:37:32.146782 [info ] [Thread-1 (]: 12 of 12 START test not_null_policy_lifecycle_enriched_policy_id ............... [RUN]
[0m17:37:32.147822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_project.not_null_policy_lifecycle_enriched_last_event_type.419bba19c9, now test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b)
[0m17:37:32.148434 [debug] [Thread-1 (]: Began compiling node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m17:37:32.154470 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"
[0m17:37:32.156395 [debug] [Thread-1 (]: Began executing node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m17:37:32.159223 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"
[0m17:37:32.160050 [debug] [Thread-1 (]: On test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "my_project", "target_name": "bq", "node_id": "test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select policy_id
from `horizontal-ray-467611-f9`.`single_view_policy_assignment`.`policy_lifecycle_enriched`
where policy_id is null



  
  
      
    ) dbt_internal_test
[0m17:37:32.160466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:33.093288 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=horizontal-ray-467611-f9&j=bq:australia-southeast1:82d2dbdd-fcdf-481d-ad63-43e3b80eef7f&page=queryresults
[0m17:37:33.417396 [info ] [Thread-1 (]: 12 of 12 PASS not_null_policy_lifecycle_enriched_policy_id ..................... [[32mPASS[0m in 1.27s]
[0m17:37:33.419167 [debug] [Thread-1 (]: Finished running node test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b
[0m17:37:33.421515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:37:33.481990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:33.482372 [debug] [MainThread]: Connection 'test.my_project.not_null_policy_lifecycle_enriched_policy_id.adb029a72b' was properly closed.
[0m17:37:33.482610 [info ] [MainThread]: 
[0m17:37:33.482831 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 18.10 seconds (18.10s).
[0m17:37:33.483963 [debug] [MainThread]: Command end result
[0m17:37:33.504974 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/pratibhagangavarapu/my_project/target/manifest.json
[0m17:37:33.505870 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/pratibhagangavarapu/my_project/target/semantic_manifest.json
[0m17:37:33.509536 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/pratibhagangavarapu/my_project/target/run_results.json
[0m17:37:33.509731 [info ] [MainThread]: 
[0m17:37:33.509922 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:37:33.510072 [info ] [MainThread]: 
[0m17:37:33.510263 [error] [MainThread]: [31mFailure in test dbt_expectations_source_expect_column_values_to_not_be_null_policy_events_policy_events_external_table_policy_id (models/build/source.yml)[0m
[0m17:37:33.510449 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:37:33.510579 [info ] [MainThread]: 
[0m17:37:33.510737 [info ] [MainThread]:   compiled code at target/compiled/my_project/models/build/source.yml/dbt_expectations_source_expect_220988c18ae28ad56365e52f07aad26c.sql
[0m17:37:33.510873 [info ] [MainThread]: 
[0m17:37:33.511028 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=12
[0m17:37:33.511269 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 21.134878, "process_in_blocks": "0", "process_kernel_time": 0.967596, "process_mem_max_rss": "408403968", "process_out_blocks": "0", "process_user_time": 5.34983}
[0m17:37:33.511520 [debug] [MainThread]: Command `dbt test` failed at 17:37:33.511480 after 21.14 seconds
[0m17:37:33.511699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c1a4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c138b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b4f1730>]}
[0m17:37:33.511861 [debug] [MainThread]: Flushing usage events
[0m17:37:34.791826 [debug] [MainThread]: An error was encountered while trying to flush usage events
